
<!DOCTYPE html>

<html>
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/><meta content="Docutils 0.17.1: http://docutils.sourceforge.net/" name="generator"/>
<title>Building from source â€” JAX  documentation</title>
<!-- Loaded before other Sphinx assets -->
<link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet"/>
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet"/>
<link href="_static/vendor/fontawesome/5.13.0/css/all.min.css" rel="stylesheet"/>
<link as="font" crossorigin="" href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2" rel="preload" type="font/woff2"/>
<link href="_static/pygments.css" rel="stylesheet" type="text/css">
<link href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" rel="stylesheet" type="text/css">
<link href="_static/plot_directive.css" rel="stylesheet" type="text/css">
<link href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" rel="stylesheet" type="text/css">
<link href="_static/copybutton.css" rel="stylesheet" type="text/css">
<link href="_static/style.css" rel="stylesheet" type="text/css"/>
<!-- Pre-loaded scripts that we'll load fully later -->
<link as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf" rel="preload"/>
<script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
<script src="_static/jquery.js"></script>
<script src="_static/underscore.js"></script>
<script src="_static/doctools.js"></script>
<script src="_static/clipboard.min.js"></script>
<script src="_static/copybutton.js"></script>
<script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
<link href="_static/favicon.png" rel="shortcut icon">
<link href="genindex.html" rel="index" title="Index"/>
<link href="search.html" rel="search" title="Search"/>
<link href="jax_internal_api.html" rel="next" title="Internal APIs"/>
<link href="contributing.html" rel="prev" title="Contributing to JAX"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<meta content="None" name="docsearch:language"/>
<!-- Google Analytics -->
</link></link></link></link></link></link></head>
<body data-offset="60" data-spy="scroll" data-target="#bd-toc-nav">
<!-- Checkboxes to toggle the left sidebar -->
<input aria-label="Toggle navigation sidebar" class="sidebar-toggle" id="__navigation" name="__navigation" type="checkbox"/>
<label class="overlay overlay-navbar" for="__navigation">
<div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input aria-label="Toggle in-page Table of Contents" class="sidebar-toggle" id="__page-toc" name="__page-toc" type="checkbox"/>
<label class="overlay overlay-pagetoc" for="__page-toc">
<div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>
<div class="container-fluid" id="banner"></div>
<div class="container-xl">
<div class="row">
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
<div class="bd-sidebar__content">
<div class="bd-sidebar__top"><div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
<!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
<img alt="logo" class="logo" src="_static/jax_logo_250px.png"/>
</a>
</div><form action="search.html" class="bd-search d-flex align-items-center" method="get">
<i class="icon fas fa-search"></i>
<input aria-label="Search the docs ..." autocomplete="off" class="form-control" id="search-input" name="q" placeholder="Search the docs ..." type="search"/>
</form><nav aria-label="Main" class="bd-links" id="bd-docs-nav">
<div class="bd-toc-item active">
<p aria-level="2" class="caption" role="heading">
<span class="caption-text">
  Getting Started
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1">
<a class="reference internal" href="installation.html">
   Installing JAX
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="notebooks/quickstart.html">
   JAX Quickstart
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="notebooks/thinking_in_jax.html">
   How to Think in JAX
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="notebooks/Common_Gotchas_in_JAX.html">
   ðŸ”ª JAX - The Sharp Bits ðŸ”ª
  </a>
</li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="jax-101/index.html">
   Tutorial: JAX 101
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox">
<label for="toctree-checkbox-1">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="jax-101/01-jax-basics.html">
     JAX As Accelerated NumPy
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="jax-101/02-jitting.html">
     Just In Time Compilation with JAX
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="jax-101/03-vectorization.html">
     Automatic Vectorization in JAX
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="jax-101/04-advanced-autodiff.html">
     Advanced Automatic Differentiation in JAX
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="jax-101/05-random-numbers.html">
     Pseudo Random Numbers in JAX
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="jax-101/05.1-pytrees.html">
     Working with Pytrees
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="jax-101/06-parallelism.html">
     Parallel Evaluation in JAX
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="jax-101/07-state.html">
     Stateful Computations in JAX
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="jax-101/08-pjit.html">
     Introduction to pjit
    </a>
</li>
</ul>
</input></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="debugging/index.html">
   Runtime value debugging in JAX
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox">
<label for="toctree-checkbox-2">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="debugging/print_breakpoint.html">
<code class="docutils literal notranslate">
<span class="pre">
       jax.debug.print
      </span>
</code>
     and
     <code class="docutils literal notranslate">
<span class="pre">
       jax.debug.breakpoint
      </span>
</code>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="debugging/checkify_guide.html">
     The
     <code class="docutils literal notranslate">
<span class="pre">
       checkify
      </span>
</code>
     transformation
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="debugging/flags.html">
     JAX debugging flags
    </a>
</li>
</ul>
</input></li>
</ul>
<p aria-level="2" class="caption" role="heading">
<span class="caption-text">
  Reference Documentation
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1">
<a class="reference internal" href="faq.html">
   JAX Frequently Asked Questions (FAQ)
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="async_dispatch.html">
   Asynchronous dispatch
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="aot.html">
   Ahead-of-time lowering and compilation
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="jaxpr.html">
   Understanding Jaxprs
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="notebooks/convolutions.html">
   Convolutions in JAX
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="pytrees.html">
   Pytrees
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="type_promotion.html">
   Type promotion semantics
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="errors.html">
   JAX Errors
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="transfer_guard.html">
   Transfer guard
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="glossary.html">
   JAX Glossary of Terms
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="changelog.html">
   Change log
  </a>
</li>
</ul>
<p aria-level="2" class="caption" role="heading">
<span class="caption-text">
  Advanced JAX Tutorials
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1">
<a class="reference internal" href="notebooks/autodiff_cookbook.html">
   The Autodiff Cookbook
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="notebooks/vmapped_log_probs.html">
   Autobatching log-densities example
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="notebooks/neural_network_with_tfds_data.html">
   Training a Simple Neural Network, with tensorflow/datasets Data Loading
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="notebooks/Custom_derivative_rules_for_Python_code.html">
   Custom derivative rules for JAX-transformable Python functions
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="notebooks/How_JAX_primitives_work.html">
   How JAX primitives work
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="notebooks/Writing_custom_interpreters_in_Jax.html">
   Writing custom Jaxpr interpreters in JAX
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="notebooks/Neural_Network_and_Data_Loading.html">
   Training a Simple Neural Network, with PyTorch Data Loading
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="notebooks/xmap_tutorial.html">
   Named axes and easy-to-revise parallelism
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="multi_process.html">
   Using JAX in multi-host and multi-process environments
  </a>
</li>
</ul>
<p aria-level="2" class="caption" role="heading">
<span class="caption-text">
  Notes
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1">
<a class="reference internal" href="api_compatibility.html">
   API compatibility
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="deprecation.html">
   Python and NumPy version support policy
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="concurrency.html">
   Concurrency
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="gpu_memory_allocation.html">
   GPU memory allocation
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="profiling.html">
   Profiling JAX programs
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="device_memory_profiling.html">
   Device Memory Profiling
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="rank_promotion_warning.html">
   Rank promotion warning
  </a>
</li>
</ul>
<p aria-level="2" class="caption" role="heading">
<span class="caption-text">
  Developer documentation
 </span>
</p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1">
<a class="reference internal" href="contributing.html">
   Contributing to JAX
  </a>
</li>
<li class="toctree-l1 current active">
<a class="current reference internal" href="#">
   Building from source
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="jax_internal_api.html">
   Internal APIs
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="autodidax.html">
   Autodidax: JAX core from scratch
  </a>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="jep/index.html">
   JAX Enhancement Proposals (JEPs)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox">
<label for="toctree-checkbox-3">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="jep/263-prng.html">
     263: JAX PRNG Design
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="jep/2026-custom-derivatives.html">
     2026: Custom JVP/VJP rules for JAX-transformable functions
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="jep/4008-custom-vjp-update.html">
     4008: Custom VJP and `nondiff_argnums` update
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="jep/4410-omnistaging.html">
     4410: Omnistaging
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="jep/9407-type-promotion.html">
     9407: Design of Type Promotion Semantics for JAX
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="jep/9419-jax-versioning.html">
     9419: Jax and Jaxlib versioning
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="jep/10657-sequencing-effects.html">
     10657: Sequencing side-effects in JAX
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="jep/11830-new-remat-checkpoint.html">
     11830: `jax.remat` / `jax.checkpoint` new implementation
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="jep/12049-type-annotations.html">
     12049: Type Annotation Roadmap for JAX
    </a>
</li>
</ul>
</input></li>
</ul>
<p aria-level="2" class="caption" role="heading">
<span class="caption-text">
  API documentation
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="jax.html">
   Public API: jax package
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
<label for="toctree-checkbox-4">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="jax.numpy.html">
     jax.numpy package
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="jax.scipy.html">
     jax.scipy package
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="jax.config.html">
     JAX configuration
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="jax.debug.html">
     jax.debug package
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="jax.dlpack.html">
     jax.dlpack module
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="jax.distributed.html">
     jax.distributed module
    </a>
</li>
<li class="toctree-l2 has-children">
<a class="reference internal" href="jax.example_libraries.html">
     jax.example_libraries package
    </a>
<input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
<label for="toctree-checkbox-5">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l3">
<a class="reference internal" href="jax.example_libraries.optimizers.html">
       jax.example_libraries.optimizers module
      </a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="jax.example_libraries.stax.html">
       jax.example_libraries.stax module
      </a>
</li>
</ul>
</li>
<li class="toctree-l2 has-children">
<a class="reference internal" href="jax.experimental.html">
     jax.experimental package
    </a>
<input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
<label for="toctree-checkbox-6">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l3">
<a class="reference internal" href="jax.experimental.checkify.html">
       jax.experimental.checkify module
      </a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="jax.experimental.global_device_array.html">
       jax.experimental.global_device_array module
      </a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="jax.experimental.host_callback.html">
       jax.experimental.host_callback module
      </a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="jax.experimental.maps.html">
       jax.experimental.maps module
      </a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="jax.experimental.pjit.html">
       jax.experimental.pjit module
      </a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="jax.experimental.sparse.html">
       jax.experimental.sparse module
      </a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="jax.experimental.jet.html">
       jax.experimental.jet module
      </a>
</li>
</ul>
</li>
<li class="toctree-l2">
<a class="reference internal" href="jax.flatten_util.html">
     jax.flatten_util package
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="jax.image.html">
     jax.image package
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="jax.lax.html">
     jax.lax package
    </a>
</li>
<li class="toctree-l2 has-children">
<a class="reference internal" href="jax.nn.html">
     jax.nn package
    </a>
<input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
<label for="toctree-checkbox-7">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l3">
<a class="reference internal" href="jax.nn.initializers.html">
       jax.nn.initializers package
      </a>
</li>
</ul>
</li>
<li class="toctree-l2">
<a class="reference internal" href="jax.ops.html">
     jax.ops package
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="jax.profiler.html">
     jax.profiler module
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="jax.random.html">
     jax.random package
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="jax.stages.html">
     jax.stages package
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="jax.tree_util.html">
     jax.tree_util package
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="jax.lib.html">
     jax.lib package
    </a>
</li>
</ul>
</li>
</ul>
</div>
</nav></div>
<div class="bd-sidebar__bottom">
<!-- To handle the deprecated key -->
<div class="navbar_extra_footer">
            Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
</div>
</div>
</div>
<div id="rtd-footer-container"></div>
</div>
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
<div class="header-article row sticky-top noprint">
<div class="col py-1 d-flex header-article-main">
<div class="header-article__left">
<label class="headerbtn" data-placement="right" data-toggle="tooltip" for="__navigation" title="Toggle navigation">
<span class="headerbtn__icon-container">
<i class="fas fa-bars"></i>
</span>
</label>
</div>
<div class="header-article__right">
<button class="headerbtn" data-placement="bottom" data-toggle="tooltip" onclick="toggleFullScreen()" title="Fullscreen mode">
<span class="headerbtn__icon-container">
<i class="fas fa-expand"></i>
</span>
</button>
<a class="headerbtn" data-placement="bottom" data-toggle="tooltip" href="https://github.com/google/jax" title="Source repository">
<span class="headerbtn__icon-container">
<i class="fab fa-github"></i>
</span>
</a>
<div class="menu-dropdown menu-dropdown-download-buttons">
<button aria-label="Download this page" class="headerbtn menu-dropdown__trigger">
<i class="fas fa-download"></i>
</button>
<div class="menu-dropdown__content">
<ul>
<li>
<a class="headerbtn" data-placement="left" data-toggle="tooltip" href="_sources/developer.md.txt" title="Download source file">
<span class="headerbtn__icon-container">
<i class="fas fa-file"></i>
</span>
<span class="headerbtn__text-container">.md</span>
</a>
</li>
<li>
<button class="headerbtn" data-placement="left" data-toggle="tooltip" onclick="printPdf(this)" title="Print to PDF">
<span class="headerbtn__icon-container">
<i class="fas fa-file-pdf"></i>
</span>
<span class="headerbtn__text-container">.pdf</span>
</button>
</li>
</ul>
</div>
</div>
<label class="headerbtn headerbtn-page-toc" for="__page-toc">
<span class="headerbtn__icon-container">
<i class="fas fa-list"></i>
</span>
</label>
</div>
</div>
<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
<div class="tocsection onthispage pt-5 pb-3">
<i class="fas fa-list"></i> Contents
    </div>
<nav aria-label="Page" id="bd-toc-nav">
<ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#">
   Building from source
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#building-or-installing-jaxlib">
     Building or installing
     <code class="docutils literal notranslate">
<span class="pre">
       jaxlib
      </span>
</code>
</a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#installing-jaxlib-with-pip">
       Installing
       <code class="docutils literal notranslate">
<span class="pre">
         jaxlib
        </span>
</code>
       with pip
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#building-jaxlib-from-source">
       Building
       <code class="docutils literal notranslate">
<span class="pre">
         jaxlib
        </span>
</code>
       from source
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#building-jaxlib-from-source-with-a-modified-tensorflow-repository">
       Building jaxlib from source with a modified TensorFlow repository.
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#additional-notes-for-building-jaxlib-from-source-on-windows">
       Additional Notes for Building
       <code class="docutils literal notranslate">
<span class="pre">
         jaxlib
        </span>
</code>
       from source on Windows
      </a>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#installing-jax">
     Installing
     <code class="docutils literal notranslate">
<span class="pre">
       jax
      </span>
</code>
</a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#running-the-tests">
   Running the tests
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#using-bazel">
     Using Bazel
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#using-pytest">
     Using pytest
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#controlling-test-behavior">
     Controlling test behavior
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#doctests">
     Doctests
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#type-checking">
   Type checking
  </a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#linting">
   Linting
  </a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#update-documentation">
   Update documentation
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#update-notebooks">
     Update notebooks
    </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#editing-ipynb">
       Editing ipynb
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#editing-md">
       Editing md
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#syncing-notebooks">
       Syncing notebooks
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#creating-new-notebooks">
       Creating new notebooks
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#notebooks-within-the-sphinx-build">
       Notebooks within the sphinx build
      </a>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#documentation-building-on-readthedocs-io">
     Documentation building on readthedocs.io
    </a>
</li>
</ul>
</li>
</ul>
</nav>
</div>
</div>
<div class="article row">
<div class="col pl-md-3 pl-lg-5 content-container">
<!-- Table of contents that is only displayed when printing the page -->
<div class="onlyprint" id="jb-print-docs-body">
<h1>Building from source</h1>
<!-- Table of contents -->
<div id="print-main-content">
<div id="jb-print-toc">
<div>
<h2> Contents </h2>
</div>
<nav aria-label="Page">
<ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#">
   Building from source
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#building-or-installing-jaxlib">
     Building or installing
     <code class="docutils literal notranslate">
<span class="pre">
       jaxlib
      </span>
</code>
</a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#installing-jaxlib-with-pip">
       Installing
       <code class="docutils literal notranslate">
<span class="pre">
         jaxlib
        </span>
</code>
       with pip
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#building-jaxlib-from-source">
       Building
       <code class="docutils literal notranslate">
<span class="pre">
         jaxlib
        </span>
</code>
       from source
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#building-jaxlib-from-source-with-a-modified-tensorflow-repository">
       Building jaxlib from source with a modified TensorFlow repository.
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#additional-notes-for-building-jaxlib-from-source-on-windows">
       Additional Notes for Building
       <code class="docutils literal notranslate">
<span class="pre">
         jaxlib
        </span>
</code>
       from source on Windows
      </a>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#installing-jax">
     Installing
     <code class="docutils literal notranslate">
<span class="pre">
       jax
      </span>
</code>
</a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#running-the-tests">
   Running the tests
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#using-bazel">
     Using Bazel
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#using-pytest">
     Using pytest
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#controlling-test-behavior">
     Controlling test behavior
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#doctests">
     Doctests
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#type-checking">
   Type checking
  </a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#linting">
   Linting
  </a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#update-documentation">
   Update documentation
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#update-notebooks">
     Update notebooks
    </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#editing-ipynb">
       Editing ipynb
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#editing-md">
       Editing md
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#syncing-notebooks">
       Syncing notebooks
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#creating-new-notebooks">
       Creating new notebooks
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#notebooks-within-the-sphinx-build">
       Notebooks within the sphinx build
      </a>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#documentation-building-on-readthedocs-io">
     Documentation building on readthedocs.io
    </a>
</li>
</ul>
</li>
</ul>
</nav>
</div>
</div>
</div>
<main id="main-content" role="main">
<div>
<a class="dashAnchor" name="//apple_ref/cpp/Section/Building from source"></a><section class="tex2jax_ignore mathjax_ignore" id="building-from-source">
<h1>Building from source<a class="headerlink" href="#building-from-source" title="Permalink to this headline">#</a></h1>
<p>First, obtain the JAX source code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">google</span><span class="o">/</span><span class="n">jax</span>
<span class="n">cd</span> <span class="n">jax</span>
</pre></div>
</div>
<p>Building JAX involves two steps:</p>
<ol class="arabic simple">
<li><p>Building or installing <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code>, the C++ support library for <code class="docutils literal notranslate"><span class="pre">jax</span></code>.</p></li>
<li><p>Installing the <code class="docutils literal notranslate"><span class="pre">jax</span></code> Python package.</p></li>
</ol>
<a class="dashAnchor" name="//apple_ref/cpp/Section/Building or installing jaxlib"></a><section id="building-or-installing-jaxlib">
<h2>Building or installing <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code><a class="headerlink" href="#building-or-installing-jaxlib" title="Permalink to this headline">#</a></h2>
<a class="dashAnchor" name="//apple_ref/cpp/Section/Installing jaxlib with pip"></a><section id="installing-jaxlib-with-pip">
<h3>Installing <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code> with pip<a class="headerlink" href="#installing-jaxlib-with-pip" title="Permalink to this headline">#</a></h3>
<p>If youâ€™re only modifying Python portions of JAX, we recommend installing
<code class="docutils literal notranslate"><span class="pre">jaxlib</span></code> from a prebuilt wheel using pip:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">jaxlib</span>
</pre></div>
</div>
<p>See the <a class="reference external" href="https://github.com/google/jax#installation">JAX readme</a> for full
guidance on pip installation (e.g., for GPU and TPU support).</p>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/Building jaxlib from source"></a><section id="building-jaxlib-from-source">
<h3>Building <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code> from source<a class="headerlink" href="#building-jaxlib-from-source" title="Permalink to this headline">#</a></h3>
<p>To build <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code> from source, you must also install some prerequisites:</p>
<ul>
<li><p>a C++ compiler (g++, clang, or MSVC)</p>
<p>On Ubuntu or Debian you can install the necessary prerequisites with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">apt</span> <span class="n">install</span> <span class="n">g</span><span class="o">++</span> <span class="n">python</span> <span class="n">python3</span><span class="o">-</span><span class="n">dev</span>
</pre></div>
</div>
<p>If you are building on a Mac, make sure XCode and the XCode command line tools
are installed.</p>
<p>See below for Windows build instructions.</p>
</li>
<li><p>Python packages: <code class="docutils literal notranslate"><span class="pre">numpy</span></code>, <code class="docutils literal notranslate"><span class="pre">wheel</span></code>.</p></li>
</ul>
<p>You can install the necessary Python dependencies using <code class="docutils literal notranslate"><span class="pre">pip</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">numpy</span> <span class="n">wheel</span>
</pre></div>
</div>
<p>To build <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code> without CUDA GPU or TPU support (CPU only), you can run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">build</span><span class="o">/</span><span class="n">build</span><span class="o">.</span><span class="n">py</span>
<span class="n">pip</span> <span class="n">install</span> <span class="n">dist</span><span class="o">/*.</span><span class="n">whl</span>  <span class="c1"># installs jaxlib (includes XLA)</span>
</pre></div>
</div>
<p>To build <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code> with CUDA support, use <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">build/build.py</span> <span class="pre">--enable_cuda</span></code>;
to build with TPU support, use <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">build/build.py</span> <span class="pre">--enable_tpu</span></code>.</p>
<p>See <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">build/build.py</span> <span class="pre">--help</span></code> for configuration options, including ways to
specify the paths to CUDA and CUDNN, which you must have installed. Here
<code class="docutils literal notranslate"><span class="pre">python</span></code> should be the name of your Python 3 interpreter; on some systems, you
may need to use <code class="docutils literal notranslate"><span class="pre">python3</span></code> instead. By default, the wheel is written to the
<code class="docutils literal notranslate"><span class="pre">dist/</span></code> subdirectory of the current directory.</p>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/Building jaxlib from source with a modified TensorFlow repository."></a><section id="building-jaxlib-from-source-with-a-modified-tensorflow-repository">
<h3>Building jaxlib from source with a modified TensorFlow repository.<a class="headerlink" href="#building-jaxlib-from-source-with-a-modified-tensorflow-repository" title="Permalink to this headline">#</a></h3>
<p>JAX depends on XLA, whose source code is in the
<a class="reference external" href="https://github.com/tensorflow/tensorflow">Tensorflow GitHub repository</a>.
By default JAX uses a pinned copy of the TensorFlow repository, but we often
want to use a locally-modified copy of XLA when working on JAX. There are two
ways to do this:</p>
<ul>
<li><p>use Bazelâ€™s <code class="docutils literal notranslate"><span class="pre">override_repository</span></code> feature, which you can pass as a command
line flag to <code class="docutils literal notranslate"><span class="pre">build.py</span></code> as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">build</span><span class="o">/</span><span class="n">build</span><span class="o">.</span><span class="n">py</span> <span class="o">--</span><span class="n">bazel_options</span><span class="o">=--</span><span class="n">override_repository</span><span class="o">=</span><span class="n">org_tensorflow</span><span class="o">=/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">tensorflow</span>
</pre></div>
</div>
</li>
<li><p>modify the <code class="docutils literal notranslate"><span class="pre">WORKSPACE</span></code> file in the root of the JAX source tree to point to
a different TensorFlow tree.</p></li>
</ul>
<p>To contribute changes back to XLA, send PRs to the TensorFlow repository.</p>
<p>The version of XLA pinned by JAX is regularly updated, but is updated in
particular before each <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code> release.</p>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/Additional Notes for Building jaxlib from source on Windows"></a><section id="additional-notes-for-building-jaxlib-from-source-on-windows">
<h3>Additional Notes for Building <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code> from source on Windows<a class="headerlink" href="#additional-notes-for-building-jaxlib-from-source-on-windows" title="Permalink to this headline">#</a></h3>
<p>On Windows, follow <a class="reference external" href="https://docs.microsoft.com/en-us/visualstudio/install/install-visual-studio?view=vs-2019">Install Visual Studio</a>
to set up a C++ toolchain. Visual Studio 2019 version 16.5 or newer is required.
If you need to build with CUDA enabled, follow the
<a class="reference external" href="https://docs.nvidia.com/cuda/cuda-installation-guide-microsoft-windows/index.html">CUDA Installation Guide</a>
to set up a CUDA environment.</p>
<p>JAX builds use symbolic links, which require that you activate
<a class="reference external" href="https://docs.microsoft.com/en-us/windows/apps/get-started/enable-your-device-for-development">Developer Mode</a>.</p>
<p>You can either install Python using its
<a class="reference external" href="https://www.python.org/downloads/">Windows installer</a>, or if you prefer, you
can use <a class="reference external" href="https://docs.anaconda.com/anaconda/install/windows/">Anaconda</a>
or <a class="reference external" href="https://docs.conda.io/en/latest/miniconda.html#windows-installers">Miniconda</a>
to set up a Python environment.</p>
<p>Some targets of Bazel use bash utilities to do scripting, so <a class="reference external" href="https://www.msys2.org">MSYS2</a>
is needed. See <a class="reference external" href="https://bazel.build/install/windows#install-compilers">Installing Bazel on Windows</a>
for more details. Install the following packages:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pacman</span> <span class="o">-</span><span class="n">S</span> <span class="n">patch</span> <span class="n">coreutils</span>
</pre></div>
</div>
<p>Once coreutils is installed, the realpath command should be present in your shellâ€™s path.</p>
<p>Once everything is installed. Open PowerShell, and make sure MSYS2 is in the
path of the current session. Ensure <code class="docutils literal notranslate"><span class="pre">bazel</span></code>, <code class="docutils literal notranslate"><span class="pre">patch</span></code> and <code class="docutils literal notranslate"><span class="pre">realpath</span></code> are
accessible. Activate the conda environment. The following command builds with
CUDA enabled, adjust it to whatever suitable for you:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>python .\build\build.py `
  --enable_cuda `
  --cuda_path='C:/Program Files/NVIDIA GPU Computing Toolkit/CUDA/v10.1' `
  --cudnn_path='C:/Program Files/NVIDIA GPU Computing Toolkit/CUDA/v10.1' `
  --cuda_version='10.1' `
  --cudnn_version='7.6.5'
</pre></div>
</div>
<p>To build with debug information, add the flag <code class="docutils literal notranslate"><span class="pre">--bazel_options='--copt=/Z7'</span></code>.</p>
</section>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/Installing jax"></a><section id="installing-jax">
<h2>Installing <code class="docutils literal notranslate"><span class="pre">jax</span></code><a class="headerlink" href="#installing-jax" title="Permalink to this headline">#</a></h2>
<p>Once <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code> has been installed, you can install <code class="docutils literal notranslate"><span class="pre">jax</span></code> by running:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="o">-</span><span class="n">e</span> <span class="o">.</span>  <span class="c1"># installs jax</span>
</pre></div>
</div>
<p>To upgrade to the latest version from GitHub, just run <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">pull</span></code> from the JAX
repository root, and rebuild by running <code class="docutils literal notranslate"><span class="pre">build.py</span></code> or upgrading <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code> if
necessary. You shouldnâ€™t have to reinstall <code class="docutils literal notranslate"><span class="pre">jax</span></code> because <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">-e</span></code>
sets up symbolic links from site-packages into the repository.</p>
</section>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/Running the tests"></a><section class="tex2jax_ignore mathjax_ignore" id="running-the-tests">
<a class="dashAnchor" name="//apple_ref/cpp/Section/Running the tests"></a><span id="running-tests"></span><h1>Running the tests<a class="headerlink" href="#running-the-tests" title="Permalink to this headline">#</a></h1>
<p>There are two supported mechanisms for running the JAX tests, either using Bazel
or using pytest.</p>
<a class="dashAnchor" name="//apple_ref/cpp/Section/Using Bazel"></a><section id="using-bazel">
<h2>Using Bazel<a class="headerlink" href="#using-bazel" title="Permalink to this headline">#</a></h2>
<p>First, configure the JAX build by running:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">build</span><span class="o">/</span><span class="n">build</span><span class="o">.</span><span class="n">py</span> <span class="o">--</span><span class="n">configure_only</span>
</pre></div>
</div>
<p>You may pass additional options to <code class="docutils literal notranslate"><span class="pre">build.py</span></code> to configure the build; see the
<code class="docutils literal notranslate"><span class="pre">jaxlib</span></code> build documentation for details.</p>
<p>By default the Bazel build runs the JAX tests using <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code> built form source.
To run JAX tests, run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">bazel</span> <span class="n">test</span> <span class="o">//</span><span class="n">tests</span><span class="p">:</span><span class="n">cpu_tests</span> <span class="o">//</span><span class="n">tests</span><span class="p">:</span><span class="n">backend_independent_tests</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">//tests:gpu_tests</span></code> and <code class="docutils literal notranslate"><span class="pre">//tests:tpu_tests</span></code> are also available, if you have the necessary hardware.</p>
<p>To use a preinstalled <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code> instead of building <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code> from source, run</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">bazel</span> <span class="n">test</span> <span class="o">--//</span><span class="n">jax</span><span class="p">:</span><span class="n">build_jaxlib</span><span class="o">=</span><span class="n">false</span> <span class="o">//</span><span class="n">tests</span><span class="p">:</span><span class="n">cpu_tests</span> <span class="o">//</span><span class="n">tests</span><span class="p">:</span><span class="n">backend_independent_tests</span>
</pre></div>
</div>
<p>A number of test behaviors can be controlled using environment variables (see
below). Environment variables may be passed to JAX tests using the
<code class="docutils literal notranslate"><span class="pre">--test_env=FLAG=value</span></code> flag to Bazel.</p>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/Using pytest"></a><section id="using-pytest">
<h2>Using pytest<a class="headerlink" href="#using-pytest" title="Permalink to this headline">#</a></h2>
<p>To run all the JAX tests using <code class="docutils literal notranslate"><span class="pre">pytest</span></code>, we recommend using <code class="docutils literal notranslate"><span class="pre">pytest-xdist</span></code>,
which can run tests in parallel. First, install <code class="docutils literal notranslate"><span class="pre">pytest-xdist</span></code> and
<code class="docutils literal notranslate"><span class="pre">pytest-benchmark</span></code> by running <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">-r</span> <span class="pre">build/test-requirements.txt</span></code>.
Then, from the repository root directory run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pytest</span> <span class="o">-</span><span class="n">n</span> <span class="n">auto</span> <span class="n">tests</span>
</pre></div>
</div>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/Controlling test behavior"></a><section id="controlling-test-behavior">
<h2>Controlling test behavior<a class="headerlink" href="#controlling-test-behavior" title="Permalink to this headline">#</a></h2>
<p>JAX generates test cases combinatorially, and you can control the number of
cases that are generated and checked for each test (default is 10) using the
<code class="docutils literal notranslate"><span class="pre">JAX_NUM_GENERATED_CASES</span></code> environment variable. The automated tests
currently use 25 by default.</p>
<p>For example, one might write</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span># Bazel
bazel test //tests/... --test_env=JAX_NUM_GENERATED_CASES=25`
</pre></div>
</div>
<p>or</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># pytest</span>
<span class="n">JAX_NUM_GENERATED_CASES</span><span class="o">=</span><span class="mi">25</span> <span class="n">pytest</span> <span class="o">-</span><span class="n">n</span> <span class="n">auto</span> <span class="n">tests</span>
</pre></div>
</div>
<p>The automated tests also run the tests with default 64-bit floats and ints
(<code class="docutils literal notranslate"><span class="pre">JAX_ENABLE_X64</span></code>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">JAX_ENABLE_X64</span><span class="o">=</span><span class="mi">1</span> <span class="n">JAX_NUM_GENERATED_CASES</span><span class="o">=</span><span class="mi">25</span> <span class="n">pytest</span> <span class="o">-</span><span class="n">n</span> <span class="n">auto</span> <span class="n">tests</span>
</pre></div>
</div>
<p>You can run a more specific set of tests using
<a class="reference external" href="https://docs.pytest.org/en/latest/usage.html#specifying-tests-selecting-tests">pytest</a>â€™s
built-in selection mechanisms, or alternatively you can run a specific test
file directly to see more detailed information about the cases being run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">tests</span><span class="o">/</span><span class="n">lax_numpy_test</span><span class="o">.</span><span class="n">py</span> <span class="o">--</span><span class="n">num_generated_cases</span><span class="o">=</span><span class="mi">5</span>
</pre></div>
</div>
<p>You can skip a few tests known to be slow, by passing environment variable
JAX_SKIP_SLOW_TESTS=1.</p>
<p>To specify a particular set of tests to run from a test file, you can pass a string
or regular expression via the <code class="docutils literal notranslate"><span class="pre">--test_targets</span></code> flag. For example, you can run all
the tests of <code class="docutils literal notranslate"><span class="pre">jax.numpy.pad</span></code> using:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">tests</span><span class="o">/</span><span class="n">lax_numpy_test</span><span class="o">.</span><span class="n">py</span> <span class="o">--</span><span class="n">test_targets</span><span class="o">=</span><span class="s2">"testPad"</span>
</pre></div>
</div>
<p>The Colab notebooks are tested for errors as part of the documentation build.</p>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/Doctests"></a><section id="doctests">
<h2>Doctests<a class="headerlink" href="#doctests" title="Permalink to this headline">#</a></h2>
<p>JAX uses pytest in doctest mode to test the code examples within the documentation.
You can run this using</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pytest</span> <span class="n">docs</span>
</pre></div>
</div>
<p>Additionally, JAX runs pytest in <code class="docutils literal notranslate"><span class="pre">doctest-modules</span></code> mode to ensure code examples in
function docstrings will run correctly. You can run this locally using, for example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pytest</span> <span class="o">--</span><span class="n">doctest</span><span class="o">-</span><span class="n">modules</span> <span class="n">jax</span><span class="o">/</span><span class="n">_src</span><span class="o">/</span><span class="n">numpy</span><span class="o">/</span><span class="n">lax_numpy</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>Keep in mind that there are several files that are marked to be skipped when the
doctest command is run on the full package; you can see the details in
<a class="reference external" href="https://github.com/google/jax/blob/main/.github/workflows/ci-build.yaml"><code class="docutils literal notranslate"><span class="pre">ci-build.yaml</span></code></a></p>
</section>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/Type checking"></a><section class="tex2jax_ignore mathjax_ignore" id="type-checking">
<h1>Type checking<a class="headerlink" href="#type-checking" title="Permalink to this headline">#</a></h1>
<p>We use <code class="docutils literal notranslate"><span class="pre">mypy</span></code> to check the type hints. To check types locally the same way
as the CI checks them:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">mypy</span>
<span class="n">mypy</span> <span class="o">--</span><span class="n">config</span><span class="o">=</span><span class="n">mypy</span><span class="o">.</span><span class="n">ini</span> <span class="o">--</span><span class="n">show</span><span class="o">-</span><span class="n">error</span><span class="o">-</span><span class="n">codes</span> <span class="n">jax</span>
</pre></div>
</div>
<p>Alternatively, you can use the <a class="reference external" href="https://pre-commit.com/">pre-commit</a> framework to run this
on all staged files in your git repository, automatically using the same mypy version as
in the GitHub CI:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pre</span><span class="o">-</span><span class="n">commit</span> <span class="n">run</span> <span class="n">mypy</span>
</pre></div>
</div>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/Linting"></a><section class="tex2jax_ignore mathjax_ignore" id="linting">
<h1>Linting<a class="headerlink" href="#linting" title="Permalink to this headline">#</a></h1>
<p>JAX uses the <a class="reference external" href="https://flake8.pycqa.org/">flake8</a> linter to ensure code quality. You can check
your local changes by running:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">flake8</span>
<span class="n">flake8</span> <span class="n">jax</span>
</pre></div>
</div>
<p>Alternatively, you can use the <a class="reference external" href="https://pre-commit.com/">pre-commit</a> framework to run this
on all staged files in your git repository, automatically using the same flake8 version as
the GitHub tests:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pre</span><span class="o">-</span><span class="n">commit</span> <span class="n">run</span> <span class="n">flake8</span>
</pre></div>
</div>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/Update documentation"></a><section class="tex2jax_ignore mathjax_ignore" id="update-documentation">
<h1>Update documentation<a class="headerlink" href="#update-documentation" title="Permalink to this headline">#</a></h1>
<p>To rebuild the documentation, install several packages:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="o">-</span><span class="n">r</span> <span class="n">docs</span><span class="o">/</span><span class="n">requirements</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
<p>And then run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx</span><span class="o">-</span><span class="n">build</span> <span class="o">-</span><span class="n">b</span> <span class="n">html</span> <span class="n">docs</span> <span class="n">docs</span><span class="o">/</span><span class="n">build</span><span class="o">/</span><span class="n">html</span> <span class="o">-</span><span class="n">j</span> <span class="n">auto</span>
</pre></div>
</div>
<p>This can take a long time because it executes many of the notebooks in the documentation source;
if youâ€™d prefer to build the docs without executing the notebooks, you can run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sphinx</span><span class="o">-</span><span class="n">build</span> <span class="o">-</span><span class="n">b</span> <span class="n">html</span> <span class="o">-</span><span class="n">D</span> <span class="n">nb_execution_mode</span><span class="o">=</span><span class="n">off</span> <span class="n">docs</span> <span class="n">docs</span><span class="o">/</span><span class="n">build</span><span class="o">/</span><span class="n">html</span> <span class="o">-</span><span class="n">j</span> <span class="n">auto</span>
</pre></div>
</div>
<p>You can then see the generated documentation in <code class="docutils literal notranslate"><span class="pre">docs/build/html/index.html</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">-j</span> <span class="pre">auto</span></code> option controls the parallelism of the build. You can use a number
in place of <code class="docutils literal notranslate"><span class="pre">auto</span></code> to control how many CPU cores to use.</p>
<a class="dashAnchor" name="//apple_ref/cpp/Section/Update notebooks"></a><section id="update-notebooks">
<a class="dashAnchor" name="//apple_ref/cpp/Section/Update notebooks"></a><span id="id1"></span><h2>Update notebooks<a class="headerlink" href="#update-notebooks" title="Permalink to this headline">#</a></h2>
<p>We use <a class="reference external" href="https://jupytext.readthedocs.io/">jupytext</a> to maintain two synced copies of the notebooks
in <code class="docutils literal notranslate"><span class="pre">docs/notebooks</span></code>: one in <code class="docutils literal notranslate"><span class="pre">ipynb</span></code> format, and one in <code class="docutils literal notranslate"><span class="pre">md</span></code> format. The advantage of the former
is that it can be opened and executed directly in Colab; the advantage of the latter is that
it makes it much easier to track diffs within version control.</p>
<a class="dashAnchor" name="//apple_ref/cpp/Section/Editing ipynb"></a><section id="editing-ipynb">
<h3>Editing ipynb<a class="headerlink" href="#editing-ipynb" title="Permalink to this headline">#</a></h3>
<p>For making large changes that substantially modify code and outputs, it is easiest to
edit the notebooks in Jupyter or in Colab. To edit notebooks in the Colab interface,
open <a class="reference external" href="http://colab.research.google.com">http://colab.research.google.com</a> and <code class="docutils literal notranslate"><span class="pre">Upload</span></code> from your local repo.
Update it as needed, <code class="docutils literal notranslate"><span class="pre">Run</span> <span class="pre">all</span> <span class="pre">cells</span></code> then <code class="docutils literal notranslate"><span class="pre">Download</span> <span class="pre">ipynb</span></code>.
You may want to test that it executes properly, using <code class="docutils literal notranslate"><span class="pre">sphinx-build</span></code> as explained above.</p>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/Editing md"></a><section id="editing-md">
<h3>Editing md<a class="headerlink" href="#editing-md" title="Permalink to this headline">#</a></h3>
<p>For making smaller changes to the text content of the notebooks, it is easiest to edit the
<code class="docutils literal notranslate"><span class="pre">.md</span></code> versions using a text editor.</p>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/Syncing notebooks"></a><section id="syncing-notebooks">
<h3>Syncing notebooks<a class="headerlink" href="#syncing-notebooks" title="Permalink to this headline">#</a></h3>
<p>After editing either the ipynb or md versions of the notebooks, you can sync the two versions
using <a class="reference external" href="https://jupytext.readthedocs.io/">jupytext</a> by running <code class="docutils literal notranslate"><span class="pre">jupytext</span> <span class="pre">--sync</span></code> on the updated
notebooks; for example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">jupytext</span><span class="o">==</span><span class="mf">1.13.8</span>
<span class="n">jupytext</span> <span class="o">--</span><span class="n">sync</span> <span class="n">docs</span><span class="o">/</span><span class="n">notebooks</span><span class="o">/</span><span class="n">quickstart</span><span class="o">.</span><span class="n">ipynb</span>
</pre></div>
</div>
<p>The jupytext version should match that specified in
<a class="reference external" href="https://github.com/google/jax/blob/main/.pre-commit-config.yaml">.pre-commit-config.yaml</a>.</p>
<p>To check that the markdown and ipynb files are properly synced, you may use the
<a class="reference external" href="https://pre-commit.com/">pre-commit</a> framework to perform the same check used
by the github CI:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">add</span> <span class="n">docs</span> <span class="o">-</span><span class="n">u</span>  <span class="c1"># pre-commit runs on files in git staging.</span>
<span class="n">pre</span><span class="o">-</span><span class="n">commit</span> <span class="n">run</span> <span class="n">jupytext</span>
</pre></div>
</div>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/Creating new notebooks"></a><section id="creating-new-notebooks">
<h3>Creating new notebooks<a class="headerlink" href="#creating-new-notebooks" title="Permalink to this headline">#</a></h3>
<p>If you are adding a new notebook to the documentation and would like to use the <code class="docutils literal notranslate"><span class="pre">jupytext</span> <span class="pre">--sync</span></code>
command discussed here, you can set up your notebook for jupytext by using the following command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">jupytext</span> <span class="o">--</span><span class="nb">set</span><span class="o">-</span><span class="n">formats</span> <span class="n">ipynb</span><span class="p">,</span><span class="n">md</span><span class="p">:</span><span class="n">myst</span> <span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">the</span><span class="o">/</span><span class="n">notebook</span><span class="o">.</span><span class="n">ipynb</span>
</pre></div>
</div>
<p>This works by adding a <code class="docutils literal notranslate"><span class="pre">"jupytext"</span></code> metadata field to the notebook file which specifies the
desired formats, and which the <code class="docutils literal notranslate"><span class="pre">jupytext</span> <span class="pre">--sync</span></code> command recognizes when invoked.</p>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/Notebooks within the sphinx build"></a><section id="notebooks-within-the-sphinx-build">
<h3>Notebooks within the sphinx build<a class="headerlink" href="#notebooks-within-the-sphinx-build" title="Permalink to this headline">#</a></h3>
<p>Some of the notebooks are built automatically as part of the pre-submit checks and
as part of the <a class="reference external" href="https://jax.readthedocs.io/en/latest">Read the docs</a> build.
The build will fail if cells raise errors. If the errors are intentional, you can either catch them,
or tag the cell with <code class="docutils literal notranslate"><span class="pre">raises-exceptions</span></code> metadata (<a class="reference external" href="https://github.com/google/jax/pull/2402/files">example PR</a>).
You have to add this metadata by hand in the <code class="docutils literal notranslate"><span class="pre">.ipynb</span></code> file. It will be preserved when somebody else
re-saves the notebook.</p>
<p>We exclude some notebooks from the build, e.g., because they contain long computations.
See <code class="docutils literal notranslate"><span class="pre">exclude_patterns</span></code> in <a class="reference external" href="https://github.com/google/jax/blob/main/docs/conf.py">conf.py</a>.</p>
</section>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/Documentation building on readthedocs.io"></a><section id="documentation-building-on-readthedocs-io">
<h2>Documentation building on readthedocs.io<a class="headerlink" href="#documentation-building-on-readthedocs-io" title="Permalink to this headline">#</a></h2>
<p>JAXâ€™s auto-generated documentation is at <a class="reference external" href="https://jax.readthedocs.io/">https://jax.readthedocs.io/</a>.</p>
<p>The documentation building is controlled for the entire project by the
<a class="reference external" href="https://readthedocs.org/dashboard/jax">readthedocs JAX settings</a>. The current settings
trigger a documentation build as soon as code is pushed to the GitHub <code class="docutils literal notranslate"><span class="pre">main</span></code> branch.
For each code version, the building process is driven by the
<code class="docutils literal notranslate"><span class="pre">.readthedocs.yml</span></code> and the <code class="docutils literal notranslate"><span class="pre">docs/conf.py</span></code> configuration files.</p>
<p>For each automated documentation build you can see the
<a class="reference external" href="https://readthedocs.org/projects/jax/builds/">documentation build logs</a>.</p>
<p>If you want to test the documentation generation on Readthedocs, you can push code to the <code class="docutils literal notranslate"><span class="pre">test-docs</span></code>
branch. That branch is also built automatically, and you can
see the generated documentation <a class="reference external" href="https://jax.readthedocs.io/en/test-docs/">here</a>. If the documentation build
fails you may want to <a class="reference external" href="https://docs.readthedocs.io/en/stable/guides/wipe-environment.html">wipe the build environment for test-docs</a>.</p>
<p>For a local test, I was able to do it in a fresh directory by replaying the commands
I saw in the Readthedocs logs:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>mkvirtualenv jax-docs  # A new virtualenv
mkdir jax-docs  # A new directory
cd jax-docs
git clone --no-single-branch --depth 50 https://github.com/google/jax
cd jax
git checkout --force origin/test-docs
git clean -d -f -f
workon jax-docs

python -m pip install --upgrade --no-cache-dir pip
python -m pip install --upgrade --no-cache-dir -I Pygments==2.3.1 setuptools==41.0.1 docutils==0.14 mock==1.0.1 pillow==5.4.1 alabaster&gt;=0.7,&lt;0.8,!=0.7.5 commonmark==0.8.1 recommonmark==0.5.0 'sphinx&lt;2' 'sphinx-rtd-theme&lt;0.5' 'readthedocs-sphinx-ext&lt;1.1'
python -m pip install --exists-action=w --no-cache-dir -r docs/requirements.txt
cd docs
python `which sphinx-build` -T -E -b html -d _build/doctrees-readthedocs -D language=en . _build/html
</pre></div>
</div>
</section>
</section>
</div>
</main>
<footer class="footer-article noprint">
<!-- Previous / next buttons -->
<div class="prev-next-area">
<a class="left-prev" href="contributing.html" id="prev-link" title="previous page">
<i class="fas fa-angle-left"></i>
<div class="prev-next-info">
<p class="prev-next-subtitle">previous</p>
<p class="prev-next-title">Contributing to JAX</p>
</div>
</a>
<a class="right-next" href="jax_internal_api.html" id="next-link" title="next page">
<div class="prev-next-info">
<p class="prev-next-subtitle">next</p>
<p class="prev-next-title">Internal APIs</p>
</div>
<i class="fas fa-angle-right"></i>
</a>
</div>
</footer>
</div>
</div>
<div class="footer-content row">
<footer class="col footer"><p>
  
    By The JAX authors<br/>
  
      Â© Copyright 2020, The JAX Authors. NumPy and SciPy documentation are copyright the respective authors..<br/>
</p>
</footer>
</div>
</div>
</div>
</div>
<!-- Scripts loaded after <body> so the DOM is not blocked -->
<script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>
</body>
</html>