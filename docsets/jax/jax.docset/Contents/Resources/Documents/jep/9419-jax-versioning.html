
<!DOCTYPE html>

<html>
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/><meta content="Docutils 0.17.1: http://docutils.sourceforge.net/" name="generator"/>
<title>Jax and Jaxlib versioning â€” JAX  documentation</title>
<!-- Loaded before other Sphinx assets -->
<link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet"/>
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet"/>
<link href="../_static/vendor/fontawesome/5.13.0/css/all.min.css" rel="stylesheet"/>
<link as="font" crossorigin="" href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2" rel="preload" type="font/woff2"/>
<link href="../_static/pygments.css" rel="stylesheet" type="text/css">
<link href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" rel="stylesheet" type="text/css">
<link href="../_static/plot_directive.css" rel="stylesheet" type="text/css">
<link href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" rel="stylesheet" type="text/css">
<link href="../_static/copybutton.css" rel="stylesheet" type="text/css">
<link href="../_static/style.css" rel="stylesheet" type="text/css"/>
<!-- Pre-loaded scripts that we'll load fully later -->
<link as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf" rel="preload"/>
<script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
<script src="../_static/jquery.js"></script>
<script src="../_static/underscore.js"></script>
<script src="../_static/doctools.js"></script>
<script src="../_static/clipboard.min.js"></script>
<script src="../_static/copybutton.js"></script>
<script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
<link href="../_static/favicon.png" rel="shortcut icon">
<link href="../genindex.html" rel="index" title="Index"/>
<link href="../search.html" rel="search" title="Search"/>
<link href="10657-sequencing-effects.html" rel="next" title="Sequencing side-effects in JAX"/>
<link href="9407-type-promotion.html" rel="prev" title="Design of Type Promotion Semantics for JAX"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<meta content="None" name="docsearch:language"/>
<!-- Google Analytics -->
</link></link></link></link></link></link></head>
<body data-offset="60" data-spy="scroll" data-target="#bd-toc-nav">
<!-- Checkboxes to toggle the left sidebar -->
<input aria-label="Toggle navigation sidebar" class="sidebar-toggle" id="__navigation" name="__navigation" type="checkbox"/>
<label class="overlay overlay-navbar" for="__navigation">
<div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input aria-label="Toggle in-page Table of Contents" class="sidebar-toggle" id="__page-toc" name="__page-toc" type="checkbox"/>
<label class="overlay overlay-pagetoc" for="__page-toc">
<div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>
<div class="container-fluid" id="banner"></div>
<div class="container-xl">
<div class="row">
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
<div class="bd-sidebar__content">
<div class="bd-sidebar__top"><div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
<!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
<img alt="logo" class="logo" src="../_static/jax_logo_250px.png"/>
</a>
</div><form action="../search.html" class="bd-search d-flex align-items-center" method="get">
<i class="icon fas fa-search"></i>
<input aria-label="Search the docs ..." autocomplete="off" class="form-control" id="search-input" name="q" placeholder="Search the docs ..." type="search"/>
</form><nav aria-label="Main" class="bd-links" id="bd-docs-nav">
<div class="bd-toc-item active">
<p aria-level="2" class="caption" role="heading">
<span class="caption-text">
  Getting Started
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1">
<a class="reference internal" href="../installation.html">
   Installing JAX
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../notebooks/quickstart.html">
   JAX Quickstart
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../notebooks/thinking_in_jax.html">
   How to Think in JAX
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../notebooks/Common_Gotchas_in_JAX.html">
   ðŸ”ª JAX - The Sharp Bits ðŸ”ª
  </a>
</li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../jax-101/index.html">
   Tutorial: JAX 101
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox">
<label for="toctree-checkbox-1">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../jax-101/01-jax-basics.html">
     JAX As Accelerated NumPy
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../jax-101/02-jitting.html">
     Just In Time Compilation with JAX
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../jax-101/03-vectorization.html">
     Automatic Vectorization in JAX
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../jax-101/04-advanced-autodiff.html">
     Advanced Automatic Differentiation in JAX
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../jax-101/05-random-numbers.html">
     Pseudo Random Numbers in JAX
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../jax-101/05.1-pytrees.html">
     Working with Pytrees
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../jax-101/06-parallelism.html">
     Parallel Evaluation in JAX
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../jax-101/07-state.html">
     Stateful Computations in JAX
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../jax-101/08-pjit.html">
     Introduction to pjit
    </a>
</li>
</ul>
</input></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../debugging/index.html">
   Runtime value debugging in JAX
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox">
<label for="toctree-checkbox-2">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../debugging/print_breakpoint.html">
<code class="docutils literal notranslate">
<span class="pre">
       jax.debug.print
      </span>
</code>
     and
     <code class="docutils literal notranslate">
<span class="pre">
       jax.debug.breakpoint
      </span>
</code>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../debugging/checkify_guide.html">
     The
     <code class="docutils literal notranslate">
<span class="pre">
       checkify
      </span>
</code>
     transformation
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../debugging/flags.html">
     JAX debugging flags
    </a>
</li>
</ul>
</input></li>
</ul>
<p aria-level="2" class="caption" role="heading">
<span class="caption-text">
  Reference Documentation
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1">
<a class="reference internal" href="../faq.html">
   JAX Frequently Asked Questions (FAQ)
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../async_dispatch.html">
   Asynchronous dispatch
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../aot.html">
   Ahead-of-time lowering and compilation
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../jaxpr.html">
   Understanding Jaxprs
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../notebooks/convolutions.html">
   Convolutions in JAX
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../pytrees.html">
   Pytrees
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../type_promotion.html">
   Type promotion semantics
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../errors.html">
   JAX Errors
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../transfer_guard.html">
   Transfer guard
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../glossary.html">
   JAX Glossary of Terms
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../changelog.html">
   Change log
  </a>
</li>
</ul>
<p aria-level="2" class="caption" role="heading">
<span class="caption-text">
  Advanced JAX Tutorials
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1">
<a class="reference internal" href="../notebooks/autodiff_cookbook.html">
   The Autodiff Cookbook
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../notebooks/vmapped_log_probs.html">
   Autobatching log-densities example
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../notebooks/neural_network_with_tfds_data.html">
   Training a Simple Neural Network, with tensorflow/datasets Data Loading
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../notebooks/Custom_derivative_rules_for_Python_code.html">
   Custom derivative rules for JAX-transformable Python functions
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../notebooks/How_JAX_primitives_work.html">
   How JAX primitives work
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../notebooks/Writing_custom_interpreters_in_Jax.html">
   Writing custom Jaxpr interpreters in JAX
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../notebooks/Neural_Network_and_Data_Loading.html">
   Training a Simple Neural Network, with PyTorch Data Loading
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../notebooks/xmap_tutorial.html">
   Named axes and easy-to-revise parallelism
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../multi_process.html">
   Using JAX in multi-host and multi-process environments
  </a>
</li>
</ul>
<p aria-level="2" class="caption" role="heading">
<span class="caption-text">
  Notes
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1">
<a class="reference internal" href="../api_compatibility.html">
   API compatibility
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../deprecation.html">
   Python and NumPy version support policy
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../concurrency.html">
   Concurrency
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../gpu_memory_allocation.html">
   GPU memory allocation
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../profiling.html">
   Profiling JAX programs
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../device_memory_profiling.html">
   Device Memory Profiling
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../rank_promotion_warning.html">
   Rank promotion warning
  </a>
</li>
</ul>
<p aria-level="2" class="caption" role="heading">
<span class="caption-text">
  Developer documentation
 </span>
</p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1">
<a class="reference internal" href="../contributing.html">
   Contributing to JAX
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../developer.html">
   Building from source
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../jax_internal_api.html">
   Internal APIs
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../autodidax.html">
   Autodidax: JAX core from scratch
  </a>
</li>
<li class="toctree-l1 current active has-children">
<a class="reference internal" href="index.html">
   JAX Enhancement Proposals (JEPs)
  </a>
<input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox">
<label for="toctree-checkbox-3">
<i class="fas fa-chevron-down">
</i>
</label>
<ul class="current">
<li class="toctree-l2">
<a class="reference internal" href="263-prng.html">
     263: JAX PRNG Design
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="2026-custom-derivatives.html">
     2026: Custom JVP/VJP rules for JAX-transformable functions
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="4008-custom-vjp-update.html">
     4008: Custom VJP and `nondiff_argnums` update
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="4410-omnistaging.html">
     4410: Omnistaging
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="9407-type-promotion.html">
     9407: Design of Type Promotion Semantics for JAX
    </a>
</li>
<li class="toctree-l2 current active">
<a class="current reference internal" href="#">
     9419: Jax and Jaxlib versioning
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="10657-sequencing-effects.html">
     10657: Sequencing side-effects in JAX
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="11830-new-remat-checkpoint.html">
     11830: `jax.remat` / `jax.checkpoint` new implementation
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="12049-type-annotations.html">
     12049: Type Annotation Roadmap for JAX
    </a>
</li>
</ul>
</input></li>
</ul>
<p aria-level="2" class="caption" role="heading">
<span class="caption-text">
  API documentation
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../jax.html">
   Public API: jax package
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
<label for="toctree-checkbox-4">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../jax.numpy.html">
     jax.numpy package
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../jax.scipy.html">
     jax.scipy package
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../jax.config.html">
     JAX configuration
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../jax.debug.html">
     jax.debug package
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../jax.dlpack.html">
     jax.dlpack module
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../jax.distributed.html">
     jax.distributed module
    </a>
</li>
<li class="toctree-l2 has-children">
<a class="reference internal" href="../jax.example_libraries.html">
     jax.example_libraries package
    </a>
<input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
<label for="toctree-checkbox-5">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l3">
<a class="reference internal" href="../jax.example_libraries.optimizers.html">
       jax.example_libraries.optimizers module
      </a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../jax.example_libraries.stax.html">
       jax.example_libraries.stax module
      </a>
</li>
</ul>
</li>
<li class="toctree-l2 has-children">
<a class="reference internal" href="../jax.experimental.html">
     jax.experimental package
    </a>
<input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
<label for="toctree-checkbox-6">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l3">
<a class="reference internal" href="../jax.experimental.checkify.html">
       jax.experimental.checkify module
      </a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../jax.experimental.global_device_array.html">
       jax.experimental.global_device_array module
      </a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../jax.experimental.host_callback.html">
       jax.experimental.host_callback module
      </a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../jax.experimental.maps.html">
       jax.experimental.maps module
      </a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../jax.experimental.pjit.html">
       jax.experimental.pjit module
      </a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../jax.experimental.sparse.html">
       jax.experimental.sparse module
      </a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../jax.experimental.jet.html">
       jax.experimental.jet module
      </a>
</li>
</ul>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../jax.flatten_util.html">
     jax.flatten_util package
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../jax.image.html">
     jax.image package
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../jax.lax.html">
     jax.lax package
    </a>
</li>
<li class="toctree-l2 has-children">
<a class="reference internal" href="../jax.nn.html">
     jax.nn package
    </a>
<input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
<label for="toctree-checkbox-7">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l3">
<a class="reference internal" href="../jax.nn.initializers.html">
       jax.nn.initializers package
      </a>
</li>
</ul>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../jax.ops.html">
     jax.ops package
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../jax.profiler.html">
     jax.profiler module
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../jax.random.html">
     jax.random package
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../jax.stages.html">
     jax.stages package
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../jax.tree_util.html">
     jax.tree_util package
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../jax.lib.html">
     jax.lib package
    </a>
</li>
</ul>
</li>
</ul>
</div>
</nav></div>
<div class="bd-sidebar__bottom">
<!-- To handle the deprecated key -->
<div class="navbar_extra_footer">
            Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
</div>
</div>
</div>
<div id="rtd-footer-container"></div>
</div>
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
<div class="header-article row sticky-top noprint">
<div class="col py-1 d-flex header-article-main">
<div class="header-article__left">
<label class="headerbtn" data-placement="right" data-toggle="tooltip" for="__navigation" title="Toggle navigation">
<span class="headerbtn__icon-container">
<i class="fas fa-bars"></i>
</span>
</label>
</div>
<div class="header-article__right">
<button class="headerbtn" data-placement="bottom" data-toggle="tooltip" onclick="toggleFullScreen()" title="Fullscreen mode">
<span class="headerbtn__icon-container">
<i class="fas fa-expand"></i>
</span>
</button>
<a class="headerbtn" data-placement="bottom" data-toggle="tooltip" href="https://github.com/google/jax" title="Source repository">
<span class="headerbtn__icon-container">
<i class="fab fa-github"></i>
</span>
</a>
<div class="menu-dropdown menu-dropdown-download-buttons">
<button aria-label="Download this page" class="headerbtn menu-dropdown__trigger">
<i class="fas fa-download"></i>
</button>
<div class="menu-dropdown__content">
<ul>
<li>
<a class="headerbtn" data-placement="left" data-toggle="tooltip" href="../_sources/jep/9419-jax-versioning.md.txt" title="Download source file">
<span class="headerbtn__icon-container">
<i class="fas fa-file"></i>
</span>
<span class="headerbtn__text-container">.md</span>
</a>
</li>
<li>
<button class="headerbtn" data-placement="left" data-toggle="tooltip" onclick="printPdf(this)" title="Print to PDF">
<span class="headerbtn__icon-container">
<i class="fas fa-file-pdf"></i>
</span>
<span class="headerbtn__text-container">.pdf</span>
</button>
</li>
</ul>
</div>
</div>
<label class="headerbtn headerbtn-page-toc" for="__page-toc">
<span class="headerbtn__icon-container">
<i class="fas fa-list"></i>
</span>
</label>
</div>
</div>
<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
<div class="tocsection onthispage pt-5 pb-3">
<i class="fas fa-list"></i> Contents
    </div>
<nav aria-label="Page" id="bd-toc-nav">
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#why-are-jax-and-jaxlib-separate-packages">
   Why are
   <code class="docutils literal notranslate">
<span class="pre">
     jax
    </span>
</code>
   and
   <code class="docutils literal notranslate">
<span class="pre">
     jaxlib
    </span>
</code>
   separate packages?
  </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#how-are-jax-and-jaxlib-versioned">
   How are
   <code class="docutils literal notranslate">
<span class="pre">
     jax
    </span>
</code>
   and
   <code class="docutils literal notranslate">
<span class="pre">
     jaxlib
    </span>
</code>
   versioned?
  </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#how-can-i-safely-make-changes-to-the-api-of-jaxlib">
   How can I safely make changes to the API of
   <code class="docutils literal notranslate">
<span class="pre">
     jaxlib
    </span>
</code>
   ?
  </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#how-is-the-source-to-jaxlib-laid-out">
   How is the source to
   <code class="docutils literal notranslate">
<span class="pre">
     jaxlib
    </span>
</code>
   laid out?
  </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#how-do-we-make-changes-across-the-jax-and-jaxlib-boundary-between-releases">
   How do we make changes across the
   <code class="docutils literal notranslate">
<span class="pre">
     jax
    </span>
</code>
   and
   <code class="docutils literal notranslate">
<span class="pre">
     jaxlib
    </span>
</code>
   boundary between releases?
  </a>
</li>
</ul>
</nav>
</div>
</div>
<div class="article row">
<div class="col pl-md-3 pl-lg-5 content-container">
<!-- Table of contents that is only displayed when printing the page -->
<div class="onlyprint" id="jb-print-docs-body">
<h1>Jax and Jaxlib versioning</h1>
<!-- Table of contents -->
<div id="print-main-content">
<div id="jb-print-toc">
<div>
<h2> Contents </h2>
</div>
<nav aria-label="Page">
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#why-are-jax-and-jaxlib-separate-packages">
   Why are
   <code class="docutils literal notranslate">
<span class="pre">
     jax
    </span>
</code>
   and
   <code class="docutils literal notranslate">
<span class="pre">
     jaxlib
    </span>
</code>
   separate packages?
  </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#how-are-jax-and-jaxlib-versioned">
   How are
   <code class="docutils literal notranslate">
<span class="pre">
     jax
    </span>
</code>
   and
   <code class="docutils literal notranslate">
<span class="pre">
     jaxlib
    </span>
</code>
   versioned?
  </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#how-can-i-safely-make-changes-to-the-api-of-jaxlib">
   How can I safely make changes to the API of
   <code class="docutils literal notranslate">
<span class="pre">
     jaxlib
    </span>
</code>
   ?
  </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#how-is-the-source-to-jaxlib-laid-out">
   How is the source to
   <code class="docutils literal notranslate">
<span class="pre">
     jaxlib
    </span>
</code>
   laid out?
  </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#how-do-we-make-changes-across-the-jax-and-jaxlib-boundary-between-releases">
   How do we make changes across the
   <code class="docutils literal notranslate">
<span class="pre">
     jax
    </span>
</code>
   and
   <code class="docutils literal notranslate">
<span class="pre">
     jaxlib
    </span>
</code>
   boundary between releases?
  </a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<main id="main-content" role="main">
<div>
<a class="dashAnchor" name="//apple_ref/cpp/Section/Jax and Jaxlib versioning"></a><section class="tex2jax_ignore mathjax_ignore" id="jax-and-jaxlib-versioning">
<h1>Jax and Jaxlib versioning<a class="headerlink" href="#jax-and-jaxlib-versioning" title="Permalink to this headline">#</a></h1>
<a class="dashAnchor" name="//apple_ref/cpp/Section/Why are jax and jaxlib separate packages?"></a><section id="why-are-jax-and-jaxlib-separate-packages">
<h2>Why are <code class="docutils literal notranslate"><span class="pre">jax</span></code> and <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code> separate packages?<a class="headerlink" href="#why-are-jax-and-jaxlib-separate-packages" title="Permalink to this headline">#</a></h2>
<p>We publish JAX as two separate Python wheels, namely <code class="docutils literal notranslate"><span class="pre">jax</span></code>, which is a pure
Python wheel, and <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code>, which is a mostly-C++ wheel that contains libraries
such as:</p>
<ul class="simple">
<li><p>XLA,</p></li>
<li><p>pieces of LLVM used by XLA,</p></li>
<li><p>MLIR infrastructure, such as the MHLO Python bindings.</p></li>
<li><p>JAX-specific C++ libraries for fast JIT and PyTree manipulation.</p></li>
</ul>
<p>We distribute separate <code class="docutils literal notranslate"><span class="pre">jax</span></code> and <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code> packages because it makes it easy to
work on the Python parts of JAX without having to build C++ code or even having
a C++ toolchain installed. <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code> is a large library that is not easy for
many users to build, but most changes to JAX only touch Python code. By
allowing the Python pieces to be updated independently of the C++ pieces, we
improve the development velocity for Python changes.</p>
<p>In addition <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code> is not cheap to build, but we want to be able to iterate on
and run the JAX tests in environments without a lot of CPU, for example in
Github Actions or on a laptop. Many of our CI builds simply use a prebuilt
<code class="docutils literal notranslate"><span class="pre">jaxlib</span></code>, rather than needing to rebuild the C++ pieces of JAX on each PR.</p>
<p>As we will see, distributing <code class="docutils literal notranslate"><span class="pre">jax</span></code> and <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code> separately comes with a cost, in
that it requires that changes to <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code> maintain a backward compatible API.
However, we believe that on balance it is preferable to make Python changes
easy, even if at the cost of making C++ changes slightly harder.</p>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/How are jax and jaxlib versioned?"></a><section id="how-are-jax-and-jaxlib-versioned">
<h2>How are <code class="docutils literal notranslate"><span class="pre">jax</span></code> and <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code> versioned?<a class="headerlink" href="#how-are-jax-and-jaxlib-versioned" title="Permalink to this headline">#</a></h2>
<p>Summary: <code class="docutils literal notranslate"><span class="pre">jax</span></code> and <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code> share the same version number in the JAX source tree, but are released as separate Python packages.
When installed, the <code class="docutils literal notranslate"><span class="pre">jax</span></code> package version must be greater than or equal to <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code>â€™s version,
and <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code>â€™s version must be greater than or equal to the minimum <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code>
version specified by <code class="docutils literal notranslate"><span class="pre">jax</span></code>.</p>
<p>Both <code class="docutils literal notranslate"><span class="pre">jax</span></code> and <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code> releases are numbered <code class="docutils literal notranslate"><span class="pre">x.y.z</span></code>, where <code class="docutils literal notranslate"><span class="pre">x</span></code> is the major
version, and <code class="docutils literal notranslate"><span class="pre">y</span></code> is the minor version, and <code class="docutils literal notranslate"><span class="pre">z</span></code> is an optional patch release.
Version numbers must follow
<a class="reference external" href="https://www.python.org/dev/peps/pep-0440/">PEP 440</a>. Version number comparisons
are lexicographic comparisons on tuples of integers.</p>
<p>Each <code class="docutils literal notranslate"><span class="pre">jax</span></code> release has an associated minimum <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code> version <code class="docutils literal notranslate"><span class="pre">mx.my.mz</span></code>. The
minimum <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code> version for <code class="docutils literal notranslate"><span class="pre">jax</span></code> version <code class="docutils literal notranslate"><span class="pre">x.y.z</span></code> must be no greater than
<code class="docutils literal notranslate"><span class="pre">x.y.z</span></code>.</p>
<p>For <code class="docutils literal notranslate"><span class="pre">jax</span></code> version <code class="docutils literal notranslate"><span class="pre">x.y.z</span></code> and <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code> version <code class="docutils literal notranslate"><span class="pre">lx.ly.lz</span></code> to be compatible,
the following must hold:</p>
<ul class="simple">
<li><p>The jaxlib version (<code class="docutils literal notranslate"><span class="pre">lx.ly.lz</span></code>) must be greater than or equal to the minimum
jaxlib version (<code class="docutils literal notranslate"><span class="pre">mx.my.mz</span></code>).</p></li>
<li><p>The jax version (<code class="docutils literal notranslate"><span class="pre">x.y.z</span></code>) must be greater than or equal to the jaxlib version
(<code class="docutils literal notranslate"><span class="pre">lx.ly.lz</span></code>).</p></li>
</ul>
<p>These constraints imply the following rules for releases:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">jax</span></code> may be released on its own at any time, without updating <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code>.</p></li>
<li><p>If a new <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code> is released, a <code class="docutils literal notranslate"><span class="pre">jax</span></code> release must be made at the same time.</p></li>
</ul>
<p>These
<a class="reference external" href="https://github.com/google/jax/blob/main/jax/version.py">version constraints</a>
are currently checked by <code class="docutils literal notranslate"><span class="pre">jax</span></code> at import time, instead of being expressed as
Python package version constraints. <code class="docutils literal notranslate"><span class="pre">jax</span></code> checks the <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code> version at
runtime rather than using a <code class="docutils literal notranslate"><span class="pre">pip</span></code> package version constraint because we
<a class="reference external" href="https://github.com/google/jax#installation">provide separate <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code> wheels</a>
for a variety of hardware and software versions (e.g, GPU, TPU, etc.). Since we
do not know which is the right choice for any given user, we do not want <code class="docutils literal notranslate"><span class="pre">pip</span></code>
to install a <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code> package for us automatically.</p>
<p>In the future, we hope to separate out the hardware-specific pieces of <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code>
into separate plugins, at which point the minimum version could be expressed as
a Python package dependency. For now, we do provide
platform-specific extra requirements that install a compatible jaxlib version,
e.g., <code class="docutils literal notranslate"><span class="pre">jax[cuda]</span></code>.</p>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/How can I safely make changes to the API of jaxlib?"></a><section id="how-can-i-safely-make-changes-to-the-api-of-jaxlib">
<h2>How can I safely make changes to the API of <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code>?<a class="headerlink" href="#how-can-i-safely-make-changes-to-the-api-of-jaxlib" title="Permalink to this headline">#</a></h2>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">jax</span></code> may drop compatibility with older <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code> releases at any time, so long
as the minimum <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code> version is increased to a compatible version. However,
note that the minimum <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code>, even for unreleased versions of <code class="docutils literal notranslate"><span class="pre">jax</span></code>, must be
a released version! This allows us to use released <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code> wheels in our CI
builds, and allows Python developers to work on <code class="docutils literal notranslate"><span class="pre">jax</span></code> at HEAD without ever
needing to build <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code>.</p>
<p>For example, to remove an old backwards compatibility path in the <code class="docutils literal notranslate"><span class="pre">jax</span></code> Python
code, it is sufficient to bump the minimum jaxlib version and then delete the
compatibility path.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">jaxlib</span></code> may drop compatibility with older <code class="docutils literal notranslate"><span class="pre">jax</span></code> releases lower than
its own release version number. The version constraints enforced by <code class="docutils literal notranslate"><span class="pre">jax</span></code>
would forbid the use of an incompatible <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code>.</p>
<p>For example, for <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code> to drop a Python binding API used by an older <code class="docutils literal notranslate"><span class="pre">jax</span></code>
version, the <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code> minor or major version number must be incremented.</p>
</li>
<li><p>If possible, changes to the <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code> should be made in a backwards-compatible
way.</p>
<p>In general <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code> may freely change its API, so long
as the rules about <code class="docutils literal notranslate"><span class="pre">jax</span></code> being compatible with all <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code>s at least as new
as the minimum version are followed. This implies that
<code class="docutils literal notranslate"><span class="pre">jax</span></code> must always be compatible with at least two versions of <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code>,
namely, the last release, and the tip-of-tree version, effectively
the next release. This is easier to do if compatibility is maintained,
although incompatible changes can be made using version tests from <code class="docutils literal notranslate"><span class="pre">jax</span></code>; see
below.</p>
<p>For example, it is usually safe to add a new function to <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code>, but unsafe
to remove an existing function or to change its signature if current <code class="docutils literal notranslate"><span class="pre">jax</span></code> is
still using it. Changes to <code class="docutils literal notranslate"><span class="pre">jax</span></code> must work or degrade gracefully
for all <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code> releases greater than the minimum up to HEAD.</p>
</li>
</ul>
<p>Note that the compatibility rules here only apply to <em>released</em> versions of
<code class="docutils literal notranslate"><span class="pre">jax</span></code> and <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code>. They do not apply to unreleased versions; that is, it is ok
to introduce and then remove an API from <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code> if it is never released, or if
no released <code class="docutils literal notranslate"><span class="pre">jax</span></code> version uses that API.</p>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/How is the source to jaxlib laid out?"></a><section id="how-is-the-source-to-jaxlib-laid-out">
<h2>How is the source to <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code> laid out?<a class="headerlink" href="#how-is-the-source-to-jaxlib-laid-out" title="Permalink to this headline">#</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">jaxlib</span></code> is split across two main repositories, namely the
<a class="reference external" href="https://github.com/google/jax/tree/main/jaxlib"><code class="docutils literal notranslate"><span class="pre">jaxlib/</span></code> subdirectory in the main JAX repository</a>
and in the
<a class="reference external" href="https://github.com/tensorflow/tensorflow/tree/master/tensorflow/compiler/xla">XLA source tree, which lives inside the TensorFlow repository</a>.
The JAX-specific pieces inside XLA are primarily in the
<a class="reference external" href="https://github.com/tensorflow/tensorflow/tree/master/tensorflow/compiler/xla/python"><code class="docutils literal notranslate"><span class="pre">xla/python</span></code> subdirectory</a>.</p>
<p>The reason that C++ pieces of JAX, such as Python bindings and runtime
components, are inside the XLA tree is partially
historical and partially technical.</p>
<p>The historical reason is that originally the
<code class="docutils literal notranslate"><span class="pre">xla/python</span></code> bindings were envisaged as general purpose Python bindings that
might be shared with other frameworks. In practice this is increasingly less
true, and <code class="docutils literal notranslate"><span class="pre">xla/python</span></code> incorporates a number of JAX-specific pieces and is
likely to incorporate more. So it is probably best to simply think of
<code class="docutils literal notranslate"><span class="pre">xla/python</span></code> as part of JAX.</p>
<p>The technical reason is that the XLA C++ API is not stable. By keeping the
XLA:Python bindings in the XLA tree, their C++ implementation can be updated
atomically with the C++ API of XLA. It is easier to maintain backward and forward
compatibility of Python APIs than C++ ones, so <code class="docutils literal notranslate"><span class="pre">xla/python</span></code> exposes Python APIs
and is responsible for maintaining backward compatibility at the Python
level.</p>
<p><code class="docutils literal notranslate"><span class="pre">jaxlib</span></code> is built using Bazel out of the <code class="docutils literal notranslate"><span class="pre">jax</span></code> repository. The pieces of
<code class="docutils literal notranslate"><span class="pre">jaxlib</span></code> from the XLA repository are incorporated into the build
<a class="reference external" href="https://github.com/google/jax/blob/main/WORKSPACE">as a Bazel submodule</a>.
To update the version of XLA used during the build, one must update the pinned
version in the Bazel <code class="docutils literal notranslate"><span class="pre">WORKSPACE</span></code>. This is done manually on an
as-needed basis, but can be overriden on a build-by-build basis.</p>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/How do we make changes across the jax and jaxlib boundary between releases?"></a><section id="how-do-we-make-changes-across-the-jax-and-jaxlib-boundary-between-releases">
<h2>How do we make changes across the <code class="docutils literal notranslate"><span class="pre">jax</span></code> and <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code> boundary between releases?<a class="headerlink" href="#how-do-we-make-changes-across-the-jax-and-jaxlib-boundary-between-releases" title="Permalink to this headline">#</a></h2>
<p>The jaxlib version is a coarse instrument: it only lets us reason about
<em>releases</em>.</p>
<p>However, since the <code class="docutils literal notranslate"><span class="pre">jax</span></code> and <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code> code is split across repositories that
cannot be updated atomically in a single change, we need to manage compatibility
at a finer granularity than our release cycle. To manage fine-grained
compatibility, we have additional versioning that is independent of the <code class="docutils literal notranslate"><span class="pre">jaxlib</span></code>
release version numbers.</p>
<p>We maintain an additional version number (<code class="docutils literal notranslate"><span class="pre">_version</span></code>) in
<a class="reference external" href="https://github.com/tensorflow/tensorflow/blob/master/tensorflow/compiler/xla/python/xla_client.py"><code class="docutils literal notranslate"><span class="pre">xla_client.py</span></code> in the XLA repository</a>.
The idea is that this version number, is defined in <code class="docutils literal notranslate"><span class="pre">xla/python</span></code>
together with the C++ parts of JAX, is also accessible to JAX Python as
<code class="docutils literal notranslate"><span class="pre">jax._src.lib.xla_extension_version</span></code>, and must
be incremented every time that a change is made to the XLA/Python code that has
backwards compatibility implications for <code class="docutils literal notranslate"><span class="pre">jax</span></code>. The JAX Python code can then use
this version number to maintain backwards compatibility, e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">jax._src.lib</span> <span class="kn">import</span> <span class="n">xla_extension_version</span>

<span class="c1"># 123 is the new version number for _version in xla_client.py</span>
<span class="k">if</span> <span class="n">xla_extension_version</span> <span class="o">&gt;=</span> <span class="mi">123</span><span class="p">:</span>
  <span class="c1"># Use new code path</span>
  <span class="o">...</span>
<span class="k">else</span><span class="p">:</span>
  <span class="c1"># Use old code path.</span>
</pre></div>
</div>
<p>Note that this version number is in <em>addition</em> to the constraints on the
released version numbers, that is, this version number exists to help manage
compatibility during development for unreleased code. Releases must also
follow the compatibility rules given above.</p>
</section>
</section>
</div>
</main>
<footer class="footer-article noprint">
<!-- Previous / next buttons -->
<div class="prev-next-area">
<a class="left-prev" href="9407-type-promotion.html" id="prev-link" title="previous page">
<i class="fas fa-angle-left"></i>
<div class="prev-next-info">
<p class="prev-next-subtitle">previous</p>
<p class="prev-next-title">Design of Type Promotion Semantics for JAX</p>
</div>
</a>
<a class="right-next" href="10657-sequencing-effects.html" id="next-link" title="next page">
<div class="prev-next-info">
<p class="prev-next-subtitle">next</p>
<p class="prev-next-title">Sequencing side-effects in JAX</p>
</div>
<i class="fas fa-angle-right"></i>
</a>
</div>
</footer>
</div>
</div>
<div class="footer-content row">
<footer class="col footer"><p>
  
    By The JAX authors<br/>
  
      Â© Copyright 2020, The JAX Authors. NumPy and SciPy documentation are copyright the respective authors..<br/>
</p>
</footer>
</div>
</div>
</div>
</div>
<!-- Scripts loaded after <body> so the DOM is not blocked -->
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>
</body>
</html>