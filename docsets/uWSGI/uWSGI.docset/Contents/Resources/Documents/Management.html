
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Managing the uWSGI server &#8212; uWSGI 2.0 documentation</title>
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Supported languages and platforms" href="LanguagesAndPlatforms.html" />
    <link rel="prev" title="The uWSGI build system" href="BuildSystem.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="LanguagesAndPlatforms.html" title="Supported languages and platforms"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="BuildSystem.html" title="The uWSGI build system"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">uWSGI 2.0 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="managing-the-uwsgi-server">
<h1>Managing the uWSGI server<a class="headerlink" href="#managing-the-uwsgi-server" title="Permalink to this headline">¶</a></h1>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>If you are managing multiple apps or a high volume site, take a look at</p>
<ul class="simple">
<li><p><a class="reference internal" href="Emperor.html"><span class="doc">The uWSGI Emperor – multi-app deployment</span></a></p></li>
<li><p><a class="reference internal" href="Zerg.html"><span class="doc">Zerg mode</span></a></p></li>
<li><p><a class="reference internal" href="SubscriptionServer.html"><span class="doc">uWSGI Subscription Server</span></a></p></li>
</ul>
</div>
<div class="section" id="starting-the-server">
<h2>Starting the server<a class="headerlink" href="#starting-the-server" title="Permalink to this headline">¶</a></h2>
<p>Starting an uWSGI server is the role of the system administrator, like starting the Web server. It should not be the role of the Web server to start the uWSGI server – though you can also do that if it fits your architecture.</p>
<p>How to best start uWSGI services at boot depends on the operating system you use.</p>
<p>On modern systems the following should hold true. On “classic” operating systems you can use <code class="docutils literal notranslate"><span class="pre">init.d</span></code>/<code class="docutils literal notranslate"><span class="pre">rc.d</span></code> scripts, or tools such as Supervisor, Daemontools or <a class="reference internal" href="Inetd.html"><span class="doc">inetd/xinetd</span></a>.</p>
<table class="docutils align-center">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>System</p></th>
<th class="head"><p>Method</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Ubuntu &lt; 15.04</p></td>
<td><p><a class="reference internal" href="Upstart.html"><span class="doc">Running uWSGI via Upstart</span></a> (the official <code class="docutils literal notranslate"><span class="pre">uwsgi</span></code> package, available since Ubuntu 12.04 provides an init.d based solution. Read the README.)</p></td>
</tr>
<tr class="row-odd"><td><p>Ubuntu &gt;= 15.04</p></td>
<td><p><a class="reference internal" href="Systemd.html"><span class="doc">Systemd</span></a></p></td>
</tr>
<tr class="row-even"><td><p>Debian</p></td>
<td><p><a class="reference internal" href="Systemd.html"><span class="doc">Systemd</span></a></p></td>
</tr>
<tr class="row-odd"><td><p>Arch Linux</p></td>
<td><p><a class="reference internal" href="Systemd.html"><span class="doc">Systemd</span></a></p></td>
</tr>
<tr class="row-even"><td><p>Fedora</p></td>
<td><p><a class="reference internal" href="Systemd.html"><span class="doc">Systemd</span></a></p></td>
</tr>
<tr class="row-odd"><td><p>OSX</p></td>
<td><p>launchd</p></td>
</tr>
<tr class="row-even"><td><p>Solaris</p></td>
<td><p>SMF</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="signals-for-controlling-uwsgi">
<h2>Signals for controlling uWSGI<a class="headerlink" href="#signals-for-controlling-uwsgi" title="Permalink to this headline">¶</a></h2>
<p>You can instruct uWSGI to write the master process PID to a file with the <code class="docutils literal notranslate"><span class="pre">safe-pidfile</span></code> option.</p>
<p>The uWSGI server responds to the following signals.</p>
<table class="docutils align-center">
<colgroup>
<col style="width: 6%" />
<col style="width: 45%" />
<col style="width: 49%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Signal</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Convenience command</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><cite>SIGHUP</cite></p></td>
<td><p>gracefully reload all the workers and the master process</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">--reload</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><cite>SIGTERM</cite></p></td>
<td><p>brutally reload all the workers and the master process</p></td>
<td><p>(use <code class="docutils literal notranslate"><span class="pre">--die-on-term</span></code> to respect the convention of shutting down the instance)</p></td>
</tr>
<tr class="row-even"><td><p><cite>SIGINT</cite></p></td>
<td><p>immediately kill the entire uWSGI stack</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">--stop</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><cite>SIGQUIT</cite></p></td>
<td><p>immediately kill the entire uWSGI stack</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><cite>SIGUSR1</cite></p></td>
<td><p>print statistics</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><cite>SIGUSR2</cite></p></td>
<td><p>print worker status or wakeup the spooler</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><cite>SIGURG</cite></p></td>
<td><p>restore a snapshot</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><cite>SIGTSTP</cite></p></td>
<td><p>pause/suspend/resume an instance</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><cite>SIGWINCH</cite></p></td>
<td><p>wakeup a worker blocked in a syscall (internal use)</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><cite>SIGFPE</cite></p></td>
<td><p>generate C traceback</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><cite>SIGSEGV</cite></p></td>
<td><p>generate C traceback</p></td>
<td></td>
</tr>
</tbody>
</table>
<p>Note: there are better ways to manage your instances than signals, as an example the master-fifo is way more robust.</p>
</div>
<div class="section" id="reloading-the-server">
<h2>Reloading the server<a class="headerlink" href="#reloading-the-server" title="Permalink to this headline">¶</a></h2>
<p>When running with the <code class="docutils literal notranslate"><span class="pre">master</span></code> process mode, the uWSGI server can be gracefully restarted without closing the main sockets.</p>
<p>This functionality allows you patch/upgrade the uWSGI server without closing the connection with the web server and losing a single request.</p>
<p>When you send the <cite>SIGHUP</cite> to the master process it will try to gracefully stop all the workers, waiting for the completion of any currently running requests.</p>
<p>Then it closes all the eventually opened file descriptors not related to uWSGI.</p>
<p>Lastly, it binary patches (using <code class="docutils literal notranslate"><span class="pre">execve()</span></code>) the uWSGI process image with a new one, inheriting all of the previous file descriptors.</p>
<p>The server will know that it is a reloaded instance and will skip all the sockets initialization, reusing the previous ones.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Sending the <cite>SIGTERM</cite> signal will obtain the same result reload-wise but will not wait for the completion of running requests.</p>
</div>
<p>There are several ways to make uWSGI gracefully restart.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="c1"># using kill to send the signal</span>
<span class="nb">kill</span> -HUP <span class="sb">`</span>cat /tmp/project-master.pid<span class="sb">`</span>
<span class="c1"># or the convenience option --reload</span>
uwsgi --reload /tmp/project-master.pid
<span class="c1"># or if uwsgi was started with touch-reload=/tmp/somefile</span>
touch /tmp/somefile
</pre></div>
</div>
<p>Or from your application, in Python:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">uwsgi</span><span class="o">.</span><span class="n">reload</span><span class="p">()</span>
</pre></div>
</div>
<p>Or in Ruby,</p>
<div class="highlight-ruby notranslate"><div class="highlight"><pre><span></span><span class="no">UWSGI</span><span class="o">.</span><span class="n">reload</span>
</pre></div>
</div>
</div>
<div class="section" id="stopping-the-server">
<h2>Stopping the server<a class="headerlink" href="#stopping-the-server" title="Permalink to this headline">¶</a></h2>
<p>If you have the uWSGI process running in the foreground for some reason, you can just hit CTRL+C to kill it off.</p>
<p>When dealing with background processes, you’ll need to use the master pidfile again. The SIGINT signal will kill uWSGI.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="nb">kill</span> -INT <span class="sb">`</span>cat /tmp/project-master.pid<span class="sb">`</span>
<span class="c1"># or for convenience...</span>
uwsgi --stop /tmp/project-master.pid
</pre></div>
</div>
</div>
<div class="section" id="the-master-fifo">
<h2>The Master FIFO<a class="headerlink" href="#the-master-fifo" title="Permalink to this headline">¶</a></h2>
<p>Starting from uWSGI 1.9.17, a new management system has been added using unix named pipes (fifo): <a class="reference internal" href="MasterFIFO.html"><span class="doc">The Master FIFO</span></a></p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Managing the uWSGI server</a><ul>
<li><a class="reference internal" href="#starting-the-server">Starting the server</a></li>
<li><a class="reference internal" href="#signals-for-controlling-uwsgi">Signals for controlling uWSGI</a></li>
<li><a class="reference internal" href="#reloading-the-server">Reloading the server</a></li>
<li><a class="reference internal" href="#stopping-the-server">Stopping the server</a></li>
<li><a class="reference internal" href="#the-master-fifo">The Master FIFO</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="BuildSystem.html"
                        title="previous chapter">The uWSGI build system</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="LanguagesAndPlatforms.html"
                        title="next chapter">Supported languages and platforms</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/Management.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="LanguagesAndPlatforms.html" title="Supported languages and platforms"
             >next</a> |</li>
        <li class="right" >
          <a href="BuildSystem.html" title="The uWSGI build system"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">uWSGI 2.0 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2012-2016, uWSGI.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.0.1.
    </div>
  </body>
</html>