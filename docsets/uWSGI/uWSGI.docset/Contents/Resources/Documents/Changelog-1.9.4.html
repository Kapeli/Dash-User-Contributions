
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>uWSGI 1.9.4 &#8212; uWSGI 2.0 documentation</title>
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="uWSGI 1.9.3" href="Changelog-1.9.3.html" />
    <link rel="prev" title="uWSGI 1.9.5" href="Changelog-1.9.5.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="Changelog-1.9.3.html" title="uWSGI 1.9.3"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="Changelog-1.9.5.html" title="uWSGI 1.9.5"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">uWSGI 2.0 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="uwsgi-1-9-4">
<h1>uWSGI 1.9.4<a class="headerlink" href="#uwsgi-1-9-4" title="Permalink to this headline">¶</a></h1>
<p>Changelog 20130330</p>
<div class="section" id="bugfixes">
<h2>Bugfixes<a class="headerlink" href="#bugfixes" title="Permalink to this headline">¶</a></h2>
<p>fixed cache statistics exported by the stats subsystem (Łukasz Mierzwa)</p>
<p>fixed CoroEV bug in after_request (Tom Molesworth and John Berthels)</p>
<p>update cache items after a restore from persistent storage (Łukasz Mierzwa)</p>
<p>fixed signal handling in non-worker processes</p>
<p>fixed thundering herd in multiple mules setup</p>
<p>ported the cplusplus skeletal plugin to the new api</p>
<p>fixed uWSGI reloading when build as a shared library</p>
</div>
<div class="section" id="new-features">
<h2>New features<a class="headerlink" href="#new-features" title="Permalink to this headline">¶</a></h2>
<div class="section" id="smartos-official-support">
<h3>SmartOS official support<a class="headerlink" href="#smartos-official-support" title="Permalink to this headline">¶</a></h3>
<p>From now on, SmartOS is included in the officially supported operating systems</p>
</div>
<div class="section" id="v8-initial-support">
<h3>V8 initial support<a class="headerlink" href="#v8-initial-support" title="Permalink to this headline">¶</a></h3>
<p>The Lua previous suggestion for writing uWSGI routing rules and configurations, woke up lot of javascript users stating that javascript
itself could be a valid alternative. A V8 plugin is now available, supporting RPC, signal handlers and configurations. You need libv8 headers to build it:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>python uwsgiconfig.py --plugin plugins/v8
</pre></div>
</div>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">config</span> <span class="o">=</span> <span class="p">{};</span>
<span class="nx">config</span><span class="p">[</span><span class="s1">&#39;socket&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;:3031&#39;</span><span class="p">,</span> <span class="s1">&#39;:3032&#39;</span><span class="p">,</span> <span class="s1">&#39;:3033&#39;</span><span class="p">];</span>
<span class="nx">config</span><span class="p">[</span><span class="s1">&#39;master&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
<span class="nx">config</span><span class="p">[</span><span class="s1">&#39;processes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>
<span class="nx">config</span><span class="p">[</span><span class="s1">&#39;module&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;werkzeug.testapp:test_app&#39;</span><span class="p">;</span>

<span class="nx">config</span><span class="p">;</span>
</pre></div>
</div>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>uwsgi --plugin v8 --config foo.js
</pre></div>
</div>
<p>The previous example will allows you to write dynamic configs in javascript, while you can export javascript functions via the RPC subsystem:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kd">function</span> <span class="nx">part1</span><span class="p">(</span><span class="nx">request_uri</span><span class="p">,</span> <span class="nx">remote_addr</span><span class="p">)</span> <span class="p">{</span>
     <span class="k">return</span> <span class="s1">&#39;&lt;h1&gt;i am part1 for &#39;</span> <span class="o">+</span> <span class="nx">request_uri</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="nx">remote_addr</span> <span class="o">+</span> <span class="s2">&quot;&lt;/h1&gt;&quot;</span> <span class="p">;</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">part2</span><span class="p">(</span><span class="nx">request_uri</span><span class="p">,</span> <span class="nx">remote_addr</span><span class="p">)</span> <span class="p">{</span>
     <span class="k">return</span> <span class="s1">&#39;&lt;h2&gt;i am part2 for &#39;</span> <span class="o">+</span> <span class="nx">request_uri</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="nx">remote_addr</span> <span class="o">+</span> <span class="s2">&quot;&lt;/h2&gt;&quot;</span> <span class="p">;</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">part3</span><span class="p">(</span><span class="nx">request_uri</span><span class="p">,</span> <span class="nx">remote_addr</span><span class="p">)</span> <span class="p">{</span>
     <span class="k">return</span> <span class="s1">&#39;&lt;h3&gt;i am part3 for &#39;</span> <span class="o">+</span> <span class="nx">request_uri</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="nx">remote_addr</span> <span class="o">+</span> <span class="s2">&quot;&lt;/h3&gt;&quot;</span> <span class="p">;</span>
<span class="p">}</span>

<span class="nx">uwsgi_register_rpc</span><span class="p">(</span><span class="s1">&#39;part1&#39;</span><span class="p">,</span> <span class="nx">part1</span><span class="p">);</span>
<span class="nx">uwsgi_register_rpc</span><span class="p">(</span><span class="s1">&#39;part2&#39;</span><span class="p">,</span> <span class="nx">part2</span><span class="p">);</span>
<span class="nx">uwsgi_register_rpc</span><span class="p">(</span><span class="s1">&#39;part3&#39;</span><span class="p">,</span> <span class="nx">part3</span><span class="p">);</span>
</pre></div>
</div>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[uwsgi]</span>
<span class="na">plugin</span> <span class="o">=</span> <span class="s">v8</span>
<span class="na">v8-load</span> <span class="o">=</span> <span class="s">func.js</span>
<span class="na">cache2</span> <span class="o">=</span> <span class="s">name=foobar,items=10</span>

<span class="na">http-socket</span> <span class="o">=</span> <span class="s">:9090</span>

<span class="na">route-run</span> <span class="o">=</span> <span class="s">addheader:Content-Type: text/html</span>
<span class="na">route-run</span> <span class="o">=</span> <span class="s">cache:key=pippo,name=foobar</span>
<span class="na">route-run</span> <span class="o">=</span> <span class="s">cachestore:key=pippo,name=foobar</span>
<span class="na">route-run</span> <span class="o">=</span> <span class="s">rpcnext:part1 ${REQUEST_URI} ${REMOTE_ADDR}</span>
<span class="na">route-run</span> <span class="o">=</span> <span class="s">rpcnext:part2 ${REQUEST_URI} ${REMOTE_ADDR}</span>
<span class="na">route-run</span> <span class="o">=</span> <span class="s">rpcnext:part3 ${REQUEST_URI} ${REMOTE_ADDR}</span>
<span class="na">route-run</span> <span class="o">=</span> <span class="s">break:</span>
</pre></div>
</div>
<p>The previous example generates an HTTP response from 3 javascript functions and store it in the uWSGI cache.</p>
<p>Curious about rpcnext ?</p>
</div>
<div class="section" id="the-rpcnext-routing-action">
<h3>The rpcnext routing action<a class="headerlink" href="#the-rpcnext-routing-action" title="Permalink to this headline">¶</a></h3>
<p>We can already call rpc functions from the routing subsystem to generate response. With the rpcnext action (aliased as rpcblob too)
you can call multiple rpc functions and assemble the return values in a single response.</p>
</div>
<div class="section" id="legion-improvements">
<h3>Legion improvements<a class="headerlink" href="#legion-improvements" title="Permalink to this headline">¶</a></h3>
<p>We are hardly working in stabilizing <a class="reference internal" href="Legion.html"><span class="doc">The uWSGI Legion subsystem</span></a> The objective is have a rock-solid clustering implementation for uWSGI 2.0
that you can use even from your applications.</p>
<p>The code in 1.9.4 has been refactored a bit by Łukasz Mierzwa to allow easier integration with external plugins.</p>
<p>A new “join” hook has been added, it is called as soon as a node becomes active part of a legion (read, it is part of a quorum).</p>
</div>
</div>
<div class="section" id="availability">
<h2>Availability<a class="headerlink" href="#availability" title="Permalink to this headline">¶</a></h2>
<p>uWSGI 1.9.4 will be available since 20130330 at this url</p>
<p><a class="reference external" href="https://projects.unbit.it/downloads/uwsgi-1.9.4.tar.gz">https://projects.unbit.it/downloads/uwsgi-1.9.4.tar.gz</a></p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">uWSGI 1.9.4</a><ul>
<li><a class="reference internal" href="#bugfixes">Bugfixes</a></li>
<li><a class="reference internal" href="#new-features">New features</a><ul>
<li><a class="reference internal" href="#smartos-official-support">SmartOS official support</a></li>
<li><a class="reference internal" href="#v8-initial-support">V8 initial support</a></li>
<li><a class="reference internal" href="#the-rpcnext-routing-action">The rpcnext routing action</a></li>
<li><a class="reference internal" href="#legion-improvements">Legion improvements</a></li>
</ul>
</li>
<li><a class="reference internal" href="#availability">Availability</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="Changelog-1.9.5.html"
                        title="previous chapter">uWSGI 1.9.5</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="Changelog-1.9.3.html"
                        title="next chapter">uWSGI 1.9.3</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/Changelog-1.9.4.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="Changelog-1.9.3.html" title="uWSGI 1.9.3"
             >next</a> |</li>
        <li class="right" >
          <a href="Changelog-1.9.5.html" title="uWSGI 1.9.5"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">uWSGI 2.0 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2012-2016, uWSGI.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.0.1.
    </div>
  </body>
</html>