
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Upgrading your 1.x uWSGI instances to 2.0 (work in progress) &#8212; uWSGI 2.0 documentation</title>
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">uWSGI 2.0 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="upgrading-your-1-x-uwsgi-instances-to-2-0-work-in-progress">
<h1>Upgrading your 1.x uWSGI instances to 2.0 (work in progress)<a class="headerlink" href="#upgrading-your-1-x-uwsgi-instances-to-2-0-work-in-progress" title="Permalink to this headline">¶</a></h1>
<p>The following notes are for users moving from 1.0, 1.2 and 1.4 to uWSGI 2.0.</p>
<p>Users of the 1.9 tree can skip this document as 2.0 is a “stabilized/freezed” 1.9.</p>
<div class="section" id="what-s-new">
<h2>What’s new<a class="headerlink" href="#what-s-new" title="Permalink to this headline">¶</a></h2>
<div class="section" id="license-change">
<h3>License change<a class="headerlink" href="#license-change" title="Permalink to this headline">¶</a></h3>
<p>uWSGI is now GPL2 + linking exception instead of plain GPL2.</p>
<p>This should address some legal issues with users compiling uWSGI as a library (libuwsgi.so) and loading non-GPL compatible plugins/libraries.</p>
</div>
<div class="section" id="non-blocking-by-default">
<h3>Non-blocking by default<a class="headerlink" href="#non-blocking-by-default" title="Permalink to this headline">¶</a></h3>
<p>All of the I/O of the uWSGI stack (from the core to the plugins) is now fully non-blocking.</p>
<p>No area in the whole stack is allowed to block (except your app obviously), and plugins must use uWSGI’s I/O API.</p>
<p>When you load loop engines like gevent or Coro::AnyEvent, the uWSGI internals are patched to support their specific non-blocking hooks.</p>
<p>What does this mean for app developers?</p>
<p>Well, the most important aspect is that network congestions or kernel problems do not block your instances and badly behaving peers
are closed if they do not unblock in the socket-timeout interval (default 4 seconds).</p>
</div>
<div class="section" id="newer-faster-and-better-parsers">
<h3>Newer, faster and better parsers<a class="headerlink" href="#newer-faster-and-better-parsers" title="Permalink to this headline">¶</a></h3>
<p>uWSGI 2.0 has support for pluggable protocols. The following protocols are supported and all of them have been updated
for better performance:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">uwsgi</span></code> – the classic uwsgi parser, improved for reduced syscall usage</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">http</span></code> – the classic HTTP parser, improved for reduced syscall usage (supports the PROXY1 protocol)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">https</span></code> – (new) support for native HTTPS</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fastcgi</span></code> – classic FastCGI parser, improved for reduced syscall usage</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">scgi</span></code> – (new) support for SCGI</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">suwsgi</span></code> – (new) secured uwsgi, uwsgi over SSL (supported by Nginx 1.5)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">puwsgi</span></code> – (new) persistent uwsgi, uwsgi with persistent connections, supported only internally</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mongrel2</span></code> – classic zeromq/mongrel2 support, now it is exposed as a plugin</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">raw</span></code> – (new) fake parser, allows you to write applications directly working on file descriptors</p></li>
</ul>
</div>
<div class="section" id="new-reloading-ways">
<h3>New reloading ways<a class="headerlink" href="#new-reloading-ways" title="Permalink to this headline">¶</a></h3>
<p>uWSGI 2.0 introduces a blast of new ways for reloading instances.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><span class="xref std std-doc">TheArtOfGracefulReloading</span></p>
</div>
</div>
<div class="section" id="other-new-features">
<h3>Other new features<a class="headerlink" href="#other-new-features" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p><a class="reference internal" href="MasterFIFO.html"><span class="doc">The Master FIFO</span></a> – A signal-free new approach for managing your instances.</p></li>
<li><p><a class="reference internal" href="Caching.html"><span class="doc">The uWSGI caching framework</span></a> &amp; <a class="reference internal" href="tutorials/CachingCookbook.html"><span class="doc">The uWSGI Caching Cookbook</span></a> – The new generation caching subsystem.</p></li>
<li><p><a class="reference internal" href="SharedArea.html"><span class="doc">SharedArea – share memory pages between uWSGI components</span></a> – The new sharedarea.</p></li>
<li><p><a class="reference internal" href="SNI.html"><span class="doc">SNI - Server Name Identification (virtual hosting for SSL nodes)</span></a></p></li>
<li><p><a class="reference internal" href="Legion.html"><span class="doc">The uWSGI Legion subsystem</span></a></p></li>
<li><p><a class="reference internal" href="WebSockets.html"><span class="doc">WebSocket support</span></a></p></li>
<li><p><a class="reference internal" href="Hooks.html"><span class="doc">Hooks</span></a></p></li>
<li><p><a class="reference internal" href="Transformations.html"><span class="doc">uWSGI Transformations</span></a></p></li>
<li><p><a class="reference internal" href="Namespaces.html"><span class="doc">Jailing your apps using Linux Namespaces</span></a></p></li>
<li><p><a class="reference internal" href="FreeBSDJails.html"><span class="doc">FreeBSD Jails</span></a></p></li>
<li><p><a class="reference internal" href="Metrics.html"><span class="doc">The Metrics subsystem</span></a></p></li>
<li><p><a class="reference internal" href="tutorials/GraphiteAndMetrics.html"><span class="doc">Setting up Graphite on Ubuntu using the Metrics subsystem</span></a></p></li>
<li><p><a class="reference internal" href="RPC.html"><span class="doc">uWSGI RPC Stack</span></a> – now supports 64-bit length responses</p></li>
</ul>
</div>
<div class="section" id="new-plugin-build-system">
<h3>New plugin build system<a class="headerlink" href="#new-plugin-build-system" title="Permalink to this headline">¶</a></h3>
<p>It is pretty fun (and easy) to write uWSGI plugins, but (funnily enough) the worst aspect was building them, as dealing with build profiles, cflags, ldflags and friends tend to lead to all sorts of bugs and crashes.</p>
<p>A simplified (and saner) build system for external plugins has been added. Now you only need to call the uwsgi binary you want to build the plugin for:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>uwsgi --build-plugin &lt;plugin&gt;
</pre></div>
</div>
<p>where &lt;plugin&gt; is the directory where the plugin sources (and the uwsgiplugin.py file) are stored.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="ThirdPartyPlugins.html"><span class="doc">uWSGI third party plugins</span></a></p>
</div>
</div>
<div class="section" id="strict-mode">
<h3>Strict mode<a class="headerlink" href="#strict-mode" title="Permalink to this headline">¶</a></h3>
<p>while having the freedom of defining custom options in uWSGI config files is a handy features, sometimes typos will
bring you lot of headaches.</p>
<p>Adding –strict to your instance options will instruct uWSGI config parser to raise an error when not-available options have been specified.</p>
<p>If you are in trouble and want to be sure you did not have written wrong options, add –strict and retry</p>
</div>
<div class="section" id="cygwin-support">
<h3>Cygwin support<a class="headerlink" href="#cygwin-support" title="Permalink to this headline">¶</a></h3>
<p>Yes, you can now build and run uWSGI on Windows systems :(</p>
</div>
<div class="section" id="kfreebsd-support">
<h3>kFreeBSD support<a class="headerlink" href="#kfreebsd-support" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="pypy-support">
<h3>PyPy support<a class="headerlink" href="#pypy-support" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="jvm-support">
<h3>JVM support<a class="headerlink" href="#jvm-support" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="mono-support">
<h3>Mono support<a class="headerlink" href="#mono-support" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="v8-support">
<h3>V8 support<a class="headerlink" href="#v8-support" title="Permalink to this headline">¶</a></h3>
</div>
</div>
<div class="section" id="upgrading-notes">
<h2>Upgrading Notes<a class="headerlink" href="#upgrading-notes" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Snapshotting mode is no longer available. Check the new graceful reloading ways for better approaches.</p></li>
<li><p>Mongrel2 support is no longer a built-in. you have to build the ‘mongrel2’ plugin to pair uWSGI with Mongrel2.</p></li>
<li><p>LDAP and Sqlite support has been moved to two plugins, you need to load them for using their features.</p></li>
<li><p>Dynamic options are no more.</p></li>
<li><p>The ‘admin’ plugin is gone.</p></li>
<li><p>Probes have been removed, the alarm framework presents better ways to monitor services.</p></li>
<li><p>The shared area API changed dramatically, check the new sharedarea docs.</p></li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Upgrading your 1.x uWSGI instances to 2.0 (work in progress)</a><ul>
<li><a class="reference internal" href="#what-s-new">What’s new</a><ul>
<li><a class="reference internal" href="#license-change">License change</a></li>
<li><a class="reference internal" href="#non-blocking-by-default">Non-blocking by default</a></li>
<li><a class="reference internal" href="#newer-faster-and-better-parsers">Newer, faster and better parsers</a></li>
<li><a class="reference internal" href="#new-reloading-ways">New reloading ways</a></li>
<li><a class="reference internal" href="#other-new-features">Other new features</a></li>
<li><a class="reference internal" href="#new-plugin-build-system">New plugin build system</a></li>
<li><a class="reference internal" href="#strict-mode">Strict mode</a></li>
<li><a class="reference internal" href="#cygwin-support">Cygwin support</a></li>
<li><a class="reference internal" href="#kfreebsd-support">kFreeBSD support</a></li>
<li><a class="reference internal" href="#pypy-support">PyPy support</a></li>
<li><a class="reference internal" href="#jvm-support">JVM support</a></li>
<li><a class="reference internal" href="#mono-support">Mono support</a></li>
<li><a class="reference internal" href="#v8-support">V8 support</a></li>
</ul>
</li>
<li><a class="reference internal" href="#upgrading-notes">Upgrading Notes</a></li>
</ul>
</li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/UpgradingTo2.0.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">uWSGI 2.0 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2012-2016, uWSGI.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.0.1.
    </div>
  </body>
</html>