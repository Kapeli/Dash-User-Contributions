
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Apache support &#8212; uWSGI 2.0 documentation</title>
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Cherokee support" href="Cherokee.html" />
    <link rel="prev" title="The asyncio loop engine (CPython &gt;= 3.4, uWSGI &gt;= 2.0.4)" href="asyncio.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="Cherokee.html" title="Cherokee support"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="asyncio.html" title="The asyncio loop engine (CPython &gt;= 3.4, uWSGI &gt;= 2.0.4)"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">uWSGI 2.0 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="apache-support">
<h1>Apache support<a class="headerlink" href="#apache-support" title="Permalink to this headline">¶</a></h1>
<p>Currently there are three uwsgi-protocol related apache2 modules available.</p>
<div class="section" id="mod-uwsgi">
<h2>mod_uwsgi<a class="headerlink" href="#mod-uwsgi" title="Permalink to this headline">¶</a></h2>
<p>This is the original module. It is solid, but incredibly ugly and does not follow a lot of apache coding convention style.</p>
<p><code class="docutils literal notranslate"><span class="pre">mod_uwsgi</span></code> can be used in two ways:</p>
<ul class="simple">
<li><p>The “assbackwards” way (the default one). It is the fastest but somewhat far from the Apache2 API.
If you do not use Apache2 filters (including gzip) for content generated by uWSGI, use this mode.</p></li>
<li><p>The “cgi” mode. This one is somewhat slower but better integrated with Apache. To use the CGI mode, pass <code class="docutils literal notranslate"><span class="pre">-C</span></code> to the uWSGI server.</p></li>
</ul>
<div class="section" id="options">
<h3>Options<a class="headerlink" href="#options" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All of the options can be set per-host or per-location.</p>
</div>
<p><strong>uWSGISocket &lt;path&gt; [timeout]</strong>   Absolute path and optional timeout in seconds of uwsgi server socket.</p>
<p><strong>uWSGISocket2 &lt;path&gt;</strong>            Absolute path of failover uwsgi server socket</p>
<p><strong>uWSGIServer &lt;host:port&gt;</strong>        Address and port of an UWSGI server (e.g. localhost:4000)</p>
<p><strong>uWSGIModifier1 &lt;int&gt;</strong>           Set uWSGI modifier1</p>
<p><strong>uWSGIModifier2 &lt;int&gt;</strong>           Set uWSGI modifier2</p>
<p><strong>uWSGIForceScriptName &lt;value&gt;</strong>   Force <code class="docutils literal notranslate"><span class="pre">SCRIPT_NAME</span></code> (app name)</p>
<p><strong>uWSGIForceCGIMode &lt;on/off&gt;</strong>     Force uWSGI CGI mode for perfect integration with apache filters</p>
<p><strong>uWSGIForceWSGIScheme &lt;value&gt;</strong>   Force the WSGI scheme var (set by default to “http”)</p>
<p><strong>uWSGIMaxVars  &lt;int&gt;</strong>            Set the maximum allowed number of uwsgi protocol variables (default 128)</p>
<p>To pass custom variables use the <code class="docutils literal notranslate"><span class="pre">SetEnv</span></code> directive:</p>
<blockquote>
<div><p>SetEnv UWSGI_SCRIPT yourapp</p>
</div></blockquote>
</div>
</div>
<div class="section" id="mod-proxy-uwsgi">
<h2>mod_proxy_uwsgi<a class="headerlink" href="#mod-proxy-uwsgi" title="Permalink to this headline">¶</a></h2>
<p>This is the latest module and probably the best bet for the future.  It is a
“proxy” module, so you will get all of the features exported by mod_proxy.  It
is fully “apache api compliant” so it should be easy to integrate with the
available modules.  Using it is easy; just remember to load mod_proxy and
mod_proxy_uwsgi modules in your apache config.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ProxyPass</span> <span class="o">/</span><span class="n">foo</span> <span class="n">uwsgi</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">3032</span><span class="o">/</span>
<span class="n">ProxyPass</span> <span class="o">/</span><span class="n">bar</span> <span class="n">uwsgi</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">3033</span><span class="o">/</span>
<span class="n">ProxyPass</span> <span class="o">/</span> <span class="n">uwsgi</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">3031</span><span class="o">/</span>
</pre></div>
</div>
<p>The first two forms set SCRIPT_NAME respectively to /foo and /bar while the
last one use an empty SCRIPT_NAME. You can set additional uwsgi vars using the
SetEnv directive and load balance requests using mod_proxy_balancer.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">Proxy</span> <span class="n">balancer</span><span class="p">:</span><span class="o">//</span><span class="n">mycluster</span><span class="o">&gt;</span>
   <span class="n">BalancerMember</span> <span class="n">uwsgi</span><span class="p">:</span><span class="o">//</span><span class="mf">192.168</span><span class="o">.</span><span class="mf">1.50</span><span class="p">:</span><span class="mi">3031</span><span class="o">/</span>
   <span class="n">BalancerMember</span> <span class="n">uwsgi</span><span class="p">:</span><span class="o">//</span><span class="mf">192.168</span><span class="o">.</span><span class="mf">1.51</span><span class="p">:</span><span class="mi">3031</span><span class="o">/</span>
<span class="o">&lt;/</span><span class="n">Proxy</span><span class="o">&gt;</span>
<span class="n">ProxyPass</span> <span class="o">/</span> <span class="n">balancer</span><span class="p">:</span><span class="o">//</span><span class="n">mycluster</span>
</pre></div>
</div>
<p>Pay attention to the last slash in the member/node definition. It is optional
for non-empty SCRIPT_NAME/mountpoints but required for apps mounted in the root
of the domain.  Currently the module lacks the ability to set modifiers, though
this will be fixed soon. An alternative is to set the plugin you want to use as
the first one (0):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plugins</span> <span class="o">=</span> <span class="mi">0</span><span class="p">:</span><span class="n">php</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><cite>mod_proxy_uwsgi</cite> is considered stable starting from uWSGI 2.0.6</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you want to use this module (and help the uWSGI project), report any bugs
you find, rather than falling back to the ancient (and ugly) mod_uwsgi</p>
</div>
<p>Starting from Apache 2.4.9, support for Unix sockets has been added. The syntax is pretty simple:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ProxyPass</span> <span class="o">/</span> <span class="n">unix</span><span class="p">:</span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">uwsgi</span><span class="o">/</span><span class="n">app1</span><span class="o">.</span><span class="n">sock</span><span class="o">|</span><span class="n">uwsgi</span><span class="p">:</span><span class="o">//</span><span class="n">uwsgi</span><span class="o">-</span><span class="n">uds</span><span class="o">-</span><span class="n">app1</span><span class="o">/</span>
<span class="n">ProxyPass</span> <span class="o">/</span> <span class="n">unix</span><span class="p">:</span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">uwsgi</span><span class="o">/</span><span class="n">app2</span><span class="o">.</span><span class="n">sock</span><span class="o">|</span><span class="n">uwsgi</span><span class="p">:</span><span class="o">//</span><span class="n">uwsgi</span><span class="o">-</span><span class="n">uds</span><span class="o">-</span><span class="n">app2</span><span class="o">/</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>As per apache documentation, the hostname part of the proxy address is
ignored. However, if one wants to have different sockets for different apps
within the same apache instance, the proxy address is used by apache to
identify different proxy workers: if the proxy address is the same, only
the firstly declared unix domain socket will get a worker and the secondly
declared app will have no worker and won’t be reachable. A workaround this
apache limitation (bug?) is to use different hostnames.</p>
</div>
</div>
<div class="section" id="mod-ruwsgi">
<h2>mod_Ruwsgi<a class="headerlink" href="#mod-ruwsgi" title="Permalink to this headline">¶</a></h2>
<p>This module is based on the SCGI module written by Roger Florkowski.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This module is currently undocumented.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Apache support</a><ul>
<li><a class="reference internal" href="#mod-uwsgi">mod_uwsgi</a><ul>
<li><a class="reference internal" href="#options">Options</a></li>
</ul>
</li>
<li><a class="reference internal" href="#mod-proxy-uwsgi">mod_proxy_uwsgi</a></li>
<li><a class="reference internal" href="#mod-ruwsgi">mod_Ruwsgi</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="asyncio.html"
                        title="previous chapter">The asyncio loop engine (CPython &gt;= 3.4, uWSGI &gt;= 2.0.4)</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="Cherokee.html"
                        title="next chapter">Cherokee support</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/Apache.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="Cherokee.html" title="Cherokee support"
             >next</a> |</li>
        <li class="right" >
          <a href="asyncio.html" title="The asyncio loop engine (CPython &gt;= 3.4, uWSGI &gt;= 2.0.4)"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">uWSGI 2.0 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2012-2016, uWSGI.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.0.1.
    </div>
  </body>
</html>