<!DOCTYPE html><html lang="en"><head><meta charset="utf-8" /><title>revDataFromQuery</title><link rel="stylesheet" type="text/css" href="userguide.css" /></head><body><table><tr><td colspan="2"><h1>revDataFromQuery</h1></td></tr><tr><td><b>Type</b></td><td>function</td></tr><tr><td><b>Dictionary</b></td><td>LCS</td></tr><tr><td><b>Library</b></td><td>LiveCode Script</td></tr><tr><td><b>Syntax</b></td><td><pre><span class="normal">revDataFromQuery([&lt;columnDelim&gt;],[&lt;rowDelim&gt;], &lt;databaseID&gt;, &lt;SQLQuery&gt; [, &lt;varsList&gt;])</span></pre></td></tr><tr><td><b>Synonyms</b></td><td>revdb_querylist</td></tr><tr><td><b>Associations</b></td><td>database library</td></tr><tr><td><b>Summary</b></td><td><p>Gets <a href="record_LCS_glossary.html">records</a> from a <a href="database_LCS_glossary.html">database</a> according to a <a href="SQL_query_LCS_glossary.html">SQL query</a> andplaces the resulting data in a <a href="variable_LCS_glossary.html">variable</a>, without creating a recordset (database cursor)(glossary).</p></td></tr><tr><td><b>Edition</b></td><td>Community</td></tr><tr><td><b>Introduced</b></td><td>1.1.1</td></tr><tr><td><b>Changes</b></td><td><p>The ability to specify array elements in the varsList was added in 2.9.</p></td></tr><tr><td><b>OS</b></td><td>mac, windows, linux, ios, android</td></tr><tr><td><b>Platforms</b></td><td>desktop, server, mobile</td></tr><tr><td><b>Parameters</b></td><td><table class="inner"><tr><th>Name</th><th>Type</th><th>Description</th></tr><tr><td>columnDelim</td><td></td><td><p>A character, or an expression that evaluates to a character. If nocolumnDelim is specified, columns are delimited by the tab character.</p></td></tr><tr><td>rowDelim</td><td></td><td><p>A character, or an expression that evaluates to a character. If norowDelim is specified, rows are delimited by the return character.</p></td></tr><tr><td>databaseID</td><td></td><td><p>The number returned by the revOpenDatabase function when the databasewas opened.</p></td></tr><tr><td>SQLQuery</td><td></td><td><p>A string in Structured Query Language.</p></td></tr><tr><td>varsList</td><td></td><td><p>The varsList consists of one or more variable names (or expressions thatevaluate to variable names), separated by commas. The variable names mayalso be array elements.</p></td></tr></table></td></tr><tr><td><b>Example</b></td><td><pre><span class="normal">revDataFromQuery(, , tConnectionId, </span><span class="function">the</span><span class="normal"> </span><span class="property">text</span><span class="normal"> </span><span class="function">of</span><span class="normal"> </span><span class="function">field</span><span class="normal"> </span><span class="normal">"Query"</span><span class="normal">)</span></pre><pre><b><span class="command">get</span></b><span class="normal"> revDataFromQuery(</span><span class="function">comma</span><span class="normal">, </span><b><span class="command">return</span></b><span class="normal">, tConnectionId, tQuery)</span></pre><pre><b><span class="command">get</span></b><span class="normal"> revDataFromQuery(</span><span class="function">tab</span><span class="normal">, </span><b><span class="command">return</span></b><span class="normal">, tConnectionId, </span><span class="normal">"SELECT * FROM myTable WHERE id = :1"</span><span class="normal">, </span><span class="normal">"tCustomerDetails[id]"</span><span class="normal">)</span></pre></td></tr><tr><td><b>Values</b></td><td><table class="inner"><tr><th>Name</th><th>Type</th><th>Description</th></tr><tr><td>return</td><td></td><td><p>The <a href="revDataFromQuery_LCS_function.html">revDataFromQuery</a> <a href="function_LCS_glossary.html">function</a> returns the data in the<a href="record_LCS_glossary.html">records</a> selected by the <b>SQLQuery</b>, with the <a href="record_LCS_glossary.html">records</a><a href="delimit_LCS_glossary.html">delimited</a> by the <b>rowDelim</b> and the database fields withineach <a href="record_LCS_glossary.html">record</a> <a href="delimit_LCS_glossary.html">delimited</a> by the <b>columnDelim</b>.</p></td></tr></table></td></tr><tr><td><b>Related</b></td><td><b>Keyword</b>: <a href="string_LCS_keyword.html">string</a><br><b>Glossary</b>: <a href="function_LCS_glossary.html">function</a>, <a href="LiveCode_custom_library_LCS_glossary.html">LiveCode custom library</a>, <a href="return_LCS_glossary.html">return</a>, <a href="variable_LCS_glossary.html">variable</a>, <a href="database_LCS_glossary.html">database</a>, <a href="record_set__28database_cursor_29_LCS_glossary.html">record set (database cursor)</a>, <a href="record_LCS_glossary.html">record</a>, <a href="Standalone_Application_Settings_LCS_glossary.html">Standalone Application Settings</a>, <a href="standalone_application_LCS_glossary.html">standalone application</a>, <a href="SQL_query_LCS_glossary.html">SQL query</a>, <a href="delimit_LCS_glossary.html">delimit</a>, <a href="prepend_LCS_glossary.html">prepend</a><br><b>Command</b>: <a href="revCloseCursor_LCS_command.html">revCloseCursor</a>, <a href="revExecuteSQL_LCS_command.html">revExecuteSQL</a><br><b>Function</b>: <a href="base64Encode_LCS_function.html">base64Encode</a>, <a href="revQueryDatabase_LCS_function.html">revQueryDatabase</a>, <a href="revDatabaseColumnNamed_LCS_function.html">revDatabaseColumnNamed</a><br><b>Library</b>: <a href="Database_library_LCS_library.html">Database library</a><br><b>Control structure</b>: <a href="function_LCS_control_structure.html">function</a><br></td></tr><tr><td><b>Security</b></td><td>disk, network</td></tr><tr><td><b>Description</b></td><td><p>Use the <a href="revDataFromQuery_LCS_function.html">revDataFromQuery</a> <a href="function_LCS_glossary.html">function</a> when you want to use or displaydata from a database, but not continue to work with the <a href="record_LCS_glossary.html">records</a>that contain it.</p><p>It is convenient to use the <a href="revDataFromQuery_LCS_function.html">revDataFromQuery</a> <a href="function_LCS_glossary.html">function</a>, instead ofrevQueryDatabase, when you want to obtain the data for use but don&#39;tneed to retain a reference to the <a href="record_LCS_glossary.html">records</a> that the data camefrom. The <a href="revDataFromQuery_LCS_function.html">revDataFromQuery</a> <a href="function_LCS_glossary.html">function</a> executes the <b>SQLQuery</b>, getsthe <a href="record_LCS_glossary.html">records</a> found by the <a href="SQL_query_LCS_glossary.html">query</a>, closes the recordset (database cursor)|record set created by the <a href="SQL_query_LCS_glossary.html">query</a>, andreturns the data. Important:The <a href="revDataFromQuery_LCS_function.html">revDataFromQuery</a> function should notbe used if any of the data being retrieved is binary, doing so willprobably produce unexpected results. If you wish to use this function toreturn things like image data, the data should be encoded before beingstored in the database, this could for example be done with the<a href="base64Encode_LCS_function.html">base64Encode</a> <a href="function_LCS_glossary.html">function</a>. Also remember to specify a columDelim and<b>rowDelim</b> that will not appear in the data. Alternatively, both theseproblems can be avoided by using the <a href="revQueryDatabase_LCS_function.html">revQueryDatabase</a> <a href="function_LCS_glossary.html">function</a> togenerate a record set, then using <a href="revDatabaseColumnNamed_LCS_function.html">revDatabaseColumnNamed</a> to retrieveeach field individually.</p><p>The <b>SQLQuery</b> may contain one or more placeholders, which aresequential numbers <a href="prepend_LCS_glossary.html">prepended</a> by a colon. The<a href="revDataFromQuery_LCS_function.html">revDataFromQuery</a> <a href="function_LCS_glossary.html">function</a> substitutes the corresponding variablename in the variablesList for each of these placeholders. For example,if you have two <a href="variable_LCS_glossary.html">variables</a> called &quot;valueX&quot; and &quot;valueY&quot;, youcan use a <b>SQLQuery</b> that includes placeholders as follows:</p><p>get revDataFromQuery(, , myID,&quot;SELECT x,y FROM test WHERE x = :1 AND y =:2&quot;, &quot;valueX&quot;, &quot;valueY&quot; )</p><p>The content of the variable valueX is substituted for the &quot;:1&quot; in the<b>SQLQuery</b> (in both places where &quot;:1&quot; appears), and the content ofvalueY is substituted for &quot;:2&quot;.</p><p>To pass binary data in a variable in the variablesList, <a href="prepend_LCS_glossary.html">prepend</a> &quot;*b&quot;to the variable name. The <a href="revDataFromQuery_LCS_function.html">revDataFromQuery</a> <a href="function_LCS_glossary.html">function</a> strips thebinary marker &quot;*b&quot; and passes it to the database as binary data, ratherthan text data.</p><p>local tImageDataput the text of image &quot;MyImage&quot; into tImageDataget revDataFromQuery(, , myID,&quot;SELECT size FROM images WHERE imagedata = :1&quot;, &quot;*btImageData&quot; )</p><p>You can also use the name of a numerically indexed array, instead of alist of variable names. In this case, the elements of the array aresubstituted for the corresponding placeholders. To pass binary data inan array element, prepend &quot;*b&quot; to the element&#39;s value.</p><p>local tImageDataArrayput &quot;*b&quot; &amp; the text of image &quot;MyImage&quot; into tImageDataArray[1]get revDataFromQuery(, , myId,&quot;SELECT size FROM images WHERE imagedata = :1&quot;, &quot;tImageDataArray&quot; )</p><p>To pass an asterisk as part of the query, substitute a percent sign (%).For example, to use the query&quot;SELECT * FROM Customers WHERE Cust.Name Like &#39;*Inc.&#39;&quot;, use a statementlike the following:</p><p>get revDataFromQuery(2,&quot;SELECT * FROM Customers WHERE Cust.Name Like &#39;%Inc.&#39;&quot; )</p><p>If the query is not successful, the <a href="revDataFromQuery_LCS_function.html">revDataFromQuery</a> <a href="function_LCS_glossary.html">function</a><a href="return_LCS_glossary.html">returns</a> an error message beginning with the <a href="string_LCS_glossary.html">string</a>&quot;revdberr,&quot;. You can test for success by checking whether the first itemof the returned value is &quot;revdberr&quot;.</p><Blockquote><p><b>Important:</b>  The <a href="revDataFromQuery_LCS_function.html">revDataFromQuery</a> <a href="function_LCS_glossary.html">function</a> is part of the <a href="Database_library_LCS_library.html">Database library</a>. To ensure that the <a href="function_LCS_glossary.html">function</a> works in a <a href="standalone_application_LCS_glossary.html">standalone application</a>, you must include this <a href="LiveCode_custom_library_LCS_glossary.html">custom library</a> when you create your <a href="standalone_application_LCS_glossary.html">standalone</a>. In the Inclusions pane of the <a href="Standalone_Application_Settings_LCS_glossary.html">Standalone Application Settings</a> window, make sure both the &quot;Database&quot; library checkbox and those of the database drivers you are using are checked.</p></Blockquote></td></tr><tr><td><b>Tags</b></td><td>database</td></tr></table></body></html>