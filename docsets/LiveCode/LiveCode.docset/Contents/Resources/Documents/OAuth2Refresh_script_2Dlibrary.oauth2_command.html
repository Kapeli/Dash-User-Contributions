<!DOCTYPE html><html lang="en"><head><meta charset="utf-8" /><title>OAuth2Refresh</title><link rel="stylesheet" type="text/css" href="userguide.css" /></head><body><table><tr><td colspan="2"><h1>OAuth2Refresh</h1></td></tr><tr><td><b>Type</b></td><td>command</td></tr><tr><td><b>Dictionary</b></td><td>script-library.oauth2</td></tr><tr><td><b>Library</b></td><td>oauth2</td></tr><tr><td><b>Syntax</b></td><td><pre><span class="normal">OAuth2Refresh &lt;pTokenURL&gt;,&lt;pClientID&gt;,&lt;pClientSecret&gt;,&lt;pRefreshToken&gt;,&lt;pPort&gt;</span></pre></td></tr><tr><td><b>Associations</b></td><td>com.livecode.script-library.oauth2</td></tr><tr><td><b>Summary</b></td><td><p>Obtain a new authorization token using a refresh token</p></td></tr><tr><td><b>Parameters</b></td><td><table class="inner"><tr><th>Name</th><th>Type</th><th>Description</th></tr><tr><td>pTokenURL</td><td></td><td><p>The URL to obtain the authorization token from once an authorization code issent to the redirect uri. This can be obtained from the API documentation of the service beingauthorized.</p></td></tr><tr><td>pClientID</td><td></td><td><p>The application client ID obtained when setting up your application withthe web service.</p></td></tr><tr><td>pClientSecret</td><td></td><td><p>The application client secret obtained when setting up your application withthe web service.</p></td></tr><tr><td>pRefreshToken</td><td></td><td><p>The refresh token obtained from a previous OAuth 2 authorization.</p></td></tr><tr><td>pPort</td><td></td><td><p>The port to use for the redirect uri. It is recommended to use the range 49152-65535.</p></td></tr></table></td></tr><tr><td><b>Example</b></td><td><pre><b><span class="command">constant</span></b><span class="normal"> kTokenURL = </span><span class="normal">"https://www.googleapis.com/oauth2/v4/token"</span><b><span class="command">constant</span></b><span class="normal"> kClientID = </span><span class="normal">"XXXXXXXXXXXXXXXXXXXXXXX"</span><b><span class="command">constant</span></b><span class="normal"> kClientSecret = </span><span class="normal">"XXXXXXXXXXXXXXXXXXXXXXX"</span><p></p><b><span class="command">local</span></b><span class="normal"> sAuth</span><p></p><b><span class="normal">private</span></b><span class="normal"> <b>command</b> __RefreshAuth</span><span class="normal">   <b>if</b> sAuth </span><span class="function">is</span><span class="normal"> </span><span class="function">not</span><span class="normal"> </span><span class="function">an</span><span class="normal"> </span><span class="function">array</span><span class="normal"> <b>then</b></span><span class="normal">      </span><b><span class="command">return</span></b><span class="normal"> </span><span class="normal">"No authorization info available"</span><span class="normal"> </span><span class="function">for</span><span class="normal"> </span><span class="function">error</span><span class="normal">   <b>end</b> <b>if</b></span><p></p><span class="normal">   OAuth2Refresh kTokenURL, kClientID, kClientSecret, sAuth[</span><span class="normal">"refresh_token"</span><span class="normal">], </span><span class="normal">59004</span><span class="normal">   <b>if</b> </span><span class="function">the</span><span class="normal"> </span><span class="function">result</span><span class="normal"> </span><span class="function">is</span><span class="normal"> </span><span class="function">empty</span><span class="normal"> <b>then</b></span><span class="normal">      </span><b><span class="command">put</span></b><span class="normal"> it </span><span class="function">into</span><span class="normal"> sAuth</span><span class="normal">   <b>else</b></span><span class="normal">      </span><b><span class="command">return</span></b><span class="normal"> </span><span class="normal">"Not authorized"</span><span class="normal"> </span><span class="function">for</span><span class="normal"> </span><span class="function">error</span><span class="normal">   <b>end</b> <b>if</b></span><p></p><span class="normal">   </span><b><span class="command">set</span></b><span class="normal"> </span><span class="function">the</span><span class="normal"> </span><span class="property">httpHeaders</span><span class="normal"> </span><span class="function">to</span><span class="normal"> </span><span class="normal">"Authorization: Bearer "</span><span class="normal">& sAuth[</span><span class="normal">"access_token"</span><span class="normal">]</span><span class="normal">   </span><b><span class="command">return</span></b><span class="normal"> </span><span class="function">empty</span><span class="normal"> </span><span class="function">for</span><span class="normal"> </span><span class="function">error</span><b><span class="normal">end</span></b><span class="normal"> __RefreshAuth</span></pre></td></tr><tr><td><b>Values</b></td><td><table class="inner"><tr><th>Name</th><th>Type</th><th>Description</th></tr><tr><td>It</td><td></td><td><p>An array containing the parsed JSON data returned by the token url</p></td></tr><tr><td>The result</td><td></td><td><p>An error string if an error occurred during authorization</p></td></tr></table></td></tr><tr><td><b>Description</b></td><td><p>Access tokens have limited lifetimes. If your application needs access toan API beyond the lifetime of a single access token, it can obtain a refresh token. A refresh token allows your application to obtain new access tokens.</p><b><p><em>Note</em>:</b> Save refresh tokens in secure long-term storage and continue touse them as long as they remain valid. Limits apply to the number ofrefresh tokens that are issued per client-user combination, and peruser across all clients, and these limits are different. If your applicationrequests enough refresh tokens to go over one of the limits, older refreshtokens stop working.</p></td></tr></table></body></html>