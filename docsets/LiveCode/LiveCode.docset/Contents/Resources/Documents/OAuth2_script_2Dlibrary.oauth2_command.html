<!DOCTYPE html><html lang="en"><head><meta charset="utf-8" /><title>OAuth2</title><link rel="stylesheet" type="text/css" href="userguide.css" /></head><body><table><tr><td colspan="2"><h1>OAuth2</h1></td></tr><tr><td><b>Type</b></td><td>command</td></tr><tr><td><b>Dictionary</b></td><td>script-library.oauth2</td></tr><tr><td><b>Library</b></td><td>oauth2</td></tr><tr><td><b>Syntax</b></td><td><pre><span class="normal">OAuth2 &lt;pAuthURL&gt;,&lt;pTokenURL&gt;,&lt;pClientID&gt;,&lt;pClientSecret&gt;,&lt;pScopes&gt;,&lt;pPort&gt;,&lt;pParams&gt;</span></pre></td></tr><tr><td><b>Associations</b></td><td>com.livecode.script-library.oauth2</td></tr><tr><td><b>Summary</b></td><td><p>Present an authorization dialog for any web service that supports OAuth2 Authorization Code Flow</p></td></tr><tr><td><b>Parameters</b></td><td><table class="inner"><tr><th>Name</th><th>Type</th><th>Description</th></tr><tr><td>pAuthURL</td><td></td><td><p>The URL to present for the authorization page. This can be obtained from theAPI documentation of the service being authorized.</p></td></tr><tr><td>pTokenURL</td><td></td><td><p>The URL to obtain the authorization token from once an authorization code issent to the redirect uri. This can be obtained from the API documentation of the service beingauthorized.</p></td></tr><tr><td>pClientID</td><td></td><td><p>The application client ID obtained when setting up your application withthe web service.</p></td></tr><tr><td>pClientSecret</td><td></td><td><p>The application client secret obtained when setting up your application withthe web service.</p></td></tr><tr><td>pScopes</td><td></td><td><p>A comma delimited list of authorization scopes. Valid scopes will be foundin the API documentation of the service being authorized. If empty the scope parameter will beomitted.</p></td></tr><tr><td>pPort</td><td></td><td><p>The port to use for the redirect uri. It is recommended to use the range 49152-65535.</p></td></tr><tr><td>pParams</td><td></td><td><p>An array of additional key - value pairs of extra parameters to be sent tothe authorization url. Some services implement additional options that require extra parameters.</p></td></tr></table></td></tr><tr><td><b>Example</b></td><td><pre><b><span class="command">constant</span></b><span class="normal"> kAuthURL = </span><span class="normal">"https://slack.com/oauth/authorize"</span><b><span class="command">constant</span></b><span class="normal"> kTokenURL = </span><span class="normal">"https://slack.com/api/oauth.access"</span><b><span class="command">constant</span></b><span class="normal"> kClientID = </span><span class="normal">"XXXXXXXXX.XXXXXXXX"</span><b><span class="command">constant</span></b><span class="normal"> kClientSecret = </span><span class="normal">"XXXXXXXXXXXXXXXXXXXXX"</span><b><span class="command">constant</span></b><span class="normal"> kScopes = </span><span class="normal">"incoming-webhook"</span><p></p><span class="normal">OAuth2 kAuthURL, kTokenURL, kClientID, kClientSecret, kScopes, </span><span class="normal">54303</span><b><span class="normal">if</span></b><span class="normal"> </span><span class="function">the</span><span class="normal"> </span><span class="function">result</span><span class="normal"> </span><span class="function">is</span><span class="normal"> </span><span class="function">not</span><span class="normal"> </span><span class="function">empty</span><span class="normal"> <b>then</b></span><span class="normal">   </span><b><span class="command">answer</span></b><span class="normal"> </span><span class="function">error</span><span class="normal"> </span><span class="normal">"Not authorized!"</span><span class="normal"> </span><b><span class="normal">else</span></b><span class="normal">   </span><b><span class="command">local</span></b><span class="normal"> tAuth</span><span class="normal">   </span><b><span class="command">put</span></b><span class="normal"> it </span><span class="function">into</span><span class="normal"> tAuth</span><span class="normal">   </span><b><span class="command">local</span></b><span class="normal"> tMessage</span><span class="normal">   </span><b><span class="command">ask</span></b><span class="normal"> </span><span class="function">question</span><span class="normal"> </span><span class="normal">"What do you want to send?"</span><span class="normal">   <b>if</b> it </span><span class="function">is</span><span class="normal"> </span><span class="function">empty</span><span class="normal"> <b>then</b></span><span class="normal">      <b>exit</b> mouseUp</span><span class="normal">   <b>end</b> <b>if</b></span><p></p><span class="normal">   </span><b><span class="command">put</span></b><span class="normal"> it </span><span class="function">into</span><span class="normal"> tMessage[</span><span class="normal">"text"</span><span class="normal">]</span><span class="normal">   </span><b><span class="command">put</span></b><span class="normal"> ArrayToJSON(tMessage) </span><span class="function">into</span><span class="normal"> tMessage</span><p></p><span class="normal">   </span><b><span class="command">set</span></b><span class="normal"> </span><span class="function">the</span><span class="normal"> </span><span class="property">httpHeaders</span><span class="normal"> </span><span class="function">to</span><span class="normal"> </span><span class="normal">"Content-type: application/json"</span><span class="normal"> & \</span><span class="normal">         </span><b><span class="command">return</span></b><span class="normal"> & </span><span class="normal">"Authorization: token "</span><span class="normal"> & sAuth[</span><span class="normal">"access_token"</span><span class="normal">]</span><span class="normal">   </span><b><span class="command">post</span></b><span class="normal"> tMessage </span><span class="function">to</span><span class="normal"> </span><span class="function">url</span><span class="normal"> tAuth[</span><span class="normal">"incoming_webhook"</span><span class="normal">][</span><span class="normal">"url"</span><span class="normal">]</span><b><span class="normal">end</span></b><span class="normal"> <b>if</b></span></pre></td></tr><tr><td><b>Values</b></td><td><table class="inner"><tr><th>Name</th><th>Type</th><th>Description</th></tr><tr><td>It</td><td></td><td><p>An array containing the parsed JSON data returned by the token url</p></td></tr><tr><td>The result</td><td></td><td><p>An error string if an error occurred during authorization</p></td></tr></table></td></tr><tr><td><b>Description</b></td><td><p>In order to handle the redirect the library accepts socket connections on localhost on aconfigurable port. The redirect uri configured when setting up your application with theweb service should be <code>http://127.0.0.1:port</code> where <code>port</code> is the port that can beconfigured with the port parameter. It is recommended to use the range 49152-65535.</p><p><strong>Warning:</strong> The client secret should be kept securely when distributing an application inorder to protect your application from malicious use. The recommended way to do this is toinclude the client secret into a script in a password protected stack. If that is not possibleallow users to configure their own application with the web service and enter their ownclient id and secret into a preference instead of distributing your client id and  secret.</p></td></tr></table></body></html>