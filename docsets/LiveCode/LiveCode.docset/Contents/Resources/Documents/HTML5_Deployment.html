<!DOCTYPE html><html lang="en"><head><meta charset="utf-8" /><title>HTML5 Deployment</title><link rel="stylesheet" type="text/css" href="userguide.css" /></head><body><hr/><h2>group: deployment</h2><h1>HTML5 Deployment</h1><h2><a name="//apple_ref/cpp/Guide/Introduction" class="dashAnchor"></a>Introduction</h2><p><strong>Note: This is BETA release of HTML5 deployment support. If you intend to use it in production, please test thoroughly that it supports all the functionality you are looking for.</strong></p><p>Almost every Internet-connected device has a web browser.  If your application can run in a browser, your app can be used anywhere and by anyone, without any need to download or install it.</p><p>With LiveCode 8&#39;s HTML5 deployment capability, you can now run applications written in LiveCode in any web browser that supports JavaScript and HTML5.</p><h2><a name="//apple_ref/cpp/Guide/Supported browsers" class="dashAnchor"></a>Supported browsers</h2><p>Only a limited range of browsers are supported for HTML5 deployment in this release of LiveCode.</p><ul><li><a href="https://www.mozilla.org/firefox/new/">Mozilla Firefox</a> 40.0 (or newer)</li><li><a href="https://www.google.com/chrome/">Google Chrome</a> 44 (or newer)</li><li><a href="https://support.apple.com/HT204416">Safari for Mac</a> (latest version)</li></ul><p>We hope to broaden the range of supported browsers in the future.</p><h2><a name="//apple_ref/cpp/Guide/HTML5 engine features" class="dashAnchor"></a>HTML5 engine features</h2><p>The HTML5 engine in this release of LiveCode has a limited range of features.  You can:</p><ul><li>deploy single-stack applications with embedded resources</li><li>use most of the engine&#39;s built-in controls and graphics capabilities.</li><li>read and write temporary files in a special virtual filesystem (which is erased when the user navigates away from the page)</li><li>use LiveCode Builder widgets and extensions</li><li>interact with JavaScript code in the web page using <code>do &lt;script&gt; as &quot;JavaScript&quot;</code></li><li>perform basic networking operations using the <strong>load</strong> command</li></ul><p>Several important features are not yet supported:</p><ul><li>some <code>ask</code> and <code>answer</code> message boxes</li><li>multimedia (the &quot;player&quot; control)</li><li>JavaScript in LiveCode Builder extensions</li></ul><p>Two important unsupported features are unlikely to be added in the near future:</p><ul><li>operations that need to pause the script while something happens(e.g. <code>wait 10</code>)</li><li>externals (including revdb)</li></ul><h2><a name="//apple_ref/cpp/Guide/How to deploy an app to HTML5" class="dashAnchor"></a>How to deploy an app to HTML5</h2><h3>Step by step</h3><p>Deploying an app to an HTML5 standalone is straightforward:</p><p>1) Open your stack in the LiveCode IDE</p><p>2) Select <strong>File ? Standalone Application Settings...</strong> from the menu bar</p><p>3) Browse to the <strong>HTML5</strong> tab of the standalone settings window</p><p>4) Make sure that the <strong>Build for HTML5</strong> checkbox is enabled</p><p>5) Close the standalone settings window</p><p>6) Select <strong>File ? Save as Standalone Application...</strong> from the menu bar</p><p>Your application will be packaged up and placed in the selected output folder.</p><h3>Contents of the HTML5 standalone</h3><p>The HTML5 standalone contains four files:</p><ul><li><p>A standalone archive, named <code>standalone.zip</code> by default.  This file contains your application and all of the resources that it depends on.  When the engine runs, the filesystem that&#39;s visible to the engine (e.g. via the <code>open file</code> syntax) is based on the contents of the standalone archive.</p></li><li><p>The engine itself, which consists of two files.  The <code>.js</code> file contains the engine&#39;s executable code, and the <code>.html.mem</code> file contains essential data that&#39;s needed for the engine to run.  These files are always the same, and only change when LiveCode is upgraded.</p></li><li><p>A test HTML page.  This can be opened in a browser and will correctly prepare, download and start your HTML5 app in a convenient test environment.</p></li></ul><h3>Testing your HTML5 app with a local web server</h3><p>Some browsers, such as Google Chrome, do not permit pages to download resources from <code>file://</code> URLs.  You won&#39;t be able to test your application in these browsers unless you run a local HTTP server.</p><p>A quick and easy way to run a simple local HTTP server is to use Python.  Open a terminal window, change directory to your standalone&#39;s directory, and run:</p><pre><code>python -m SimpleHTTPServer 8080</code></pre><p>This will let you access your standalone by opening your web browser and visiting <a href="http://localhost:8080">http://localhost:8080</a>.</p><h2><a name="//apple_ref/cpp/Guide/Reporting bugs" class="dashAnchor"></a>Reporting bugs</h2><p>Please report bugs to the <a href="http://quality.livecode.com/">LiveCode Quality Centre</a>.  Make sure to select &quot;HTML5 Standalone&quot; when you&#39;re creating your bug report!</p><h2><a name="//apple_ref/cpp/Guide/Advanced: HTML5 standalone filesystem" class="dashAnchor"></a>Advanced: HTML5 standalone filesystem</h2><p>JavaScript applications running in a browser don&#39;t have access to the host system&#39;s filesystem.  Instead, the filesystem-related features of LiveCode, such as <code>open file</code>, use a virtual filesystem (VFS) that exists only in memory.  This filesystem is initialised before the engine starts, and is reset and its content discarded when the engine stops (when the user closes the browser view or navigates to a different page).</p><p>During engine startup, the VFS is populated from the contents of the <code>standalone.zip</code> file that&#39;s created by the HTML5 deployment process.  All of the initial files are stored in <code>/boot/</code> in the VFS.</p><p>There are several special files &amp; directories in the <code>/boot/</code> directory:</p><ul><li><code>/boot/__startup.livecode</code>: a stack that performs loading &amp; initialisation operations during engine startup.</li><li><code>/boot/auxiliary_stackfiles/</code>: during startup, each file in this directory is loaded and is receives the <code>revLoadLibrary</code> message</li><li><code>/boot/fonts/basefont.ttf</code>: the font used by the engine</li><li><code>/boot/standalone/__boot.livecode</code>: this is the initial stack of the application, which is the main stack that receives the <code>startup</code> message when the engine has been initialized</li><li><code>/boot/standalone/</code>: the <code>defaultFolder</code> when the engine starts, and the location where additional assets selected using the &quot;Copy files&quot; page of the standalone builder are placed</li><li><code>/boot/extensions/extensions.txt</code>: list of extensions included in the standalone, in the order in which they should be autoloaded</li><li><code>/boot/extensions/</code>: the directory where all autoloaded extensions are stored</li></ul><p>In general, if you wish to add new files or directories to the <code>standalone.zip</code> archive, it is best to add them outside the <code>/boot/</code> directory tree.</p><h2><a name="//apple_ref/cpp/Guide/Advanced: Embedding an HTML5 standalone in a web page" class="dashAnchor"></a>Advanced: Embedding an HTML5 standalone in a web page</h2><p>The default HTML5 page provided by the HTML5 standalone builder is designed for testing and debugging purposes.  However, you may want to embed the standalone engine in a more visually appealing page.  To do this, you require three elements: 1) a canvas, 2) a JavaScript <code>Module</code> object, and 3) an HTML <code>&lt;script&gt;</code> element that downloads the engine.</p><h3>The canvas</h3><p>The engine renders into a HTML5 <code>&lt;canvas&gt;</code> element.  There are three important considerations when creating the canvas:</p><ul><li><p>the canvas must have absolutely no border, or mouse coordinate calculations will be incorrect</p></li><li><p>it will be automatically resized by the engine to match the size of your stack, so don&#39;t attempt to set its size using HTML or CSS</p></li><li><p>it needs to be easily uniquely identifiable, so that the engine can find it.</p></li></ul><p>The absolute minimum canvas element would look something like this:</p><pre><code>&lt;canvas style=&quot;border: 0px none;&quot; id=&quot;canvas&quot; oncontextmenu=&quot;event.preventDefault();&quot;&gt;&lt;/canvas&gt;</code></pre><p>By default, most web browsers will indicate when the canvas has focus by displaying a highlighted outline.  This helps users identify which part of the web page is capturing their key presses.  You can usually disable this outline by adding <code>outline: none;</code> to the canvas&#39;s CSS styles.</p><h3>The Module object</h3><p>The top-level JavaScript <code>Module</code> object contains the parameters that control how the engine runs.  At minimum, you need only specify the <code>Module.canvas</code>, which should be your canvas element.</p><p>The absolute minimum <code>Module</code> object declaration would look something like:</p><pre><code>&lt;script type=&quot;text/javascript&quot;&gt;var Module = {  canvas: document.getElementById(&#39;canvas&#39;),};&lt;/script&gt;</code></pre><h3>Engine download</h3><p>The engine is quite a large JavaScript file, so it&#39;s downloaded asynchronously in order to let the rest of the page finish loading and start being displayed.</p><p>Quite straightforwardly:</p><pre><code>&lt;script async type=&quot;text/javascript&quot; src=&quot;standalone-&lt;version&gt;.js&quot;&gt;&lt;/script&gt;</code></pre><p>Make sure to replace <code>&lt;version&gt;</code> as appropriate.</p><h3>Bringing it all together</h3><p>Here&#39;s the complete skeleton web page for an HTML5 standalone:</p><pre><code>&lt;html&gt;   &lt;body&gt;    &lt;canvas style=&quot;border: 0px none;&quot; id=&quot;canvas&quot; oncontextmenu=&quot;event.preventDefault()&quot;&gt;&lt;/canvas&gt;     &lt;script type=&quot;text/javascript&quot;&gt;       var Module = { canvas: document.getElementById(&#39;canvas&#39;)  };     &lt;/script&gt;    &lt;script async type=&quot;text/javascript&quot; src=&quot;standalone-community.js&quot;&gt;&lt;/script&gt;  &lt;/body&gt;&lt;/html&gt;</code></pre><h2><a name="//apple_ref/cpp/Guide/Advanced: Speeding up engine download" class="dashAnchor"></a>Advanced: Speeding up engine download</h2><p>Currently, the engine files are almost 30 MB, which is a lot to download before the engine can start.  It is possible to speed up the download by enabling deflate compression in the web server configuration.</p><p>Enabling deflate compression reduces the total download size to around 6.3 MB.  It&#39;s recommended to pre-compress the engine with <code>gzip</code>, and then configure your web server to serve the pre-compressed files.</p><ul><li>For the Apache web server, configure <code>mod_deflate</code> to serve <a href="https://httpd.apache.org/docs/2.4/mod/mod_deflate.html#precompressed">pre-compressed content</a></li><li>For the NGINX web server, add <a href="https://www.nginx.com/resources/admin-guide/compression-and-decompression/#send"><code>gzip_static on;</code></a> to your configuration.</li></ul><h2><a name="//apple_ref/cpp/Guide/Advanced: Customizing the Module object" class="dashAnchor"></a>Advanced: Customizing the Module object</h2><p>There are a number of LiveCode-specific <code>Module</code> attributes that you can modify to affect how the engine behaves:</p><ul><li><code>Module.livecodeStandalone</code>: the filename of the standalone archive (default <code>standalone.zip</code>)</li><li><code>Module.livecodeStandalonePrefixURL</code>: Prepended to the standalone archive filename to construct its full URL (default empty)</li><li><code>Module.livecodeStandaloneRequest</code>: If you assign a network request to this attribute (before the engine runs), then it will use that request for the standalone archive instead of automatically starting a download for you. This means that you can, in your HTML, fire off a request for the standalone before the engine script actually arrives.  For this to work, the network request should be an <code>XMLHttpRequest</code> with its <code>responseType</code> set to <code>arraybuffer</code>.</li></ul><p>See also Emscripten&#39;s <a href="https://kripken.github.io/emscripten-site/docs/api_reference/module.html">Module object documentation</a>.</p></body></html>