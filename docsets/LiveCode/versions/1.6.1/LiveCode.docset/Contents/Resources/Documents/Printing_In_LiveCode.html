<!DOCTYPE html><html lang="en"><head><meta charset="utf-8" /><title>Printing In LiveCode</title><link rel="stylesheet" type="text/css" href="userguide.css" /></head><body><h1>Printing In LiveCode</h1><h3><a name="//apple_ref/cpp/Guide/Introduction" class="dashAnchor"></a>Introduction</h3><p>Printing is a vital aspect of many applications. LiveCode provides acomprehensive set of printing capabilities. Whether you want a simpleprint out of your stack, want to print labels or produce complexreports, LiveCode has the features you need.</p><p>LiveCode supports a number of methods of printing. You can use the<em>print card command</em> and have LiveCode manage the layout of cards on thepaper. Alternatively you can use the <em>print into rectangle commands</em>which allow you to take full control over the layout of your print out.The former method is most suited to implementing simple printfunctionality, while the latter is better suited for more complex layoutprinting or printing reports. Finally, you can use the built-in fieldprinting script library to print the contents of any text field using asimple command.</p><p>LiveCode also includes a full set of features to access and set printerdevice options, including options such as margins, page range and numberof copies. This feature is invaluable if you want to produce a highresolution PDF file from your stack.</p><h3><a name="//apple_ref/cpp/Guide/Controlling Printer Device Settings" class="dashAnchor"></a>Controlling Printer Device Settings</h3><p>LiveCode gives you full programmatic control over your printer deviceand any available settings.</p><h3><a name="//apple_ref/cpp/Guide/Choosing a Printer" class="dashAnchor"></a>Choosing a Printer</h3><p>Use the <strong>availablePrinters</strong> to list the printers available on theuser&#39;s system. Printers can include fax modems and networked devices. Ifthe <strong>availablePrinters</strong> is empty, no printer is assigned. For example,to place a list of the available printers into a list field:</p><pre><code>put the availablePrinters into field &quot;list of printers&quot;</code></pre><p>Set the <strong>printerName</strong> to the printer you want to use to print. You canuse any printer listed in the availablePrinters. This property is usefulwhen producing an in-house utility that needs to print to a specificprinter on the corporate network, or for automatically restoring theuser&#39;s previous printer choice stored in a preferences file.</p><pre><code>set the printerName to the cSavedPrinter of stack &quot;My Preferences&quot;</code></pre><p>The <strong>printerFeatures</strong> provides a list of the features supported by thecurrently selected printer. Features will vary widely from device todevice, but typical features may include things such as &quot;collate&quot;,&quot;color&quot; and &quot;duplex&quot;. Use this property to enable and disable outputoptions in any custom printer settings dialog.</p><h3><a name="//apple_ref/cpp/Guide/Choosing Output Mode %28e.g. Print to File%29" class="dashAnchor"></a>Choosing Output Mode (e.g. Print to File)</h3><p>The <strong>printerOutput</strong> global property allows you to choose the outputmode for subsequent printing commands. This property is set by thesystem to the default printer on startup and will be changed if you opena system print dialog in which the user chooses a different printer. Ifthis property is set to <em>device</em> it will output to the physical printer.Alternatively, you can set it to a file path to print to a file. On Macyou can set this to <em>preview</em> to create a preview.</p><p>For example, to save the current card to a file:</p><pre><code>ask file &quot;Save as:set the printerOutput to (&quot;file:&quot; &amp; it )print this card</code></pre><h3><a name="//apple_ref/cpp/Guide/Working with Printer Dialogs" class="dashAnchor"></a>Working with Printer Dialogs</h3><p>In most applications that need to print, you will want to provide a wayto bring up the standard OS Print and Page Setup dialogs. Typically youwould make these dialogs available from Print and Page Setup items inthe File menu of your application. When the user makes changes in thesedialogs the changes are made accessible to you in global properties. Wediscuss how to save and utilize these properties below.</p><blockquote><p><strong>Note:</strong> It is not necessary to bring up the standard OS dialogs toalter printer settings. You may set the appropriate printer settingdirectly by script instead.</p></blockquote><p>On Linux systems you will need a recent version of GTK installed inorder to display the OS printer dialog. If you don&#39;t have thisinstalled, LiveCode will display its own printer dialog which has beenbuilt as a stack and script library. This dialog mimics the standardsystem printer dialog and sets the LiveCode printing global propertiesdirectly.</p><blockquote><p><strong>Tip:</strong> You may force LiveCode to use its own internal print settingsdialog by setting the <code>systemPrintSelector</code>global property to false.Advanced users may customize the printer dialog that LiveCode uses byrunning <code>toplevel &quot;print dialog&quot;</code>or <code>toplevel &quot;page setup&quot;</code>in theMessage Box. Remember to save a copy of the stack as it will beoverwritten each time you upgrade your copy of LiveCode.</p><p><strong>Important:</strong> The LiveCode print and page setup dialogs must beincluded in a standalone application if you use them. Ensure that thecheck box Print Dialog is turned on in the Standalone ApplicationSettings dialog for your application. You do not need to include thesedialogs if you only use the OS native print dialogs. For moreinformation on including resources in your standalone application, seethe chapter on Building Standalone Applications.</p></blockquote><p>To bring up the standard OS printer dialog, use the <strong><code>answer printer</code></strong>command.</p><pre><code>answer printer</code></pre><p>If the user does not press the cancel button then any changes to theprinter settings will be reflected in the global printing properties,discussed below.</p><p>To bring up the standard OS page setup dialog, use the <strong>answer page setup</strong> command.</p><pre><code>answer page setup</code></pre><h3><a name="//apple_ref/cpp/Guide/Saving Printer Settings" class="dashAnchor"></a>Saving Printer Settings</h3><p>To save or set a complete set of options relating to the current printerwhich includes every setting in the OS Page Setup and Print dialogs, usethe <strong>printerSettings</strong> global property.</p><p>The <strong>printerSettings</strong> property is a binary string that completelydescribes the current settings. The property contains the name of theprinter and the settings currently in use.</p><p>You should not attempt to modify the printerSettings but rather get andset it in its entirety. To access individual printer properties, use theglobal printing properties described below.</p><p>When you set the <strong>printerSettings</strong> property to a saved value, LiveCodewill choose the printer named in the property and set all of itssettings to those contained within the property. If the printer cannotbe found LiveCode will return the error &quot;unknown printer&quot; in the result.If the printer is found but the settings are not valid then LiveCodewill choose the printer and reset it to default values.</p><blockquote><p><strong>Note:</strong> You must save a separate copy of the printerSettingsproperty for each printer or OS you intend to use. The printerSettings property cannot betransferred between platforms. For example, a printerSettings propertygenerated on a Windows computer cannot be used on Mac – even for thesame printer. If you want to alter settings across different platformsand printer types use the global printing properties described below.Use the printerSettings for convenience when you know you will be usingthe same printer and want to save all the settings, or where you aresetting esoteric properties not listed in the global printingproperties described below.</p></blockquote><p>To save the current printer settings into a custom property stored onthe current stack:</p><pre><code>set the cSavedPrinterSettings of this stack to the printerSettingssave this stack</code></pre><p>Then to restore these settings:</p><pre><code>set the printerSettings to the cSavedPrinterSettings of this stack</code></pre><h3><a name="//apple_ref/cpp/Guide/Paper Related Options" class="dashAnchor"></a>Paper Related Options</h3><p>This section discusses how you get and set paper related options – therectangle area of the paper, the paper size, the orientation and thescale to use to print onto the paper. These paper options apply to alltypes of printing, i.e. card, field and layout printing.</p><p>Use the <strong>printRectangle</strong> to get the printable rectangle area withinthe paper (returned in device co-ordinates). This property takes intoaccount any settings applied by the user in the Page Setup and Printerdialogs including the print orientation (e.g. landscape or portrait).The rectangle is represented left,top,right,bottom and is alwaysrelative to the top left of the page – thus the top left will always be0,0. The printRectangle will always be within the<strong>printPaperRectangle</strong> – the rectangular area of the sheet of paper.</p><p>The printRectangle property is read only and cannot be set directly – toalter it you must set other options relating to the paper, for examplethe <strong>printPaperOrientation</strong>(discussed below).</p><p>Do not confuse the <strong>printMargins</strong>and other card layout printingproperties with paper properties such as the <strong>printRectangle</strong>. The<strong>printMargins</strong>only applies to printing cards using LiveCode&#39;s automaticcard layout capabilities (discussed below). Thus the <strong>printMargins</strong>hasno effect on <strong>printRectangle</strong>.</p><p>Use the <strong>printPaperOrientation</strong> to get and set the orientation of yourprint out. This property may be set to one of the following values:</p><p><em>portrait</em>: rotated 0 degrees.</p><p><em>landscape</em>: rotated 90 degrees clockwise.</p><p><em>reverse portrait</em>: rotated 180 degrees clockwise.</p><p><em>reverse landscape</em>: 270 degrees clockwise.</p><pre><code>set the printPaperOrientation to &quot;landscape&quot;</code></pre><p>Use the <strong>printPaperScale</strong> property to apply a scale factor to yourprint out after all other settings have been taking into account.</p><p>The <strong>printPaperScale</strong> is applied after all other layout and scalingoptions. For example, if you have used the layout printing features toprint a series of cards at 50% scale, then set the <strong>printPaperScale</strong>,this factor will be applied to the entire layout after the card layoutscaling has been calculated.</p><p>To print a range between 1 and 100% set the <strong>printPaperScale</strong> to anumber between 0 and 1. To print at 200% set the <strong>printPaperScale</strong> to2.</p><pre><code>set the printPaperScale to 0.5 -- 50%</code></pre><h3><a name="//apple_ref/cpp/Guide/Job Related Options" class="dashAnchor"></a>Job Related Options</h3><p>This section discusses how to get and set job related options – thenumber of copies, duplex printing, collation, color, title and printablearea.</p><blockquote><p><strong>Important:</strong> The available job options all depend on what thecurrently selected printer supports (use the<strong>printerFeatures</strong>property, described above, to retrieve a list offeatures supported by the current printer).</p></blockquote><p>Use the <strong>printCopies</strong> property to get and set the number of copies toprint. The printCopies should be set to a value of 1 or more.</p><pre><code>set the printCopies to 5 -- print 5 copies</code></pre><p>Use the <strong>printDuplex</strong> property to tell the printer to print doublesided. This property may be set to any of the following values:</p><ul><li><em>none</em>: no double-sided printing </li><li><em>short edge</em>: double-sided printing with tumble (flip the non-facing page) </li><li><p><em>long edge</em>: double-sided printing without tumble.</p><p>set the printDuplex to &quot;short edge&quot;</p></li></ul><p>Use the <strong>printCollate</strong> property to specify whether to interleavemultiple copies of a print job. If a print job has three pages, P1, P2and P3, with printCollate set to <em>true</em> and <strong>printCopies</strong>set to 2 theoutput order will be P1, P2, P3, P1, P2, P3. With printCollate set to<em>false</em> the output will be P1, P1, P2, P2, P3, P3.</p><pre><code>set the printCollate to true</code></pre><p>Use the <strong>printColors</strong> property to specify whether to print in color ornot. If &quot;color&quot; is not among the lines of the <strong>printerFeatures</strong> thenthis property will have no effect and all print jobs will be printed inmonochrome. This property may be set to either <em>true</em> or <em>false</em>.</p><p>For example, to check if color printing is supported on the currentprinter and use it if it is:</p><pre><code>if &quot;color&quot; is among the lines of the printerFeatures then     set the printColors to trueend if</code></pre><p>Use the <strong>printTitle</strong> property to specify the name of the next printjob in the system printer queue. Setting this property to match the nameof the user&#39;s document will ensure that the user is able to recognize itin the system printer queue utility. If the <strong>printTitle</strong>is empty atthe start of a printing loop, the title of the defaultStack will be used.</p><pre><code>set the printTitle to &quot;My Report 1&quot;</code></pre><p>Use the <strong>printRectangle</strong> property to determine the printable region ofthe physical page as returned by the printer. This rectangle will alwaysbe contained within the <strong>printPaperRectangle</strong>. Thus you should use theprintRectangle and not the <strong>printPaperRectangle</strong> when calculating aprint layout. The <strong>printPaperRectangle</strong> is useful if you aregenerating a print preview and want to show the entire area of the paperincluding any margin areas that cannot be printed on. This property isread only and cannot be set directly.</p><h3><a name="//apple_ref/cpp/Guide/Printer Font Metrics %28Windows%29" class="dashAnchor"></a>Printer Font Metrics (Windows)</h3><p>Windows systems sometimes use different versions of the same font fordisplaying text on screen and printing. This can result in layouts andline breaks differing between the screen display and the printed output.To prevent this from happening, you can tell LiveCode to use the printerfonts for display on screen. To do this, set a stacks<strong>formatForPrinting</strong> property to true.</p><p><strong>Do:</strong><br/>- Set the <strong>formatForPrinting</strong>stack property to true before loading a stack in memory. If the stack is already loaded, set this property to true then save and reload it. (Save then use <em>Close and Remove from Memory</em> in the File menu).<br/>- Create a stack off screen (with <strong>formatForPrinting</strong> set to true) with your print layout template and copy text into it prior to printing.<br/>- Set the <strong>formatForPrinting</strong>before doing any print layout related calculations on the stack.<br/>- Set the <strong>formatForPrinting</strong>to true on any print preview stack being displayed to the user.</p><p><strong>Don&#39;t:</strong> - Allow the user to directly edit text in fields whose <strong>formatForPrinting</strong> is set to true. Attempting to do this may cause display anomalies. Set this property to false and reload the stack first.<br/>- Generally use stacks with <strong>formatForPrinting</strong>set to true for display on screen, as this will show text that has been optimized for print display (instead of screen display), which is harder to read on screen.<br/>- Use this property on other platforms – Windows is the only platform that uses different fonts on screen vs. in a print out.<br/>- Use the <strong>windowBoundingRect</strong> property to constrain display of a stack who&#39;s <strong>formatForPrinting</strong>has been set to true – this property will be ignored when the stack is opened or maximized.</p><h3><a name="//apple_ref/cpp/Guide/Printing a Card" class="dashAnchor"></a>Printing a Card</h3><p>Once you have set your printer, paper and job options (above) you arenow ready to use one of the print commands to start printing. At itssimplest, the <strong>print</strong> card command allows you to print a card. Laterwe will discuss ways of printing more complex layouts, fields and text.</p><pre><code>print this card -- prints the current cardprint card 12 -- prints card 12</code></pre><p>For more details on how to specify which cards to print, see the <strong>print</strong> command in the <em>LiveCode Dictionary</em>.</p><p>To print a scale between 1 and 100% set the <strong>printScale</strong> to a numberbetween 0 and 1. To print at 200% set the <strong>printScale</strong> to 2.</p><p>The printScale applies to each card that you print. It is not related tothe <strong>printPaperScale</strong> which is applied to the entire print job afterall other scaling calculations have been applied. Thus you may set the<strong>printPaperScale</strong> to 0.5 to print at 50%, then print individual cardsat different printScale values. With a <strong>printPaperScale</strong> of 0.5, aprintScale of 2 would result in that card being printed at 100%.</p><p>When printing a card, use the <strong>printMargins</strong> to specify the marginsaround the border of the card on the page.</p><blockquote><p><strong>Note:</strong> When calculating placement on the printed page, allcalculations assume that there are 72 dots per inch – regardless ofplatform or printer device. LiveCode will automatically adjust theprint out for resolution of the actual device. This makes it simple tocalculate your printed layout.</p></blockquote><pre><code>-- a one-inch margin on each sideset the printMargins is set to 72,72,72,72</code></pre><p>The <strong>printMargins</strong> only applies when using print card directly. Itdoes not have any effect on printing cards into a layout (describedbelow).</p><p>The <strong>printCardBorders</strong> property specifies whether or not the bevelborder around the edge of a card should appear in the print out.</p><h3><a name="//apple_ref/cpp/Guide/Card Layout Options" class="dashAnchor"></a>Card Layout Options</h3><p>When using the basic print card form of the print command, there are twolayout options that allow you to customize the positioning of cards onthe printed page. If you require further flexibility, see the section onprinting a layout, below.</p><p>Use the <strong>printRowsFirst</strong> property to specify whether cards should beprinted across and down or down then across.</p><p>Consider a simple example of printing multiple cards – this example isuseful for printing labels. In this example we have a stack thatcontains 8 cards, each one containing a mailing label. If you want totry out this example:</p><ul><li>Create a stack and size it to be small – the size of a mailing label</li><li>Create a single field, and in the field Inspector turn off the <em>Shared Text</em> property</li><li>Group the field and in the group property <em>Inspector</em> turn on <em>Behave as Background</em></li><li>Turn on <em>Select Grouped</em> on the Toolbar and select the field</li><li>Place the contents of the first mailing label into the <em>Contents</em> tab of the <em>Inspector</em></li><li>Create 8 more cards, and in each select the field and place the contents of a different label</li></ul><p>Thus we have a stack that looks like the figure below.</p><p><img src="images/printing-label_stack_example.png" alt="Print label stack example"/></p><p>Now we will implement the printing commands. If this was a realapplication you would probably want to put these in a Print command inthe File menu. In this instance you may execute the following in themulti-line message box (open the Message Box then press the second iconto get the multi-line pane).</p><pre><code>-- allow the user to choose printer output optionsanswer printerprint 9 cards</code></pre><p>Press enter to execute the commands.</p><p>The resulting print out will look like the figure below.</p><p><img src="images/printing-label_sized_cards_default.png" alt="Printing 9 label-sized cards with default settings"/></p><p>If we modify the print commands to include an additional line to turnoff the printRowsFirst:</p><pre><code>answer printerset the printRowsFirst to falseprint 9 cards</code></pre><p>The resulting print out will look like the figure below.</p><p><img src="images/printing-label_sized_cards_printRowsFirst_false.png" alt="Printing 9 label-sized cards with printRowsFirst set tofalse"/></p><p>Use the <strong>printGutters</strong> property to specify the margin between eachcard. By default the printGutters are set to 36,36 or one half inchhorizontally and vertically.</p><p>In the following example, we print the same label stack but reduce thespace between each label to 1/10<sup>th</sup> of an inch. To make iteasy to see the differente we also turn on printing of card bordersusing the printCardBorders property.</p><pre><code>answer printerset the printGutters to 7,7set the printCardBorders to trueprint 9 cards</code></pre><p>The resulting print out will look like the figure below.</p><p><img src="images/printing-label_sized_cards_gutter.png" alt="Printing 9 label-sized cards with borders and a narrowgutter between each"/></p><h3><a name="//apple_ref/cpp/Guide/Printing Fields %26amp%3B Text" class="dashAnchor"></a>Printing Fields &amp; Text</h3><p>To print a field, use the <strong>revPrintField</strong> command. This command takesa single parameter, a reference to a field. This command only allowsprinting a single field. If you need to include a header and footer ortext you have constructed programmatically, see the <strong>revPrintText</strong>command below.</p><pre><code>revPrintField the long id of field &quot;text document&quot;</code></pre><p><strong>revPrintField</strong> is implemented as a script library located in theLiveCode IDE. The script library creates an invisible stack, sets therectangle of that stack to the current paper size, sets the<strong>formatForPrinting</strong>to true, creates a field, then copies the contentsof the field you specify into this invisible stack. It then prints thefield one page at a time, scrolling the text after each page. Advancedusers can locate this library script by going to the <em>Back Scripts</em> tabin the Message Box, turning on the checkbox for <em>Show LiveCode UI BackScripts</em>, then editing the script of <em>stack &quot;revPrintLibrary&quot;</em>. The<em>revPrintField</em> handler is near the top of the script.</p><p>Use the <strong>revShowPrintDialog</strong> command to control whether the systemprinter and page setups dialogs should be shown by <strong>revPrintField</strong> or<strong>revPrintText</strong>.</p><pre><code>-- show the system printer dialog, but not page setuprevShowPrintDialog true, falserevPrintField the long id of field &quot;text document&quot;</code></pre><p>Use the <strong>revPrintText</strong> command to print plain or styled text togetherwith an optional header and footer.</p><pre><code>revPrintText textToPrint [,headerText [,footerText [,fieldTemplate]]]</code></pre><p>The <em>textToPrint</em> is anything which evaluates to a string. If you wantto printed styled text, pass HTML instead of plain text. (To convert afield containing styled text to a HTML use the <strong>htmlText</strong> property.)</p><p>The <em>headerText</em> and <em>footerText</em> contains the text to use as a headerand footer. You may include an expression that is computed for eachpage. For more details on using expressions, see the <em>LiveCode Dictionary</em> entry for <strong>revPrintText</strong>.</p><p>The <em>fieldTemplate</em> parameter allows you to specify a field reference touse. Fonts in the print out will be inherited from this field.</p><h3><a name="//apple_ref/cpp/Guide/Printing a Layout" class="dashAnchor"></a>Printing a Layout</h3><p>If you need to print a more complex layout than allowed with the basicprint card command or text printing commands (described above), you canuse the <strong>print card into rect</strong> syntax to create any sort of layout youchoose.</p><pre><code>print card from topLeft to rightBottom into pageRect</code></pre><p>The <em>topLeft</em> is the top left coordinate of the current card to startprinting at.</p><p>The <em>rightBottom</em> is the bottom right coordinate of the current card tostop printing at.</p><p>The <em>pageRect</em> is therectangular area on the paper to print into.</p><p>printMargins only applies when using print card directly. It does nothave any effect on printing cards into a layout. Use the<strong>printRectangle</strong> to get the printable area when working with layoutprinting.</p><p>For example, lets say that we want to print the text field from themiddle of the stack in the figure below. (You can load the stack shown inthe picture by going to your LiveCode installation folder then openingResources-&gt; Examples-&gt; SQLite Sampler.rev.) We want the output toscale to take up the entire width of the paper and half the height.</p><p><img src="images/printing-stack_with_text_field.png" alt="Stack with text field to print into a layout"/></p><pre><code>local tRectput 0,0,item 3 of the printRectangle, \    round(item 4 of the printRectangle / 2) into tRectprint this card from the topleft of field &quot;theText&quot; \    to the bottomRight of field &quot;theText&quot; \    into tRect</code></pre><p>This results in the print out shown in the figure below.</p><p><img src="images/printing-stack_with_text_field_print.png" alt="Result of layout printing command"/></p><p>You can construct a complex layout taking components from multiplestacks by printing a sequence of rectangles onto the same page. Forexample, you may have a stack that contains a standard header andfooter, another that contains a logo, and a layout that contains text.Use the <strong>open printing</strong> command to start a print job, then print eachelement into the appropriate rectangle on the paper. The use then<strong>close printing</strong> command to send the print job to the printer. Theexample in the figure below shows two stacks with printable regions thatwe want to combine onto a single sheet of paper.</p><p><img src="images/printing-separate_header_body_stacks.png" alt="Separate header and body stacks to print into a layout"/></p><p>To print these onto a single sheet:</p><pre><code>answer printer -- show the system print settings dialogopen printing -- start a print job-- work with the header stackset the defaultStack to &quot;header&quot;-- print the header field onto the top left of the paperprint this card from the topLeft of field &quot;header&quot; \    to the bottomRight of field &quot;header&quot; \    into the rect of field &quot;header&quot;-- save the bottom of the headerput the bottom of field &quot;header&quot; into tHeaderBottomset the defaultStack to &quot;report editor&quot;-- print the table field below the headerprint this card from the `topLeft`of field &quot;report table&quot; \    to the bottomRight of field &quot;report table&quot; \    into 0,tHeaderBottom,the`right of field &quot;report table&quot;, \    the bottom of field &quot;report table&quot; + tHeaderBottom-- send `the`job to `the`printerclose`printing</code></pre><p><img src="images/printing-layout_multiple_stacks.png" alt="Result of layout printing command with multiple stacks"/></p><h3><a name="//apple_ref/cpp/Guide/Printing a complex layout" class="dashAnchor"></a>Printing a complex layout</h3><p>To print a more complicated layout, create a stack and set its rectangleto the current <strong>printRectangle</strong>. Add rectangular areas for eachcomponent you will be printing. Then set <em>Geometry</em> properties (see thesection on the <em>Geometry Manager</em>, in the <strong>LiveCode Script</strong> guide formore information) on each of these rectangles so they resize correctlywhen the stack is scaled. Set up your print routine so that you openthis stack invisibly then resize it to the <strong>printRectangle</strong>. This willtrigger the geometry routines and scale the rectangular areas correctly.Then run your sequence of print commands to print into each rectangle.</p><p>In the figure below, we have set the size of the stack to the<strong>printRectangle</strong> then added 4 rectangle graphics. We have named eachgraphic and turned on the <em>Show Name</em> property for each so you can seethe name.</p><p><img src="images/printing-stack_template.png" alt="Stack template for printing a layout"/></p><p>Next, we set Geometry properties for each of the rectangle graphics. Theheader graphic is set to scale relative to the right and bottom, with aminimum size limit of 100 pixels (see the figure below). The body graphicis set to link the top edge to the header graphic, the right and bottomto the stack (see the figure below). The footer 1 graphic is set to scalethe right edge and position the bottom edge. And footer 2 is set toposition both the right and bottom.</p><p><img src="images/printing-example_geometry_property1.png" alt="Example geometry properties for print layout stack"/><img src="images/printing-example_geometry_property2.png" alt="Example geometry properties for print layout stack"/></p><p>To make the printing template stack take on the size of the paper, wecan add the following handler to the stack script:</p><pre><code>on preOpenStack    set the width of this stack to (item 3 of the printRectangle - item 1 of the printRectangle)    set the height of this stack to (item 4 of the printRectangle - item 2 of the printRectangle)end preOpenStack</code></pre><p>We now have a working print template stack. All that remains is to write the script that prints into the rectangles:</p><pre><code>-- prepare to load this stack off screenhide stack &quot;print layout&quot;-- this will trigger the stack to resize, which run the geometry -- routines, giving us the correct values for each rectanglego stack &quot;print layout&quot;-- now we store these rectangle coordinates in variablesput the rect of graphic &quot;header&quot; into tHeaderRectput the rect of graphic &quot;body&quot; into tBodyRectput the rect of graphic &quot;footer 1&quot; into tFooter1Rectput the rect of graphic &quot;footer 2&quot; into tFooter2Rect-- we can close the layout stack as its no longer neededclose stack &quot;print layout&quot;-- load the system printer dialog to allow the user -- to choose number of copies, etc.answer printer-- start the print jobopen printing-- set the stack we are working on to a stack containing the header-- you could use any stack or region within a card hereset the defaultStack to stack &quot;header graphics&quot;-- print from the rectangle of our header group -- into the rectangle we stored earlier-- we could use a graphic or any rectangular area instead of a groupprint this card from the topLeft of group &quot;header&quot; \    to the bottomRight of group &quot;header&quot; into tHeaderRectset the defaultStack to &quot;body contents&quot;print this card from the topLeft `of`group &quot;body&quot; \    to the bottomRight of group &quot;body&quot; into tBodyRectset the defaultStack to &quot;footer1&quot;print this card from the topLeft of group &quot;footer1&quot; \    to the bottomRight of group &quot;footer1&quot; into tFooter1Rectset the defaultStack to &quot;footer2&quot;print this card from the topLeft of group &quot;footer2&quot; \    to the bottomRight of group &quot;footer2&quot;-- send the print job to the printerclose printing-- check to see if the user cancelled or there was an errorif the result is “cancel” then    -- insert any code you need here to handle cancellationelse if the result is not empty then    -- bring up an error dialog    answer “Printer Error”else    -- insert any code you need here to handle successend if</code></pre><p>For more information on how to print multiple pages of a complex layout,see the section on <em>Printing Multiple Pages</em>, below. For information onprinting scrolling text fields into an area within a layout, see thesection on <em>Working with Scrolling Fields when Layout Printing</em>, below.</p><h3><a name="//apple_ref/cpp/Guide/Printing Multiple Pages" class="dashAnchor"></a>Printing Multiple Pages</h3><h3><a name="//apple_ref/cpp/Guide/Multiple pages using card printing" class="dashAnchor"></a>Multiple pages using card printing</h3><p>To print multiple pages when printing cards, simply specify which cardsyou want to print as part of the print command.</p><pre><code>print {range}</code></pre><p>Examples:</p><pre><code>-- prints the current cardprint this card-- prints all cards in the current stackprint all cards-- prints the next 10 cards, starting with the current cardprint 10 cards-- prints card 3 to 7 of the current stackprint card 3 to 7 print marked cards-- prints all cards where the mark property is trueprint marked cards</code></pre><h3><a name="//apple_ref/cpp/Guide/Multiple pages when using layout printing" class="dashAnchor"></a>Multiple pages when using layout printing</h3><p>To print multiple pages when printing layouts, use the <strong>open printing</strong>command to open a print job. Then print the layout for the first page(see above). Then use the <strong>print break</strong> command to insert a page breakinto the print job. Then lay out the second page and so on. Finally, usethe <strong>close printing</strong> command to send the print job to the printer.</p><h3><a name="//apple_ref/cpp/Guide/Working with Scrolling Fields when Layout Printing" class="dashAnchor"></a>Working with Scrolling Fields when Layout Printing</h3><p>To print a single scrolling text field, use the <strong>revPrintText</strong> command(see above for more information). If you want to incorporate thecontents of a scrolling field within a layout, use the <strong>pageHeights</strong>property to scroll the field each time you print a page, then <strong>printbreak</strong> to move to the next page.</p><p>The pageHeights returns a list of values to indicate how far a scrollingfield needs to be scrolled to avoid clipping a line of text on each pageof your print out. (You should use this feature in conjunction with theformatForPrinting property, above.)</p><pre><code>-- store a list of pageHeightsput the pageHeights of field &quot;body text&quot; into tHeightsList-- scroll the field to the startset the scroll of field “body text” to 0-- start the print jobopen printingrepeat for each line l in tHeightsList-- clip the field to the bottom of the last visible lineset the height of field “body text” to l-- print the field rectangle-- you may want to add an output &quot;into&quot; rectangleprint this card from the topLeft of field &quot;body text&quot; \     to the bottomRight of field &quot;body text&quot;-- print a new pageprint breakend repeat-- send the job to the printerclose printing</code></pre><blockquote><p><strong>Important:</strong> Set the Lock Location (lockLoc) property of the fieldto true before setting the height in the loop above to avoid the field“drifting” each time you alter the height.</p><p><strong>Tip:</strong> Turn off the scroll bar properties (hScrollbar andvScrollbar) of the field before printing and set the border width to 0if you want to avoid printing a border or scroll bar.</p></blockquote><p>You can incorporate scrolling fields into a template print layout stack(see the section <em>Printing a Complex Layout</em> above) to make it easier tomanage printing a complex layout. Create a field in your template printstack instead of a graphic, turn off the scroll bar, set the borderwidth to 0, the lock location to true and then the geometry propertiesas per the section above. At the start of each print job, copy the textfont and size by using the <strong>textFont</strong> and <strong>textSize</strong> properties,then the contents of the text field you want to print using the<strong>htmlText</strong> property.</p><h3><a name="//apple_ref/cpp/Guide/Working with Print Ranges" class="dashAnchor"></a>Working with Print Ranges</h3><p>Use the <strong>printRanges</strong> property to get a list of pages that the userhas selected in the printer settings dialog. Use this property whenprinting to avoid printing pages the user has not selected. To use thisproperty, open a system printer dialog, then store the <strong>printRanges</strong>in a variable. Then set the <strong>printRanges</strong> to &quot;all&quot;, then send only thepages that were selected (stored in the variable) to the printer.</p><blockquote><p><strong>Note:</strong> If you ignore the printRanges property LiveCode will handlethis setting automatically. Simply send every page to the printer asnormal and LiveCode will ignore the pages the user has not selected inthe print dialog. Handle this option manually only if you are printingan extremely complex layout and want to save processing time buildingthe layout for every unselected page.</p></blockquote><p>Use the <strong>printPageNumber</strong> to get the number of the page currently being printed during your printing loop.</p><h3><a name="//apple_ref/cpp/Guide/Printing a Browser Object" class="dashAnchor"></a>Printing a Browser Object</h3><p>To print the contents of a browser object, use the <strong>revBrowserPrint</strong> command. For more information, see the <strong>revBrowserPrint</strong> command in the <em>LiveCode Dictionary</em>.</p></body></html>