<!DOCTYPE html><html lang="en"><head><meta charset="utf-8" /><title>Script Profiler</title><link rel="stylesheet" type="text/css" href="userguide.css" /></head><body><h1>Script Profiler</h1><p>The script profiler can help you identify the most costly lines of code in a stack.  This can help you optimise your code by identifying inefficiencies.</p><h3><a name="//apple_ref/cpp/Guide/Using the Profiler" class="dashAnchor"></a>Using the Profiler</h3><p>To use the script profiler, first open a stack and choose <code>Start Profiling Script</code> from the <code>Development</code> menu to profile the topStack. When each line of a script in the stack is executed the execution time will be recorded. Choose <code>Stop Profiling Script...</code> from the <code>Development</code> menu to stop profiling and present a report.</p><p>You can also start and stop the script profiler using the stack context menu, opened by ctrl-clicking or right clicking on the stack, or via the stack context menu in the Project Browser.</p><h3><a name="//apple_ref/cpp/Guide/Example" class="dashAnchor"></a>Example</h3><p>In this example we will look at an area that can often benefit from some optimisation, looping over an array. This example just uses a simple array with 10000 values in it. The code loops across the array and prints out all the values stored in the array.</p><p>The initial looping code is</p><pre><code>command arrayLoop    local tList   put empty into field &quot;list&quot;   repeat with x = 1 to the number of lines in the keys of sTestArray      put line x of the keys of sTestArray into tKey      put sTestArray[tKey] &amp; return after tList   end repeat   put tList into field &quot;list&quot;end arrayLoop</code></pre><p>When the script profiler is stopped a report is shown.</p><p><img src="25images/pre-opt.png" alt="Report"/></p><p>The report shows, for each line of script that was executed,* the line number* the number of times the line was called* the time to execute the line</p><p>The total time in seconds is displayed at the bottom of the report.</p><p>Double clicking a line in the report will open the line of script in the Script Editor.</p><p>Now we can see where all the time is going we know where we want to optimise our code.</p><p>In this example the vast majority of the time is spent on the line</p><pre><code>put line x of the keys of sTestArray into tKey</code></pre><p>With a little thought we can see that we can change the form of the repeat loop we are using to something more efficient. We are only really interested in the values stored in the array, not the keys, so we can change the code to loop across the elements of the array.</p><pre><code>command arrayLoop    local tList   put empty into field &quot;list&quot;   repeat for each element tValue in sTestArray      put tValue &amp; return after tList   end repeat   put tList into field &quot;list&quot;end arrayLoop</code></pre><p>Now run the script profiler again and see how much faster the code is: 0.221 seconds rather than 10.318 seconds.</p><p><img src="25images/opt.png" alt="Report"/></p></body></html>