<!DOCTYPE html><html lang="en"><head><meta charset="utf-8" /><title>OAuth2Refresh</title><link rel="stylesheet" type="text/css" href="userguide.css" /></head><body><table><tr><td colspan="2"><h1>OAuth2Refresh</h1></td></tr><tr><td><b>Type</b></td><td>command</td></tr><tr><td><b>Dictionary</b></td><td>library.oauth2</td></tr><tr><td><b>Library</b></td><td>OAuth2 Library</td></tr><tr><td><b>Syntax</b></td><td><pre>OAuth2Refresh &lt;pTokenURL&gt;,&lt;pClientID&gt;,&lt;pClientSecret&gt;,&lt;pRefreshToken&gt;,&lt;pPort&gt;</pre></td></tr><tr><td><b>Associations</b></td><td>com.livecode.library.oauth2</td></tr><tr><td><b>Summary</b></td><td><p>Obtain a new authorization token using a refresh token</p></td></tr><tr><td><b>Parameters</b></td><td><table class="inner"><tr><th>Name</th><th>Type</th><th>Description</th></tr><tr><td>pTokenURL</td><td></td><td><p>The URL to obtain the authorization token from once an authorization code issent to the redirect uri. This can be obtained from the API documentation of the service beingauthorized.</p></td></tr><tr><td>pClientID</td><td></td><td><p>The application client ID obtained when setting up your application withthe web service.</p></td></tr><tr><td>pClientSecret</td><td></td><td><p>The application client secret obtained when setting up your application withthe web service.</p></td></tr><tr><td>pRefreshToken</td><td></td><td><p>The refresh token obtained from a previous OAuth 2 authorization.</p></td></tr><tr><td>pPort</td><td></td><td><p>The port to use for the redirect uri. It is recommended to use the range 49152-65535.</p></td></tr></table></td></tr><tr><td><b>Example</b></td><td><pre>constant kTokenURL = "https://www.googleapis.com/oauth2/v4/token"constant kClientID = "XXXXXXXXXXXXXXXXXXXXXXX"constant kClientSecret = "XXXXXXXXXXXXXXXXXXXXXXX"<p></p>local sAuth<p></p>private command __RefreshAuth   if sAuth is not an array then      return "No authorization info available" for error   end if<p></p>   OAuth2Refresh kTokenURL, kClientID, kClientSecret, sAuth["refresh_token"], 59004   if the result is empty then      put it into sAuth   else      return "Not authorized" for error   end if<p></p>   set the httpHeaders to "Authorization: Bearer "& sAuth["access_token"]   return empty for errorend __RefreshAuth</pre></td></tr><tr><td><b>Values</b></td><td><table class="inner"><tr><th>Name</th><th>Type</th><th>Description</th></tr><tr><td>It</td><td></td><td><p>An array containing the parsed JSON data returned by the token url</p></td></tr><tr><td>The result</td><td></td><td><p>An error string if an error occurred during authorization</p></td></tr></table></td></tr><tr><td><b>Description</b></td><td><p>Access tokens have limited lifetimes. If your application needs access toan API beyond the lifetime of a single access token, it can obtain a refresh token. A refresh token allows your application to obtain new access tokens.</p><b><p><em>Note</em>:</b> Save refresh tokens in secure long-term storage and continue touse them as long as they remain valid. Limits apply to the number ofrefresh tokens that are issued per client-user combination, and peruser across all clients, and these limits are different. If your applicationrequests enough refresh tokens to go over one of the limits, older refreshtokens stop working.</p></td></tr></table></body></html>