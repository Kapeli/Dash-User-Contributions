<!DOCTYPE html><html lang="en"><head><meta charset="utf-8" /><title>mimeEncodeAsMIMEEmail</title><link rel="stylesheet" type="text/css" href="userguide.css" /></head><body><table><tr><td colspan="2"><h1>mimeEncodeAsMIMEEmail</h1></td></tr><tr><td><b>Type</b></td><td>command</td></tr><tr><td><b>Dictionary</b></td><td>library.mime</td></tr><tr><td><b>Library</b></td><td>MIME Library</td></tr><tr><td><b>Syntax</b></td><td><pre>mimeEncodeAsMIMEEmail &lt;pBody&gt;,&lt;pFrom&gt;,&lt;pTo&gt;,&lt;pCc&gt;,&lt;pSubject&gt;,&lt;pAttachmentA&gt;</pre></td></tr><tr><td><b>Associations</b></td><td>com.livecode.library.mime</td></tr><tr><td><b>Summary</b></td><td><p>Create data to be sent as an email</p></td></tr><tr><td><b>Parameters</b></td><td><table class="inner"><tr><th>Name</th><th>Type</th><th>Description</th></tr><tr><td>pBody</td><td></td><td><p>The pre-encoded body of the email. See the <a href="mimeEncodeFieldAsMIMEMultipartDocument_LCS_function.html">mimeEncodeFieldAsMIMEMultipartDocument</a><a href="function_LCS_glossary.html">function</a> for an easy way to generate the body from field content.</p></td></tr><tr><td>pFrom</td><td></td><td><p>From email address</p></td></tr><tr><td>pTo</td><td></td><td><p>Recipient email addresses with one per line</p></td></tr><tr><td>pCc</td><td></td><td><p>Copy to email addresses with one per line</p></td></tr><tr><td>pSubject</td><td></td><td><p>Email subject line</p></td></tr><tr><td>pAttachmentA</td><td></td><td><p>A numerically indexed (1..N) multi-dimensionalarray. Each element describes a different attachment. The elements ofthe array may contain the following keys.</p><ul><li>&quot;filepath&quot;: The full path to the file. Optional if the &quot;data&quot; element has a value</li><li>&quot;data&quot;: The file data. Optional if the &quot;filepath&quot; element has a value</li><li>&quot;name&quot;: The file name. Optional if the &quot;filepath&quot; element has a value</li><li>&quot;mimetype&quot;: The file mime type. Optional if the &quot;filepath&quot; or &quot;name&quot; element has an extension</li></ul></td></tr></table></td></tr><tr><td><b>Example</b></td><td><pre>put mimeEncodeFieldAsMIMEMultipartDocument(the long id of field "email") into tBodymimeEncodeAsMIMEEmail tBody, "sales@livecode.com", field "email", , "Purchase order"<p></p>local tBytes, tSettings, tResponseHeadersput "username" into tSettings["username"]put "p@$$w0rd" into tSettings["password"]<p></p>local tResultput tsNetSmtpSync("smtps://mail.livecode.com:465", "sales@livecode.com", field "email", it, tResponseHeaders,tBytes,tSettings) into tResultif tResult begins with "tsneterr:" then   answer error "Error:" & word 2 to -1 of tResultend if</pre></td></tr><tr><td><b>Values</b></td><td><table class="inner"><tr><th>Name</th><th>Type</th><th>Description</th></tr><tr><td>It</td><td></td><td><p>Set to the email body including headers</p></td></tr><tr><td>The result</td><td></td><td><p>An error message if an error was encountered</p></td></tr></table></td></tr><tr><td><b>Description</b></td><td><p>Creates the data to be sent as an email via an SMTP server</p></td></tr></table></body></html>