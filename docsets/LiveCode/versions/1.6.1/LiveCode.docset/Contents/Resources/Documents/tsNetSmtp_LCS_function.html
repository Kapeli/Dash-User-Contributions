<!DOCTYPE html><html lang="en"><head><meta charset="utf-8" /><title>tsNetSmtp</title><link rel="stylesheet" type="text/css" href="userguide.css" /></head><body><table><tr><td colspan="2"><h1>tsNetSmtp</h1></td></tr><tr><td><b>Type</b></td><td>function</td></tr><tr><td><b>Dictionary</b></td><td>LCS</td></tr><tr><td><b>Library</b></td><td>LiveCode Script</td></tr><tr><td><b>Syntax</b></td><td><pre>tsNetSmtp(&lt;pConnectionID&gt;, &lt;pURL&gt;, &lt;pFrom&gt;, &lt;pRcpt&gt;, &lt;pCallback&gt;, &lt;pData&gt;, [&lt;pSettings&gt;])</pre></td></tr><tr><td><b>Associations</b></td><td>tsnet</td></tr><tr><td><b>Summary</b></td><td><p>Send an asynchronous upload request to a server.</p></td></tr><tr><td><b>Edition</b></td><td>Business</td></tr><tr><td><b>Introduced</b></td><td>8.1</td></tr><tr><td><b>OS</b></td><td>mac, windows, linux, ios, android</td></tr><tr><td><b>Platforms</b></td><td>desktop, server, mobile</td></tr><tr><td><b>Parameters</b></td><td><table class="inner"><tr><th>Name</th><th>Type</th><th>Description</th></tr><tr><td>pConnectionID</td><td></td><td><p>A arbitrary user-defined label for the connection that isused when retrieving any details of the transfer.</p></td></tr><tr><td>pURL</td><td></td><td><p>The URL formatted as &#39;scheme://host:port/path&#39; and URL-encoded asoutlined in <a href="http://www.ietf.org/rfc/rfc3986.txt">RFC 3986</a>. For SMTPfunctions, the scheme must be either &#39;smtp&#39; or &#39;smtps&#39;.</p></td></tr><tr><td>pFrom</td><td></td><td><p>The e-mail address of the sender to be used in the MAIL FROMcommand to the SMTP server. This is unrelated to the sender listedin the mail header itself which is contained within the pData parameter.</p></td></tr><tr><td>pRcpt</td><td></td><td><p>The e-mail addresses of the recipients to be used in the RCPT TOcommand to the SMTP server. This is unrelated to the recipients listedin the mail header itself which is contained within the pData parameter.</p></td></tr><tr><td>pCallback</td><td></td><td><p>Specify a callback message to be sent to the current objectwhen the transfer is complete.</p></td></tr><tr><td>pData</td><td></td><td><p>The e-mail message that is to be send to the server. This shouldinclude the e-mail header followed by a blank line and then the body ofthe e-mail.</p></td></tr><tr><td>pSettings</td><td></td><td><p>An array of additional settings that control how thetransfer is initiated.</p></td></tr></table></td></tr><tr><td><b>Example</b></td><td><pre>local tRcpt, tResult, tFilePath, tData, tSettingsput "mysmtpusername@example.com" into tSettings["username"]put "mysmtppassword" into tSettings["password"]-- This next line forces the connection to be TLSput true into tSettings["use_ssl"]put specialFolderPath("documents") & "/mime_message.eml" into tFilePathput URL("file:" & tFilePath) into tDataput "you@example.com" & cr & "admin@example.com" into tRcpt-- For TLS connections, the standard port is 587put tsNetSmtp("1", "smtp://smtp.example.com:587", "me@example.com", \   tRcpt, "transferComplete", tData, tSettings) into tResult</pre><pre>local tRcpt, tResult, tFilePath, tData, tSettingsput "mysmtpusername@example.com" into tSettings["username"]put "mysmtppassword" into tSettings["password"]put specialFolderPath("documents") & "/mime_message.eml" into tFilePathput URL("file:" & tFilePath) into tDataput "you@example.com" & cr & "admin@example.com" into tRcpt-- Using smtps:// here forces the connection to be SSLput tsNetSmtp("1", "smtps://smtp.example.com", "me@example.com", \   tRcpt, "transferComplete", tData, tSettings) into tResult</pre><pre>on transferComplete pID, pResult, pBytes, pCurlCode   local tData, tHeaders   if pCurlCode is not 0 then      answer tsNetRetrError(pID)   else      answer "Email sent successfully"   end if   tsNetCloseConn pIDend transferComplete</pre></td></tr><tr><td><b>Values</b></td><td><table class="inner"><tr><th>Name</th><th>Type</th><th>Description</th></tr><tr><td>return</td><td></td><td><p>The tsNetSmtp function returns empty on success. On error,the return value will be a string containing the error starting with&quot;tsneterr:&quot;.</p></td></tr></table></td></tr><tr><td><b>Related</b></td><td><b>Command</b>: <a href="tsNetCloseConn_LCS_command.html">tsNetCloseConn</a><br><b>Function</b>: <a href="tsNetRetrError_LCS_function.html">tsNetRetrError</a>, <a href="tsNetRetrSentHeaders_LCS_function.html">tsNetRetrSentHeaders</a>, <a href="tsNetRetrData_LCS_function.html">tsNetRetrData</a><br><b>Library</b>: <a href="tsNet_LCS_library.html">tsNet</a><br></td></tr><tr><td><b>Description</b></td><td><p>This function sends a callback message on completion. Use<a href="tsNetRetrData_LCS_function.html">tsNetRetrData</a> to access any returned data. To save memory, itis recommended to call <a href="tsNetCloseConn_LCS_command.html">tsNetCloseConn</a> when the connection is nolonger needed.</p><p>Using the <code>smtps://</code> scheme will initiate an SMTP SSL connection to theserver. To connect using Transport Layer Security (TLS), use a URL witha format of <code>smtp://host:port</code> where the port number reflects theappropriate server port for TLS connections and set the &quot;use_ssl&quot; arraysetting below to true.</p><p>The callback message will be sent with four parameters: the connectionidentifier, the status code sent back by the server, the number ofbytes transferred and the cURL result code.</p><p>The cURL result code parameter in the callback message will be 0 forsuccessful transfers. For any errors, further information can beretrieved by calling the <a href="tsNetRetrError_LCS_function.html">tsNetRetrError</a> function.</p><p>The settings array can consist of the following elements (not allof the settings make sense for every possible transfer type):</p><b><p>&quot;use_ssl&quot;:</b> Set to true to connect using Transport Layer Security (TLS)for SMTPS and FTPS (explicit) connections.</p><b><p>&quot;no_transfer&quot;:</b> Set to true to connect to the server but not perform anytransfer.</p><b><p>&quot;no_reuse&quot;:</b> Set to true to specify that the connection to theserver should be disconnected and not left open for any futureconnections.</p><b><p>“replace_lf_crlf”:</b> If this is set to true, tsNet will convert the standard LiveCode newline in the body of the e-mail with CRLF.  SomeSMTP servers do not recognise the standard LiveCode end-of-line character and you may experience issues sending e-mail through them unless this is enabled.</p><b><p>&quot;save_sent_headers&quot;:</b> Set to true to specify that external should storea copy of all the headers that it sends to the server. This must be setto true to use the <a href="tsNetRetrSentHeaders_LCS_function.html">tsNetRetrSentHeaders</a> function.</p><b><p>&quot;username&quot;:</b> Set to a string containing the username to be used in anyauthentication requests from the server.</p><b><p>&quot;password&quot;:</b> Set to a string containing the password to be used in anyauthentication requests from the server.</p><b><p>&quot;proxy_headers&quot;:</b> Set to a list of headers (one per line) that shouldbe sent to any proxy server that is being used.</p></td></tr><tr><td><b>Tags</b></td><td>externals</td></tr></table></body></html>