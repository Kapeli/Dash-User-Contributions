<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:og="http://ogp.me/ns#" xmlns:fb="http://ogp.me/ns/fb#" charset="utf-8"><head><meta charset="UTF-8"><title></title>
<link rel="stylesheet" href="css/normalize.css">
<link rel="stylesheet" type="text/css" href="css/main.css">
<link rel="stylesheet" href="css/style.css">
<style>
html,body {
margin: 0px;
padding: 10px;
width: 210mm;
max-width: 210mm;
overflow-x: hidden;
}
pre {
	width: 100%;
	overflow-x: hidden;
}
</style>
<script src="js/prefixfree.min.js"></script>
</head><body><h1>Overview</h1><a name="aboutforwardingandreceivingdata"></a> <script src="js/prefixfree.min.js"></script><div class="all-questions">

<h2> <a name="aboutforwardingandreceivingdata_about_forwarding_and_receiving"><span class="mw-headline" id="About_forwarding_and_receiving"> About forwarding and receiving</span></a></h2>
<p><b>Important:</b> Before reading this manual, you should be familiar with the fundamentals of Splunk Enterprise distributed deployment, as described in the Distributed Deployment Manual.
</p><p>You can forward data from one Splunk Enterprise instance to another Splunk Enterprise instance or even to a non-Splunk system. The Splunk Enterprise instance that performs the <b>forwarding</b> is typically a smaller footprint version of Splunk Enterprise, called a <b>forwarder</b>. 
</p><p>A Splunk Enterprise instance that <b>receives</b> data from one or more forwarders is called a <b>receiver</b>. The receiver is usually a Splunk Enterprise <b>indexer</b>, but can also be another forwarder, as described <a href="#forwarderdeploymenttopologies_intermediate_forwarding" class="external text">here</a>.
</p><p>This diagram shows three forwarders sending data to a single receiver (an indexer), which then indexes the data and makes it available for searching:
</p><p><img alt="30 admin13 forwardreceive-dataforward 60.png" src="images/7/70/30_admin13_forwardreceive-dataforward_60.png" width="700" height="552"></p><p>Forwarders represent a much more robust solution for data forwarding than raw network feeds, with their capabilities for:
</p>
<ul><li> Tagging of metadata (source, source type, and host)
</li><li> Configurable buffering 
</li><li> Data compression
</li><li> SSL security
</li><li> Use of any available network ports
</li></ul><p>The forwarding and receiving capability makes possible all sorts of interesting Splunk Enterprise topologies to handle functions like <b><a href="#consolidatedatafrommultiplemachinesd" class="external text">data consolidation</a></b>, <b>load balancing</b>, and <b>data routing</b>. For more information on the types of deployment topologies that you can create with forwarders, see <a href="#forwarderdeploymenttopologies" class="external text">"Forwarder deployment topologies"</a>.
</p><p>There are a few different types of forwarders, as described in <a href="#typesofforwarders" class="external text">"Types of forwarders"</a>.
</p>
<a name="typesofforwarders"></a><h2> <a name="typesofforwarders_types_of_forwarders"><span class="mw-headline" id="Types_of_forwarders"> Types of forwarders</span></a></h2>
<p>There are three types of forwarders:
</p>
<ul><li> The <b>universal forwarder</b> is a streamlined, dedicated version of Splunk Enterprise that contains only the essential components needed to forward data to receivers. 
</li><li> A <b>heavy forwarder</b> is a full Splunk Enterprise instance, with some features disabled to achieve a smaller footprint. 
</li><li> A <b>light forwarder</b> is also a full Splunk Enterprise instance, with <i>most</i> features disabled to achieve as small a footprint as possible. <b>The universal forwarder, with its even smaller footprint yet similar functionality, supersedes the light forwarder for nearly all purposes.</b>
</li></ul><p><b>Note:</b> The light forwarder has been deprecated in Splunk Enterprise version 6.0. For a list of all deprecated features, see the topic "Deprecated features" in the Release Notes.
</p><p>In nearly all respects, the universal forwarder represents the best tool for forwarding data to indexers. Its main limitation is that it forwards only unparsed data, as described <a href="#typesofforwarders_types_of_forwarder_data" class="external text">later in this topic</a>. Therefore, you cannot use it to route data based on event contents. For that, you must use a heavy forwarder. You also cannot index data locally on a universal forwarder; only a heavy forwarder can index and forward.
</p> 
<h3> <a name="typesofforwarders_the_universal_forwarder"><span class="mw-headline" id="The_universal_forwarder"> The universal forwarder </span></a></h3>
<p>The universal forwarder is Splunk's new lightweight forwarder. You use it to gather data from a variety of inputs and forward the data to a Splunk Enterprise server for indexing and searching. You can also forward data to another forwarder, as an intermediate step before sending the data onwards to an indexer.
</p><p>The universal forwarder's sole purpose is to forward data. Unlike a full Splunk Enterprise instance, you cannot use the universal forwarder to index or search data. To achieve higher performance and a lighter footprint, it has several limitations:
</p>
<ul><li> The universal forwarder has no searching, indexing, or alerting capability.
</li><li> The universal forwarder does not <b>parse</b> data.
</li><li> Unlike full Splunk Enterprise, the universal forwarder does not include a bundled version of Python. 
</li></ul><p>For details on the universal forwarder's capabilities, see <a href="#introducingtheuniversalforwarder" class="external text">"Introducing the universal forwarder"</a>. 
</p><p><b>Note:</b> The universal forwarder is a separately downloadable piece of software. Unlike the heavy and light forwarders, you do not enable it from a full Splunk Enterprise instance. To learn how to download, install, and deploy a universal forwarder, see <a href="#deploymentoverview" class="external text">"Universal forwarder deployment overview"</a>. 
</p>
<h3> <a name="typesofforwarders_heavy_and_light_forwarders"><span class="mw-headline" id="Heavy_and_light_forwarders"> Heavy and light forwarders </span></a></h3>
<p>While the universal forwarder is generally the preferred way to forward data, you might have reason (legacy-based or otherwise) to use heavy or light forwarders as well. Unlike the universal forwarder, which is an entirely separate, streamlined executable, both heavy and light forwarders are actually full Splunk Enterprise instances with certain features disabled. Heavy and light forwarders differ in capability and the corresponding size of their footprints. 
</p><p>A <b>heavy forwarder</b> (sometimes referred to as a "regular forwarder") has a smaller footprint than a Splunk Enterprise indexer but retains most of the capability, except that it lacks the ability to perform distributed searches. Much of its default functionality, such as Splunk Web, can be disabled, if necessary, to reduce the size of its footprint. A heavy forwarder parses data before forwarding it and can route data based on criteria such as source or type of event. 
</p><p>One key advantage of the heavy forwarder is that it can index data locally, as well as forward data to another Splunk Enterprise instance. <b>You must turn this capability on</b>; it's disabled by default. See <a href="#configureforwarderswithoutputs.confd_global_stanza" class="external text">"Configure forwarders with outputs.conf"</a> in this manual for details.
</p><p>A <b>light forwarder</b> has a smaller footprint with much more limited functionality. It forwards only unparsed data. Starting with 4.2, it has been superseded by the universal forwarder, which provides very similar functionality in a smaller footprint. The light forwarder continues to be available mainly to meet any legacy needs. We recommend that you always use the universal forwarder to forward unparsed data. When you install a universal forwarder, the installer gives you the opportunity to migrate checkpoint settings from any (version 4.0 or greater) light forwarder residing on the same machine. See <a href="#introducingtheuniversalforwarder" class="external text">"Introducing the universal forwarder"</a> for a more detailed comparison of the universal and light forwarders.
</p><p>For detailed information on the capabilities of heavy and light forwarders, see <a href="#forwardercapabilities" class="external text">"Heavy and light forwarder capabilities"</a>.
</p><p>To learn how to enable and deploy a heavy or light forwarder, see <a href="#deployaforwarder" class="external text">"Deploy a heavy or light forwarder"</a>. 
</p>
<h3> <a name="typesofforwarders_forwarder_comparison"><span class="mw-headline" id="Forwarder_comparison"> Forwarder comparison </span></a></h3>
<p>This table summarizes the similarities and differences among the three types of forwarders:
</p>
<table cellpadding="5" cellspacing="0" border="1"><tr><th bgcolor="#C0C0C0"> Features and capabilities
</th><th bgcolor="#C0C0C0"> Universal forwarder
</th><th bgcolor="#C0C0C0"> Light forwarder
</th><th bgcolor="#C0C0C0"> Heavy forwarder
</th></tr><tr><td valign="top" width="25%" align="left"> Type of Splunk Enterprise instance
</td><td valign="top" width="25%" align="left"> Dedicated executable
</td><td valign="top" width="25%" align="left"> Full Splunk Enterprise, with most features disabled
</td><td valign="top" width="25%" align="left"> Full Splunk Enterprise, with some features disabled
</td></tr><tr><td valign="top" align="left"> Footprint (memory, CPU load)
</td><td valign="top" align="left"> Smallest
</td><td valign="top" align="left"> Small
</td><td valign="top" align="left"> Medium-to-large (depending on enabled features)
</td></tr><tr><td valign="top" align="left"> Bundles Python?
</td><td valign="top" align="left"> No
</td><td valign="top" align="left"> Yes
</td><td valign="top" align="left"> Yes
</td></tr><tr><td valign="top" align="left"> Handles data inputs?
</td><td valign="top" align="left"> All types (but scripted inputs might require Python installation)
</td><td valign="top" align="left"> All types
</td><td valign="top" align="left"> All types
</td></tr><tr><td valign="top" align="left"> Forwards to Splunk Enterprise?
</td><td valign="top" align="left"> Yes
</td><td valign="top" align="left"> Yes
</td><td valign="top" align="left"> Yes
</td></tr><tr><td valign="top" align="left"> Forwards to 3rd party systems?
</td><td valign="top" align="left"> Yes
</td><td valign="top" align="left"> Yes
</td><td valign="top" align="left"> Yes
</td></tr><tr><td valign="top" align="left"> Serves as intermediate forwarder?
</td><td valign="top" align="left"> Yes
</td><td valign="top" align="left"> Yes
</td><td valign="top" align="left"> Yes
</td></tr><tr><td valign="top" align="left"> Indexer acknowledgment (guaranteed delivery)?
</td><td valign="top" align="left"> Optional
</td><td valign="top" align="left"> Optional (version 4.2+)
</td><td valign="top" align="left"> Optional (version 4.2+)
</td></tr><tr><td valign="top" align="left"> Load balancing?
</td><td valign="top" align="left"> Yes
</td><td valign="top" align="left"> Yes
</td><td valign="top" align="left"> Yes
</td></tr><tr><td valign="top" align="left"> Data cloning?
</td><td valign="top" align="left"> Yes
</td><td valign="top" align="left"> Yes
</td><td valign="top" align="left"> Yes
</td></tr><tr><td valign="top" align="left"> Per-event filtering?
</td><td valign="top" align="left"> No
</td><td valign="top" align="left"> No
</td><td valign="top" align="left"> Yes
</td></tr><tr><td valign="top" align="left"> Event routing?
</td><td valign="top" align="left"> No
</td><td valign="top" align="left"> No
</td><td valign="top" align="left"> Yes
</td></tr><tr><td valign="top" align="left"> Event parsing?
</td><td valign="top" align="left"> No
</td><td valign="top" align="left"> No
</td><td valign="top" align="left"> Yes
</td></tr><tr><td valign="top" align="left"> Local indexing?
</td><td valign="top" align="left"> No
</td><td valign="top" align="left"> No
</td><td valign="top" align="left"> Optional, by setting <code><font size="2">indexAndForward</font></code> attribute in <code><font size="2">outputs.conf</font></code>
</td></tr><tr><td valign="top" align="left"> Searching/alerting?
</td><td valign="top" align="left"> No
</td><td valign="top" align="left"> No
</td><td valign="top" align="left"> Optional
</td></tr><tr><td valign="top" align="left"> Splunk Web?
</td><td valign="top" align="left"> No
</td><td valign="top" align="left"> No
</td><td valign="top" align="left"> Optional
</td></tr></table><p>For detailed information on specific capabilities, see the rest of this topic, as well as the other forwarding topics in the manual.
</p>
<h3> <a name="typesofforwarders_types_of_forwarder_data"><span class="mw-headline" id="Types_of_forwarder_data"> Types of forwarder data </span></a></h3>
<p>Forwarders can transmit three types of data: 
</p>
<ul><li> Raw
</li><li> Unparsed
</li><li> Parsed  
</li></ul><p>The type of data a forwarder can send depends on the type of forwarder it is, as well as how you configure it. Universal forwarders and light forwarders can send raw or unparsed data. Heavy forwarders can send raw or parsed data. 
</p><p><b>With raw data,</b> the data stream is forwarded as raw TCP; it is not converted into Splunk's communications format. The forwarder just collects the data and forwards it on. This is particularly useful for sending data to a non-Splunk system.
</p><p><b>With unparsed data,</b> a universal forwarder performs only minimal processing. It does not examine the data stream, but it does tag the entire stream with metadata to identify source, source type, and host. It also divides the data stream into 64K blocks and performs some rudimentary timestamping on the stream, for use by the receiving indexer in case the events themselves have no discernible timestamps. The universal forwarder does not identify, examine, or tag individual events.
</p><p><b>With parsed data,</b> a heavy forwarder breaks the data into individual events, which it tags and then forwards to a Splunk Enterprise indexer. It can also examine the events. Because the data has been parsed, the forwarder can perform conditional routing based on event data, such as field values. 
</p><p>The parsed and unparsed formats are both referred to as <b>cooked</b> data, to distinguish them from raw data. By default, forwarders send cooked data &mdash; in the universal forwarder's case, unparsed data, and in the heavy forwarder's case, parsed data.  To send raw data instead, set the <code><font size="2">sendCookedData=false</font></code> attribute/value pair in <a href="#configureforwarderswithoutputs.confd" class="external text">outputs.conf</a>. 
</p>
<h3> <a name="typesofforwarders_forwarders_and_indexes"><span class="mw-headline" id="Forwarders_and_indexes">Forwarders and indexes</span></a></h3>
<p>Forwarders forward and route data on an index-by-index basis. By default, they forward all external data, as well as data for the <code><font size="2">_audit</font></code> internal index. In some cases, they also forward data for the <code><font size="2">_internal</font></code> internal index. You can change this behavior as necessary. For details, see <a href="#routeandfilterdatad_filter_data_by_target_index" class="external text">"Filter data by target index"</a>.
</p>
<a name="forwarderdeploymenttopologies"></a><h2> <a name="forwarderdeploymenttopologies_forwarder_deployment_topologies"><span class="mw-headline" id="Forwarder_deployment_topologies"> Forwarder deployment topologies</span></a></h2>
<p>You can deploy forwarders in a wide variety of scenarios. This topic provides an overview of some of the most useful types of topologies that you can create with forwarders. For detailed information on how to configure various deployment topologies, refer to the topics in the section <a href="#consolidatedatafrommultiplemachinesd" class="external text">"Use the forwarder to create deployment topologies"</a>.
</p>
<h3> <a name="forwarderdeploymenttopologies_data_consolidation"><span class="mw-headline" id="Data_consolidation"> Data consolidation </span></a></h3>
<p>Data consolidation is one of the most common topologies, with multiple forwarders sending data to a single Splunk Enterprise instance. The scenario typically involves universal forwarders forwarding unparsed data from workstations or production non-Splunk servers to a central Splunk Enterprise instance for consolidation and indexing. With their lighter footprint, universal forwarders have minimal impact on the performance of the systems they reside on. In other scenarios, heavy forwarders can send parsed data to a central Splunk Enterprise indexer.
</p><p>Here, three universal forwarders are sending data to a single indexer:
</p><p><img alt="30 admin13 forwardreceive-dataforward 60.png" src="images/7/70/30_admin13_forwardreceive-dataforward_60.png" width="700" height="552"></p><p>For more information on data consolidation, read <a href="#consolidatedatafrommultiplemachinesd" class="external text">"Consolidate data from multiple machines"</a>.
</p>
<h3> <a name="forwarderdeploymenttopologies_load_balancing"><span class="mw-headline" id="Load_balancing"> Load balancing </span></a></h3>
<p><b>Load balancing</b> simplifies the process of distributing data across several indexers to handle considerations such as high data volume, horizontal scaling for enhanced search performance, and fault tolerance. In load balancing, the forwarder routes data sequentially to different indexers at specified intervals.
</p><p>Forwarders perform automatic load balancing, in which the forwarder switches receivers at set time intervals. If parsing is turned on (for a heavy forwarder), the switching will occur at event boundaries. 
</p><p>In this diagram, three universal forwarders are each performing load balancing between two indexers:
</p><p><img alt="30 admin13 forwardreceive-balance 60.png" src="images/3/35/30_admin13_forwardreceive-balance_60.png" width="700" height="554"></p><p>For more information on load balancing, read <a href="#setuploadbalancingd" class="external text">"Set up load balancing"</a>.
</p>
<h3> <a name="forwarderdeploymenttopologies_routing_and_filtering"><span class="mw-headline" id="Routing_and_filtering"> Routing and filtering </span></a></h3>
<p>In <b>data routing</b>, a forwarder routes events to specific Splunk Enterprise or third-party servers, based on criteria such as source, source type, or patterns in the events themselves. Routing at the event level requires a heavy forwarder.
</p><p>A forwarder can also filter and route events to specific queues, or discard them altogether by routing to the null queue.
</p><p>Here, a heavy forwarder routes data to three indexers based on event patterns:
</p><p><img alt="30 admin13 forwardreceive-datarouting 60.png" src="images/b/be/30_admin13_forwardreceive-datarouting_60.png" width="700" height="554"></p><p>For more information on routing and filtering, read <a href="#routeandfilterdatad" class="external text">"Route and filter data"</a>.
</p>
<h3> <a name="forwarderdeploymenttopologies_forwarders_and_indexer_clusters"><span class="mw-headline" id="Forwarders_and_indexer_clusters"> Forwarders and indexer clusters </span></a></h3>
<p>You can use forwarders to send data to peer nodes in an indexer cluster. It is recommended that you use load-balanced forwarders for that purpose.
</p><p>This diagram shows two load-balanced forwarders sending data to a cluster:
</p><p><img alt="Simplified basic cluster 60.png" src="images/5/58/Simplified_basic_cluster_60.png" width="700" height="554"></p><p>To learn more about forwarders and indexer clusters, read "Use forwarders to get your data" in the <i>Managing Indexers and Clusters of Indexers</i> manual. To learn more about indexer clusters in general, read "About indexer clusters and index replication".
</p>
<h3> <a name="forwarderdeploymenttopologies_forwarding_to_non-splunk_systems"><span class="mw-headline" id="Forwarding_to_non-Splunk_systems"> Forwarding to non-Splunk systems </span></a></h3>
<p>You can send raw data to a third-party system such as a syslog aggregator. You can combine this with data routing, sending some data to a non-Splunk system and other data to one or more Splunk Enterprise servers.
</p><p>Here, three forwarders are routing data to two Splunk Enterprise servers and a non-Splunk system:
</p><p><img alt="30 admin13 forwardreceive-thirdparty 60.png" src="images/6/63/30_admin13_forwardreceive-thirdparty_60.png" width="700" height="554"></p><p>For more information on forwarding to non-Splunk systems, read <a href="#forwarddatatothird-partysystemsd" class="external text">"Forward data to third-party systems"</a>.
</p>
<h3> <a name="forwarderdeploymenttopologies_intermediate_forwarding"><span class="mw-headline" id="Intermediate_forwarding"> Intermediate forwarding </span></a></h3>
<p>To handle some advanced use cases, you might want to insert an intermediate forwarder between a group of forwarders and the indexer. In this type of scenario, the originating forwarders send data to a consolidating forwarder, which then forwards the data on to an indexer, usually after indexing it locally. 
</p><p>Typical use cases are situations where you need an intermediate index, either for "store-and-forward" requirements or to enable localized searching. (In this case, you would need to use a heavy forwarder.) You can also use an intermediate forwarder if you have some need to limit access to the indexer machine; for instance, for security reasons.
</p><p>To enable intermediate forwarding, you need to configure the forwarder as a both a forwarder and a receiver. For information on how to configure a receiver, read <a href="#enableareceiver" class="external text">"Enable a receiver"</a>.
</p>
<h1>Configure forwarding</h1><a name="setupforwardingandreceiving"></a><h2> <a name="setupforwardingandreceiving_set_up_forwarding_and_receiving"><span class="mw-headline" id="Set_up_forwarding_and_receiving"> Set up forwarding and receiving</span></a></h2>
<p>Once you've determined your <a href="#forwarderdeploymenttopologies" class="external text">forwarder deployment topology</a> and what <a href="#typesofforwarders" class="external text">type of forwarder</a> is necessary to implement it, the steps for setting up forwarding and receiving are straightforward. This topic outlines the key steps and provides links to the detailed topics. 
</p><p>To set up forwarding and receiving, you need to perform two basic actions, in this order:
</p><p><b>1.</b> Set up one or more Splunk Enterprise indexers as receivers. These will receive the data from the forwarders.
</p><p><b>2.</b> Set up one or more forwarders. These will forward data to the receivers.
</p><p>The remainder of this topic lists the key steps involved, with links to more detailed topics. The procedures vary somewhat according to whether the forwarder is a universal forwarder or a heavy/light forwarder. Universal forwarders can sometimes be installed and configured in a single step. Heavy/light forwarders are first installed as full Splunk Enterprise instances and then configured as forwarders.
</p><p><b>Note:</b> This topic assumes that your receivers are indexers. However, in some scenarios, discussed  <a href="#forwarderdeploymenttopologies_intermediate_forwarding" class="external text">elsewhere</a>, a forwarder also serves as receiver. The set-up is basically much the same for any kind of receiver.
</p><p><b>Note:</b> You cannot forward data across a proxy, because the communication between forwarder and receiver does not use the HTTP protocol.
</p>
<h3> <a name="setupforwardingandreceiving_forwarders_and_indexer_clusters"><span class="mw-headline" id="Forwarders_and_indexer_clusters"> Forwarders and indexer clusters </span></a></h3>
<p>When using forwarders to send data to peer nodes in an indexer cluster, you set up forwarding and receiving a bit differently from the description in this topic. To learn more about forwarders and clusters, read "Use forwarders to get your data" in the <i>Managing Indexers and Clusters of Indexers</i> manual.
</p>
<h3> <a name="setupforwardingandreceiving_set_up_forwarding_and_receiving:_universal_forwarders"><span class="mw-headline" id="Set_up_forwarding_and_receiving:_universal_forwarders"> Set up forwarding and receiving: universal forwarders</span></a></h3>
<p><b>1.</b> Install the full Splunk Enterprise instances that will serve as receivers. See the Installation Manual for details.
</p><p><b>2.</b> Use Splunk Web or the CLI to enable receiving on the instances designated as receivers. See <a href="#enableareceiver" class="external text">"Enable a receiver"</a> in this manual.
</p><p><b>3.</b> Install, configure, and deploy the universal forwarders. Depending on your forwarding needs, there are a number of best practices deployment scenarios. See <a href="#deploymentoverview" class="external text">"Universal forwarder deployment overview"</a> for details. Some of these scenarios allow you to configure the forwarder during the installation process.
</p><p><b>4.</b> If you have not already done so during installation, you must specify data inputs for each universal forwarder. See "What Splunk Enterprise can index" in the <i>Getting Data In</i> manual. In some cases, you can configure your forwarder inputs directly from the Add Data page on the receiving indexer. See "Forward data" in the <i>Getting Data In</i> manual. 
</p><p><b>Note:</b> Since the universal forwarder does not include Splunk Web, you must configure inputs through either the CLI or <code><font size="2">inputs.conf</font></code>; you cannot configure them in Splunk Web.
</p><p><b>5.</b> If you have not already done so during installation, you must specify the universal forwarders' output configurations. You can do so through the CLI or by editing the <code><font size="2">outputs.conf</font></code> file. You get the greatest flexibility by editing <code><font size="2">outputs.conf</font></code>. For details, see the other topics in this section, including <a href="#configureforwarderswithoutputs.confd" class="external text">"Configure forwarders with outputs.conf"</a>.
</p><p><b>6.</b> Test the results to confirm that forwarding, along with any configured behaviors like load balancing or filtering, is occurring as expected.
</p>
<h3> <a name="setupforwardingandreceiving_set_up_forwarding_and_receiving:_heavy_or_light_forwarders"><span class="mw-headline" id="Set_up_forwarding_and_receiving:_heavy_or_light_forwarders">Set up forwarding and receiving: heavy or light forwarders</span></a></h3>
<p><b>Note:</b> The light forwarder has been deprecated in Splunk Enterprise version 6.0. For a list of all deprecated features, see the topic "Deprecated features" in the Release Notes.
</p><p><b>1.</b> Install the full Splunk Enterprise instances that will serve as forwarders and receivers. See the Installation Manual for details.
</p><p><b>2.</b> Use Splunk Web or the CLI to enable receiving on the instances designated as receivers. See <a href="#enableareceiver" class="external text">"Enable a receiver"</a> in this manual.
</p><p><b>3.</b> Use Splunk Web or the CLI to enable forwarding on the instances designated as forwarders. See <a href="#deployaforwarder" class="external text">"Deploy a heavy or light forwarder"</a> in this manual.
</p><p><b>4.</b> Specify data inputs for the forwarders in the usual manner. See "What Splunk Enterprise can index" in the Getting Data In manual.
</p><p><b>5.</b> Specify the forwarders' output configurations. You can do so through Splunk Web, the CLI, or by editing the <code><font size="2">outputs.conf</font></code> file. You get the greatest flexibility by editing <code><font size="2">outputs.conf</font></code>. For details, see <a href="#deployaforwarder" class="external text">"Deploy a heavy or light forwarder"</a>, as well as the other topics in this section, including <a href="#configureforwarderswithoutputs.confd" class="external text">"Configure forwarders with outputs.conf"</a>. 
</p><p><b>6.</b> Test the results to confirm that forwarding, along with any configured behaviors like load balancing or routing, is occurring as expected.
</p>
<h3> <a name="setupforwardingandreceiving_manage_your_forwarders"><span class="mw-headline" id="Manage_your_forwarders">Manage your forwarders</span></a></h3>
<p>In environments with multiple forwarders, you might find it helpful to use the <b>deployment server</b> to update and manage your forwarders. See "About deployment server" in the Updating Splunk Enterprise Instances manual. 
</p><p>To view the status of your forwarders, you can use the deployment monitor.
</p>
<a name="compatibilitybetweenforwardersandindexers"></a><h2> <a name="compatibilitybetweenforwardersandindexers_compatibility_between_forwarders_and_indexers"><span class="mw-headline" id="Compatibility_between_forwarders_and_indexers"> Compatibility between forwarders and indexers</span></a></h2>
<p>These are the specific version compatibility restrictions between forwarders and their receiving indexers:
</p>
<ul><li> 6.x forwarders (universal/light/heavy) are backwards compatible down to 5.0.x indexers. 
</li><li> 6.x indexers are backwards compatible with forwarders down to 4.3.x. 
</li></ul><p>The following 6.0 features are available only if both indexers and forwarders are at version 6.0 or higher:
</p>
<ul><li> Dynamic file headers
</li><li> Forwarding of structured data
</li><li> Timezone transmission by the forwarder. The timezone transmission feature of the 6.0+ protocol is not maintained across multiple forwarding links in a multilevel forwarding scenario where intermediate links are light or universal forwarders.
</li></ul><p>For app-specific compatibility restrictions, check  the app's documentation on Splunkbase.
</p><p>As a best practice, it is recommended that indexers be at the same or higher version level than the forwarders they're receiving data from.
</p>
<a name="enableareceiver"></a><h2> <a name="enableareceiver_enable_a_receiver"><span class="mw-headline" id="Enable_a_receiver"> Enable a receiver</span></a></h2>
<p>To enable forwarding and receiving, you configure both a <b>receiver</b> and a <b>forwarder</b>. The receiver is the Splunk Enterprise instance receiving the data; the forwarder sends data to the receiver. 
</p><p>Depending on your needs (for example to enable load balancing), you might have multiple receivers for each forwarder. Conversely, a single receiver usually receives data from many forwarders. 
</p><p>The receiver is either a Splunk Enterprise <b>indexer</b> (the typical case) or another forwarder (referred to as an <a href="#forwarderdeploymenttopologies_intermediate_forwarding" class="external text">"intermediate forwarder"</a>) configured to receive data from forwarders.
</p><p>You must set up the receiver first. You can then set up forwarders to send data to that receiver.
</p>
<h3> <a name="enableareceiver_set_up_receiving"><span class="mw-headline" id="Set_up_receiving"> Set up receiving </span></a></h3>
<p>Before enabling a Splunk Enterprise instance (either an indexer or a forwarder) as a receiver, you must install it. You can then enable receiving on the instance through Splunk Web, the CLI, or the inputs.conf configuration file.
</p>
<h4><font size="3"><b><i> <a name="enableareceiver_set_up_receiving_with_splunk_web"><span class="mw-headline" id="Set_up_receiving_with_Splunk_Web"> Set up receiving with Splunk Web </span></a></i></b></font></h4>
<p>Use Splunk Web to set up a receiver:
</p><p><b>1.</b> Log into Splunk Web as admin on the server that will be receiving data from a forwarder.
</p><p><b>2.</b> Click the <b>Settings</b> link at the top of the page.
</p><p><b>3.</b> Select <b>Forwarding and receiving</b> in the Data area.
</p><p><b>4.</b> Click <b>Add new</b> in the <b>Receive data</b> section.
</p><p><b>5.</b> Specify which TCP port you want the receiver to listen on (the <b>listening port</b>, also known as the <b>receiving port</b>). For example, if you enter "9997," the receiver will receive data on port 9997. By convention, receivers listen on port 9997, but you can specify any unused port. You can use a tool like <code><font size="2">netstat</font></code> to determine what ports are available on your system. Make sure the port you select is not in use by splunkweb or splunkd. 
</p><p><b>6.</b> Click <b>Save.</b> You must restart the instance to complete the process.
</p>
<h4><font size="3"><b><i> <a name="enableareceiver_set_up_receiving_with_splunk_cli"><span class="mw-headline" id="Set_up_receiving_with_Splunk_CLI"> Set up receiving with Splunk CLI </span></a></i></b></font></h4>
<p>To enable receiving, run the CLI command: 
</p>
<code><font size="2"><br>splunk enable listen &lt;port&gt; -auth &lt;username&gt;:&lt;password&gt;<br></font></code>
<p>For <code><font size="2">&lt;port&gt;</font></code>, substitute the port you want the receiver to listen on (the receiving port).  For example, if you enter "9997," the receiver will receive data on port 9997. By convention, receivers listen on port 9997, but you can specify any unused port. You can use a tool like <code><font size="2">netstat</font></code> to determine what ports are available on your system. Make sure the port you select is not in use by splunkweb or splunkd. 
</p><p>The <code><font size="2">splunk enable listen</font></code> command creates a <code><font size="2">[splunktcp]</font></code> stanza in <code><font size="2">inputs.conf</font></code>.  For example, if you set the port to "9997", it creates the stanza <code><font size="2">[splunktcp://9997]</font></code>.
</p>
<h4><font size="3"><b><i> <a name="enableareceiver_set_up_receiving_with_the_configuration_file"><span class="mw-headline" id="Set_up_receiving_with_the_configuration_file"> Set up receiving with the configuration file </span></a></i></b></font></h4>
<p>You can enable receiving on your Splunk Enterprise instance by configuring <code><font size="2">inputs.conf</font></code> in <code><font size="2">$SPLUNK_HOME/etc/system/local</font></code>. To configure a universal forwarder as an intermediate forwarder (a forwarder that functions also as a receiver), use this method.
</p><p>To enable receiving, add a <code><font size="2">[splunktcp]</font></code> stanza that specifies the receiving port. In this example, the receiving port is 9997:
</p>
<code><font size="2"><br>[splunktcp://9997]<br>disabled = 0<br></font></code>
<p>For further details, refer to the inputs.conf spec file.
</p><p><b>Note:</b> The forms <code><font size="2">[splunktcp://9997]</font></code> and <code><font size="2">[splunktcp://:9997]</font></code> (one colon or two) are semantically equivalent. Use either one.
</p>
<h3> <a name="enableareceiver_searching_data_received_from_a_forwarder_running_on_a_different_operating_system"><span class="mw-headline" id="Searching_data_received_from_a_forwarder_running_on_a_different_operating_system"> Searching data received from a forwarder running on a different operating system </span></a></h3>
<p>In most cases, a Splunk Enterprise instance receiving data from a forwarder on a different OS will need to install the app for that OS. However, there are numerous subtleties that affect this; read on for the details.
</p><p>Forwarding and indexing are OS-independent operations. You can employ any combination of forwarders and receivers, as long as each is running on a certified OS. For example, a Linux receiver can index data from a Windows universal forwarder. 
</p><p>Once data has been forwarded and indexed, the next step is to search or perform other knowledge-based activities on the data. At this point, the instance performing such activities might need information about the OS whose data it is examining. You typically handle this by installing the app specific to that OS. For example, if you want a Linux instance to search OS-specific data forwarded from Windows, you will ordinarily want to install the Windows app on the Linux instance. 
</p><p>If the data you're interested in is not OS-specific, such as web logs, then you do not need to install the Splunk OS app.
</p><p>In addition, if the receiver is only indexing the data, and an external search head is performing the actual searches, you do not need to install the OS app on the receiver, but you might need to install it on the search head. As an alternative, you can use a search head running the OS. For example, to search data forwarded from Windows to a Linux receiver, you can use a Windows search head pointing to the Linux indexer as a remote search peer. For more information on search heads, see "About distributed search".
</p><p><b>Important:</b> After you have downloaded the relevant OS app, remove its <code><font size="2">inputs.conf</font></code> file before enabling the app, to ensure that its default inputs are not added to your indexer. For the Windows app, the location is: <code><font size="2">%SPLUNK_HOME%\etc\apps\windows\default\inputs.conf.</font></code> 
</p><p>In summary, you only need to install the app for the forwarder's OS on the receiver (or search head) if it will be performing searches on the forwarded OS data. 
</p>
<h3> <a name="enableareceiver_troubleshoot_forwarder_to_receiver_connectivity"><span class="mw-headline" id="Troubleshoot_forwarder_to_receiver_connectivity">Troubleshoot forwarder to receiver connectivity</span></a></h3>
<h4><font size="3"><b><i> <a name="enableareceiver_confusing_the_receiver.27s_receiver_and_management_ports"><span class="mw-headline" id="Confusing_the_receiver.27s_receiver_and_management_ports">Confusing the receiver's receiver and management ports</span></a></i></b></font></h4>
<p>As part of setting up a forwarder, you specify the receiver's <code><font size="2">hostname/IP_address</font></code> and <code><font size="2">port</font></code>. The forwarder uses these to send data to the receiver. Be sure to specify the  port that was designated as the receiving port at the time the receiver was configured. If you mistakenly specify the receiver's management port, the receiver will generate an error similar to this:
</p>
<div class="samplecode">
<code><font size="2"><br>splunkd.log:03-01-2010 13:35:28.653 ERROR TcpInputFd - SSL Error = error:140760FC:SSL routines:SSL23_GET_CLIENT_HELLO:unknown protocol<br>splunkd.log:03-01-2010 13:35:28.653 ERROR TcpInputFd - ACCEPT_RESULT=-1 VERIFY_RESULT=0<br>splunkd.log:03-01-2010 13:35:28.653 ERROR TcpInputFd - SSL Error for fd from HOST:localhost.localdomain, IP:127.0.0.1, PORT:53075<br>splunkd.log:03-01-2010 13:35:28.653 ERROR TcpInputFd - SSL Error = error:140760FC:SSL routines:SSL23_GET_CLIENT_HELLO:unknown protocol<br>splunkd.log:03-01-2010 13:35:28.653 ERROR TcpInputFd - ACCEPT_RESULT=-1 VERIFY_RESULT=0<br>splunkd.log:03-01-2010 13:35:28.653 ERROR TcpInputFd - SSL Error for fd from HOST:localhost.localdomain, IP:127.0.0.1, PORT:53076<br>splunkd.log:03-01-2010 13:35:28.653 ERROR TcpInputFd - SSL Error = error:140760FC:SSL routines:SSL23_GET_CLIENT_HELLO:unknown protocol<br>splunkd.log:03-01-2010 13:35:28.654 ERROR TcpInputFd - ACCEPT_RESULT=-1 VERIFY_RESULT=0<br>splunkd.log:03-01-2010 13:35:28.654 ERROR TcpInputFd - SSL Error for fd from HOST:localhost.localdomain, IP:127.0.0.1, PORT:53077<br>splunkd.log:03-01-2010 13:35:28.654 ERROR TcpInputFd - SSL Error = error:140760FC:SSL routines:SSL23_GET_CLIENT_HELLO:unknown protocol<br>splunkd.log:03-01-2010 13:35:28.654 ERROR TcpInputFd - ACCEPT_RESULT=-1 VERIFY_RESULT=0<br></font></code>
</div>
<h4><font size="3"><b><i> <a name="enableareceiver_closed_receiver_socket"><span class="mw-headline" id="Closed_receiver_socket">Closed receiver socket</span></a></i></b></font></h4>
<p>If a receiving indexer's queues become full, it will close the receiver socket, to prevent additional forwarders from connecting to it. If a forwarder with load-balancing enabled can no longer forward to that receiver, it will send its data to another indexer on its list. If the forwarder does not employ load-balancing, it will hold the data until the problem is resolved.
</p><p>The receiver socket will reopen automatically when the queue gets unclogged.
</p><p>Typically, a receiver gets behind on the data flow because it can no longer write data due to a full disk or because it is itself attempting to forward data to another Splunk Enterprise instance that is not accepting data.
</p><p>The following warning message will appear in <code><font size="2">splunkd.log</font></code> if the socket gets blocked:
</p>
<code><font size="2"><br>Stopping all listening ports. Queues blocked for more than N seconds. <br></font></code>
<p>This message will appear when the socket reopens:
</p>
<code><font size="2"><br>Started listening on tcp ports. Queues unblocked. <br></font></code>
<h3> <a name="enableareceiver_disable_receiving"><span class="mw-headline" id="Disable_receiving"> Disable receiving</span></a></h3>
<p>To disable receiving through the CLI, run the <code><font size="2">splunk disable listen</font></code> command:
</p>
<code><font size="2"><br>splunk disable listen -port &lt;port&gt; -auth &lt;username&gt;:&lt;password&gt;<br></font></code>
<p>You can also disable receiving by deleting the <code><font size="2">[splunktcp]</font></code> stanza from <code><font size="2">inputs.conf</font></code>.
</p>
<h3> <a name="enableareceiver_answers"><span class="mw-headline" id="Answers">Answers</span></a></h3>
<p>Have questions? Visit Splunk Answers and see what questions and answers the Splunk community has around configuring forwarding.
</p>
<a name="consolidatedatafrommultiplemachinesd"></a><h2> <a name="consolidatedatafrommultiplemachinesd_consolidate_data_from_multiple_machines"><span class="mw-headline" id="Consolidate_data_from_multiple_machines"> Consolidate data from multiple machines</span></a></h2>
<p>One of the most common forwarding use cases is to consolidate data originating across numerous machines. Forwarders located on the machines forward the data to a central Splunk Enterprise indexer. With their small footprint, universal forwarders ordinarily have little impact on their machines' performance. This diagram illustrates a common scenario, where universal forwarders residing on machines running diverse operating systems send data to a single Splunk Enterprise instance, which indexes and provides search capabilities across all the data:
</p><p><img alt="30 admin13 forwardreceive-dataforward 60.png" src="images/7/70/30_admin13_forwardreceive-dataforward_60.png" width="700" height="552"></p><p>The diagram illustrates a small deployment. In practice, the number of universal forwarders in a data consolidation use case could number upwards into the thousands.
</p><p>This type of use case is simple to configure:
</p><p><b>1.</b> Determine what data, originating from which machines, you need to access.
</p><p><b>2.</b> Install a Splunk Enterprise instance, typically on its own machine. This instance will function as the <b>receiver</b>. All indexing and searching will occur on it.
</p><p><b>3.</b> Enable the instance as a receiver through Splunk Web or the CLI. Using the CLI, enter this command from <code><font size="2">$SPLUNK_HOME/bin/</font></code>: 
</p>
<code><font size="2"><br>./splunk enable listen &lt;port&gt; -auth &lt;username&gt;:&lt;password&gt;<br></font></code>
<p>For <code><font size="2">&lt;port&gt;,</font></code> substitute the port you want the receiver to listen on. This also known as the "receiver port". 
</p><p><b>4.</b> If any of the universal forwarders will be running on a different operating system from the receiver, install the app for the forwarder's OS on the receiver. For example, assume the receiver in the diagram above is running on a Linux box. In that case, you'll need to install the Windows app on the receiver. You might need to install the *nix app, as well. -- However, since the receiver is on Linux, you probably have already installed that app. Details and provisos regarding this can be found <a href="#enableareceiver_searching_data_received_from_a_forwarder_running_on_a_different_operating_system" class="external text">here</a>.
</p><p>After you have downloaded the relevant app, remove its <code><font size="2">inputs.conf</font></code> file before enabling it, to ensure that its default inputs are not added to your indexer. For the Windows app, the location is: <code><font size="2">$SPLUNK_HOME/etc/apps/windows/default/inputs.conf.</font></code>
</p><p><b>5.</b> Install universal forwarders on each machine that will be generating data. These will forward the data to the receiver.
</p><p><b>6.</b> Set up inputs for each forwarder. See "What Splunk Enterprise can index".
</p><p><b>7.</b> Configure each forwarder to forward data to the receiver. For Windows forwarders, you can do this at installation time, as described <a href="#deployawindowsdfmanually" class="external text">here</a>. For *nix forwarders, you must do this through the CLI:
</p>
<code><font size="2"><br>./splunk add forward-server &lt;host&gt;:&lt;port&gt; -auth &lt;username&gt;:&lt;password&gt;<br></font></code>
<p>For <code><font size="2">&lt;host&gt;:&lt;port&gt;,</font></code> substitute the host and receiver port number of the receiver. For example, <code><font size="2">splunk_indexer.acme.com:9995.</font></code>
</p><p>Alternatively, if you have many forwarders, you can use an <code><font size="2">outputs.conf</font></code> file to specify the receiver. For example:
</p>
<code><font size="2"><br>[tcpout:my_indexers]<br>server= splunk_indexer.acme.com:9995<br></font></code>
<p>You can create this file once, then distribute copies of it to each forwarder.
</p>
<a name="setuploadbalancingd"></a><h2> <a name="setuploadbalancingd_set_up_load_balancing"><span class="mw-headline" id="Set_up_load_balancing"> Set up load balancing</span></a></h2>
<p>With <b>load balancing</b>, a forwarder distributes data across several receiving Splunk Enterprise instances. Each receiver gets a portion of the total data, and together the receivers hold all the data. To access the full set of forwarded data, you need to set up distributed searching across all the receivers. For information on distributed search, see "About distributed search" in the Distributed Search manual. 
</p><p>Load balancing enables horizontal scaling for improved performance. In addition, its automatic switchover capability ensures resiliency in the face of machine outages. If a machine goes down, the forwarder simply begins sending data to the next available receiver.
</p><p>Load balancing can also be of use when getting data from network devices like routers. To handle syslog and other data generated across port 514, a single heavy forwarder can monitor port 514 and distribute the incoming data across several indexers.
</p><p><b>Note:</b> When implementing load balancing between forwarders and receivers, you must use the forwarder's inherent capability. <i>Do not use an external load balancer.</i> The use of external load balancers between forwarders and receivers will not work properly. 
</p>
<h3> <a name="setuploadbalancingd_how_load_balancing_works"><span class="mw-headline" id="How_load_balancing_works">How load balancing works</span></a></h3>
<p>Forwarders perform "automatic load balancing". The forwarder routes data to different indexers based on a specified time interval. For example, assume you have a load-balanced group consisting of three indexers: A, B, and C. At some specified interval, such as every 30 seconds, the forwarder switches the data stream to another indexer in the group, selected at random. So, the forwarder might switch from indexer B to indexer A to indexer C, and so on. If one indexer is down, the forwarder immediately switches to another.
</p><p>To expand on this a bit, there is a data stream for each of the inputs that the forwarder is configured to monitor. The forwarder determines if it is safe for a data stream to switch to another indexer. Then, at the specified interval, it switches the data stream to the newly selected indexer. If it cannot switch the data stream to the new indexer safely, it keeps the connection to the previous indexer open and continues to send the data stream until it has been safely sent.
</p><p><b>Important:</b> Universal forwarders are not able to switch indexers when monitoring TCP network streams of data (including Syslog) unless an EOF is reached or an indexer goes down, at which point the forwarder will switch to the next indexer in the list. Because the universal forwarder does not parse the data and identify event boundaries before forwarding the data to the indexer (unlike a heavy forwarder), it has no way of knowing when it's safe to switch to the next indexer unless it receives an EOF. 
</p><p><b>Note:</b> Round-robin load balancing, which was previously available as an alternative to automatic load balancing, was deprecated in Splunk Enterprise version 4.2. 
</p><p>This diagram shows a typical load-balancing scenario, in which three forwarders are sending load-balanced data across a set of two receiving indexers:
</p><p><img alt="30 admin13 forwardreceive-balance 60.png" src="images/3/35/30_admin13_forwardreceive-balance_60.png" width="700" height="554"></p>
<h3> <a name="setuploadbalancingd_targets_for_load_balancing"><span class="mw-headline" id="Targets_for_load_balancing"> Targets for load balancing </span></a></h3>
<p>When configuring the set of target receivers, you can employ either DNS or static lists. 
</p><p>DNS lists provide greater flexibility and simplified scale-up, particularly for large deployments. Through DNS, you can change the set of receivers without needing to re-edit each forwarder's <code><font size="2">outputs.conf</font></code> file. 
</p><p>The main advantage of a static list is that it allows you to specify a different port for each receiver. This is useful if you need to perform load balancing across multiple receivers running on a single host. Each receiver can listen on a separate port.
</p>
<h4><font size="3"><b><i> <a name="setuploadbalancingd_static_list_target"><span class="mw-headline" id="Static_list_target"> Static list target </span></a></i></b></font></h4>
<p>To use a static list for the target, you simply specify each of the receivers in the target group's <code><font size="2">[tcpout]</font></code> stanza in the forwarder's <code><font size="2">outputs.conf</font></code> file. In this example, the target group consists of three receivers, specified by IP address and receiver port number:
</p>
<code><font size="2"><br>[tcpout: my_LB_indexers]<br>server=10.10.10.1:9997,10.10.10.2:9996,10.10.10.3:9995<br></font></code>
<p>The universal forwarder will load balance between the three receivers listed. If one receiver goes down, the forwarder automatically switches to another one on the list.
</p>
<h4><font size="3"><b><i> <a name="setuploadbalancingd_dns_list_target"><span class="mw-headline" id="DNS_list_target"> DNS list target </span></a></i></b></font></h4>
<p>To use a DNS list, edit your forwarder's <code><font size="2">outputs.conf</font></code> file to specify a single host in the target group's <code><font size="2">[tcpout]</font></code> stanza. For example:
</p>
<code><font size="2"><br>[tcpout:my_LB_indexers]<br>server=splunkreceiver.mycompany.com:9997<br></font></code>
<p>In your DNS server, create a DNS A record for each host's IP address, referencing the server name you specified in <code><font size="2">outputs.conf.</font></code> For example:
</p>
<code><font size="2"><br>splunkreceiver.mycompany.com &nbsp;&nbsp;A &nbsp;&nbsp;10.10.10.1<br>splunkreceiver.mycompany.com &nbsp;&nbsp;A &nbsp;&nbsp;10.10.10.2<br>splunkreceiver.mycompany.com &nbsp;&nbsp;A &nbsp;&nbsp;10.10.10.3<br></font></code>
<p>The forwarder will use the DNS list to load balance, sending data in intervals, switching among the receivers specified. If a receiver is not available, the forwarder skips it and sends data to another one on the list.
</p><p>If you have a topology with many forwarders, the DNS list method allows you to update the set of receivers by making changes in just a single location, without touching the forwarders' <code><font size="2">outputs.conf</font></code> files.
</p>
<h3> <a name="setuploadbalancingd_configure_load_balancing_for_horizontal_scaling"><span class="mw-headline" id="Configure_load_balancing_for_horizontal_scaling"> Configure load balancing for horizontal scaling </span></a></h3>
<p>To configure load balancing, first determine your needs, particularly your horizontal scaling and failover requirements. Then develop a topology based on those needs, possibly including multiple forwarders, as well as receivers and a search head to search across the receivers. 
</p><p>Assuming a topology of three universal forwarders and three receivers, set up DNS-based load balancing with these steps:
</p><p><b>1.</b> Install and enable a set of three Splunk Enterprise instances as receivers. This example uses a DNS list to designate the receivers, so they must all listen on the same port. For example, if the port is 9997, enable each receiver by going to its <code><font size="2">$SPLUNK_HOME/bin/</font></code> location and using this CLI command:
</p>
<code><font size="2">./splunk enable listen 9997 -auth &lt;username&gt;:&lt;password&gt;<br></font></code>
<p><b>2.</b> Install the set of universal forwarders, as described <a href="#deploymentoverview" class="external text">here</a>.
</p><p><b>3.</b> Set up a DNS list with an A record for each receiver's IP address:
</p>
<code><font size="2"><br>splunkreceiver.mycompany.com &nbsp;&nbsp;A &nbsp;&nbsp;10.10.10.1<br>splunkreceiver.mycompany.com &nbsp;&nbsp;A &nbsp;&nbsp;10.10.10.2<br>splunkreceiver.mycompany.com &nbsp;&nbsp;A &nbsp;&nbsp;10.10.10.3<br></font></code>
<p><b>4.</b> Create a single <code><font size="2">outputs.conf</font></code> file for use by all the forwarders. This one specifies the DNS server name used in the DNS list and the port the receivers are listening on:
</p>
<code><font size="2"><br>[tcpout]<br>defaultGroup=my_LB_indexers<br><br>[tcpout:my_LB_indexers]<br>disabled=false<br>autoLBFrequency=40<br>server=splunkreceiver.mycompany.com:9997<br></font></code>
<p>This <code><font size="2">outputs.conf</font></code> file uses the <code><font size="2">autoLBFrequency</font></code> attribute to set a load-balance frequency of 40 seconds. Every 40 seconds, the forwarders will switch to another receiver. The default frequency, which rarely needs changing, is 30 seconds.
</p><p><b>5.</b> Distribute the <code><font size="2">outputs.conf</font></code> file to all the forwarders. You can use the <b>deployment server</b> to handle the distribution.
</p><p>The steps are similar if you're using a static list instead of DNS.
</p>
<h3> <a name="setuploadbalancingd_specify_load_balancing_from_the_cli"><span class="mw-headline" id="Specify_load_balancing_from_the_CLI">Specify load balancing from the CLI </span></a></h3>
<p>You can also use the CLI to specify load balancing. You do this when you start forwarding activity to a set of receivers, using this syntax:  
</p>
<code><font size="2"><br>./splunk add forward-server &lt;host&gt;:&lt;port&gt; -method autobalance<br></font></code>
<p>where <code><font size="2">&lt;host&gt;:&lt;port&gt;</font></code> is the host and receiver port of the receiver. 
</p><p>This example creates a load-balanced group of four receivers:
</p>
<code><font size="2"><br>./splunk add forward-server indexer1:9997 -method autobalance<br>./splunk add forward-server indexer2:9997 -method autobalance<br>./splunk add forward-server indexer3:9997 -method autobalance<br>./splunk add forward-server indexer4:9997 -method autobalance<br></font></code>

<h1>The universal forwarder</h1><a name="introducingtheuniversalforwarder"></a><h2> <a name="introducingtheuniversalforwarder_introducing_the_universal_forwarder"><span class="mw-headline" id="Introducing_the_universal_forwarder"> Introducing the universal forwarder</span></a></h2>
<p>The <b>universal forwarder</b> is Splunk's lightweight <b>forwarder</b>. Use the universal forwarder to gather data from a variety of inputs and forward the data to a Splunk Enterprise server for indexing and searching. 
</p><p>This section of the Distributed Deployment manual describes how to deploy the universal forwarder for a variety of systems and needs. For information on the different kinds of forwarders and detailed information on configuring them for a range of topologies and use cases, see the <a href="#aboutforwardingandreceivingdata" class="external text">"Forward data"</a> chapter of this manual.
</p><p>The universal forwarder replaces the light forwarder. 
</p><p><b>Note:</b> The universal forwarder is a separate executable from full Splunk Enterprise. Instances of full Splunk Enterprise and the universal forwarder can co-exist on the same system.
</p><p>For information on deploying the universal forwarder, see <a href="#deploymentoverview" class="external text">"Universal forwarder deployment overview"</a>.
</p>
<h3> <a name="introducingtheuniversalforwarder_how_universal_forwarder_compares_to_full_splunk_enterprise"><span class="mw-headline" id="How_universal_forwarder_compares_to_full_Splunk_Enterprise"> How universal forwarder compares to full Splunk Enterprise</span></a></h3>
<p>The universal forwarder's sole purpose is to forward data. Unlike a full Splunk Enterprise instance, you cannot use the universal forwarder to index or search data. To achieve higher performance and a lighter footprint, it has several limitations:
</p>
<ul><li> The universal forwarder has no searching, indexing, or alerting capability.
</li><li> The universal forwarder does not <b>parse</b> data, except in certain cases.
</li><li> The universal forwarder does not output data via syslog.
</li><li> Unlike full Splunk Enterprise, the universal forwarder does not include a bundled version of Python. 
</li></ul><h4><font size="3"><b><i> <a name="introducingtheuniversalforwarder_scripted_inputs_and_python"><span class="mw-headline" id="Scripted_inputs_and_Python">Scripted inputs and Python</span></a></i></b></font></h4>
<p>Full Splunk Enterprise comes bundled with Python. The universal forwarder does not. Therefore, if you're currently using scripted inputs with Python and you want to use those scripts with the universal forwarder, you must first install your own version of Python. If you have been using calls specific to Splunk's Python libraries, you cannot do so with the universal forwarder, because those libraries exist only in full Splunk Enterprise. You may use other scripting languages for scripted inputs with the universal forwarder if they are otherwise supported on the target host (for example, Powershell on Windows Server 2008.)
</p>
<h3> <a name="introducingtheuniversalforwarder_how_universal_forwarder_compares_to_the_light_forwarder"><span class="mw-headline" id="How_universal_forwarder_compares_to_the_light_forwarder">How universal forwarder compares to the light forwarder</span></a></h3>
<p>The universal forwarder is a streamlined, self-contained forwarder that includes only the essential components needed to forward data to other Splunk Enterprise instances. The <b>light forwarder</b>, by contrast, is a full Splunk Enterprise instance, with certain features disabled to achieve a smaller footprint. In all respects, the universal forwarder represents a better tool for forwarding data to indexers. When you install the universal forwarder, you can migrate from an existing light forwarder, version 4.0 or greater. See <a href="#deploymentoverview_migrating_from_a_light_forwarder.3f" class="external text">"Migrating from a light forwarder"</a> for details.
</p><p>Compared to the light forwarder, the universal forwarder provides a better performing and more streamlined solution to forwarding. These are the main technical differences between the universal forwarder and the light forwarder:
</p>
<ul><li> The universal forwarder puts less load on the CPU, uses less memory, and has a smaller disk footprint.
</li><li> The universal forwarder has a default data transfer rate of 256Kbps
</li><li> The universal forwarder does not come bundled with Python.
</li><li> The universal forwarder is a forwarder only; it cannot be converted to a full Splunk Enterprise instance.
</li></ul><p><b>Note:</b> The light forwarder has been deprecated in Splunk Enterprise version 6.0. For a list of all deprecated features, see the topic "Deprecated features" in the Release Notes.
</p>
<h3> <a name="introducingtheuniversalforwarder_read_on.21"><span class="mw-headline" id="Read_on.21"> Read on!</span></a></h3>
<p>For information on deploying the universal forwarder, see the topics that directly follow this one. 
</p><p>For information on using the universal forwarder to forward data and participate in various distributed topologies, see the topics in the <a href="#aboutforwardingandreceivingdata" class="external text">"Overview"</a> chapter of this manual. Those topics also discuss light and heavy forwarders.
</p><p>For information on third-party Windows binaries that the Windows version of the Splunk Enterprise universal forwarder ships with, read "Information on Windows third-party binaries distributed with Splunk Enterprise" in the Installation Manual.
</p><p>For information about running the universal forwarder in Windows Safe Mode, read "Splunk Enterprise Architecture and Processes" in the Installation Manual.
</p>
<a name="deploymentoverview"></a><h2> <a name="deploymentoverview_deployment_overview"><span class="mw-headline" id="Deployment_overview"> Deployment overview</span></a></h2>
<p>The topics in this chapter describe how to install and deploy the <b>universal forwarder</b>. They include use cases that focus on installing and configuring the forwarder for a number of different scenarios.
</p><p><b>Important:</b> Before attempting to deploy the universal forwarder, you must be familiar with how forwarding works and the full range of configuration issues.  See:
</p>
<ul><li> the topics in the chapter <a href="#aboutforwardingandreceivingdata" class="external text">"Forward data"</a> for an overview of forwarding and forwarders.
</li><li> the topics in the chapter <a href="#setupforwardingandreceiving" class="external text">"Configure forwarding"</a> to learn how to configure forwarders.
</li><li> the subtopic <a href="#setupforwardingandreceiving_set_up_forwarding_with_universal_forwarders" class="external text">"Set up forwarding and receiving: universal forwarders"</a> for a overview of configuring forwarding and receiving.
</li></ul><h3> <a name="deploymentoverview_types_of_deployments"><span class="mw-headline" id="Types_of_deployments">Types of deployments</span></a></h3>
<p>These are the main scenarios for deploying the universal forwarder:
</p>
<ul><li> Deploy a Windows universal forwarder manually, either with the <a href="#deployawindowsdfmanually" class="external text">installer GUI</a> or from the <a href="#deployawindowsdfviathecommandline" class="external text">commandline</a>.
</li><li> Deploy a <a href="#deployanixdfmanually" class="external text">nix universal forwarder manually</a>, using the CLI to configure it.
</li><li> Remotely deploy a universal forwarder  (<a href="#remotelydeployawindowsdfwithastaticconfiguration" class="external text">Windows</a> or <a href="#remotelydeployanixdfwithastaticconfiguration" class="external text">nix</a>).
</li><li> Make the universal forwarder part of a <a href="#makeadfpartofasystemimage" class="external text">system image</a>.
</li></ul><p>Each scenario is described in its own topic. For most scenarios, there are separate Windows and *nix topics.
</p><p><b>Note:</b> The universal forwarder is its own downloadable executable, separate from full Splunk Enterprise. Unlike the light and heavy forwarders, you do not enable it from a full Splunk Enterprise instance. To download the universal forwarder, go to <b>http://www.splunk.com/download/universalforwarder</b> .
</p>
<h3> <a name="deploymentoverview_before_you_start"><span class="mw-headline" id="Before_you_start"> Before you start</span></a></h3>
<h4><font size="3"><b><i> <a name="deploymentoverview_forwarders_and_indexer_clusters"><span class="mw-headline" id="Forwarders_and_indexer_clusters"> Forwarders and indexer clusters </span></a></i></b></font></h4>
<p>When using forwarders to send data to peer nodes in an indexer cluster, you deploy and configure them a bit differently from the description in this topic. To learn more about forwarders and clusters, read "Use forwarders to get your data" in the <i>Managing Indexers and Clusters of Indexers</i> manual.
</p>
<h4><font size="3"><b><i> <a name="deploymentoverview_indexer_and_universal_forwarder_compatibility"><span class="mw-headline" id="Indexer_and_universal_forwarder_compatibility"> Indexer and universal forwarder compatibility </span></a></i></b></font></h4>
<p>See <a href="#compatibilitybetweenforwardersandindexers" class="external text">"Compatibility between forwarders and indexers"</a> for details.
</p>
<h4><font size="3"><b><i> <a name="deploymentoverview_system_requirements"><span class="mw-headline" id="System_requirements"> System requirements </span></a></i></b></font></h4>
<p>See the Installation manual for specific hardware requirements and  supported operating systems.
</p>
<h4><font size="3"><b><i> <a name="deploymentoverview_licensing_requirements"><span class="mw-headline" id="Licensing_requirements"> Licensing requirements </span></a></i></b></font></h4>
<p>The universal forwarder ships with a pre-installed license. See "Types of Splunk Enterprise licenses" in the Admin manual for details.
</p>
<h4><font size="3"><b><i> <a name="deploymentoverview_other_requirements"><span class="mw-headline" id="Other_requirements"> Other requirements</span></a></i></b></font></h4>
<p>You must have admin or equivalent rights on the machine where you're installing the universal forwarder.
</p>
<h3> <a name="deploymentoverview_steps_to_deployment"><span class="mw-headline" id="Steps_to_deployment"> Steps to deployment </span></a></h3>
<p>The actual procedure varies depending on the type of deployment, but these are the typical steps:
</p><p><b>1.</b> Plan your deployment.
</p><p><b>2.</b> Download the universal forwarder from <b>http://www.splunk.com/download/universalforwarder</b>
</p><p><b>3.</b> Install the universal forwarder on a test machine.
</p><p><b>4.</b> Perform any post-installation configuration.
</p><p><b>5.</b> Test and tune the deployment.
</p><p><b>6.</b> Deploy the universal forwarder to machines across your environment (for multi-machine deployments).
</p><p>These steps are described below in more detail.
</p><p><b>Important:</b> Deploying your forwarders is just one step in the overall process of setting up forwarding and receiving. For an overview of that process, read <a href="#setupforwardingandreceiving_set_up_forwarding_with_universal_forwarders" class="external text">"Set up forwarding and receiving: universal forwarders"</a>.
</p>
<h4><font size="3"><b><i> <a name="deploymentoverview_plan_your_deployment"><span class="mw-headline" id="Plan_your_deployment"> Plan your deployment </span></a></i></b></font></h4>
<p>Here are some of the issues to consider when planning your deployment:
</p>
<ul><li> How many (and what type of) machines will you be deploying to?
</li><li> Will you be deploying across multiple OS's?
</li><li> Do you need to migrate from any existing forwarders?
</li><li> What, if any, deployment tools do you plan to use?
</li><li> Will you be deploying via a system image or virtual machine?
</li><li> Will you be deploying fully configured universal forwarders, or do you plan to complete the configuration after the universal forwarders have been deployed across your system?
</li><li> What level of security does the communication between universal forwarder and indexer require?
</li></ul><h4><font size="3"><b><i> <a name="deploymentoverview_install.2c_test.2c_configure.2c_deploy"><span class="mw-headline" id="Install.2C_test.2C_configure.2C_deploy"> Install, test, configure, deploy </span></a></i></b></font></h4>
<p>For next steps, see the topic in this chapter that matches your deployment requirements most closely. Each topic contains one or more use cases that cover specific deployment scenarios from installation through configuration and deployment:
</p>
<ul><li> <a href="#deployawindowsdfmanually" class="external text">"Deploy a Windows universal forwarder via the installer GUI"</a> 
</li></ul><ul><li> <a href="#deployawindowsdfviathecommandline" class="external text">"Deploy a Windows universal forwarder via the commandline"</a>
</li></ul><ul><li> <a href="#remotelydeployawindowsdfwithastaticconfiguration" class="external text">"Remotely deploy a Windows universal forwarder with a static configuration"</a> 
</li></ul><ul><li> <a href="#deployanixdfmanually" class="external text">"Deploy a nix universal forwarder manually"</a> 
</li></ul><ul><li> <a href="#remotelydeployanixdfwithastaticconfiguration" class="external text">"Remotely deploy a nix universal forwarder with a static configuration"</a>
</li></ul><ul><li> <a href="#makeadfpartofasystemimage" class="external text">"Make a universal forwarder part of a system image"</a>
</li></ul><p>But first, read the next section to learn more about universal forwarder configuration.
</p><p><b>Note:</b> The universal forwarder's executable is named <code><font size="2">splunkd</font></code>, the same as the executable for full Splunk Enterprise. The service name is <code><font size="2">SplunkUniversalForwarder</font></code>.
</p>
<h3> <a name="deploymentoverview_general_configuration_issues"><span class="mw-headline" id="General_configuration_issues">General configuration issues </span></a></h3>
<p>Because the universal forwarder has no Splunk Web GUI, you must perform all configuration either during installation (Windows-only) or later, as a separate step. To perform post-installation configuration, you can use the CLI, modify the configuration files directly, or use deployment server.  
</p>
<h4><font size="3"><b><i> <a name="deploymentoverview_where_to_configure"><span class="mw-headline" id="Where_to_configure">Where to configure</span></a></i></b></font></h4>
<p>Key configuration files include inputs.conf (for data inputs) and outputs.conf (for data outputs). Others include server.conf and deploymentclient.conf.  
</p><p>When you make configuration changes with the CLI, the universal forwarder writes the changes to configuration files in the search app (except for changes to <code><font size="2">outputs.conf</font></code>, which it writes to a file in <code><font size="2">$SPLUNK_HOME/etc/system/local/</font></code>). The search app is the default app for the universal forwarder, even though you cannot actually use the universal forwarder to perform searches. If this seems odd, it is.
</p><p><b>Important:</b> The Windows installation process writes configuration changes to an app called "MSICreated", not to the search app. 
</p><p><b>Note:</b> The universal forwarder also ships with a SplunkUniversalForwarder app, which must be enabled. (This happens automatically.) This app includes preconfigured settings that enable the universal forwarder to run in a streamlined mode. No configuration changes get written there. We recommend that you do <b>not</b> make any changes or additions to that app.
</p>
<h4><font size="3"><b><i> <a name="deploymentoverview_learn_more_about_configuration"><span class="mw-headline" id="Learn_more_about_configuration">Learn more about configuration </span></a></i></b></font></h4>
<p>Refer to these topics for some important information:
</p>
<ul><li> "About configuration files" and "Configuration file precedence" in the Admin manual, for details on how configuration files work.
</li><li> <a href="#configureforwarderswithoutputs.confd" class="external text">"Configure forwarders with outputs.conf"</a>, for information on <code><font size="2">outputs.conf</font></code> specifically. 
</li><li> The topics in the <a href="#consolidatedatafrommultiplemachinesd" class="external text">"Use the forwarder to create deployment topologies"</a> section, for information on configuring outputs with the CLI. 
</li><li> "Configure your inputs" in the Getting Data In manual, for details on configuring data inputs with <code><font size="2">inputs.conf</font></code> or the CLI.
</li></ul><h4><font size="3"><b><i> <a name="deploymentoverview_deploy_configuration_updates"><span class="mw-headline" id="Deploy_configuration_updates">Deploy configuration updates</span></a></i></b></font></h4>
<p>These are the main methods for deploying configuration updates across your set of universal forwarders:
</p>
<ul><li> Edit or copy the configuration files for each universal forwarder manually (for small deployments only).
</li><li> Use the Splunk <b>deployment server</b> to push configured apps to your set of universal forwarders.
</li><li> Use your own deployment tools to push configuration changes.
</li></ul><h4><font size="3"><b><i> <a name="deploymentoverview_restart_the_universal_forwarder"><span class="mw-headline" id="Restart_the_universal_forwarder">Restart the universal forwarder </span></a></i></b></font></h4>
<p>Some configuration changes might require that you restart the forwarder. (The  topics covering specific configuration changes will let you know if a change does require a restart.)
</p><p>To restart the universal forwarder, use the same CLI <code><font size="2">restart</font></code> command that you use to restart a full Splunk Enterprise instance:
</p>
<ul><li> <b>On Windows:</b> Go to <code><font size="2">%SPLUNK_HOME%\bin</font></code> and run this command:
</li></ul><code><font size="2"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt; splunk restart <br></font></code>
<ul><li> <b>On *nix systems:</b> From a shell prompt on the host, run this command:
</li></ul><code><font size="2"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# splunk restart <br></font></code>
<h3> <a name="deploymentoverview_migrating_from_a_light_forwarder.3f"><span class="mw-headline" id="Migrating_from_a_light_forwarder.3F"> Migrating from a light forwarder?</span></a></h3>
<p>The universal forwarder provides all the functionality of the old <b>light forwarder</b> but in a smaller footprint with better performance. Therefore, you might want to migrate your existing light forwarder installations to universal forwarders. Splunk provides tools that ease the migration process and ensure that the new universal forwarder does not send an indexer any data already sent by the old light forwarder. 
</p><p><b>Note:</b> You can only migrate from light forwarders of version 4.0 or later.
</p><p>Migration is available as an option during the universal forwarder installation process. See <a href="#migrateawindowsforwarder" class="external text">"Migrate a Windows forwarder"</a> or <a href="#migrateanixforwarder" class="external text">"Migrate a nix forwarder"</a> for details. You will want to uninstall the old light forwarder instance once your universal forwarder is up and running (and once you've tested to ensure migration worked correctly).
</p>
<h4><font size="3"><b><i> <a name="deploymentoverview_what_migration_does"><span class="mw-headline" id="What_migration_does">What migration does</span></a></i></b></font></h4>
<p>Migration copies checkpoint data, including the fishbucket directory, from the old forwarder to the new universal forwarder. This prevents the universal forwarder from re-forwarding data that the previous forwarder had already sent to an indexer. This in turn avoids unnecessary re-indexing, ensuring that you maintain your statistics and keep your license usage under control. Specifically, migration copies:
</p>
<ul><li> the fishbucket directory (contains seek pointers for tailed files).
</li></ul><h4><font size="3"><b><i> <a name="deploymentoverview_what_migration_does_not_do"><span class="mw-headline" id="What_migration_does_not_do"> What migration does not do</span></a></i></b></font></h4>
<p>Migration does not copy any configuration files, such as <code><font size="2">inputs.conf</font></code> or <code><font size="2">outputs.conf</font></code>. This is because it would not be possible to conclusively determine where all existing versions of configuration files reside on the old forwarder. Therefore, you still need to configure your data inputs and outputs, either during installation or later. If you choose to configure later, you can copy over the necessary configuration files manually or you can use the deployment server to push them out to all your universal forwarders. See <a href="#deploymentoverview_general_configuration_issues" class="external text">this section below</a> for more information on configuration files.
</p><p>If the data inputs for the universal forwarder differ from the old forwarder, you can still migrate. Migrated checkpoint data pertaining to any inputs not configured for the universal forwarder will just be ignored. If you decide to add those inputs later, the universal forwarder will use the migrated checkpoints to determine where in the data stream to start forwarding.
</p><p>Migration also does not copy over any apps from the light forwarder. If you have any apps that you want to migrate to the universal forwarder, you'll need to do so manually.
</p>
<a name="supportedclicommands"></a><h2> <a name="supportedclicommands_supported_cli_commands"><span class="mw-headline" id="Supported_CLI_commands"> Supported CLI commands</span></a></h2>
<p>The universal forwarder supports a subset of objects for use in CLI commands. Certain objects valid in full Splunk Enterprise, like <code><font size="2">index</font></code> (as in <code><font size="2">add index</font></code>), make no sense in the context of the universal forwarder.
</p><p>Commands act upon objects.  If you type an invalid command/object combination, the universal forwarder will return an error message.
</p>
<h3> <a name="supportedclicommands_valid_cli_objects"><span class="mw-headline" id="Valid_CLI_objects"> Valid CLI objects</span></a></h3>
<p>The universal forwarder supports all CLI commands for these objects:
</p>
<code><font size="2"><br>&nbsp;&nbsp;&nbsp;&nbsp;add<br>&nbsp;&nbsp;&nbsp;&nbsp;app<br>&nbsp;&nbsp;&nbsp;&nbsp;config<br>&nbsp;&nbsp;&nbsp;&nbsp;datastore-dir<br>&nbsp;&nbsp;&nbsp;&nbsp;default-hostname<br>&nbsp;&nbsp;&nbsp;&nbsp;deploy-client<br>&nbsp;&nbsp;&nbsp;&nbsp;deploy-poll<br>&nbsp;&nbsp;&nbsp;&nbsp;eventlog<br>&nbsp;&nbsp;&nbsp;&nbsp;exec<br>&nbsp;&nbsp;&nbsp;&nbsp;forward-server<br>&nbsp;&nbsp;&nbsp;&nbsp;monitor<br>&nbsp;&nbsp;&nbsp;&nbsp;oneshot<br>&nbsp;&nbsp;&nbsp;&nbsp;perfmon<br>&nbsp;&nbsp;&nbsp;&nbsp;registry<br>&nbsp;&nbsp;&nbsp;&nbsp;servername<br>&nbsp;&nbsp;&nbsp;&nbsp;splunkd-port<br>&nbsp;&nbsp;&nbsp;&nbsp;tcp<br>&nbsp;&nbsp;&nbsp;&nbsp;udp<br>&nbsp;&nbsp;&nbsp;&nbsp;user<br>&nbsp;&nbsp;&nbsp;&nbsp;wmi<br></font></code>
<p><b>Note:</b> A few commands, such as <code><font size="2">start</font></code> and <code><font size="2">stop</font></code> can be run without an object. A command with no object is also valid for the universal forwarder.
</p>
<h3> <a name="supportedclicommands_a_brief_introduction_to_cli_syntax"><span class="mw-headline" id="A_brief_introduction_to_CLI_syntax">A brief introduction to CLI syntax</span></a></h3>
<p>The general syntax for a CLI command is:
</p>
<code><font size="2"><br>./splunk &lt;command&gt; [&lt;object&gt;] [[-&lt;parameter&gt;] &lt;value&gt;]...<br></font></code>
<p>As described above, it's the <i>object</i> that determines whether a command is valid in the universal forwarder. For example, the above list includes the <code><font size="2">monitor</font></code> object. Therefore, the <code><font size="2">add monitor</font></code> and <code><font size="2">edit monitor</font></code> command/object combinations are both valid.  For more information on the <code><font size="2">monitor</font></code> object, see "Use the CLI to monitor files and directories" in the Getting Data In manual.
</p><p>For more details on using the CLI in general, see the "Administer Splunk Enterprise with the CLI" chapter in the Admin manual. In particular, the topic "CLI admin commands" provides details on CLI syntax, including a list of all commands supported by full Splunk Enterprise and the objects they can act upon.
</p>
<a name="chooseyourplatform"></a><h2> <a name="chooseyourplatform_how_to_install_a_universal_forwarder"><span class="mw-headline" id="How_to_install_a_universal_forwarder">How to install a universal forwarder</span></a></h2>
<p>Before you install a universal forwarder, you must get the correct version for your operating system. The universal forwarder can be downloaded for Windows as well as many different versions of *nix. 
</p><p>To find out which operating systems Splunk supports, read the system requirements page in the Installation manual. Then proceed to the universal forwarder download page and download the correct forwarder for your application.
</p><p>After you download the forwarder installer, follow the installation topic that matches your deployment requirements most closely. During or immediately after the installation, you also perform configuration. Each installation topic contains one or more use cases that cover specific deployment scenarios from installation through configuration and deployment.
</p><p>For additional details on the universal forwarder, see "<a href="#deploymentoverview" class="external text">Deployment overview</a>" in this manual.
</p>
<h3> <a name="chooseyourplatform_install_the_universal_forwarder_on_windows"><span class="mw-headline" id="Install_the_universal_forwarder_on_Windows"> Install the universal forwarder on Windows </span></a></h3>
<ul><li> <a href="#deployawindowsdfmanually" class="external text">"Deploy a Windows universal forwarder via the installer GUI"</a> 
</li></ul><ul><li> <a href="#deployawindowsdfviathecommandline" class="external text">"Deploy a Windows universal forwarder via the commandline"</a>
</li></ul><h3> <a name="chooseyourplatform_install_the_universal_forwarder_on_.2anix"><span class="mw-headline" id="Install_the_universal_forwarder_on_.2Anix"> Install the universal forwarder on *nix </span></a></h3>
<ul><li> <a href="#deployanixdfmanually" class="external text">"Deploy a nix universal forwarder manually"</a> 
</li></ul><ul><li> <a href="#remotelydeployanixdfwithastaticconfiguration" class="external text">"Remotely deploy a nix universal forwarder with a static configuration"</a>
</li></ul><h1>Deploy Windows universal forwarders</h1><a name="deployawindowsdfmanually"></a><h2> <a name="deployawindowsdfmanually_deploy_a_windows_universal_forwarder_via_the_installer_gui"><span class="mw-headline" id="Deploy_a_Windows_universal_forwarder_via_the_installer_GUI"> Deploy a Windows universal forwarder via the installer GUI</span></a></h2>
<table cellpadding="10" cellspacing="0" border="1" width="100%"><tr bgcolor="#D9EAED"><th valign="top" bgcolor="#C0C0C0"> Important
</th></tr><tr><td valign="center" align="left"> New for version 6.2 of the Splunk universal forwarder, the installation procedure has changed significantly. Read "<a href="#deployawindowsdfmanually_installation_options" class="external text">Installation Options</a>" to learn about the new installation procedure.
</td></tr></table><p>This topic describes how to manually install, configure, and deploy the universal forwarder in a Windows environment using the installer GUI. It assumes that you're installing directly onto the Windows machine, rather than using a deployment tool. This method of installation best suits these needs:
</p>
<ul><li> small deployments
</li><li> proof-of-concept test deployments
</li><li> system image or virtual machine for eventual cloning
</li></ul><p>If you are interested in a different deployment method or a different operating system, look for another topic in this section that better fits your needs.
</p><p>You can also install the universal forwarder from the command line, using <code><font size="2">msiexec</font></code>. The command-line deployment provides more configuration options, for data inputs and other settings. See <a href="#deployawindowsdfviathecommandline" class="external text">"Deploy a Windows universal forwarder via the command line"</a> for more information.
</p><p><b>Important:</b> If you do not want the universal forwarder to start immediately after installation, you <b>must</b> install via the command line.
</p><p>Before following the procedures in this topic, read <a href="#deploymentoverview" class="external text">"Deployment overview"</a> to further understand the mechanics of a distributed Splunk Enterprise deployment.
</p>
<h3> <a name="deployawindowsdfmanually_steps_to_deployment"><span class="mw-headline" id="Steps_to_deployment"> Steps to deployment </span></a></h3>
<p>Once you have downloaded the universal forwarder and planned your deployment, as described in <a href="#deploymentoverview" class="external text">"Deployment overview"</a>, perform these steps:
</p><p><b>1.</b> Install the universal forwarder (with optional migration and configuration).
</p><p><b>2.</b> Test and tune the deployment.
</p><p><b>3.</b> Perform any post-installation configuration.
</p><p><b>4.</b> Deploy the universal forwarder across your environment.
</p>
<h3> <a name="deployawindowsdfmanually_before_you_install"><span class="mw-headline" id="Before_you_install"> Before you install </span></a></h3>
<h4><font size="3"><b><i> <a name="deployawindowsdfmanually_choose_the_account_that_the_universal_forwarder_should_use"><span class="mw-headline" id="Choose_the_account_that_the_universal_forwarder_should_use"> Choose the account that the universal forwarder should use </span></a></i></b></font></h4>
<p>When you install the universal forwarder, you can select where the forwarder will get its data. You have two choices:
</p>
<ul><li> Local System
</li><li> Domain account
</li></ul><p>If you tell the installer to install as the <b>Local System</b> user, the universal forwarder can collect any kind of data that is available on the local machine. It cannot, however, collect data from other machines. 
</p><p>You must install the forwarder as a <b>Domain user</b> if you intend to do any of the following:
</p>
<ul><li> Read Event Logs remotely
</li><li> Collect performance counters remotely
</li><li> Read network shares for log files 
</li><li> Enumerate the Active Directory schema, using Active Directory monitoring
</li></ul><p>If you install as a domain user, you must then specify a user which has access to the data you want to monitor. Read "Choose the Windows user Splunk should run as" in the Installation Manual for concepts and procedures on the user requirements that must be in place before you collect remote Windows data.
</p><p>If you install as a domain user, you can choose whether or not the user has administrative privileges on the local machine. If you choose not to give the user administrative privileges, the universal forwarder enables "low-privilege" mode. Read the installation instructions later in this topic for additional information on how to enable low-privilege mode.
</p><p><b>Important:</b> You should choose - and configure - the user that Splunk will run as before attempting to install a universal forwarder for remote Windows data collection.
</p>
<h4><font size="3"><b><i> <a name="deployawindowsdfmanually_configure_your_windows_environment_for_remote_data_collection"><span class="mw-headline" id="Configure_your_Windows_environment_for_remote_data_collection"> Configure your Windows environment for remote data collection </span></a></i></b></font></h4>
<p>If you do not need to install the universal forwarder to collect remote Windows data, you can continue to the installation instructions below.
</p><p>If your monitoring needs require you to install the universal forwarder to collect remote Windows data, then you must configure your Windows environment for the proper installation of the forwarder.
</p><p><b>1.</b> Create and configure security groups with the user you want the universal forwarder to run as.
</p><p><b>2.</b> Optionally, configure the universal forwarder account as a managed service account.
</p><p><b>3.</b> Create and configure Group Policy objects for security policy and user rights assignment.
</p><p><b>4.</b> Assign appropriate user rights to the GPO.
</p><p><b>5.</b> Deploy the GPO(s) with the updated settings to the appropriate objects.
</p><p><b>Note:</b> These steps are high-level procedures only. For step-by-step instructions, read "Prepare your Windows network for a Splunk Enterprise installation as a network or domain user" in the Installation Manual. Depending on whether or not you install the forwarder in low-privilege mode, one or more steps might not be necessary.
</p>
<h3> <a name="deployawindowsdfmanually_install_the_universal_forwarder"><span class="mw-headline" id="Install_the_universal_forwarder"> Install the universal forwarder </span></a></h3>
<p>The Windows installer guides you through the process of installing and configuring your universal forwarder. It also offers you the option of migrating your checkpoint settings from an existing forwarder.
</p><p>To install the universal forwarder, double-click the appropriate MSI file: 
</p>
<ul><li><code><font size="2">splunkuniversalforwarder-&lt;...&gt;-x86-release.msi</font></code> (for 32-bit platforms)
</li><li><code><font size="2">splunkuniversalforwarder-&lt;...&gt;-x64-release.msi</font></code> (for 64-bit platforms)
</li></ul><p>The value of <code><font size="2">&lt;...&gt;</font></code> varies according to the particular release; for example, <code><font size="2">splunkuniversalforwarder-4.2-86454-x64-release.msi</font></code>.
</p><p><b>Caution:</b> You can no longer install or run the 32-bit version of the Splunk universal forwarder for Windows on a 64-bit Windows system. You also cannot install the universal forwarder on a machine that runs an unsupported OS. See "System requirements."
</p><p>If you attempt to run the installer in such a way, it warns you and prevents the installation.
</p><p>A series of dialogs guides you through the installation. When you're through with a dialog, click <b>Next</b> to move to the next in the series. Here are the dialogs, in order:
</p><p><b>1. "Universal forwarder setup" dialog</b>
</p><p><img alt="62 UFInstaller.png" src="images/8/82/62_UFInstaller.png" width="300" height="231"></p><p>To continue the installation, check the "Check this box to accept the License Agreement" checkbox. To view the license agreement, click the "View License Agreement" button.
</p>
<h4><font size="3"><b><i> <a name="deployawindowsdfmanually_installation_options"><span class="mw-headline" id="Installation_Options"> Installation Options </span></a></i></b></font></h4>
<p>New for version 6.2 of the universal forwarder, the Windows installer gives you two choices: Install with the default installation settings, or configure all settings prior to installing.
</p><p>The installer does the following by default:
</p>
<ul><li> Installs the universal forwarder in <code><font size="2">\Program Files\SplunkUniversalForwarder</font></code> on the system drive (the drive that booted your Windows system.)
</li><li> Installs the universal forwarder with the default management port.
</li><li> Configures the universal forwarder to run as the Local System user. Read "Choose the user Splunk Enterprise should run as" in this manual to understand the ramifications.
</li><li> Enables the Application, System, and Security Windows Event Log inputs.
</li></ul><p><b>2a.</b> If you want to change any of these default installation settings, click the "Customize Options" button and proceed with the instructions in "Customize Options" in this topic. 
</p><p><b>2b.</b> Otherwise, click the "Install" button to install the software with the defaults. Then, continue with Step 8.
</p>
<h4><font size="3"><b><i> <a name="deployawindowsdfmanually_customize_options"><span class="mw-headline" id="Customize_Options">Customize Options</span></a></i></b></font></h4>
<p>On each panel, click <b>Next</b> to continue, <b>Back</b> to go back a step, or <b>Cancel</b> to cancel the installation and quit the installer.
</p><p><b>3. "Destination Folder" dialog</b>
</p><p><img alt="62 UFInstaller Location.png" src="images/1/1d/62_UFInstaller_Location.png" width="300" height="231"></p><p>The installer puts the universal forwarder into the <code><font size="2">C:\Program Files\SplunkUniversalForwarder</font></code> directory by default. 
</p><p>Click <b>Change...</b> to specify a different installation directory. 
</p><p><b>Caution:</b> Do not install the universal forwarder over an existing installation of full Splunk Enterprise.The default installation directory for full Splunk Enterprise is <code><font size="2">C:\Program Files\Splunk</font></code>, so, if you stick with the defaults, you're safe.
</p><p><b>4. "Certificate Information" dialog</b>
</p><p><img alt="62 UFInstaller Certificate.png" src="images/4/43/62_UFInstaller_Certificate.png" width="300" height="233"></p><p>Select an SSL certificate for verifying the identity of this machine. This step is optional. Skip this step if using Splunk Cloud.
</p><p>Depending on your certificate requirements, you might need to specify a password and a Root Certificate Authority (CA) certificate to verify the identity of the certificate. If not, these fields can be left blank.
</p><p><b>5. "User selection" dialogs</b>
</p><p><img alt="62 UFInstaller ChooseUser.png" src="images/d/d7/62_UFInstaller_ChooseUser.png" width="300" height="231"></p><p>This step in the installer requires one or two dialogs, depending on the user type you choose. 
</p><p>In the first dialog, specify whether you want the universal forwarder to run as the Local System user or a domain user. The installer uses this information to determine the permissions the universal forwarder needs. 
</p><p>If you select <b>Local System</b>, the universal forwarder installs as the Local System user. This is recommended for improved security, unless you want this universal forwarder to collect event logs or metrics from remote machines.
</p><p>For more help in determining what to select here, see <a href="#deployawindowsdfmanually_before_you_install" class="external text">"Before you install"</a> earlier in this topic.
</p><p>After you make your choice, click <b>Next</b>.
</p><p>If you specify <b>Local System</b>, the installer skips the second screen and takes you directly to the "Enable Windows Inputs" dialog.
</p><p>If you specify <b>Domain account</b>, the installer takes you to a second dialog, where you need to enter domain and user information for this instance of the universal forwarder. The universal forwarder will run as the user you specify in this dialog.
</p><p><img alt="62 UFInstaller Entercreds.png" src="images/a/ae/62_UFInstaller_Entercreds.png" width="300" height="232"></p><p><b>Important:</b> You must specify the user name in <code><font size="2">domain\username</font></code> format. Failure to include the domain name when specifying the user will cause the installation to fail.
</p><p>On the second dialog, at the bottom, there is a checkbox labeled "Add user as local administrator". When the checkbox is checked (the default), the installer adds the domain user you specified to the local Administrators group. When the checkbox is not checked, the universal forwarder installs in "low-privilege" mode. This mode is available for customers that cannot or do not want to run programs as an administrator on servers. Read "Run the universal forwarder in low-privilege mode" later in this topic for additional information and caveats.
</p><p>To enable a normal installation as a user with local administrative privileges, leave the box checked.
</p><p><b>Important:</b> In many cases, the user you specify must have specific rights assigned to it prior to completing the installation. Failure to do so might result in a failed installation. Read <a href="#deployawindowsdfmanually_before_you_install" class="external text">"Before you install"</a> earlier in this topic for specific information and links to step-by-step instructions.
</p><p><b>Note:</b> This dialog only appears if you previously specified a receiving indexer (in the previous step).
</p><p><b>6a. "Enable Windows Inputs" dialog</b>
</p><p><img alt="62 UFInstaller EnableInputs.png" src="images/7/7c/62_UFInstaller_EnableInputs.png" width="300" height="233"></p><p>Select one or more Windows inputs from the list. 
</p><p>This step is optional. You can enable inputs later, by editing <code><font size="2">inputs.conf</font></code> within the universal forwarder directory.
</p><p><b>Note:</b> Read "Considerations for enabling data inputs in the installer" later in this topic about what happens when you enable inputs in this dialog.
</p><p><b>6b. "Splunk Add-on for Windows" dialog</b>
</p><p><img alt="62 UFInstaller Splunk TA Windows.png" src="images/3/3d/62_UFInstaller_Splunk_TA_Windows.png" width="300" height="232"></p><p>If you select any of the Windows inputs that the installer dialog shows you, the installer brings up the "Choose the Splunk Add-on for Windows" dialog.
</p><p>In this dialog: 
</p>
<ul><li> Choose "Install the SPlunk Add-on for Microsoft Windows included with this installer" if you do not already have a copy of the Splunk Add-on for Windows installed on the local machine. Or,
</li><li> Choose "Install an existing local copy of the Splunk Add-on for Microsoft Windows" if you have a local copy of the add-on installed on the machine, or if you have downloaded a more recent version from Splunkbase].
</li></ul><p>If you chose "Install an existing copy" above, locate the installed copy on your system by clicking the <b>Browse</b> button.
</p><p>Once you have completed your selection, click <b>Next</b>.
</p><p><b>Note:</b> This dialog only appears if you previously selected an input in the input selection page.
</p><p><b>7. "Specify a Deployment Server" dialog</b> 
</p><p><img alt="62 UFInstaller DeploymentServer.png" src="images/9/9c/62_UFInstaller_DeploymentServer.png" width="300" height="232"></p><p>Enter the hostname or IP address and management port for your deployment server. The default management port is 8089. Skip this step if using Splunk Cloud, unless you have an on-premises Deployment Server.
</p><p>You can use the <b>deployment server</b> to push configuration updates to the universal forwarder. See "About deployment server" in the Updating Splunk Enterprise Instances manual for details.
</p><p><b>Note:</b> This step is optional, but if you skip it, you should enter a receiving indexer in step 6; otherwise, the universal forwarder does not do anything, as it does not have any way of determining which indexer to forward data to. You can configure the forwarder with configuration files later.
</p><p><b>8.  "Specify Receiving Indexer" dialog</b>
</p><p><img alt="62 UFInstaller Receiver.png" src="images/e/ea/62_UFInstaller_Receiver.png" width="300" height="232"></p><p>Enter the hostname or IP address and <b>receiving port</b> of the receiving indexer (receiver). For information on setting up a receiver, see <a href="#enableareceiver" class="external text">"Enable a receiver"</a>. Skip this step if using Splunk Cloud. 
</p><p><b>Note:</b> This step is optional, but if you skip it, you should enter a deployment server in step 5; otherwise, the universal forwarder does not do anything, as it does not have any way of determining which indexer to forward to. A popup message appears which notes this. You can configure the forwarder with configuration files later.
</p><p><b>9. "Ready to Install the Program" dialog</b>
</p><p><img alt="62 UFInstaller Summary.png" src="images/5/56/62_UFInstaller_Summary.png" width="300" height="232"></p><p>Click <b>Install</b> to proceed.
</p><p>The installer runs and displays the <b>Installation Completed</b> dialog. 
</p><p><img alt="62 UFInstaller Complete.png" src="images/6/6a/62_UFInstaller_Complete.png" width="300" height="232"></p><p>Once the installation is complete, the universal forwarder automatically starts. <code><font size="2">SplunkForwarder</font></code> is the name of the universal forwarder service. You should confirm that it is running.
</p>
<h3> <a name="deployawindowsdfmanually_considerations_for_enabling_data_inputs_in_the_installer"><span class="mw-headline" id="Considerations_for_enabling_data_inputs_in_the_installer">Considerations for enabling data inputs in the installer</span></a></h3>
<p>If you enable data inputs when installing the universal forwarder, the installer saves the configuration that enables those inputs into the Splunk Add-on for Windows that comes with the installer. 
</p><p>This configuration includes index definitions. This means that the indexer that this forwarder sends data to must already have those indexes defined. The indexes are:
</p>
<ul><li> <code><font size="2">perfmon</font></code> for Performance Monitoring inputs.
</li><li> <code><font size="2">windows</font></code> for generic Windows inputs.
</li><li> <code><font size="2">wineventlog</font></code> for Windows Event Log inputs.
</li></ul><p>If you have not defined those indexes, do so prior to performing a universal forwarder installation. A Splunk best practice is to install the Splunk Add-on for Windows onto indexers that receive forwarded data.
</p>
<h3> <a name="deployawindowsdfmanually_install_the_universal_forwarder_in_.22low-privilege.22_mode"><span class="mw-headline" id="Install_the_universal_forwarder_in_.22low-privilege.22_mode">Install the universal forwarder in "low-privilege" mode</span></a></h3>
<p>When you specify a domain user and choose not to give that user local administrator rights, the forwarder installs and runs in "low-privilege" mode.
</p><p>There are some caveats to doing so:
</p>
<ul><li> You do not have administrative access to any resources on either the server or the domain when you run the universal forwarder in low-privilege mode.
</li><li> You might need to add the domain user to additional domain groups in order to access remote resources. Additionally, you might need to add the user to local groups to access local resources that only privileged users would have access to.
</li><li> You cannot collect Windows Management Instrumentation (WMI) data as a non-admin user. 
</li></ul><h3> <a name="deployawindowsdfmanually_test_the_deployment"><span class="mw-headline" id="Test_the_deployment"> Test the deployment </span></a></h3>
<p>Test your configured universal forwarder on a single machine, to make sure it functions correctly, before deploying the universal forwarder across your environment. Confirm that the universal forwarder is getting the desired inputs and sending the right outputs to the indexer. You can use the deployment monitor to validate the universal forwarder.
</p><p>If you migrated from an existing forwarder, make sure that the universal forwarder is forwarding data from where the old forwarder left off. If it isn't, you need to modify or add data inputs, so that they conform to those on the old forwarder. 
</p><p><b>Important:</b> Migration does not automatically copy any configuration files. You must set those up yourself. The usual way to do this is to copy the files, including <code><font size="2">inputs.conf</font></code>, from the old forwarder to the universal forwarder. Compare the <code><font size="2">inputs.conf</font></code> files on the universal forwarder and the old forwarder to ensure that the universal forwarder has all the inputs that you want to maintain.
</p><p>If you migrated from an existing forwarder, you can delete that old instance once your universal forwarder has been thoroughly tested and you're comfortable with the results.
</p>
<h3> <a name="deployawindowsdfmanually_perform_additional_configuration"><span class="mw-headline" id="Perform_additional_configuration"> Perform additional configuration </span></a></h3>
<p>You can update your universal forwarder's configuration, post-installation, by directly editing its configuration files, such as <code><font size="2">inputs.conf</font></code> and <code><font size="2">outputs.conf</font></code>. You can also update the configuration using the CLI. See <a href="#deploymentoverview_general_configuration_issues" class="external text">"Deployment overview"</a> for information. 
</p><p><b>Note:</b> When you use the CLI, you might need to authenticate into the forwarder to complete commands. The default credentials for a universal forwarder are:
</p><p><b>Username:</b> admin<br><b>Password:</b> changeme
</p><p>For information on distributing configuration changes across multiple universal forwarders, see "About deployment server" in the Updating Splunk Enterprise Instances manual.
</p>
<h3> <a name="deployawindowsdfmanually_deploy_the_universal_forwarder_across_your_environment"><span class="mw-headline" id="Deploy_the_universal_forwarder_across_your_environment"> Deploy the universal forwarder across your environment </span></a></h3>
<p>If you need just a few universal forwarders, you might find it simpler just to repeat the manual installation process, as documented in this topic. If you need to install a larger number of universal forwarders, it will probably be easier to deploy them <a href="#remotelydeployawindowsdfwithastaticconfiguration" class="external text">remotely with a deployment tool</a> or else <a href="#makeadfpartofasystemimage" class="external text">as part of a system image or virtual machine</a>.
</p>
<h3> <a name="deployawindowsdfmanually_uninstall_the_universal_forwarder"><span class="mw-headline" id="Uninstall_the_universal_forwarder"> Uninstall the universal forwarder </span></a></h3>
<p>To uninstall the universal forwarder, perform the following steps:
</p><p><b>1.</b> Use the Services MMC snap-in (<b>Start &gt; Administrative Tools &gt; Services</b>) to stop the <code><font size="2">SplunkForwarder</font></code> service.
</p><p><b>Note:</b> You can also stop the service from the command line with the following command:
</p>
<div class="samplecode">
<code><font size="2">NET STOP SplunkForwarder</font></code>
</div>
<p><b>2.</b> Next, use the <b>Add or Remove Programs</b> control panel to uninstall the forwarder. On Windows 7, 8, Server 2008, and Server 2012, that option is available under <b>Programs and Features.</b>
</p><p><b>Note:</b> Under some circumstances, the Microsoft installer might present a reboot prompt during the uninstall process. You can safely ignore this request without rebooting.
</p>
<a name="deployawindowsdfviathecommandline"></a><h2> <a name="deployawindowsdfviathecommandline_deploy_a_windows_universal_forwarder_via_the_command_line"><span class="mw-headline" id="Deploy_a_Windows_universal_forwarder_via_the_command_line"> Deploy a Windows universal forwarder via the command line</span></a></h2>
<p>This topic describes how to install, configure, and deploy the universal forwarder in a Windows environment using the command line interface. If you prefer to use a GUI installer, see <a href="#deployawindowsdfmanually" class="external text">"Deploy a Windows universal forwarder via the installer GUI"</a>. 
</p>
<h3> <a name="deployawindowsdfviathecommandline_when_to_install_from_the_command_line.3f"><span class="mw-headline" id="When_to_install_from_the_command_line.3F"> When to install from the command line?</span></a></h3>
<p>You can manually install the universal forwarder on individual machines from a command prompt or PowerShell window. Here are some scenarios where installing from the command line is useful:
</p>
<ul><li> You want to install the forwarder, but don't want it to start right away.
</li><li> You want to automate installation of the forwarder with a script.
</li><li> You want to install the forwarder on a system that you will clone later.
</li><li> You want to use a deployment tool such as Group Policy or System Center Configuration Manager.
</li><li> You run a version of Windows Server Core.
</li></ul><p>Read the following topics for additional information on installing universal forwarders:
</p>
<ul><li> "<a href="#deploymentoverview" class="external text">Deployment overview</a>" for basics on universal forwarders. 
</li><li> "<a href="#remotelydeployawindowsdfwithastaticconfiguration" class="external text">Remotely deploy a Windows universal forwarder with a static configuration</a>" for detailed information on using the command line interface with a deployment tool. 
</li></ul><h3> <a name="deployawindowsdfviathecommandline_steps_to_deployment"><span class="mw-headline" id="Steps_to_deployment"> Steps to deployment </span></a></h3>
<p>Once you have downloaded the universal forwarder and have planned your deployment, as described in <a href="#deploymentoverview" class="external text">"Deployment overview"</a>, perform these steps:
</p><p><b>1.</b> Install the universal forwarder (with optional configuration).
</p><p><b>2.</b> Test and tune the deployment.
</p><p><b>3.</b> Perform any post-installation configuration.
</p><p><b>4.</b> Deploy the universal forwarder across your environment.
</p>
<h3> <a name="deployawindowsdfviathecommandline_before_you_install"><span class="mw-headline" id="Before_you_install"> Before you install </span></a></h3>
<h4><font size="3"><b><i> <a name="deployawindowsdfviathecommandline_choose_the_windows_user_the_universal_forwarder_should_run_as"><span class="mw-headline" id="Choose_the_Windows_user_the_universal_forwarder_should_run_as"> Choose the Windows user the universal forwarder should run as </span></a></i></b></font></h4>
<p>When you install the universal forwarder, you can select the user it should run as. By default, the user is Local System. To specify a domain account, use the flags <code><font size="2">LOGON_USERNAME</font></code> and <code><font size="2">LOGON_PASSWORD</font></code>, described later in this topic.
</p><p>You can also install the forwarder as a user who is not an administrator on the local machine. Use the <code><font size="2">SET_ADMIN_USER</font></code> installation flag to install the forwarder in "low privilege" mode.
</p><p>If you install the forwarder as the Local System user, the forwarder can collect any kind of data that is available on the local machine. It cannot, however, collect data from other machines. This is by design.
</p><p>You must give the universal forwarder a user account if you intend to do any of the following:
</p>
<ul><li> Read Event Logs remotely
</li><li> Collect performance counters remotely
</li><li> Read network shares for log files 
</li><li> Enumerate the Active Directory schema, using Active Directory monitoring
</li></ul><p>Read "Choose the Windows user Splunk should run as" in the Installation Manual for concepts and procedures on the user requirements that must be in place before you collect remote Windows data.
</p><p><b>Important:</b> You must choose - and configure - the user that Splunk runs as before attempting to install a universal forwarder for remote Windows data collection. Failure to do so can result in a failed installation.
</p>
<h4><font size="3"><b><i> <a name="deployawindowsdfviathecommandline_configure_your_windows_environment_prior_to_installation"><span class="mw-headline" id="Configure_your_Windows_environment_prior_to_installation"> Configure your Windows environment prior to installation </span></a></i></b></font></h4>
<p>To configure your Windows environment for the proper installation of the forwarder, follow these steps:
</p><p><b>1.</b> Create and configure security groups with the user you want the universal forwarder to run as.
</p><p><b>2.</b> Optionally, configure the universal forwarder account as a managed service account.
</p><p><b>3.</b> Create and configure Group Policy or Local Security Policy objects for user rights assignments.
</p><p><b>4.</b> Assign appropriate security settings.
</p><p><b>5.</b> If using Active Directory, deploy the Group Policy object(s) with the updated settings to the appropriate objects.
</p><p><b>Note:</b> These steps are high-level procedures only. For step-by-step instructions, read "Prepare your Windows network for a Splunk Enterprise installation as a network or domain user" in the Installation Manual.
</p>
<h3> <a name="deployawindowsdfviathecommandline_install_the_universal_forwarder"><span class="mw-headline" id="Install_the_universal_forwarder"> Install the universal forwarder </span></a></h3>
<p>You install the universal forwarder from the command line by invoking <code><font size="2">msiexec.exe</font></code>, the Microsoft installer program.
</p><p>For 32-bit platforms, use <code><font size="2">splunkuniversalforwarder-&lt;...&gt;-x86-release.msi</font></code>:
</p>
<code><font size="2"><br>msiexec.exe /i splunkuniversalforwarder-&lt;...&gt;-x86-release.msi [&lt;flag&gt;]... [/quiet]<br></font></code>
<p>For 64-bit platforms, use <code><font size="2">splunkuniversalforwarder-&lt;...&gt;-x64-release.msi</font></code>:
</p>
<code><font size="2"><br>msiexec.exe /i splunkuniversalforwarder-&lt;...&gt;-x64-release.msi [&lt;flag&gt;]... [/quiet]<br></font></code>
<p>The value of <code><font size="2">&lt;...&gt;</font></code> varies according to the particular release; for example, <code><font size="2">splunkuniversalforwarder-4.2-86454-x64-release.msi</font></code>.
</p><p><b>Important:</b> We do not recommend that you run the 32-bit version of the universal forwarder on a 64-bit platform.
</p><p>Command line flags allow you to configure your forwarder at installation time. Using command line flags, you can specify a number of settings, including:
</p>
<ul><li> The user the universal forwarder runs as. (Be sure the user you specify has the appropriate permissions to access the content you want to forward.)
</li><li> Whether or not the forwarder runs in "low-privilege" mode - as a user who does not have local administrative access.
</li><li> The receiving Splunk Enterprise instance that the universal forwarder will send data to. 
</li><li> A deployment server for updating the configuration.
</li><li> The Windows event logs to index.
</li><li> Whether the universal forwarder should start automatically when the installation is completed.
</li></ul><p>The following sections list the flags available and provide a few examples of various configurations. 
</p>
<h3> <a name="deployawindowsdfviathecommandline_list_of_supported_flags"><span class="mw-headline" id="List_of_supported_flags">List of supported flags</span></a></h3>
<p><b>Important:</b> The installer for the full version of Splunk Enterprise is a separate executable, with its own installation flags. See "Install on Windows" in the Installation Manual.
</p>
<table cellpadding="5" cellspacing="0" border="1"><tr><th width="30%" bgcolor="#C0C0C0"> Flag
</th><th width="50%" bgcolor="#C0C0C0"> What it's for
</th><th width="20%" bgcolor="#C0C0C0"> Default
</th></tr><tr><td valign="top" width="30%" align="left"> <code><font size="2">AGREETOLICENSE=Yes|No</font></code>
</td><td valign="top" width="50%" align="left"> Use this flag to agree to the EULA. This flag must be set to <code><font size="2">Yes</font></code> for a silent installation.
</td><td valign="top" width="20%" align="left"> <code><font size="2">No</font></code>
</td></tr><tr><td valign="top" align="left"> <code><font size="2">INSTALLDIR="&lt;directory_path&gt;"</font></code>
</td><td valign="top" align="left"> Specifies the installation directory.
<p><b>Important:</b> Do <b>not</b> install the universal forwarder over an existing installation of full Splunk Enterprise.
</p>
</td><td valign="top" align="left"> <code><font size="2">c:\Program Files\SplunkUniversalForwarder</font></code>
</td></tr><tr><td valign="top" align="left"> <code><font size="2">LOGON_USERNAME="&lt;domain\username&gt;"</font></code>
<p><code><font size="2">LOGON_PASSWORD="&lt;pass&gt;"</font></code> 
</p>
</td><td valign="top" align="left"> Use these flags to provide domain\username and password information for the user to run the <code><font size="2">SplunkForwarder</font></code> service. You must specify the domain with the username in the format: <code><font size="2">domain\username</font></code>. If you don't include these flags, the universal forwarder installs as the Local System user. See "Choose the Windows user Splunk should run as".
</td><td valign="top" align="left"> n/a
</td></tr><tr><td valign="top" align="left"> <code><font size="2">RECEIVING_INDEXER="&lt;host:port&gt;"</font></code>
</td><td valign="top" align="left"> Use this flag to specify the receiving indexer to which the universal forwarder will forward data. Enter the name (hostname or IP address) and <b>receiving port</b> of the receiver. This flag accepts only a single receiver. To specify multiple receivers (to implement load balancing), you must instead configure this setting through the CLI or <code><font size="2">outputs.conf</font></code>.
<p>For information on setting up a receiver, see <a href="#enableareceiver" class="external text">"Enable a receiver"</a>.
<b>Note:</b> This flag is optional, but if you don't specify it and also don't specify <code><font size="2">DEPLOYMENT_SERVER</font></code>, the universal forwarder will be unable to function, as it will not have any way of determining which indexer to forward to. 
</p>
</td><td valign="top" align="left"> n/a
</td></tr><tr><td valign="top" align="left"> <code><font size="2">DEPLOYMENT_SERVER="&lt;host:port&gt;"</font></code>
</td><td valign="top" align="left"> Use this flag to specify a <b>deployment server</b> for pushing configuration updates to the universal forwarder. Enter the deployment server's name (hostname or IP address) and port.
<p><b>Note:</b> This flag is optional, but if you don't specify it and also don't specify <code><font size="2">RECEIVING_INDEXER</font></code>, the universal forwarder will be unable to function, as it will not have any way of determining which indexer to forward to. 
</p>
</td><td valign="top" align="left"> n/a
</td></tr><tr><td valign="top" align="left"> <code><font size="2">LAUNCHSPLUNK=1|0</font></code>
</td><td valign="top" align="left"> Use this flag to specify whether the universal forwarder should be configured to launch automatically when the installation finishes.
</td><td valign="top" align="left"> 1 (yes)
</td></tr><tr><td valign="top" align="left"> <code><font size="2">SERVICESTARTTYPE=auto|manual</font></code>
</td><td valign="top" align="left"> Use this flag to specify whether the universal forwarder should start automatically when the system reboots.
<p><b>Note:</b> By setting <code><font size="2">LAUNCHSPLUNK</font></code> to 0 and <code><font size="2">SERVICESTARTTYPE</font></code> to auto, you will cause the universal forwarder to not start forwarding until the next system boot. This is useful when cloning a system image. 
</p>
</td><td valign="top" align="left"> auto
</td></tr><tr><td valign="top" align="left"> <code><font size="2">MONITOR_PATH="&lt;directory_path&gt;" </font></code>
</td><td valign="top" align="left"> Use this flag to specify a file or directory to monitor.
</td><td valign="top" align="left"> n/a
</td></tr><tr><td valign="top" align="left">
<p><br></p><p><br><code><font size="2">WINEVENTLOG_APP_ENABLE=1|0</font></code>
</p><p><code><font size="2">WINEVENTLOG_SEC_ENABLE=1|0</font></code>
</p><p><code><font size="2">WINEVENTLOG_SYS_ENABLE=1|0</font></code>
</p><p><code><font size="2">WINEVENTLOG_FWD_ENABLE=1|0</font></code>
</p><p><code><font size="2">WINEVENTLOG_SET_ENABLE=1|0</font></code> 
</p>
</td><td valign="top" align="left"> Use these flags to enable these Windows event logs, respectively:
<p>application
</p><p>security
</p><p>system
</p><p>forwarders
</p><p>setup 
</p><p><b>Note:</b> You can specify multiple flags.
</p>
</td><td valign="top" align="left"> 0 (no)
</td></tr><tr><td valign="top" align="left"> <code><font size="2">PERFMON=&lt;input_type&gt;,&lt;input_type&gt;,...</font></code>
</td><td valign="top" align="left"> Use this flag to enable  perfmon inputs. <code><font size="2">&lt;input_type&gt;</font></code> can be any of these:
<p><code><font size="2">cpu</font></code>
<code><font size="2">memory</font></code>
<code><font size="2">network</font></code>
<code><font size="2">diskspace</font></code>
</p>
</td><td valign="top" align="left"> n/a
</td></tr><tr><td valign="top" align="left"> <code><font size="2">ENABLEADMON=1|0</font></code>
</td><td valign="top" align="left"> Use this flag to enable Active Directory monitoring for a remote deployment.
</td><td valign="top" align="left"> 0 (not enabled)
</td></tr><tr><td valign="top" align="left">
<p><br><code><font size="2">CERTFILE=&lt;c:\path\to\certfile.pem&gt;</font></code> 
</p><p><code><font size="2">ROOTCACERTFILE=&lt;c:\path\to\rootcacertfile.pem&gt;</font></code>
</p><p><code><font size="2">CERTPASSWORD=&lt;password&gt;</font></code>
</p>
</td><td valign="top" align="left"> Use these flags to supply SSL certificates:
<p>Path to the cert file that contains the public/private key pair.
</p><p>Path to the file that contains the Root CA cert for verifying CERTFILE is legitimate (optional).
</p><p>Password for private key of CERTFILE (optional).
</p><p><b>Note:</b> These flags require that you set <code><font size="2">RECEIVING_INDEXER</font></code> for them to have any effect.
</p>
</td><td valign="top" align="left"> n/a
</td></tr><tr><td valign="top" align="left"> <code><font size="2">CLONEPREP=1|0</font></code>
</td><td valign="top" align="left"> Deletes any instance-specific data in preparation for creating a clone of a machine. This invokes the <code><font size="2">splunk clone-prep</font></code> command from the CLI.
</td><td valign="top" align="left"> 0 (do not prepare the instance for cloning.)
</td></tr><tr><td valign="top" align="left"> <code><font size="2">SET_ADMIN_USER=1|0</font></code>
</td><td valign="top" align="left"> Specifies whether or not the user you specify is an administrator. If you set this flag to 0, it allows the universal forwarder to run in "low-privilege" mode - as a user without administrator privileges on the local machine. This mode is available for customers that do not have the ability to run programs as an administrator on servers. Read "Run the universal forwarder in low-privilege mode" later in this topic for additional information and caveats.
<p><b>Important:</b> This flag requires that you set both the <code><font size="2">LOGON_USERNAME</font></code> and <code><font size="2">LOGON_PASSWORD</font></code> flags. The installer ignores this flag if you install the forwarder as "Local System", which is the default if you do not specify these flags.
</p>
</td><td valign="top" align="left"> 1 (Install the universal forwarder as a user with administrative privileges. The universal forwarder runs in normal mode and not "low-privilege" mode.)
</td></tr></table><h3> <a name="deployawindowsdfviathecommandline_install_the_universal_forwarder_in_.22low-privilege.22_mode"><span class="mw-headline" id="Install_the_universal_forwarder_in_.22low-privilege.22_mode">Install the universal forwarder in "low-privilege" mode</span></a></h3>
<p>When you set the <code><font size="2">LOGON_USERNAME</font></code> and <code><font size="2">LOGON_PASSWORD</font></code> flags and specify <code><font size="2">SET_ADMIN_USER=0</font></code>, the forwarder installs and runs in "low-privilege" mode. This means that the user you specify does not need to have administrative privileges on the server that runs the forwarder.
</p><p>There are some caveats to doing so:
</p>
<ul><li> You do not have administrative access to any resources on either the server or the domain when you run the universal forwarder in low-privilege mode.
</li><li> You might need to add the domain user to additional domain groups in order to access remote resources. Additionally, you might need to add the user to local groups to access local resources that only privileged users would have access to.
</li><li> You cannot collect Windows Management Instrumentation (WMI) data as a non-admin user. 
</li></ul><h3> <a name="deployawindowsdfviathecommandline_install_the_universal_forwarder_silently"><span class="mw-headline" id="Install_the_universal_forwarder_silently">Install the universal forwarder silently</span></a></h3>
<p>To run the installation silently, add <code><font size="2">/quiet</font></code> to the end of your installation command string. You must also set the <code><font size="2">AGREETOLICENSE=Yes</font></code> flag.
</p><p>If your system has UAC enabled (the default on some systems), you must run the installation as Administrator. To do this, when opening a commandd prompt, right click and select "Run As Administrator". Then use the command prompt to run the silent install command.
</p>
<h3> <a name="deployawindowsdfviathecommandline_enable_verbose_logging_during_installation"><span class="mw-headline" id="Enable_verbose_logging_during_installation">Enable verbose logging during installation</span></a></h3>
<p>To provide verbose logging during a universal forwarder installation, use the <code><font size="2">/l</font></code> option provided by <code><font size="2">msiexec</font></code> Review the examples below for details.
</p>
<h3> <a name="deployawindowsdfviathecommandline_examples"><span class="mw-headline" id="Examples">Examples</span></a></h3>
<p>The following are some examples of using different flags.
</p>
<h4><font size="3"><b><i> <a name="deployawindowsdfviathecommandline_install_the_universal_forwarder_to_run_as_the_local_system_user_and_request_configuration_from_deploymentserver1"><span class="mw-headline" id="Install_the_universal_forwarder_to_run_as_the_Local_System_user_and_request_configuration_from_deploymentserver1">Install the universal forwarder to run as the Local System user and request configuration from deploymentserver1</span></a></i></b></font></h4>
<p>You might do this for new deployments of the forwarder.
</p>
<div class="samplecode"><code><font size="2"><br>msiexec.exe /i splunkuniversalforwarder_x86.msi DEPLOYMENT_SERVER="deploymentserver1:8089" AGREETOLICENSE=Yes /quiet<br></font></code></div>
<h4><font size="3"><b><i> <a name="deployawindowsdfviathecommandline_install_the_universal_forwarder_to_run_as_a_domain_user.2c_but_do_not_launch_it_immediately"><span class="mw-headline" id="Install_the_universal_forwarder_to_run_as_a_domain_user.2C_but_do_not_launch_it_immediately">Install the universal forwarder to run as a domain user, but do not launch it immediately </span></a></i></b></font></h4>
<p>You might do this when preparing a sample host for cloning.
</p>
<div class="samplecode"><code><font size="2"><br>msiexec.exe /i splunkuniversalforwarder_x86.msi LOGON_USERNAME="AD\splunk" LOGON_PASSWORD="splunk123" DEPLOYMENT_SERVER="deploymentserver1:8089" LAUNCHSPLUNK=0 AGREETOLICENSE=Yes /quiet<br></font></code></div>
<h4><font size="3"><b><i> <a name="deployawindowsdfviathecommandline_install_the_universal_forwarder.2c_enable_indexing_of_the_windows_security_and_system_event_logs.2c_and_run_the_installer_in_silent_mode"><span class="mw-headline" id="Install_the_universal_forwarder.2C_enable_indexing_of_the_Windows_security_and_system_event_logs.2C_and_run_the_installer_in_silent_mode">Install the universal forwarder, enable indexing of the Windows security and system event logs, and run the installer in silent mode</span></a></i></b></font></h4>
<p>You might do this to collect just the Security and System event logs through a "fire-and-forget" installation.
</p>
<div class="samplecode"><code><font size="2"><br>msiexec.exe /i splunkuniversalforwarder_x86.msi RECEIVING_INDEXER="indexer1:9997" WINEVENTLOG_SEC_ENABLE=1 WINEVENTLOG_SYS_ENABLE=1 AGREETOLICENSE=Yes /quiet<br></font></code></div>
<h4><font size="3"><b><i> <a name="deployawindowsdfviathecommandline_install_the_universal_forwarder_in_low-privilege_mode_and_enable_verbose_installation_logging_to_a_log_file"><span class="mw-headline" id="Install_the_universal_forwarder_in_low-privilege_mode_and_enable_verbose_installation_logging_to_a_log_file">Install the universal forwarder in low-privilege mode and enable verbose installation logging to a log file</span></a></i></b></font></h4>
<p>You might do this when you need to run the forwarder as a user who does not have administrative privileges on the local server.
</p>
<div class="samplecode"><code><font size="2"><br>msiexec.exe /i splunkuniversalforwarder_x64.msi /l*v install_splunkforwarder-6.1-201357-x64-release.msi.log LOGON_USERNAME=adtest1\lowpriv-testuser LOGON_PASSWORD=win1@splunk <br>AGREETOLICENSE=Yes SET_ADMIN_USER=0 /quiet<br></font></code></div>
<h3> <a name="deployawindowsdfviathecommandline_test_the_deployment"><span class="mw-headline" id="Test_the_deployment"> Test the deployment </span></a></h3>
<p>Test your configured universal forwarder on a single machine, to make sure it functions correctly, before deploying the universal forwarder across your environment. Confirm that the universal forwarder is getting the desired inputs and sending the right outputs to the indexer. You can use the deployment monitor to validate the universal forwarder.
</p><p>If you migrated from an existing forwarder, make sure that the universal forwarder is forwarding data from where the old forwarder left off. If it isn't, you probably need to modify or add data inputs, so that they conform to those on the old forwarder. 
</p><p><b>Important:</b> Migration does not automatically copy any configuration files; you must set those up yourself. The usual way to do this is to copy the files, including <code><font size="2">inputs.conf</font></code>, from the old forwarder to the universal forwarder. Compare the <code><font size="2">inputs.conf</font></code> files on the universal forwarder and the old forwarder to ensure that the universal forwarder has all the inputs that you want to maintain.
</p><p>If you migrated from an existing forwarder, you can delete that old instance once your universal forwarder has been thoroughly tested and you're comfortable with the results.
</p>
<h3> <a name="deployawindowsdfviathecommandline_perform_additional_configuration"><span class="mw-headline" id="Perform_additional_configuration"> Perform additional configuration </span></a></h3>
<p>You can update your universal forwarder's configuration, post-installation, by directly editing its configuration files, such as <code><font size="2">inputs.conf</font></code> and <code><font size="2">outputs.conf</font></code>. You can also update the configuration using the CLI. See <a href="#deploymentoverview_general_configuration_issues" class="external text">"Deployment overview"</a> for information. 
</p><p><b>Note:</b> When you use the CLI, you might need to authenticate into the forwarder to complete commands. The default credentials for a universal forwarder are:
</p><p><b>Username:</b> admin<br><b>Password:</b> changeme
</p><p>For information on distributing configuration changes across multiple universal forwarders, see "About deployment server" in the Updating Splunk Enterprise Instances manual.
</p>
<h3> <a name="deployawindowsdfviathecommandline_deploy_the_universal_forwarder_across_your_environment"><span class="mw-headline" id="Deploy_the_universal_forwarder_across_your_environment"> Deploy the universal forwarder across your environment </span></a></h3>
<p>If you need just a few universal forwarders, you might find it simpler just to repeat the command line installation process manually, as documented in this topic. If you need to install a larger number of universal forwarders, it will probably be easier to deploy them <a href="#remotelydeployawindowsdfwithastaticconfiguration" class="external text">remotely with a deployment tool</a> or else <a href="#makeadfpartofasystemimage" class="external text">as part of a system image or virtual machine</a>.
</p>
<h3> <a name="deployawindowsdfviathecommandline_uninstall_the_universal_forwarder"><span class="mw-headline" id="Uninstall_the_universal_forwarder"> Uninstall the universal forwarder </span></a></h3>
<p>To uninstall the universal forwarder, perform the following steps:
</p><p><b>1.</b> Stop the service from the command line with the following command:
</p>
<div class="samplecode">
<code><font size="2">NET STOP SplunkForwarder</font></code>
</div>
<p><b>Note:</b> You can also use the Services MMC snap-in (<b>Start &gt; Administrative Tools &gt; Services</b>) to stop the <code><font size="2">SplunkForwarder</font></code> service.
</p><p><b>2.</b> Next, run the Microsoft Installer to perform the uninstall:
</p>
<div class="samplecode">
<code><font size="2">msiexec /uninstall|x splunkuniversalforwarder-&lt;...&gt;-x86-release.msi</font></code>
</div>
<p>The installer has one supported flag that you can use during uninstallation:
</p>
<table cellpadding="5" cellspacing="0" border="1"><tr><th width="30%" bgcolor="#C0C0C0"> Flag
</th><th width="50%" bgcolor="#C0C0C0"> What it's for
</th><th width="20%" bgcolor="#C0C0C0"> Default
</th></tr><tr><td valign="top" align="left"> <code><font size="2">REMOVE_FROM_GROUPS=1|0</font></code>
</td><td valign="top" align="left"> <b>This flag is only available when uninstalling the universal forwarder.</b> Specifies whether or not to take away rights and administrative group membership from the user you installed the forwarder as.
<p>If you set this flag to 1, the installer takes away group membership and elevated rights from the user you installed the forwarder as.
</p><p>If you set this flag to 0, the installer does not take away group membership and elevated rights from the user
</p>
</td><td valign="top" align="left"> 1 (Take away elevated rights and group membership on uninstall.)
</td></tr></table><p><b>Note:</b> Under some circumstances, the Microsoft installer might present a reboot prompt during the uninstall process. You can safely ignore this request without rebooting.
</p>
<a name="remotelydeployawindowsdfwithastaticconfiguration"></a><h2> <a name="remotelydeployawindowsdfwithastaticconfiguration_remotely_deploy_a_windows_universal_forwarder_with_a_static_configuration"><span class="mw-headline" id="Remotely_deploy_a_Windows_universal_forwarder_with_a_static_configuration"> Remotely deploy a Windows universal forwarder with a static configuration</span></a></h2>
<p>You typically deploy the universal forwarder with a static configuration for one of these reasons:
</p>
<ul><li> You don't need to change the configuration later - "fire-and-forget".
</li><li> You'll be making any post-installation changes with a non-Splunk deployment tool such as System Center Configuration Manager, Altris, or BigFix/Tivoli.
</li></ul><p>For this type of deployment, you install via the Windows command line interface. During installation, you must specify all configuration options and use silent mode (<code><font size="2">/quiet</font></code>). See <a href="#deployawindowsdfviathecommandline" class="external text">"Deploy a Windows universal forwarder via the command line"</a> for information on the command line interface, including a list of supported flags, including those that enable low-privilege operation.
</p>
<h3> <a name="remotelydeployawindowsdfwithastaticconfiguration_steps_to_deployment"><span class="mw-headline" id="Steps_to_deployment"> Steps to deployment </span></a></h3>
<p>Once you have downloaded the universal forwarder and have planned your deployment, as described in <a href="#deploymentoverview" class="external text">"Deployment overview"</a>, perform these steps:
</p><p><b>1.</b> Install and configure the universal forwarder on a test machine, using the command line interface with the desired flags.
</p><p><b>2.</b> Test and tune the deployment.
</p><p><b>3.</b> Load the universal forwarder MSI into your deployment tool, specifying the tested flags.
</p><p><b>4.</b> Execute deployment with your deployment tool.
</p><p><b>5.</b> Use the deployment monitor to verify that the universal forwarders are functioning.
</p>
<h3> <a name="remotelydeployawindowsdfwithastaticconfiguration_required_installation_flags"><span class="mw-headline" id="Required_installation_flags">Required installation flags</span></a></h3>
<p>Besides specifying <code><font size="2">/quiet</font></code> mode, you must include, at a minimum, these commandline flags:
</p>
<ul><li> <code><font size="2">AGREETOLICENSE=Yes</font></code>
</li><li> <code><font size="2">RECEIVING_INDEXER="&lt;server:port&gt;"</font></code> 
</li><li> At least one data input flag, such as <code><font size="2">WINEVENTLOG_APP_ENABLE=1</font></code>. You can add as many data input flags as you need.
</li></ul><p>See <a href="#deployawindowsdfviathecommandline" class="external text">"Deploy a Windows universal forwarder via the command line"</a> for a list of all available command line flags.
</p>
<h3> <a name="remotelydeployawindowsdfwithastaticconfiguration_example_installation"><span class="mw-headline" id="Example_installation">Example installation</span></a></h3>
<p>This example sets the universal forwarder to run as Local System user, get inputs from Windows security and system event logs, send data to <code><font size="2">indexer1</font></code>, and launch automatically:
</p>
<div class="samplecode"><code><font size="2"><br>msiexec.exe /i splunkuniversalforwarder_x86.msi RECEIVING_INDEXER="indexer1:9997" WINEVENTLOG_SEC_ENABLE=1 WINEVENTLOG_SYS_ENABLE=1 AGREETOLICENSE=Yes /quiet<br></font></code></div>
<h3> <a name="remotelydeployawindowsdfwithastaticconfiguration_deploy_with_a_secure_configuration"><span class="mw-headline" id="Deploy_with_a_secure_configuration">Deploy with a secure configuration</span></a></h3>
<p>To deploy a secure configuration, you can specify an SSL certifcate. Use these installation flags:
</p>
<ul><li> <code><font size="2">CERTFILE=&lt;c:\path\to\certfile.pem&gt;</font></code>
</li><li> <code><font size="2">ROOTCACERTFILE=&lt;c:\path\to\rootcacertfile.pem&gt;</font></code>
</li><li> <code><font size="2">CERTPASSWORD=&lt;password&gt;</font></code>
</li></ul><p>For more information, see this <a href="#deployawindowsdfviathecommandline_list_of_supported_flags" class="external text">list of supported commandline flags</a>.
</p>
<h3> <a name="remotelydeployawindowsdfwithastaticconfiguration_test_the_deployment"><span class="mw-headline" id="Test_the_deployment"> Test the deployment </span></a></h3>
<p>Test your configured universal forwarder on a single machine, to make sure it functions correctly, before deploying the universal forwarder across your environment. Confirm that the universal forwarder is getting the desired inputs and sending the right outputs to the indexer. You can use the deployment monitor to validate the universal forwarder.
</p>
<a name="makeadfpartofasystemimage"></a><h2> <a name="makeadfpartofasystemimage_make_a_universal_forwarder_part_of_a_system_image"><span class="mw-headline" id="Make_a_universal_forwarder_part_of_a_system_image"> Make a universal forwarder part of a system image</span></a></h2>
<p>This topic describes how to deploy a universal forwarder as part of a system image or virtual machine. This is particularly useful if you have a large number of universal forwarders to deploy. If you have just a few, you might find it simpler to install them manually, as described for <a href="#deployawindowsdfmanually" class="external text">Windows</a> and <a href="#deployanixdfmanually" class="external text">nix machines</a>.
</p><p>Before following the procedures in this topic, read <a href="#deploymentoverview" class="external text">"Deployment overview"</a>.  
</p>
<h3> <a name="makeadfpartofasystemimage_steps_to_deployment"><span class="mw-headline" id="Steps_to_deployment"> Steps to deployment </span></a></h3>
<p>Once you have downloaded the universal forwarder and have planned your deployment, as described in <a href="#deploymentoverview" class="external text">"Deployment overview"</a>, perform these steps:
</p><p><b>1.</b> Install the universal forwarder on a test machine. See <a href="#makeadfpartofasystemimage_install_the_universal_forwarder" class="external text">below</a>.
</p><p><b>2.</b> Perform any post-installation configuration, as described below, <a href="#makeadfpartofasystemimage_perform_additional_configuration" class="external text">here</a>.
</p><p><b>3.</b> Test and tune the deployment, as described <a href="#makeadfpartofasystemimage_test_the_deployment" class="external text">below</a>.
</p><p><b>4.</b> Install the universal forwarder with the tested configuration onto a source machine.
</p><p><b>5.</b> Stop the universal forwarder.
</p><p><b>6.</b> Run this CLI command on the forwarder:
</p>
<code><font size="2"><br>./splunk clone-prep-clear-config<br></font></code>
<p>This clears instance-specific information, such as the server name and GUID, from the forwarder. This information will then be configured on each cloned forwarder at initial start-up.
</p><p><b>7.</b> Prep your image or virtual machine, as necessary, for cloning.
</p><p><b>8.</b> On *nix systems, set the splunkd daemon to start on boot using cron or your scheduling system of choice. On Windows, set the service to <code><font size="2">Automatic</font></code> but do not start it.
</p><p><b>9.</b> Distribute system image or virtual machine clones to machines across your environment and start them.
</p><p><b>10.</b> Use the deployment monitor to verify that the cloned universal forwarders are functioning.
</p>
<h3> <a name="makeadfpartofasystemimage_referenced_procedures"><span class="mw-headline" id="Referenced_procedures">Referenced procedures</span></a></h3>
<p>Steps in the above deployment procedure reference these subtopics.
</p>
<h4><font size="3"><b><i> <a name="makeadfpartofasystemimage_install_the_universal_forwarder"><span class="mw-headline" id="Install_the_universal_forwarder"> Install the universal forwarder </span></a></i></b></font></h4>
<p>Install the universal forwarder using the procedure specific to your operating system:
</p>
<ul><li> <b>To install on a *nix machine,</b> see <a href="#deployanixdfmanually" class="external text">"Deploy a nix universal forwarder manually"</a>.
</li></ul><ul><li> <b>For a Windows machine,</b> you can use the installer GUI or the command line interface. To install with the GUI, see <a href="#deployawindowsdfmanually" class="external text">"Deploy a Windows universal forwarder via the installer GUI"</a>. For information on the command line interface, see <a href="#deployawindowsdfviathecommandline" class="external text">"Deploy a Windows universal forwarder via the command line"</a>. 
</li></ul><p><b>Important:</b> On a Windows machine, if you do not want the universal forwarder to start immediately after installation, you <b>must</b> use the command line interface. Using the proper command line flags, you can configure the universal forwarder so that it does not start on the source machine when installed but does start automatically on the clones, once they're activated.
</p><p>At the time of installation, you can also configure the universal forwarder. See <a href="#deploymentoverview_general_configuration_issues" class="external text">"General configuration issues"</a> in the Deployment Overview.
</p>
<h4><font size="3"><b><i> <a name="makeadfpartofasystemimage_perform_additional_configuration"><span class="mw-headline" id="Perform_additional_configuration"> Perform additional configuration </span></a></i></b></font></h4>
<p>You can update your universal forwarder's configuration, post-installation, by directly editing its configuration files, such as <code><font size="2">inputs.conf</font></code> and <code><font size="2">outputs.conf</font></code>. See <a href="#deploymentoverview" class="external text">"Deployment overview"</a> for information.
</p><p>For information on distributing configuration changes across multiple universal forwarders, see "About deployment server" in the Updating Splunk Enterprise Instances manual.
</p>
<h4><font size="3"><b><i> <a name="makeadfpartofasystemimage_test_the_deployment"><span class="mw-headline" id="Test_the_deployment"> Test the deployment </span></a></i></b></font></h4>
<p>Test your configured universal forwarder on a single machine, to make sure it functions correctly, before deploying the universal forwarder across your environment. When testing the deployment, ask these questions:
</p><p><b>1. Do the data inputs that you configured in the forwarder collect the data you want?</b>
</p><p>If they don't:
</p>
<ul><li> Check the inputs.conf on the forwarder and confirm that the input stanzas are correct. For example, if you want to configure monitoring a file, confirm that the inputs.conf on the forwarder references that file.
</li><li> Confirm that the stanza that references the file is not disabled (look for 'disabled = 1' in the stanza.)
</li></ul><p><b>2. Does the forwarder send the data you expect to the place you expect it?</b>
</p><p>If it doesn't:
</p>
<ul><li> Confirm that the outputs.conf on the forwarder has been correctly configured. The outputs.conf file should reference a receiving indexer that the forwarder can access over the network via a host name or IP address and port that you specify.
</li><li> Confirm that no firewall blocks network traffic on the ports you specify on both the forwarder and receiver.
</li><li> Confirm that the ports you specify on the forwarder and receiver are the same, as they must be for forwarding to occur. For example, if you specify port 9997 as the receiving port on the indexer, you must specify this same port as the target in the outputs.conf configuration on the forwarder.
</li><li> Use the Search page on the receiving indexer to confirm that you see events that you configured on the forwarder.
</li></ul><a name="migrateawindowsforwarder"></a><h2> <a name="migrateawindowsforwarder_migrate_a_windows_light_forwarder"><span class="mw-headline" id="Migrate_a_Windows_light_forwarder"> Migrate a Windows light forwarder</span></a></h2>
<p>If you want to replace an existing light forwarder with a universal forwarder, you need to first migrate its checkpoint data to the new forwarder. Checkpoint data is internal data that the forwarder compiles to keep track of what data it has already forwarded to an indexer. By migrating the checkpoint data, you prevent the new universal forwarder from forwarding any data already sent by the old light forwarder. This ensures that the same data does not get indexed twice.
</p><p>You can migrate checkpoint data from an existing Windows light forwarder (version 4.0 or later) to the universal forwarder. For an overview of migration, see <a href="#deploymentoverview_migrating_from_a_light_forwarder" class="external text">"Migrating from a light forwarder"</a> in the Deployment Overview. 
</p><p>If you want to migrate, you must do so during the installation process. <b>You cannot migrate post-installation.</b> 
</p><p>You perform a Windows installation with either the installer GUI or the commandline:
</p>
<ul><li> <b>If you use the installer GUI,</b> one of the screens will prompt you to migrate. See <a href="#deployawindowsdfmanually" class="external text">"Deploy a Windows universal forwarder via the installer GUI"</a> for a walkthrough of the GUI installation procedure.
</li></ul><ul><li> <b>If you install via the commandline,</b> the flag <code><font size="2">MIGRATESPLUNK=1</font></code> specifies migration. See <a href="#deployawindowsdfviathecommandline" class="external text">"Deploy a Windows universal forwarder via the commandline"</a> for a list of supported flags and how to use them to configure your installation.
</li></ul><p><b>Important:</b> You must install the universal forwarder in a different directory from the existing light forwarder. Since the default install directory for the universal forwarder is <code><font size="2">C:\Program Files\SplunkUniversalForwarder</font></code> and the default install directory for full Splunk Enterprise (including the light forwarder) is <code><font size="2">C:\Program Files\Splunk</font></code>, you'll be safe if you just stick with the defaults.
</p>
<h4><font size="3"><b><i> <a name="migrateawindowsforwarder_what_the_installer_does"><span class="mw-headline" id="What_the_installer_does"> What the installer does </span></a></i></b></font></h4>
<p>Whichever installation method you use, the Windows installer performs the following actions:
</p><p><b>1.</b> Searches for an existing heavy or light forwarder on the machine.
</p><p><b>2.</b> Determines whether the forwarder is eligible for migration (must be at version 4.0 or above).
</p><p><b>3.</b> If it finds an eligible forwarder, the GUI offers the user the option of migrating. (The commandline installer looks to see whether the <code><font size="2">MIGRATESPLUNK=1</font></code> flag exists.)
</p><p><b>4.</b> If user specifies migration (or the <code><font size="2">MIGRATESPLUNK=1</font></code> flag exists), the installer shuts down any running services (splunkd and, if running, splunkweb) for the existing forwarder. It also sets the startup type of the services to manual, so that they don't start up again upon reboot.
</p><p><b>5.</b> Migrates the checkpoint files to the universal forwarder.
</p><p><b>6.</b> Completes installation and configuration of the universal forwarder.
</p>
<h4><font size="3"><b><i> <a name="migrateawindowsforwarder_what_you_need_to_do"><span class="mw-headline" id="What_you_need_to_do">What you need to do</span></a></i></b></font></h4>
<p>At the end of this process, you might want to perform additional configuration on the universal forwarder. Since the migration process only copies checkpoint files, you will probably want to manually copy over the old forwarder's <code><font size="2">inputs.conf</font></code> configuration file (or at least examine it, to determine what data inputs it was monitoring).
</p><p>Once the universal forwarder is up and running (and after you've tested to ensure migration worked correctly), you can uninstall the old forwarder.
</p>
<h1>Deploy nix universal forwarders</h1><a name="deployanixdfmanually"></a><h2> <a name="deployanixdfmanually_deploy_a_.2anix_universal_forwarder_manually"><span class="mw-headline" id="Deploy_a_.2Anix_universal_forwarder_manually"> Deploy a *nix universal forwarder manually</span></a></h2>
<p>This topic describes how to manually configure and deploy the universal forwarder in a *nix environment, such as Linux or Solaris. It assumes that you're installing directly onto the *nix machine, rather than using a deployment tool. This type of deployment best suits these needs:
</p>
<ul><li> small deployments
</li><li> proof-of-concept test deployments
</li><li> system image or virtual machine for eventual cloning
</li></ul><p>If you are interested in a different deployment scenario, look for another topic in this section that better fits your needs.
</p><p>Before following the procedures in this topic, read <a href="#deploymentoverview" class="external text">"Deployment overview"</a>. 
</p>
<h3> <a name="deployanixdfmanually_steps_to_deployment"><span class="mw-headline" id="Steps_to_deployment"> Steps to deployment </span></a></h3>
<p>Once you have downloaded the universal forwarder and have planned your deployment, as described in <a href="#deploymentoverview" class="external text">"Deployment overview"</a>, perform these steps:
</p><p><b>1.</b> Install the universal forwarder.
</p><p><b>2.</b> Configure (and optionally migrate) the universal forwarder.
</p><p><b>3.</b> Test and tune the deployment.
</p><p><b>4.</b> Perform any additional post-installation configuration.
</p>
<h3> <a name="deployanixdfmanually_install_the_universal_forwarder"><span class="mw-headline" id="Install_the_universal_forwarder"> Install the universal forwarder </span></a></h3>
<p>You can install the universal forwarder on a *nix machine using a package or a tar file. To install the universal forwarder on any of the supported *nix environments, see the set of topics for installing a full Splunk Enterprise instance in the <i>Installation Manual</i>:
</p>
<ul><li> Install on Linux
</li><li> Install on Solaris
</li><li> Install on Mac OS
</li><li> Install on FreeBSD
</li><li> Install on AIX
</li><li> Install on HP-UX
</li></ul><p>You install the universal forwarder the same way that you install a full Splunk Enterprise instance, as documented in these topics in the Installation manual. There are  only two differences:
</p>
<ul><li> The package name.
</li><li> The default installation directory.
</li></ul><h4><font size="3"><b><i> <a name="deployanixdfmanually_the_package_name"><span class="mw-headline" id="The_package_name">The package name</span></a></i></b></font></h4>
<p>When installing a package, substitute the name of the universal forwarder package for the full Splunk Enterprise package name used in the commands in the Installation manual. 
</p><p>For example, if installing the universal forwarder onto Red Hat Linux, use this command: 
</p>
<code><font size="2"><br>rpm -i splunkforwarder_&lt;package_name&gt;.rpm<br></font></code>
<p>instead of this command for a full Splunk Enterprise instance:
</p>
<code><font size="2"><br>rpm -i splunk_&lt;package_name&gt;.rpm<br></font></code>
<p>The only difference is the prefix to the package name: "splunkforwarder", instead of "splunk".
</p>
<h4><font size="3"><b><i> <a name="deployanixdfmanually_the_default_install_directory"><span class="mw-headline" id="The_default_install_directory">The default install directory</span></a></i></b></font></h4>
<p>The universal forwarder installs by default in <code><font size="2">/opt/splunkforwarder</font></code>. (The default install directory for full Splunk is <code><font size="2">/opt/splunk</font></code>.)
</p><p><b>Important:</b> Do <b>not</b> install the universal forwarder over an existing installation of full Splunk Enterprise.  This is particuarly vital if you will be migrating from a light forwarder as described in <a href="#migrateanixforwarder" class="external text">"Migrate a nix light forwarder"</a>.
</p>
<h3> <a name="deployanixdfmanually_configure_the_universal_forwarder"><span class="mw-headline" id="Configure_the_universal_forwarder"> Configure the universal forwarder </span></a></h3>
<p>The universal forwarder can run as any user on the local system. If you run the universal forwarder as a non-root user, make sure that it has the appropriate permissions to read the inputs that you specify. Refer to the instructions for running Splunk as a non-root user for more information.
</p><p>As part of configuration, you can migrate checkpoint settings from an existing forwarder to the universal forwarder. See <a href="#deploymentoverview" class="external text">"Deployment overview"</a>.
</p><p>Use the CLI to start and configure your universal forwarders.
</p>
<h4><font size="3"><b><i> <a name="deployanixdfmanually_start_the_universal_forwarder"><span class="mw-headline" id="Start_the_universal_forwarder">Start the universal forwarder </span></a></i></b></font></h4>
<p><b>Important:</b> If you want to migrate from an existing forwarder, you must perform a specific set of actions <i>before</i> you start the universal forwarder for the first time. See <a href="#migrateanixforwarder" class="external text">"Migrate a nix forwarder"</a> for details.
</p><p>To start the universal forwarder, run the following command from <code><font size="2">$SPLUNK_HOME/bin</font></code> directory (where <code><font size="2">$SPLUNK_HOME</font></code> is the directory into which you installed the universal forwarder):
</p>
<code><font size="2"><br>splunk start<br></font></code>
<h5> <a name="deployanixdfmanually_accept_the_license_agreement_automatically"><span class="mw-headline" id="Accept_the_license_agreement_automatically"> Accept the license agreement automatically </span></a></h5>
<p>The first time you start the universal forwarder after a new installation, you must accept the license agreement. To  start the universal forwarder and accept the license in one step:
</p>
<code><font size="2"><br>splunk start --accept-license<br></font></code>
<p><b>Note:</b> There are two dashes before the <code><font size="2">accept-license</font></code> option.
</p>
<h4><font size="3"><b><i> <a name="deployanixdfmanually_configuration_steps"><span class="mw-headline" id="Configuration_steps"> Configuration steps </span></a></i></b></font></h4>
<p>After you start the universal forwarder and accept the license agreement, follow these steps to configure it: 
</p><p><b>1.</b> Configure universal forwarder to auto-start:
</p>
<code><font size="2"><br>splunk enable boot-start<br></font></code>
<p><b>2.</b> Configure universal forwarder to act as a <b>deployment client</b> (optional). To do this, just specify the deployment server:
</p>
<code><font size="2"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;splunk set deploy-poll &lt;host&gt;:&lt;port&gt;<br></font></code>
<p>where:
</p>
<ul><li> <code><font size="2">&lt;host&gt;</font></code> is the deployment server's hostname or IP address and <code><font size="2">&lt;port&gt;</font></code> is the port it's listening on.
</li></ul><p>This step also automatically enables the deployment client functionality.
</p><p><b>3.</b> Configure the universal forwarder to forward to a specific receiving indexer, also known as the "receiver" (optional):
</p>
<code><font size="2"><br>splunk add forward-server &lt;host&gt;:&lt;port&gt; -auth &lt;username&gt;:&lt;password&gt;<br></font></code>
<p>where:
</p>
<ul><li> <code><font size="2">&lt;host&gt;</font></code> is the receiving indexer's hostname or IP address and <code><font size="2">&lt;port&gt;</font></code> is the port it's listening on. By convention, the receiver listens for forwarders on port 9997, but it can be set to listen on any port, so you'll need to check with the receiver's administrator to obtain the port number. For information on setting up a receiver, see <a href="#enableareceiver" class="external text">"Enable a receiver"</a>.
</li></ul><ul><li> <code><font size="2">&lt;username&gt;:&lt;password&gt;</font></code> is the username and password for logging into the forwarder. By default, these are "admin:changeme" (To set a different password than the default , issue the following command "splunk edit user admin -password &lt;new password&gt; -role admin -auth admin:changeme"). 
</li></ul><p>During this step, you can also configure a certificate for secure intra-Splunk communications, using a set of optional ssl flags to specify a certificate, root CA, and password. For example:
</p>
<code><font size="2"><br>splunk add forward-server &lt;host&gt;:&lt;port&gt; -ssl-cert-path /path/ssl.crt -ssl-root-ca-path /path/ca.crt -ssl-password &lt;password&gt;<br></font></code>
<p><b>Note:</b> If you do not specify a receiving indexer, be sure to configure universal forwarder to act as a deployment client, as described in step 2, so that it can later be configured for a receiving indexer.
</p><p><b>4.</b> To configure the universal forwarder's inputs, use the CLI <code><font size="2">add</font></code> command or edit <code><font size="2">inputs.conf</font></code>. See "About the CLI" and subsequent topics for details on using the CLI.
</p><p>For a complete list of CLI commands supported in the universal forwarder, see <a href="#supportedclicommands" class="external text">"Supported CLI commands"</a>.
</p>
<h3> <a name="deployanixdfmanually_test_the_deployment"><span class="mw-headline" id="Test_the_deployment"> Test the deployment </span></a></h3>
<p>Test your configured universal forwarder on a single machine, to make sure it functions correctly, before deploying the universal forwarder across your environment. Confirm that the universal forwarder is getting the desired inputs and sending the right outputs to the indexer.
</p><p>If you <a href="#migrateanixforwarder" class="external text">migrated from an existing forwarder</a>, make sure that the universal forwarder is forwarding data from where the old forwarder left off. If it isn't, you probably need to modify or add data inputs, so that they conform to those on the old forwarder. Examine the two <code><font size="2">inputs.conf</font></code> files to ensure that the new universal forwarder has all the inputs that you want to maintain.
</p><p>If you migrated from an existing forwarder, you can delete that old instance once your universal forwarder has been thoroughly tested and you're comfortable with the results.
</p><p>See <a href="#deployanixdfmanually_troubleshoot_your_deployment" class="external text">"Troubleshoot your deployment"</a> for troubleshooting tips.
</p>
<h3> <a name="deployanixdfmanually_perform_additional_configuration"><span class="mw-headline" id="Perform_additional_configuration"> Perform additional configuration </span></a></h3>
<p>In addition to using the CLI, you can update the universal forwarder's configuration by editing its configuration files, such as <code><font size="2">inputs.conf</font></code> and <code><font size="2">outputs.conf</font></code>, directly. See <a href="#deploymentoverview" class="external text">"Deployment overview"</a> for information.  
</p><p>For information on distributing configuration changes across multiple universal forwarders, see "About deployment server" in the Updating Splunk Enterprise Instances manual.
</p>
<h3> <a name="deployanixdfmanually_deploy_the_universal_forwarder_across_your_environment"><span class="mw-headline" id="Deploy_the_universal_forwarder_across_your_environment"> Deploy the universal forwarder across your environment </span></a></h3>
<p>If you need just a few universal forwarders, you might find it simpler just to repeat the installation process manually, as documented in this topic. If you need to install a larger number of universal forwarders, however, it will probably be easier to deploy them <a href="#remotelydeployanixdfwithastaticconfiguration" class="external text">remotely (using scripting or a deployment tool)</a> or else <a href="#makeadfpartofasystemimage" class="external text">as part of a system image or virtual machine</a>.
</p>
<h3> <a name="deployanixdfmanually_troubleshoot_your_deployment"><span class="mw-headline" id="Troubleshoot_your_deployment"> Troubleshoot your deployment </span></a></h3>
<p>The universal forwarder forwards some internal logs to the receiving indexer. These are:
</p>
<code><font size="2"><br>$SPLUNK_HOME/var/log/splunk/splunkd.log<br>$SPLUNK_HOME/var/log/splunk/metrics.log<br>$SPLUNK_HOME/var/log/splunk/license_audit.log<br></font></code>
<p>The logs can be searched on the indexer for errors (<code><font size="2">index=_internal host=&lt;ua-machine&gt;</font></code>). 
</p><p>If the universal forwarder is malfunctioning such that it cannot forward the logs, use a text editor or grep to examine them on the universal forwarder machine itself.
</p>
<a name="remotelydeployanixdfwithastaticconfiguration"></a><h2> <a name="remotelydeployanixdfwithastaticconfiguration_remotely_deploy_a_.2anix_universal_forwarder_with_a_static_configuration"><span class="mw-headline" id="Remotely_deploy_a_.2Anix_universal_forwarder_with_a_static_configuration"> Remotely deploy a *nix universal forwarder with a static configuration</span></a></h2>
<p>One of the main ways to deploy multiple universal forwarders remotely is through scripting. You can also use deployment management tools such as yum and Puppet. This topic focuses on script deployment.
</p><p>For information on how to install and configure a single universal forwarder, see <a href="#deployanixdfmanually" class="external text">"Deploy a nix universal forwarder manually"</a>. That topic explains how to install onto a wide variety of *nix platforms from a package or a tar file and how to configure (and optionally migrate) using the CLI.
</p>
<h3> <a name="remotelydeployanixdfwithastaticconfiguration_steps_to_deployment"><span class="mw-headline" id="Steps_to_deployment"> Steps to deployment </span></a></h3>
<p>Once you have downloaded the universal forwarder and have planned your deployment, as described in <a href="#deploymentoverview" class="external text">"Deployment overview"</a>, perform these steps:
</p><p><b>1.</b> Install and configure the universal forwarder on a test machine, as described in <a href="#deployanixdfmanually" class="external text">"Deploy a nix universal forwarder manually"</a>.
</p><p><b>2.</b> Test and tune the configuration.
</p><p><b>3.</b> Create a script wrapper for the installation and configuration commands.
</p><p><b>4.</b> Run the script on representative target machines to verify that it works with all required shells.
</p><p><b>5.</b> Execute the script against the desired set of hosts.
</p><p><b>6.</b> Use the deployment monitor to verify that the universal forwarders are functioning properly.
</p>
<h3> <a name="remotelydeployanixdfwithastaticconfiguration_create_and_execute_the_script"><span class="mw-headline" id="Create_and_execute_the_script">Create and execute the script</span></a></h3>
<p>Once you've validated your installation and configuration process by testing a fully configured universal forwarder, you're ready to incorporate the process into a script. 
</p>
<h4><font size="3"><b><i> <a name="remotelydeployanixdfwithastaticconfiguration_script_requirements"><span class="mw-headline" id="Script_requirements"> Script requirements </span></a></i></b></font></h4>
<p>You need to place the installation package or tar file in a network location accessible by the target machines. You can set this up so that the script pushes the file over to each target host, or you can place the file in a generally accessible location, such as an NFS mount.
</p><p>The script is responsible for error reporting. Logging to Splunk either directly or via a flat file is recommended.
</p>
<h4><font size="3"><b><i> <a name="remotelydeployanixdfwithastaticconfiguration_sample_script"><span class="mw-headline" id="Sample_script">Sample script</span></a></i></b></font></h4>
<p>Here's a sample script you can use as a starting point. Note that this is only an example of the type of script you could create for your deployment. The comments in the script provide some guidance on how to modify it for your needs; however, the script will likely require further modification, beyond that indicated by the comments.
</p><p>Among other things, the script:
</p>
<ul><li> Deploys the forwarder's tar file to a list of hosts specified in a file that the <code><font size="2">HOST_FILE</font></code> variable points to. You will need to provide this file, in the format specified in the script comments.
</li></ul><ul><li> Specifies the location on each destination host where the tar file will get unpacked.
</li></ul><ul><li> Specifies a Splunk Enterprise instance to serve as a <b>deployment server</b> that can subsequently manage and update the forwarders. This is an optional configuration step. 
</li></ul><ul><li> Starts the forwarder executable on each host.
</li></ul><p>The script is well commented; be sure to study it carefully before modifying it for your environment.
</p><p>Here's the sample deployment script:
</p>
<code><font size="2"><br>#!/bin/sh<br><br># This script provides an example of how to deploy the universal forwarder<br># to many remote hosts via ssh and common Unix commands.<br>#<br># Note that this script will only work unattended if you have SSH host keys<br># setup &amp; unlocked.<br># To learn more about this subject, do a web search for "openssh key management".<br><br><br># ----------- Adjust the variables below -----------<br><br># Populate this file with a list of hosts that this script should install to,<br># with one host per line. &nbsp;You may use hostnames or IP addresses, as<br># applicable. &nbsp;You can also specify a user to login as, for example, "foo@host".<br>#<br># Example file contents:<br># server1<br># server2.foo.lan<br># you@server3<br># 10.2.3.4<br><br>HOSTS_FILE="/path/to/splunk.install.list"<br><br># This is the path to the tar file that you wish to push out. &nbsp;You may<br># wish to make this a symlink to a versioned tar file, so as to minimize<br># updates to this script in the future.<br><br>SPLUNK_FILE="/path/to/splunk-latest.tar.gz"<br><br># This is where the tar file will be stored on the remote host during<br># installation. &nbsp;The file will be removed after installation. &nbsp;You normally will<br># not need to set this variable, as $NEW_PARENT will be used by default.<br>#<br># SCRATCH_DIR="/home/your_dir/temp"<br><br># The location in which to unpack the new tar file on the destination<br># host. &nbsp;This can be the same parent dir as for your existing <br># installation (if any). &nbsp;This directory will be created at runtime, if it does<br># not exist.<br><br>NEW_PARENT="/opt"<br><br># After installation, the forwarder will become a deployment client of this<br># host. &nbsp;Specify the host and management (not web) port of the deployment server<br># that will be managing these forwarder instances. &nbsp;If you do not wish to use<br># a deployment server, you may leave this unset.<br>#<br># DEPLOY_SERV="splunkDeployMaster:8089"<br><br># A directory on the current host in which the output of each installation<br># attempt will be logged. &nbsp;This directory need not exist, but the user running<br># the script must be able to create it. &nbsp;The output will be stored as<br># $LOG_DIR/&lt;[user@]destination host&gt;. &nbsp;If installation on a host fails, a<br># corresponding file will also be created, as<br># $LOG_DIR/&lt;[user@]destination host&gt;.failed.<br><br>LOG_DIR="/tmp/splunkua.install"<br><br># For conversion from normal Splunk Enterprise installs to the universal forwarder:<br># After installation, records of progress in indexing files (monitor)<br># and filesystem change events (fschange) can be imported from an existing<br># Splunk Enterprise (non-forwarder) installation. &nbsp;Specify the path to that installation here.<br># If there is no prior Splunk Enterprise instance, you may leave this variable empty ("").<br>#<br># NOTE: THIS SCRIPT WILL STOP THE SPLUNK ENTERPRISE INSTANCE SPECIFIED HERE.<br>#<br># OLD_SPLUNK="/opt/splunk"<br><br># If you use a non-standard SSH port on the remote hosts, you must set this.<br># SSH_PORT=1234<br><br># You must remove this line, or the script will refuse to run. &nbsp;This is to<br># ensure that all of the above has been read and set.&nbsp;:)<br><br>UNCONFIGURED=1<br><br># ----------- End of user adjustable settings -----------<br><br><br># helpers.<br><br>faillog() {<br>&nbsp;&nbsp;echo "$1" &gt;&amp;2<br>}<br><br>fail() {<br>&nbsp;&nbsp;faillog "ERROR: $@"<br>&nbsp;&nbsp;exit 1<br>}<br><br># error checks.<br><br>test "$UNCONFIGURED" -eq 1 &amp;&amp; \<br>&nbsp;&nbsp;fail "This script has not been configured. &nbsp;Please see the notes in the script."<br>test -z "$HOSTS_FILE" &amp;&amp; \<br>&nbsp;&nbsp;fail "No hosts configured! &nbsp;Please populate HOSTS_FILE."<br>test -z "$NEW_PARENT" &amp;&amp; \<br>&nbsp;&nbsp;fail "No installation destination provided! &nbsp;Please set NEW_PARENT."<br>test -z "$SPLUNK_FILE" &amp;&amp; \<br>&nbsp;&nbsp;fail "No splunk package path provided! &nbsp;Please populate SPLUNK_FILE."<br>if [&nbsp;! -d "$LOG_DIR" ]; then<br>&nbsp;&nbsp;mkdir -p "$LOG_DIR" || fail "Cannot create log dir at \"$LOG_DIR\"!"<br>fi<br><br># some setup.<br><br>if [ -z "$SCRATCH_DIR" ]; then<br>&nbsp;&nbsp;SCRATCH_DIR="$NEW_PARENT"<br>fi<br>if [ -n "$SSH_PORT" ]; then<br>&nbsp;&nbsp;SSH_PORT_ARG="-p${SSH_PORT}"<br>&nbsp;&nbsp;SCP_PORT_ARG="-P${SSH_PORT}"<br>fi<br><br>NEW_INSTANCE="$NEW_PARENT/splunkforwarder" # this would need to be edited for non-UA...<br>DEST_FILE="${SCRATCH_DIR}/splunk.tar.gz"<br><br>#<br>#<br># create script to run remotely.<br>#<br>#<br><br>REMOTE_SCRIPT="<br>&nbsp;&nbsp;fail() {<br>&nbsp;&nbsp;&nbsp;&nbsp;echo ERROR: \"\$@\" &gt;&amp;2<br>&nbsp;&nbsp;&nbsp;&nbsp;test -f \"$DEST_FILE\" &amp;&amp; rm -f \"$DEST_FILE\"<br>&nbsp;&nbsp;&nbsp;&nbsp;exit 1<br>&nbsp;&nbsp;}<br>"<br><br>### &nbsp;&nbsp;try untarring tar file.<br>REMOTE_SCRIPT="$REMOTE_SCRIPT<br>&nbsp;&nbsp;(cd \"$NEW_PARENT\" &amp;&amp; tar -zxf \"$DEST_FILE\") || fail \"could not untar /$DEST_FILE to $NEW_PARENT.\"<br>"<br><br>### &nbsp;&nbsp;setup seed file to migrate input records from old instance, and stop old instance.<br>if [ -n "$OLD_SPLUNK" ]; then<br>&nbsp;&nbsp;REMOTE_SCRIPT="$REMOTE_SCRIPT<br>&nbsp;&nbsp;&nbsp;&nbsp;echo \"$OLD_SPLUNK\" &gt; \"$NEW_INSTANCE/old_splunk.seed\" || fail \"could not create seed file.\"<br>&nbsp;&nbsp;&nbsp;&nbsp;\"$OLD_SPLUNK/bin/splunk\" stop || fail \"could not stop existing splunk.\"<br>&nbsp;&nbsp;"<br>fi<br><br>### &nbsp;&nbsp;setup deployment client if requested.<br>if [ -n "$DEPLOY_SERV" ]; then<br>&nbsp;&nbsp;REMOTE_SCRIPT="$REMOTE_SCRIPT<br>&nbsp;&nbsp;&nbsp;&nbsp;\"$NEW_INSTANCE/bin/splunk\" set deploy-poll \"$DEPLOY_SERV\" --accept-license --answer-yes \<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--auto-ports --no-prompt || fail \"could not setup deployment client\"<br>&nbsp;&nbsp;"<br>fi<br><br>### &nbsp;&nbsp;start new instance.<br>REMOTE_SCRIPT="$REMOTE_SCRIPT<br>&nbsp;&nbsp;\"$NEW_INSTANCE/bin/splunk\" start --accept-license --answer-yes --auto-ports --no-prompt || \<br>&nbsp;&nbsp;&nbsp;&nbsp;fail \"could not start new splunk instance!\"<br>"<br><br>### &nbsp;&nbsp;remove downloaded file.<br>REMOTE_SCRIPT="$REMOTE_SCRIPT<br>&nbsp;&nbsp;rm -f "$DEST_FILE" || fail \"could not delete downloaded file $DEST_FILE!\"<br>"<br><br>#<br>#<br># end of remote script.<br>#<br>#<br><br>exec 5&gt;&amp;1 # save stdout.<br>exec 6&gt;&amp;2 # save stderr.<br><br>echo "In 5 seconds, will copy install file and run the following script on each"<br>echo "remote host:"<br>echo<br>echo "===================="<br>echo "$REMOTE_SCRIPT"<br>echo "===================="<br>echo<br>echo "Press Ctrl-C to cancel..."<br>test -z "$MORE_FASTER" &amp;&amp; sleep 5<br>echo "Starting."<br><br># main loop. &nbsp;install on each host.<br><br>for DST in `cat "$HOSTS_FILE"`; do<br>&nbsp;&nbsp;if [ -z "$DST" ]; then<br>&nbsp;&nbsp;&nbsp;&nbsp;continue;<br>&nbsp;&nbsp;fi<br><br>&nbsp;&nbsp;LOG="$LOG_DIR/$DST"<br>&nbsp;&nbsp;FAILLOG="${LOG}.failed"<br>&nbsp;&nbsp;echo "Installing on host $DST, logging to $LOG."<br><br>&nbsp;&nbsp;# redirect stdout/stderr to logfile.<br>&nbsp;&nbsp;exec 1&gt; "$LOG"<br>&nbsp;&nbsp;exec 2&gt; "$LOG" <br><br>&nbsp;&nbsp;if&nbsp;! ssh $SSH_PORT_ARG "$DST" \<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"if [&nbsp;! -d \"$NEW_PARENT\" ]; then mkdir -p \"$NEW_PARENT\"; fi"; then<br>&nbsp;&nbsp;&nbsp;&nbsp;touch "$FAILLOG"<br>&nbsp;&nbsp;&nbsp;&nbsp;# restore stdout/stderr.<br>&nbsp;&nbsp;&nbsp;&nbsp;exec 1&gt;&amp;5 <br>&nbsp;&nbsp;&nbsp;&nbsp;exec 2&gt;&amp;6<br>&nbsp;&nbsp;&nbsp;&nbsp;continue<br>&nbsp;&nbsp;fi<br><br>&nbsp;&nbsp;# copy tar file to remote host.<br>&nbsp;&nbsp;if&nbsp;! scp $SCP_PORT_ARG "$SPLUNK_FILE" "${DST}:${DEST_FILE}"; then<br>&nbsp;&nbsp;&nbsp;&nbsp;touch "$FAILLOG"<br>&nbsp;&nbsp;&nbsp;&nbsp;# restore stdout/stderr.<br>&nbsp;&nbsp;&nbsp;&nbsp;exec 1&gt;&amp;5 <br>&nbsp;&nbsp;&nbsp;&nbsp;exec 2&gt;&amp;6<br>&nbsp;&nbsp;&nbsp;&nbsp;continue<br>&nbsp;&nbsp;fi<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;# run script on remote host and log appropriately.<br>&nbsp;&nbsp;if&nbsp;! ssh $SSH_PORT_ARG "$DST" "$REMOTE_SCRIPT"; then<br>&nbsp;&nbsp;&nbsp;&nbsp;touch "$FAILLOG" # remote script failed.<br>&nbsp;&nbsp;else<br>&nbsp;&nbsp;&nbsp;&nbsp;test -e "$FAILLOG" &amp;&amp; rm -f "$FAILLOG" # cleanup any past attempt log.<br>&nbsp;&nbsp;fi<br><br>&nbsp;&nbsp;# restore stdout/stderr.<br>&nbsp;&nbsp;exec 1&gt;&amp;5 <br>&nbsp;&nbsp;exec 2&gt;&amp;6<br><br>&nbsp;&nbsp;if [ -e "$FAILLOG" ]; then<br>&nbsp;&nbsp;&nbsp;&nbsp;echo " &nbsp;--&gt; &nbsp;&nbsp;FAILED &nbsp;&nbsp;&lt;--"<br>&nbsp;&nbsp;else<br>&nbsp;&nbsp;&nbsp;&nbsp;echo " &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SUCCEEDED"<br>&nbsp;&nbsp;fi<br>done<br><br>FAIL_COUNT=`ls "${LOG_DIR}" | grep -c '\.failed$'`<br>if [ "$FAIL_COUNT" -gt 0 ]; then<br>&nbsp;&nbsp;echo "There were $FAIL_COUNT remote installation failures."<br>&nbsp;&nbsp;echo " &nbsp;( see ${LOG_DIR}/*.failed )"<br>else<br>&nbsp;&nbsp;echo<br>&nbsp;&nbsp;echo "Done."<br>fi<br><br># Voila.<br><br></font></code>
<h4><font size="3"><b><i> <a name="remotelydeployanixdfwithastaticconfiguration_execute_the_script"><span class="mw-headline" id="Execute_the_script"> Execute the script </span></a></i></b></font></h4>
<p>Once you've executed the script, check any log files generated by your installation script for errors. For example, the sample script saves to <code><font size="2">/tmp/splunkua.install/&lt;destination hostname&gt;</font></code>.
</p>
<a name="makeadfpartofasystemimage"></a><h2> <a name="makeadfpartofasystemimage_make_a_universal_forwarder_part_of_a_system_image"><span class="mw-headline" id="Make_a_universal_forwarder_part_of_a_system_image"> Make a universal forwarder part of a system image</span></a></h2>
<p>This topic describes how to deploy a universal forwarder as part of a system image or virtual machine. This is particularly useful if you have a large number of universal forwarders to deploy. If you have just a few, you might find it simpler to install them manually, as described for <a href="#deployawindowsdfmanually" class="external text">Windows</a> and <a href="#deployanixdfmanually" class="external text">nix machines</a>.
</p><p>Before following the procedures in this topic, read <a href="#deploymentoverview" class="external text">"Deployment overview"</a>.  
</p>
<h3> <a name="makeadfpartofasystemimage_steps_to_deployment"><span class="mw-headline" id="Steps_to_deployment"> Steps to deployment </span></a></h3>
<p>Once you have downloaded the universal forwarder and have planned your deployment, as described in <a href="#deploymentoverview" class="external text">"Deployment overview"</a>, perform these steps:
</p><p><b>1.</b> Install the universal forwarder on a test machine. See <a href="#makeadfpartofasystemimage_install_the_universal_forwarder" class="external text">below</a>.
</p><p><b>2.</b> Perform any post-installation configuration, as described below, <a href="#makeadfpartofasystemimage_perform_additional_configuration" class="external text">here</a>.
</p><p><b>3.</b> Test and tune the deployment, as described <a href="#makeadfpartofasystemimage_test_the_deployment" class="external text">below</a>.
</p><p><b>4.</b> Install the universal forwarder with the tested configuration onto a source machine.
</p><p><b>5.</b> Stop the universal forwarder.
</p><p><b>6.</b> Run this CLI command on the forwarder:
</p>
<code><font size="2"><br>./splunk clone-prep-clear-config<br></font></code>
<p>This clears instance-specific information, such as the server name and GUID, from the forwarder. This information will then be configured on each cloned forwarder at initial start-up.
</p><p><b>7.</b> Prep your image or virtual machine, as necessary, for cloning.
</p><p><b>8.</b> On *nix systems, set the splunkd daemon to start on boot using cron or your scheduling system of choice. On Windows, set the service to <code><font size="2">Automatic</font></code> but do not start it.
</p><p><b>9.</b> Distribute system image or virtual machine clones to machines across your environment and start them.
</p><p><b>10.</b> Use the deployment monitor to verify that the cloned universal forwarders are functioning.
</p>
<h3> <a name="makeadfpartofasystemimage_referenced_procedures"><span class="mw-headline" id="Referenced_procedures">Referenced procedures</span></a></h3>
<p>Steps in the above deployment procedure reference these subtopics.
</p>
<h4><font size="3"><b><i> <a name="makeadfpartofasystemimage_install_the_universal_forwarder"><span class="mw-headline" id="Install_the_universal_forwarder"> Install the universal forwarder </span></a></i></b></font></h4>
<p>Install the universal forwarder using the procedure specific to your operating system:
</p>
<ul><li> <b>To install on a *nix machine,</b> see <a href="#deployanixdfmanually" class="external text">"Deploy a nix universal forwarder manually"</a>.
</li></ul><ul><li> <b>For a Windows machine,</b> you can use the installer GUI or the command line interface. To install with the GUI, see <a href="#deployawindowsdfmanually" class="external text">"Deploy a Windows universal forwarder via the installer GUI"</a>. For information on the command line interface, see <a href="#deployawindowsdfviathecommandline" class="external text">"Deploy a Windows universal forwarder via the command line"</a>. 
</li></ul><p><b>Important:</b> On a Windows machine, if you do not want the universal forwarder to start immediately after installation, you <b>must</b> use the command line interface. Using the proper command line flags, you can configure the universal forwarder so that it does not start on the source machine when installed but does start automatically on the clones, once they're activated.
</p><p>At the time of installation, you can also configure the universal forwarder. See <a href="#deploymentoverview_general_configuration_issues" class="external text">"General configuration issues"</a> in the Deployment Overview.
</p>
<h4><font size="3"><b><i> <a name="makeadfpartofasystemimage_perform_additional_configuration"><span class="mw-headline" id="Perform_additional_configuration"> Perform additional configuration </span></a></i></b></font></h4>
<p>You can update your universal forwarder's configuration, post-installation, by directly editing its configuration files, such as <code><font size="2">inputs.conf</font></code> and <code><font size="2">outputs.conf</font></code>. See <a href="#deploymentoverview" class="external text">"Deployment overview"</a> for information.
</p><p>For information on distributing configuration changes across multiple universal forwarders, see "About deployment server" in the Updating Splunk Enterprise Instances manual.
</p>
<h4><font size="3"><b><i> <a name="makeadfpartofasystemimage_test_the_deployment"><span class="mw-headline" id="Test_the_deployment"> Test the deployment </span></a></i></b></font></h4>
<p>Test your configured universal forwarder on a single machine, to make sure it functions correctly, before deploying the universal forwarder across your environment. When testing the deployment, ask these questions:
</p><p><b>1. Do the data inputs that you configured in the forwarder collect the data you want?</b>
</p><p>If they don't:
</p>
<ul><li> Check the inputs.conf on the forwarder and confirm that the input stanzas are correct. For example, if you want to configure monitoring a file, confirm that the inputs.conf on the forwarder references that file.
</li><li> Confirm that the stanza that references the file is not disabled (look for 'disabled = 1' in the stanza.)
</li></ul><p><b>2. Does the forwarder send the data you expect to the place you expect it?</b>
</p><p>If it doesn't:
</p>
<ul><li> Confirm that the outputs.conf on the forwarder has been correctly configured. The outputs.conf file should reference a receiving indexer that the forwarder can access over the network via a host name or IP address and port that you specify.
</li><li> Confirm that no firewall blocks network traffic on the ports you specify on both the forwarder and receiver.
</li><li> Confirm that the ports you specify on the forwarder and receiver are the same, as they must be for forwarding to occur. For example, if you specify port 9997 as the receiving port on the indexer, you must specify this same port as the target in the outputs.conf configuration on the forwarder.
</li><li> Use the Search page on the receiving indexer to confirm that you see events that you configured on the forwarder.
</li></ul><a name="migrateanixforwarder"></a><h2> <a name="migrateanixforwarder_migrate_a_.2anix_light_forwarder"><span class="mw-headline" id="Migrate_a_.2Anix_light_forwarder"> Migrate a *nix light forwarder</span></a></h2>
<p>If you want to replace an existing light forwarder with a universal forwarder, you need to first migrate its checkpoint data to the new forwarder. Checkpoint data is internal data that the forwarder compiles to keep track of what data it has already forwarded to an indexer. By migrating the checkpoint data, you prevent the new universal forwarder from forwarding any data already sent by the old light forwarder. This ensures that the same data does not get indexed twice.
</p><p>You can migrate checkpoint data from an existing *nix light forwarder (version 4.0 or later) to the universal forwarder. For an overview of migration, see <a href="#deploymentoverview_migrating_from_a_light_forwarder" class="external text">"Migrating from a light forwarder"</a> in the Deployment Overview. 
</p><p><b>Important:</b> Migration can only occur the first time you start the universal forwarder, post-installation. <b>You cannot migrate at any later point.</b>
</p><p>To migrate, do the following:
</p><p><b>1.</b> Stop any services (splunkd and splunkweb, if running) for the existing forwarder:
</p>
<code><font size="2"><br>&nbsp;&nbsp;&nbsp;$SPLUNK_HOME/bin/splunk stop<br></font></code>
<p><b>2.</b> Complete the basic installation of the universal forwarder, as described in <a href="#deployanixdfmanually" class="external text">"Deploy a nix universal forwarder manually"</a>. <b>Do not yet start the universal forwarder.</b>
</p><p><b>Important:</b> Make sure you install the universal forwarder into a different directory from the existing light forwarder.  Since the default install directory for the universal forwarder is <code><font size="2">/opt/splunkforwarder</font></code> and the default install directory for full Splunk Enterprise (including the light forwarder) is <code><font size="2">/opt/splunk</font></code>, you'll be safe if you just stick with the defaults.  
</p><p><b>3.</b> In the universal forwarder's installation directory, (the new <code><font size="2">$SPLUNK_HOME</font></code>), create a file named <code><font size="2">old_splunk.seed</font></code>; in other words: <code><font size="2">$SPLUNK_HOME/old_splunk.seed</font></code>. This file must contain a single line, consisting of the path of the <b>old</b> forwarder's <code><font size="2">$SPLUNK_HOME</font></code> directory. For example: <code><font size="2">/opt/splunk</font></code>. 
</p><p><b>4.</b> Start the universal forwarder:
</p>
<code><font size="2"><br>&nbsp;&nbsp;&nbsp;$SPLUNK_HOME/bin/splunk start<br></font></code>
<p>The universal forwarder will migrate the checkpoint files from the forwarder specified in the <code><font size="2">$SPLUNK_HOME/old_splunk.seed</font></code> file. Migration only occurs the first time you run the <code><font size="2">start</font></code> command. You can leave the <code><font size="2">old_splunk.seed</font></code> in place; it only gets examined the first time you start the forwarder after installing it. 
</p><p><b>5.</b> Perform any additional configuration of the universal forwarder, as described in <a href="#deployanixdfmanually" class="external text">"Deploy a nix universal forwarder manually"</a>. Since the migration process only copies checkpoint files, you will probably want to manually copy over the old forwarder's <code><font size="2">inputs.conf</font></code> configuration file (or at least examine it, to determine what data inputs it was monitoring).
</p><p>Once the universal forwarder is up and running (and after you've tested to ensure migration worked correctly), you can uninstall the old forwarder.
</p>
<h1>Upgrade forwarders</h1><a name="upgradethewindowsforwarder"></a><h2> <a name="upgradethewindowsforwarder_upgrade_the_windows_universal_forwarder"><span class="mw-headline" id="Upgrade_the_Windows_universal_forwarder"> Upgrade the Windows universal forwarder</span></a></h2>
<p>This topic describes the procedure for upgrading your Windows universal forwarder from version 5.0.x, 6.0.x, or 6.1.x to 6.2.
</p><p>The upgrade process is much simpler than the original installation. The MSI does a straight-forward upgrade with no configuration changes. If you need to change any configuration settings on your forwarders, you can do so after the upgrade, preferably through the deployment server.
</p><p><b>Important:</b> Before doing an upgrade, consider whether you really need to. In most cases, there's no compelling reason to upgrade a forwarder.  Forwarders are always compatible with later version indexers, so you do not need to upgrade them just because you've upgraded the indexers they're sending data to.
</p><p>This topic describes three upgrade scenarios:
</p>
<ul><li> Upgrade a single forwarder with the GUI installer
</li><li> Upgrade a single forwarder with the command line installer
</li><li> Perform a remote upgrade of a group of forwarders
</li></ul><p>For deployments of any size, you will most likely want to use this last scenario.
</p>
<h3> <a name="upgradethewindowsforwarder_before_you_upgrade"><span class="mw-headline" id="Before_you_upgrade">Before you upgrade</span></a></h3>
<p>Be sure to read this section before performing an upgrade. Also, read "How to upgrade Splunk Enterprise" in the Installation Manual for up-to-date information and potential issues you might encounter when upgrading.
</p>
<h4><font size="3"><b><i> <a name="upgradethewindowsforwarder_no_platform_architecture_changes"><span class="mw-headline" id="No_platform_architecture_changes">No platform architecture changes</span></a></i></b></font></h4>
<p>Due to how the universal forwarder installer is configured, you cannot upgrade a 32-bit version of the universal forwarder with the 64-bit universal forwarder installer. If you are in this situation, the follow these instructions:
</p><p><b>1.</b> Back up your configurations, including any apps or add-ons (in <code><font size="2">%SPLUNK_HOME%\etc\apps</font></code>). Also back up the checkpoint files located in&nbsp;%SPLUNK_HOME%\var\lib\modinputs\
</p><p><b>2.</b> Uninstall the existing 32-bit forwarder.
</p><p><b>3.</b> <a href="#deployawindowsdfmanually" class="external text">Install</a> the 64-bit forwarder.
</p><p><b>4.</b> Restore your apps, configurations and checkpoints by copying them to the appropriate directories:
</p>
<dl><dd><code><font size="2">%SPLUNK_HOME%\etc\system\local</font></code> for configuration files.
</dd><dd><code><font size="2">%SPLUNK_HOME%\etc\apps</font></code> for apps and add-ons.
</dd><dd><code><font size="2">%SPLUNK_HOME%\var\lib\modinputs</font></code> for checkpoint files.
</dd></dl><h4><font size="3"><b><i> <a name="upgradethewindowsforwarder_back_your_files_up"><span class="mw-headline" id="Back_your_files_up">Back your files up</span></a></i></b></font></h4>
<p>Before you perform the upgrade, we strongly recommend that you back up your configuration files. For information on backing up configurations, read "Back up configuration information" in the <i>Admin</i> manual. 
</p><p>Splunk Enterprise does not provide a means of downgrading to a previous version; if you need to revert to an older forwarder release, just uninstall the current version and reinstall the older release.
</p>
<h3> <a name="upgradethewindowsforwarder_upgrade_using_the_gui_installer"><span class="mw-headline" id="Upgrade_using_the_GUI_installer">Upgrade using the GUI installer</span></a></h3>
<p>You can upgrade a single forwarder with the GUI installer:
</p><p><b>1.</b> Download the new MSI file from the universal forwarder download page.
</p><p><b>2.</b> Double-click the MSI file. The installer displays the "Accept license agreement" panel. 
</p><p><b>3.</b> Accept the license agreement and click "Install." The installer then upgrades the forwarder while retaining the existing configuration.
</p><p><b>Note:</b> You do not need to stop the forwarder before upgrading. The MSI will do this automatically as part of the upgrade process.
</p><p><b>4.</b> The forwarder will start automatically when you complete the installation.
</p><p>The installer puts a log of upgrade changes in <code><font size="2">%TEMP%</font></code>. It also reports any errors in the Application Event log.
</p>
<h3> <a name="upgradethewindowsforwarder_upgrade_using_the_command_line"><span class="mw-headline" id="Upgrade_using_the_command_line">Upgrade using the command line</span></a></h3>
<p>You can upgrade a single forwarder by running the command line installer.  To upgrade a group of forwarders, you can load the command line installer into a deployment tool, as described below.
</p><p>Here are the steps for using the command line installer to upgrade a single forwarder:
</p><p><b>1.</b> Download the new MSI file from the Splunk universal forwarder download page.
</p><p><b>2.</b> Install the universal forwarder from the command line by invoking <code><font size="2">msiexec.exe</font></code>.
</p>
<ul><li> For 32-bit platforms, use <code><font size="2">splunkuniversalforwarder-&lt;...&gt;-x86-release.msi</font></code>:
</li></ul><code><font size="2"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;msiexec.exe /i splunkuniversalforwarder-&lt;...&gt;-x86-release.msi [AGREETOLICENSE=Yes /quiet]<br></font></code>
<ul><li> For 64-bit platforms, use <code><font size="2">splunkuniversalforwarder-&lt;...&gt;-x64-release.msi</font></code>:
</li></ul><code><font size="2"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;msiexec.exe /i splunkuniversalforwarder-&lt;...&gt;-x64-release.msi [AGREETOLICENSE=Yes /quiet]<br></font></code>
<p>The value of <code><font size="2">&lt;...&gt;</font></code> varies according to the particular release; for example, <code><font size="2">splunkuniversalforwarder-5.0-142438-x64-release.msi</font></code>.
</p><p><b>Important:</b> You cannot make configuration changes during upgrade. If you specify any command line flags besides "AGREETOLICENSE", the MSI just ignores them. 
</p><p><b>Note:</b> You do not need to stop the forwarder before upgrading. The MSI will do this automatically as part of the upgrade process.
</p><p><b>3.</b> The forwarder will start automatically when you complete the installation. 
</p><p>The installer puts a log of upgrade changes in <code><font size="2">%TEMP%</font></code>. It also reports any errors in the Application Event log.
</p>
<h3> <a name="upgradethewindowsforwarder_perform_a_remote_upgrade"><span class="mw-headline" id="Perform_a_remote_upgrade">Perform a remote upgrade </span></a></h3>
<p>To upgrade a group of forwarders across your environment: 
</p><p><b>1.</b> Load the universal forwarder MSI into your deployment tool. In most cases, you will want to run the command like this:
</p>
<code><font size="2"><br>&nbsp;&nbsp;&nbsp;msiexec.exe /i splunkuniversalforwarder-&lt;...&gt;.msi AGREETOLICENSE=Yes /quiet<br></font></code>
<p>See the previous section, "Upgrade using the command line", for details on the MSI command. 
</p><p><b>2.</b> Execute deployment with your deployment tool.
</p><p><b>3.</b> Use the deployment monitor to verify that the universal forwarders are functioning properly.
</p><p>You might want to test the upgrade locally on one machine before performing a remote upgrade across all your forwarders.
</p>
<a name="upgradethenixforwarder"></a><h2> <a name="upgradethenixforwarder_upgrade_the_universal_forwarder_for_.2anix_systems"><span class="mw-headline" id="Upgrade_the_universal_forwarder_for_.2Anix_systems"> Upgrade the universal forwarder for *nix systems </span></a></h2>
<p>This topic describes the procedure for upgrading your universal forwarder from version 4.3.x or 5.0.x to 6.0.
</p><p><b>Important:</b> Before doing an upgrade, consider whether you really need to. In most cases, there's no compelling reason to upgrade a forwarder.  Forwarders are always compatible with later version indexers, so you do not need to upgrade them just because you've upgraded the indexers they're sending data to.
</p><p>This topic describes two upgrade scenarios:
</p>
<ul><li> Upgrade a single forwarder manually
</li><li> Perform a remote upgrade of a group of forwarders
</li></ul><p>For deployments of any size, you will most likely want to use this second scenario.
</p>
<h3> <a name="upgradethenixforwarder_before_you_upgrade"><span class="mw-headline" id="Before_you_upgrade">Before you upgrade</span></a></h3>
<p>Be sure to read this section before performing an upgrade. Also, read "How to upgrade Splunk Enterprise" in the Installation Manual for up-to-date information and potential issues you might encounter when upgrading.
</p>
<h4><font size="3"><b><i> <a name="upgradethenixforwarder_back_your_files_up"><span class="mw-headline" id="Back_your_files_up">Back your files up</span></a></i></b></font></h4>
<p>Before you perform the upgrade, we strongly recommend that you back up your configuration files. For information on backing up configurations, read "Back up configuration information" in the <i>Admin</i> manual. 
</p><p>Splunk Enterprise does not provide a means of downgrading to a previous version; if you need to revert to an older forwarder release, just reinstall it.
</p>
<h3> <a name="upgradethenixforwarder_how_upgrading_works"><span class="mw-headline" id="How_upgrading_works">How upgrading works</span></a></h3>
<p>After performing the installation of the new version, your configuration changes are not actually made until you start the universal forwarder. You can run the migration preview utility at that time to see what will be changed before the files are updated. If you choose to view the changes before proceeding, a file containing the changes that the upgrade script proposes to make is written to <code><font size="2">$SPLUNK_HOME/var/log/splunk/migration.log.&lt;timestamp&gt;</font></code>
</p>
<h3> <a name="upgradethenixforwarder_upgrade_a_single_forwarder"><span class="mw-headline" id="Upgrade_a_single_forwarder">Upgrade a single forwarder</span></a></h3>
<p><b>1.</b> Execute the <code><font size="2">stop</font></code> command:
</p>
<code><font size="2"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$SPLUNK_HOME/bin/splunk stop<br></font></code>  
<p><b>Important:</b> Make sure no other processes will start the forwarder automatically (such as Solaris SMF).
</p><p><b>2.</b> Install the universal forwarder package over your existing deployment:
</p>
<ul><li> If you are using a .tar file, expand it into the same directory with the same ownership as your existing universal forwarder instance. This overwrites and replaces matching files but does not remove unique files.
</li><li> If you are using a package manager, such as an RPM, type <code><font size="2">rpm -U &lt;splunk_package_name&gt;.rpm</font></code>
</li><li> If you are using a .dmg file (on MacOS), double-click it and follow the instructions. Be sure to specify the same installation directory as your existing installation.  
</li><li> If you use init scripts, be sure to include the following so the EULA gets accepted:
</li></ul><code><font size="2"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;./splunk start --accept-license<br></font></code>
<p><b>3.</b>  Execute the <code><font size="2">start</font></code> command:
</p>
<code><font size="2"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$SPLUNK_HOME/bin/splunk start<br></font></code> 
<p>The following output is displayed:
</p>
<code><font size="2"><br>This appears to be an upgrade of Splunk.<br>--------------------------------------------------------------------------------<br>Splunk has detected an older version of Splunk installed on this machine. To<br>finish upgrading to the new version, Splunk's installer will automatically<br>update and alter your current configuration files. Deprecated configuration<br>files will be renamed with a .deprecated extension.<br>You can choose to preview the changes that will be made to your configuration<br>files before proceeding with the migration and upgrade:<br>If you want to migrate and upgrade without previewing the changes that will be<br>made to your existing configuration files, choose 'y'.<br>If you want to see what changes will be made before you proceed with the<br>upgrade, choose 'n'.<br>Perform migration and upgrade without previewing configuration changes? [y/n]<br></font></code>
<p><b>4.</b>  Choose whether you want to run the migration preview script to see what changes will be made to your existing configuration files, or proceed with the migration and upgrade right away. 
</p><p><b>5.</b> If you choose to view the expected changes, the script provides a list. 
</p><p><b>6.</b> Once you've reviewed these changes and are ready to proceed with migration and upgrade, run <code><font size="2"> $SPLUNK_HOME/bin/splunk start</font></code> again. 
</p><p><b>Note:</b> You can complete Steps 3 to 5 in one line:
</p>
<ul><li> To accept the license and view the expected changes (answer 'n') before continuing the upgrade:
</li></ul><code><font size="2"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$SPLUNK_HOME/bin/splunk start --accept-license --answer-no<br></font></code>
<ul><li> To accept the license and begin the upgrade without viewing the changes (answer 'y'):
</li></ul><code><font size="2"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$SPLUNK_HOME/bin/splunk start --accept-license --answer-yes<br></font></code>
<h3> <a name="upgradethenixforwarder_perform_a_remote_upgrade"><span class="mw-headline" id="Perform_a_remote_upgrade"> Perform a remote upgrade </span></a></h3>
<p>To upgrade a group of forwarders across your environment: 
</p><p><b>1.</b> Upgrade the universal forwarder on a test machine, as described above.
</p><p><b>2.</b> Create a script wrapper for the upgrade commands, as described in <a href="#remotelydeployanixdfwithastaticconfiguration_create_and_execute_the_script" class="external text">"Remotely deploy a nix universal forwarder with a static configuration"</a> in the <i>Forwarding Data</i> manual. You will need to modify the sample script to meet the needs of an upgrade.
</p><p><b>3.</b> Run the script on representative target machines to verify that it works with all required shells.
</p><p><b>4.</b> Execute the script against the desired set of hosts.
</p><p><b>5.</b> Use the deployment monitor to verify that the universal forwarders are functioning properly.
</p>
<h1>Perform advanced configuration</h1><a name="configureforwarderswithoutputs.confd"></a><h2> <a name="configureforwarderswithoutputs.confd_configure_forwarders_with_outputs.conf"><span class="mw-headline" id="Configure_forwarders_with_outputs.conf"> Configure forwarders with outputs.conf </span></a></h2>
<p>The outputs.conf file defines how forwarders send data to receivers. You can specify some output configurations at installation time (Windows universal forwarders only) or through Splunk Web (heavy/light forwarders only) or the CLI, but most advanced configuration settings require that you directly edit <code><font size="2">outputs.conf</font></code>. The topics describing various topologies, such as <a href="#setuploadbalancingd" class="external text">load balancing</a> and <a href="#routeandfilterdatad" class="external text">data routing</a>, provide detailed examples on configuring <code><font size="2">outputs.conf</font></code> to support those topologies.
</p><p><b>Important:</b> Although <code><font size="2">outputs.conf</font></code> is a critical file for configuring forwarders, it specifically addresses the <i>outputs</i> from the forwarder. To specify the <i>inputs</i> to a forwarder, you must separately configure the inputs, as you would for any Splunk Enterprise instance. For details on configuring inputs, see "Add data and configure inputs" in the Getting Data In manual.
</p>
<h3> <a name="configureforwarderswithoutputs.confd_types_of_outputs.conf_files"><span class="mw-headline" id="Types_of_outputs.conf_files"> Types of outputs.conf files </span></a></h3>
<p>A single forwarder can have multiple <code><font size="2">outputs.conf</font></code> files (for instance, one located in an apps directory and another in <code><font size="2">/system/local</font></code>). No matter how many <code><font size="2">outputs.conf</font></code> files the forwarder has and where they reside, the forwarder combines all their settings, using the rules of location precedence, as described in "Configuration file precedence". Your installation will contain both default and custom <code><font size="2">outputs.conf</font></code> files.
</p>
<h4><font size="3"><b><i> <a name="configureforwarderswithoutputs.confd_default_versions"><span class="mw-headline" id="Default_versions">Default versions</span></a></i></b></font></h4>
<p>Splunk Enterprise ships with these default versions of <code><font size="2">outputs.conf</font></code>:
</p>
<ul><li> <b>On the universal forwarder</b>: The universal forwarder has two default <code><font size="2">outputs.conf</font></code> files, one in <code><font size="2">$SPLUNK_HOME/etc/system/default</font></code> and the other in <code><font size="2">$SPLUNK_HOME/etc/apps/SplunkUniversalForwarder/default</font></code>. The default version in the <code><font size="2">SplunkUniversalForwarder</font></code> app has precedence over the version under <code><font size="2">/etc/system/default</font></code>.
</li><li> <b>On heavy and light forwarders</b>: These have a single default <code><font size="2">outputs.conf</font></code> file, located in <code><font size="2">$SPLUNK_HOME/etc/system/default</font></code>.
</li></ul><p><b>Important:</b> Do not touch default versions of any configuration files, for reasons explained in "About configuration files".
</p>
<h4><font size="3"><b><i> <a name="configureforwarderswithoutputs.confd_custom_versions"><span class="mw-headline" id="Custom_versions">Custom versions</span></a></i></b></font></h4>
<p>When you configure forwarding behavior, those changes get saved in custom versions of <code><font size="2">outputs.conf</font></code>. There are several ways you can specify forwarding behavior:
</p>
<ul><li> While installing the forwarder (Windows universal forwarder only)
</li><li> By running CLI commands
</li><li> By using Splunk Web (heavy/light forwarders only)
</li><li> By directly editing an <code><font size="2">outputs.conf</font></code> file
</li></ul><p>The forwarder automatically creates or edits custom versions of <code><font size="2">outputs.conf</font></code> in response to the first three methods. The locations of those versions vary, depending on the type of forwarder and other factors:
</p>
<ul><li> <b>The universal forwarder</b>. If you use the CLI to make changes to universal forwarder output behavior, it creates or edits a copy of <code><font size="2">outputs.conf</font></code> in <code><font size="2">$SPLUNK_HOME/etc/system/local</font></code>. However, the Windows installation process writes configuration changes to an <code><font size="2">outputs.conf</font></code> file located in the <code><font size="2">MSICreated</font></code> app. For more information on configuring the universal forwarder, look <a href="#deploymentoverview_general_configuration_issues" class="external text">here</a>.
</li></ul><ul><li> <b>Heavy and light forwarders</b>.  When you enable a heavy/light forwarder through Splunk Web or the CLI, an <code><font size="2">outputs.conf</font></code> file gets created in the directory of the currently running app. For example, if you're working in the search app, the file is created in <code><font size="2">$SPLUNK_HOME/etc/apps/search/local/</font></code>. You can then edit it there. 
</li></ul><p>In addition to any <code><font size="2">outputs.conf</font></code> files that you create and edit indirectly (for example, through the CLI), you can also create or edit an <code><font size="2">outputs.conf</font></code> file directly. It is recommended that you work with just a single copy of the file, which you place in <code><font size="2">$SPLUNK_HOME/etc/system/local/</font></code>. (If a copy of the file already exists in that directory, because of configuration changes made through the CLI, just edit that copy.) For purposes of distribution and management simplicity, you can combine settings from all non-default versions into a single custom <code><font size="2">outputs.conf</font></code> file.
</p><p>After making changes to <code><font size="2">outputs.conf</font></code>, you must restart the forwarder for the changes to take effect.
</p><p>For detailed information on <code><font size="2">outputs.conf</font></code>, look  here for the spec and examples.
</p>
<h3> <a name="configureforwarderswithoutputs.confd_configuration_levels"><span class="mw-headline" id="Configuration_levels"> Configuration levels </span></a></h3>
<p>There are two types of output processors: tcpout and syslog.
You can configure them at three levels of stanzas:
</p>
<ul><li> <b>Global.</b> At the global level, you specify any attributes that you want to apply globally, as well as certain attributes only configurable at the system-wide level for the output processor. This stanza is optional.
</li><li> <b>Target group.</b> A target group defines settings for one or more receiving indexers. There can be multiple target groups per output processor. Most configuration settings can be specified at the target group level.
</li><li> <b>Single server.</b> You can specify configuration values for single servers (receivers) within a target group. This stanza type is optional.
</li></ul><p>Configurations at the more specific level take precedence. For example, if you specify <code><font size="2">compressed=true</font></code> for a target group, the forwarder will send the servers in that target group compressed data, even if <code><font size="2">compressed</font></code> is set to "false" for the global level.
</p><p><b>Note:</b> This discussion focuses on the tcpout processor, which uses the <code><font size="2">[tcpout]</font></code> header. For the syslog output processor, see <a href="#forwarddatatothird-partysystemsd_syslog_data" class="external text">"Forward data to third-party systems"</a> for details. 
</p>
<h4><font size="3"><b><i> <a name="configureforwarderswithoutputs.confd_global_stanza"><span class="mw-headline" id="Global_stanza"> Global stanza </span></a></i></b></font></h4>
<p>Here you set any attributes that you want to apply globally.  This stanza is not required. However, there are several attributes that you can set only at the global level, including <code><font size="2">defaultGroup</font></code> and <code><font size="2">indexAndForward</font></code>.
</p><p>The global stanza for the tcpout procesor is specified with the <code><font size="2">[tcpout]</font></code> header. 
</p><p>Here's an example of a global tcpout stanza:
</p>
<code><font size="2"><br>[tcpout]<br>defaultGroup=indexer1<br>indexAndForward=true<br></font></code>
<p>This global stanza includes two attribute/value pairs:
</p>
<ul><li> <b>defaultGroup=indexer1</b> This tells the forwarder to send all data to the "indexer1" target group. See <a href="#configureforwarderswithoutputs.confd_default_target_groups" class="external text">"Default target groups"</a> for more information.
</li><li> <b>indexAndForward=true</b> This tells the forwarder to index the data locally, as well as forward the data to receiving indexers in the target groups. If set to "false" (the default), the forwarder just forwards data but does not index it. This attribute is only available for heavy forwarders; universal and light forwarders cannot index data.
</li></ul><h5> <a name="configureforwarderswithoutputs.confd_default_target_groups"><span class="mw-headline" id="Default_target_groups">Default target groups </span></a></h5>
<p>To set default groups for automatic forwarding, include the <code><font size="2">defaultGroup</font></code> attribute at the global level, in your <code><font size="2">[tcpout]</font></code> stanza:
</p>
<code><font size="2"><br>[tcpout]<br>defaultGroup= &lt;target_group1&gt;, &lt;target_group2&gt;, ...<br></font></code>
<p>The defaultGroup specifies one or more target groups, defined later in <code><font size="2">tcpout:&lt;target_group&gt;</font></code> stanzas. The forwarder will send all events to the specified groups. 
</p><p>If you do <b>not</b> want to forward data automatically, don't set the <code><font size="2">defaultGroup</font></code> attribute. (Prior to 4.2, you were required to set the <code><font size="2">defaultGroup</font></code> to some value. This is no longer necessary.)
</p><p>For some examples of using the <code><font size="2">defaultGroup</font></code> attribute, see <a href="#routeandfilterdatad" class="external text">"Route and filter data"</a>.
</p>
<h4><font size="3"><b><i> <a name="configureforwarderswithoutputs.confd_target_group_stanza"><span class="mw-headline" id="Target_group_stanza"> Target group stanza </span></a></i></b></font></h4>
<p>The target group identifies a set of receivers. It also specifies how the forwarder sends data to those receivers. You can define multiple target groups.
</p><p>Here's the basic pattern for the target group stanza:
</p>
<code><font size="2"><br>[tcpout:&lt;target_group&gt;]<br>server=&lt;receiving_server1&gt;, &lt;receiving_server2&gt;, ...<br>&lt;attribute1&gt; = &lt;val1&gt;<br>&lt;attribute2&gt; = &lt;val2&gt;<br>...<br></font></code>
<p>To specify a receiving server in a target group, use the format <code><font size="2">&lt;ipaddress_or_servername&gt;:&lt;port&gt;</font></code>, where <code><font size="2">&lt;port&gt;</font></code> is the receiving server's <b>receiving port</b>. For example, <code><font size="2">myhost.Splunk.com:9997</font></code>.  You can specify multiple receivers and the forwarder will load balance among them.
</p><p>See <a href="#configureforwarderswithoutputs.confd_define_typical_deployment_topologies" class="external text">"Define typical deployment topologies"</a>, later in this topic, for information on how to use the target group stanza to define several deployment topologies.
</p>
<h4><font size="3"><b><i> <a name="configureforwarderswithoutputs.confd_single-server_stanza"><span class="mw-headline" id="Single-server_stanza">Single-server stanza</span></a></i></b></font></h4>
<p>You can define a specific configuration for an individual receiving indexer. However, the receiver must also be a member of a target group.
</p><p>When you define an attribute at the single-server level, it takes precedence over  any definition at the target group or global level.
</p><p>Here is the syntax for defining a single-server stanza:
</p>
<code><font size="2"><br>[tcpout-server://&lt;ipaddress_or_servername&gt;:&lt;port&gt;]<br>&lt;attribute1&gt; = &lt;val1&gt;<br>&lt;attribute2&gt; = &lt;val2&gt;<br>...<br></font></code>
<h4><font size="3"><b><i> <a name="configureforwarderswithoutputs.confd_example"><span class="mw-headline" id="Example"> Example </span></a></i></b></font></h4>
<p>The following <code><font size="2">outputs.conf</font></code> example contains three stanzas for sending tcpout to Splunk Enterprise receivers:
</p>
<ul><li> Global settings. In this example, there is one setting, to specify a defaultGroup.
</li><li> Settings for a single target group consisting of two receivers. Here, we are specifying a load-balanced target group consisting of two receivers.
</li><li> Settings for one receiver within the target group. In this stanza, you can specify any settings specific to the <code><font size="2">mysplunk_indexer1</font></code> receiver.
</li></ul><code><font size="2"><br>[tcpout]<br>defaultGroup=my_indexers<br><br>[tcpout:my_indexers]<br>server=mysplunk_indexer1:9997, mysplunk_indexer2:9996<br><br>[tcpout-server://mysplunk_indexer1:9997]<br></font></code>
<h3> <a name="configureforwarderswithoutputs.confd_define_typical_deployment_topologies"><span class="mw-headline" id="Define_typical_deployment_topologies">Define typical deployment topologies</span></a></h3>
<p>This section shows how you can configure a forwarder to support several typical deployment topologies. See the other topics in the "Forward data" section of this book for information on configuring forwarders for other topologies.
</p>
<h4><font size="3"><b><i> <a name="configureforwarderswithoutputs.confd_load_balancing"><span class="mw-headline" id="Load_balancing">Load balancing</span></a></i></b></font></h4>
<p>To perform <b>load balancing</b>, specify one target group with multiple receivers. In this example, the target group consists of three receivers:
</p>
<code><font size="2"><br>[tcpout:my_LB_indexers]<br>server=10.10.10.1:9997,10.10.10.2:9996,10.10.10.3:9995<br></font></code>
<p>The forwarder will load balance between the three receivers listed. If one receiver goes down, the forwarder automatically switches to the next one available.
</p>
<h4><font size="3"><b><i> <a name="configureforwarderswithoutputs.confd_data_cloning"><span class="mw-headline" id="Data_cloning">Data cloning</span></a></i></b></font></h4>
<p>To perform <b>data cloning</b>, specify multiple target groups, each in its own stanza. In data cloning, the forwarder sends copies of all its events to the receivers in two or more target groups. Data cloning usually results in similar, but not necessarily exact, copies of data on the receiving indexers. Here's an example of how you set up data cloning:
</p>
<code><font size="2"><br>[tcpout]<br>defaultGroup=indexer1,indexer2<br><br>[tcpout:indexer1]<br>server=10.1.1.197:9997<br><br>[tcpout:indexer2]<br>server=10.1.1.200:9997<br></font></code>
<p>The forwarder will send duplicate data streams to the servers specified in both the <code><font size="2">indexer1</font></code> and <code><font size="2">indexer2</font></code> target groups.
</p>
<h4><font size="3"><b><i> <a name="configureforwarderswithoutputs.confd_data_cloning_with_load_balancing"><span class="mw-headline" id="Data_cloning_with_load_balancing">Data cloning with load balancing</span></a></i></b></font></h4>
<p>You can combine load balancing with data cloning. For example:
</p>
<code><font size="2"><br>[tcpout]<br>defaultGroup=cloned_group1,cloned_group2<br><br>[tcpout:cloned_group1]<br>server=10.10.10.1:9997, 10.10.10.2:9997, 10.10.10.3:9997<br><br>[tcpout:cloned_group2]<br>server=10.1.1.197:9997, 10.1.1.198:9997, 10.1.1.199:9997, 10.1.1.200:9997<br></font></code>
<p>The forwarder will send full data streams to both <code><font size="2">cloned_group1</font></code> and <code><font size="2">cloned_group2.</font></code> The data will be load-balanced within each group, rotating among receivers every 30 seconds (the default frequency). 
</p><p><b>Note:</b> For syslog and other output types, you must explicitly specify routing as described here:  <a href="#routeandfilterdatad" class="external text">"Route and filter data"</a>.
</p>
<h3> <a name="configureforwarderswithoutputs.confd_commonly_used_attributes"><span class="mw-headline" id="Commonly_used_attributes"> Commonly used attributes </span></a></h3>
<p>The <code><font size="2">outputs.conf</font></code> file provides a large number of configuration options that offer considerable control and flexibility in forwarding. Of the attributes available, several are of particular interest:
</p>
<table cellpadding="5" cellspacing="0" border="1" width="100%"><tr><th bgcolor="#C0C0C0"> Attribute
</th><th bgcolor="#C0C0C0"> Default
</th><th bgcolor="#C0C0C0"> Where configured
</th><th bgcolor="#C0C0C0"> Value
</th></tr><tr><td valign="center" align="left"> defaultGroup
</td><td valign="center" align="left"> n/a
</td><td valign="center" align="left"> global stanza
</td><td valign="center" align="left"> A comma-separated list of one or more target groups. Forwarder sends all events to all specified target groups. Don't set this attribute if you don't want events automatically forwarded to a target group.
</td></tr><tr><td valign="center" align="left"> indexAndForward
</td><td valign="center" align="left"> false
</td><td valign="center" align="left"> global stanza
</td><td valign="center" align="left">If set to "true", the forwarder will index all data locally, in addition to forwarding the data to a receiving indexer.
<p><b>Important:</b> This attribute is only available for heavy forwarders. A universal forwarder cannot index locally.
</p>
</td></tr><tr><td valign="center" align="left"> server
</td><td valign="center" align="left"> n/a
</td><td valign="center" align="left"> target group stanza
</td><td valign="center" align="left"> Required. Specifies the server(s) that will function as receivers for the forwarder. This must be set to a value using the format <code><font size="2">&lt;ipaddress_or_servername&gt;:&lt;port&gt;</font></code>, where <code><font size="2">&lt;port&gt;</font></code> is the receiving server's receiving port.
</td></tr><tr><td valign="center" align="left"> disabled
</td><td valign="center" align="left"> false
</td><td valign="center" align="left"> any stanza level
</td><td valign="center" align="left"> Specifies whether the stanza is disabled. If set to "true", it is equivalent to the stanza not being there.
</td></tr><tr><td valign="center" align="left"> sendCookedData
</td><td valign="center" align="left"> true
</td><td valign="center" align="left"> global or target group stanza
</td><td valign="center" align="left"> Specifies whether data is cooked before forwarding.
</td></tr><tr><td valign="center" align="left"> compressed
</td><td valign="center" align="left"> false
</td><td valign="center" align="left"> global or target group stanza
</td><td valign="center" align="left"> Specifies whether the forwarder sends compressed data.
</td></tr><tr><td valign="center" align="left"> ssl....
</td><td valign="center" align="left"> n/a
</td><td valign="center" align="left"> any stanza level
</td><td valign="center" align="left"> Set of attributes for configuring SSL. See "About securing data from forwarders" in the Securing Splunk Enterprise manual for information on how to use these attributes.
</td></tr><tr><td valign="center" align="left"> useACK
</td><td valign="center" align="left"> false
</td><td valign="center" align="left"> global or target group stanza
</td><td valign="center" align="left"> Specifies whether the forwarder waits for indexer acknowledgment confirming that the data has been written to the file system. See <a href="#protectagainstlossofin-flightdata" class="external text">"Protect against loss of in-flight data"</a>.
</td></tr><tr><td valign="center" align="left"> dnsResolutionInterval
</td><td valign="center" align="left"> 300
</td><td valign="center" align="left"> global or target group stanza
</td><td valign="center" align="left"> Specifies base time interval in seconds at which indexer DNS names will be resolved to IP address. See <a href="#configureforwarderswithoutputs.confd_dns_resolution_interval" class="external text">"DNS resolution interval"</a>.
</td></tr></table><p>The <code><font size="2">outputs.conf.spec</font></code> file, which you can find here, along with several examples, provides details for these and all other configuration options. In addition, most of these settings are discussed in topics dealing with specific forwarding scenarios.
</p><p><b>Note:</b> In 4.2, the persistent queue capability was much improved. It is now a feature of data inputs and is therefore configured in inputs.conf. It is not related in any way to the previous, deprecated persistent queue capability, which was configured through <code><font size="2">outputs.conf</font></code>. See "Use persistent queues to prevent data loss" for details.
</p>
<h4><font size="3"><b><i> <a name="configureforwarderswithoutputs.confd_dns_resolution_interval"><span class="mw-headline" id="DNS_resolution_interval"> DNS resolution interval </span></a></i></b></font></h4>
<p>The <code><font size="2">dnsResolutionInterval</font></code> attribute specifies the base time interval (in seconds) at which receiver DNS names will be resolved to IP addresses. This value is used to compute the run-time interval as follows:
</p>
<code><font size="2"><br>run-time interval = dnsResolutionInterval + (number of receivers in server attribute - 1) * 30<br></font></code>
<p>The run-time interval is extended by 30 seconds for each additional receiver specified in the <code><font size="2">server</font></code> attribute; that is, for each additional receiver across which the forwarder is load balancing. The <code><font size="2">dnsResolutionInterval</font></code> attribute defaults to 300 seconds.
</p><p>For example, if you leave the attribute at the default setting of 300 seconds and the forwarder is load-balancing across 20 indexers, DNS resolution will occur every 14 minutes:
</p>
<code><font size="2"><br>(300 + ((20 - 1) * 30)) = 870 seconds = 14 minutes<br></font></code>
<p>If you change <code><font size="2">dnsResolutionInterval</font></code>  to 600 seconds, and keep the number of load-balanced indexers at 20, DNS resolution will occur every 19.5 minutes:
</p>
<code><font size="2"><br>(600 + ((20 - 1) * 30)) = 1170 seconds = 19.5 minutes<br></font></code>

<a name="protectagainstlossofin-flightdata"></a><h2> <a name="protectagainstlossofin-flightdata_protect_against_loss_of_in-flight_data"><span class="mw-headline" id="Protect_against_loss_of_in-flight_data"> Protect against loss of in-flight data</span></a></h2>
<p>To guard against loss of data when <b>forwarding</b> to an <b>indexer</b>, you can use the <b>indexer acknowledgment</b> capability. With indexer acknowledgment, the <b>forwarder</b> will resend any data not acknowledged as "received" by the indexer.
</p><p>You enable indexer acknowledgment on the forwarder, in <code><font size="2">outputs.conf</font></code>. The feature is disabled by default. 
</p><p><b>Note:</b> Both forwarders and indexers must be version 4.2 or above for indexer acknowledgment to function. Otherwise, the transmission will proceed without acknowledgment.  
</p>
<h3> <a name="protectagainstlossofin-flightdata_indexer_acknowledgment_and_indexer_clusters"><span class="mw-headline" id="Indexer_acknowledgment_and_indexer_clusters"> Indexer acknowledgment and indexer clusters </span></a></h3>
<p>When using forwarders to send data to peer nodes in an indexer cluster, you should ordinarily enable indexer acknowledgment. To learn more about forwarders and clusters, read "Use forwarders to get your data" in the <i>Managing Indexers and Clusters of Indexers</i> manual.
</p>
<h3> <a name="protectagainstlossofin-flightdata_how_indexer_acknowledgment_works_when_everything_goes_well"><span class="mw-headline" id="How_indexer_acknowledgment_works_when_everything_goes_well"> How indexer acknowledgment works when everything goes well</span></a></h3>
<p>The forwarder sends data continuously to the indexer, in blocks of approximately 64kB. The forwarder maintains a copy of each block in memory, in its wait queue, until it gets an acknowledgment from the indexer. While waiting, it continues to send more data blocks.
</p><p>If all goes well, the indexer:
</p><p><b>1.</b> Receives the block of data.
</p><p><b>2.</b> Parses the data.
</p><p><b>3.</b> Writes the data to the file system as events (raw data and index data).
</p><p><b>4.</b> Sends an acknowledgment to the forwarder.
</p><p>The acknowledgment tells the forwarder that the indexer received the data and successfully wrote it to the file system. Upon receiving the acknowledgment, the forwarder releases the block from memory.
</p><p>If the wait queue is of sufficient size, it doesn't fill up while waiting for acknowledgments to arrive. But see <a href="#protectagainstlossofin-flightdata_a_key_performance_consideration" class="external text">this section</a> for possible issues and ways to address them, including how to increase the wait queue size.
</p>
<h3> <a name="protectagainstlossofin-flightdata_how_indexer_acknowledgment_works_when_there.27s_a_failure"><span class="mw-headline" id="How_indexer_acknowledgment_works_when_there.27s_a_failure"> How indexer acknowledgment works when there's a failure</span></a></h3>
<p>When there's a failure in the round-trip process, the forwarder does not receive an acknowledgment. It will then attempt to resend the block of data.
</p>
<h4><font size="3"><b><i> <a name="protectagainstlossofin-flightdata_why_no_acknowledgment.3f"><span class="mw-headline" id="Why_no_acknowledgment.3F">Why no acknowledgment?</span></a></i></b></font></h4>
<p>These are the reasons that a forwarder might not receive acknowledgment:
</p>
<ul><li> Indexer goes down after receiving the data -- for instance, due to machine failure.
</li><li> Indexer is unable to write to the file system -- for instance, because the disk is full.
</li><li> Network goes down while acknowledgment is en route to the forwarder.
</li></ul><h4><font size="3"><b><i> <a name="protectagainstlossofin-flightdata_how_the_forwarder_deals_with_failure"><span class="mw-headline" id="How_the_forwarder_deals_with_failure">How the forwarder deals with failure</span></a></i></b></font></h4>
<p>After sending a data block, the forwarder maintains a copy of the data in its wait queue until it receives an acknowledgment. In the meantime, it continues to send additional blocks as usual. If the forwarder doesn't get acknowledgment for a block within 300 seconds (by default), it closes the connection. You can change the wait time by setting the <code><font size="2">readTimeout</font></code> attribute in <code><font size="2">outputs.conf</font></code>.
</p><p>If the forwarder is set up for <b>auto load balancing</b>, it then opens a connection to the next indexer in the group (if one is available) and sends the data to it. If the forwarder is not set up for auto load balancing, it attempts to open a connection to the same indexer as before and resend the data. 
</p><p>The forwarder maintains the data block in the wait queue until acknowledgment is received. Once the wait queue fills up, the forwarder stops sending additional blocks until it receives an acknowledgment for one of the blocks, at which point it can  free up space in the queue.
</p>
<h4><font size="3"><b><i> <a name="protectagainstlossofin-flightdata_other_reasons_the_forwarder_might_close_a_connection"><span class="mw-headline" id="Other_reasons_the_forwarder_might_close_a_connection"> Other reasons the forwarder might close a connection</span></a></i></b></font></h4>
<p>There are actually three conditions that can cause the forwarder to close the network connection:
</p>
<ul><li> Read timeout. The forwarder doesn't receive acknowledgment within 300 (default) seconds. This is the condition described above.
</li><li> Write timeout. The forwarder is not able to finish a network write within 300 (default) seconds. The value is configurable in <code><font size="2">outputs.conf</font></code> by setting <code><font size="2">writeTimeout</font></code>.
</li><li> Read/write failure. Typical causes include the indexer's machine crashing or the network going down. 
</li></ul><p>In all these cases, the forwarder will then attempt to open a connection to the next indexer in the load-balanced group, or to the same indexer again if load-balancing is not enabled. 
</p>
<h4><font size="3"><b><i> <a name="protectagainstlossofin-flightdata_the_possibility_of_duplicates"><span class="mw-headline" id="The_possibility_of_duplicates">The possibility of duplicates</span></a></i></b></font></h4>
<p>It's possible for the indexer to index the same data block twice. This can happen if there's a network problem that prevents an acknowledgment from reaching the forwarder. For instance, assume the indexer receives a data block, parses it, and writes it to the file system. It then generates the acknowledgment. However, on the round-trip to the forwarder, the network goes down, so the forwarder never receives the acknowledgment. When the network comes back up, the forwarder then resends the data block, which the indexer will parse and write as if it were new data.
</p><p>To deal with such a possibility, every time the forwarder resends a data block, it writes an event to its <code><font size="2">splunkd.log</font></code> noting that it's a possible duplicate. The admin is responsible for using the log information to track down the duplicate data on the indexer.
</p><p>Here's an example of a duplicate warning:
</p>
<code><font size="2"><br>10-18-2010 17:32:36.941 WARN &nbsp;TcpOutputProc - Possible duplication of events with <br>channel=source::/home/jkerai/splunk/current-install/etc/apps/sample_app<br>/logs/maillog.1|host::MrT|sendmail|, streamId=5941229245963076846, offset=131072 <br>subOffset=219 on host=10.1.42.2:9992<br></font></code>
<h3> <a name="protectagainstlossofin-flightdata_enable_indexer_acknowledgment"><span class="mw-headline" id="Enable_indexer_acknowledgment">Enable indexer acknowledgment</span></a></h3>
<p>You configure indexer acknowledgment on the forwarder.  Set the <code><font size="2">useACK</font></code> attribute to <code><font size="2">true</font></code> in <code><font size="2">outputs.conf</font></code>:
</p>
<code><font size="2"><br>[tcpout:&lt;target_group&gt;]<br>server=&lt;server1&gt;, &lt;server2&gt;, ...<br>useACK=true<br></font></code>
<p>By default, <code><font size="2">useACK</font></code> is set to <code><font size="2">false</font></code>.
</p><p><b>Note:</b> You can set <code><font size="2">useACK</font></code> either globally or by target group, at the <code><font size="2">[tcpout]</font></code> or <code><font size="2">[tcpout:&lt;target_group&gt;]</font></code> stanza levels. You cannot set it for individual receiving indexers at the <code><font size="2">[tcpout-server: ...]</font></code> stanza level. 
</p><p>For more information, see the outputs.conf spec file.
</p>
<h3> <a name="protectagainstlossofin-flightdata_indexer_acknowledgment_and_forwarded_data_throughput"><span class="mw-headline" id="Indexer_acknowledgment_and_forwarded_data_throughput"> Indexer acknowledgment and forwarded data throughput  </span></a></h3>
<p>The forwarder uses a wait queue to manage the indexer acknowledgment process. This queue has a default maximum size of 21MB, which is generally sufficient. In rare cases, however, you might need to manually adjust the wait queue size.  
</p><p>If you want more information about the wait queue, read this section. It describes how the wait queue size is configured. It also provides detailed information on how the wait queue functions.
</p>
<h4><font size="3"><b><i> <a name="protectagainstlossofin-flightdata_how_the_wait_queue_size_is_configured"><span class="mw-headline" id="How_the_wait_queue_size_is_configured">How the wait queue size is configured</span></a></i></b></font></h4>
<p>You do not set the wait queue size directly. Instead, you set the size of the in-memory output queue, and the wait queue size is automatically set to three times the output queue size. To configure the output queue size, use the <code><font size="2">maxQueueSize</font></code> attribute in <code><font size="2">outputs.conf</font></code>.
</p><p>The default for the <code><font size="2">maxQueueSize</font></code> attribute is <code><font size="2">auto</font></code>. Splunk recommends that you keep this setting. It optimizes the queue sizes, based on whether indexer acknowledgment is enabled:
</p>
<ul><li> When <code><font size="2">useACK=true</font></code>, the output queue size is 7MB and the wait queue size is 21MB.  
</li><li> When <code><font size="2">useACK=false</font></code>, the output queue size is 500KB. 
</li></ul><p>You can set <code><font size="2">maxQueueSize</font></code> to specific values if necessary. See the  outputs.conf spec file for further details on <code><font size="2">maxQueueSize</font></code>.
</p><p>Note the following points regarding the <code><font size="2">maxQueueSize=auto</font></code> recommendation:
</p>
<ul><li> When you turn on indexer acknowledgment, the increase in queue size takes effect only after you restart the forwarder.
</li><li> The <code><font size="2">auto</font></code> setting is only available for forwarders of version 5.0.4 and above. For earlier version forwarders running indexer acknowledgment, you need to explicitly set the <code><font size="2">maxQueueSize</font></code> attribute to 7MB.
</li></ul><h4><font size="3"><b><i> <a name="protectagainstlossofin-flightdata_why_the_wait_queue_matters"><span class="mw-headline" id="Why_the_wait_queue_matters">Why the wait queue matters</span></a></i></b></font></h4>
<p>If you enable indexer acknowledgment, the forwarder uses a wait queue to manage the acknowledgment process. Because the forwarder sends data blocks continuously and does not wait for acknowledgment before sending the next block, its wait queue will typically maintain many blocks, each waiting for its acknowledgment. The forwarder will continue to send blocks until its wait queue is full, at which point it will stop forwarding. The forwarder then waits until it receives an acknowledgment, which allows it to release a block from its queue and thus resume forwarding. 
</p><p>A wait queue can fill up when something is wrong with the network or indexer; however, it can also fill up even when the indexer is functioning normally. This is because the indexer only sends the acknowledgment after it has written the data to the file system. Any delay in writing to the file system will slow the pace of acknowledgment, leading to a full wait queue.  
</p><p>There are a few reasons that a normal functioning indexer might delay writing data to the file system (and so delay its sending of acknowledgments):
</p>
<ul><li> The indexer is very busy. For example, at the time the data arrives, the indexer might be dealing with multiple search requests or with data coming from a large number of forwarders. 
</li><li> The indexer is receiving too <i>little</i> data. For efficiency, an indexer only writes to the file system periodically -- either when a write queue fills up or after a timeout of a few seconds. If a write queue is slow to fill up, the indexer will wait until the timeout to write. If data is coming from only a few forwarders, the indexer can end up in the timeout condition, even if each of those forwarders is sending a normal quantity of data. Since write queues exist on a per hot bucket basis, the condition occurs when some particular bucket is getting a small amount of data.  Usually this means that a particular index is getting a small amount of data.
</li></ul><p>To ensure that throughput does not degrade because the forwarder is waiting on the indexer for acknowledgment, you should ordinarily retain the default setting of <code><font size="2">maxQueueSize=auto</font></code>. In rare cases, you might need to increase the wait queue size, so that the forwarder has sufficient space to maintain all blocks in memory while waiting for acknowledgments to arrive. On the other hand, if you have many forwarders feeding a single indexer and a moderate number of data sources per forwarder, you might be able to conserve a few megabytes of memory by using a smaller size.
</p>
<h3> <a name="protectagainstlossofin-flightdata_when_the_receiver_is_a_forwarder.2c_not_an_indexer"><span class="mw-headline" id="When_the_receiver_is_a_forwarder.2C_not_an_indexer">When the receiver is a forwarder, not an indexer</span></a></h3>
<p>You can also use indexer acknowledgment when the data transmission occurs via an intermediate forwarder; that is, where an originating forwarder sends the data to an intermediate forwarder, which then forwards it to the indexer.  For this scenario, if you want to use indexer acknowledgment, it is recommended that you enable it along all segments of the data transmission. That way, you can ensure that the data gets delivered along the entire path from originating forwarder to indexer.
</p><p>Assume you have an originating forwarder that sends data to an intermediate forwarder, which in turn forwards that data to an indexer. To enable indexer acknowledgment along the entire line of transmission, you must enable it twice: first for the segment between originating forwarder and intermediate forwarder, and again for the segment between intermediate forwarder and indexer.  
</p><p>If you enable both segments of the transmission, the intermediate forwarder waits until it receives acknowledgment from the indexer and then it sends acknowledgment back to the originating forwarder.
</p><p>However, if you enable just one of the segments, you only get indexer acknowledgment over that part of the transmission. For example, say indexer acknowledgment is enabled for the segment from originating forwarder to intermediate forwarder but not for the segment from intermediate forwarder to indexer. In this case, the intermediate forwarder sends acknowledgment back to the originating forwarder as soon as it sends the data on to the indexer. It then relies on TCP to safely deliver the data to the indexer. Because indexer acknowledgment is not enabled for this second segment, the intermediate forwarder cannot verify delivery of the data to the indexer. This second case has limited value and is not recommended.
</p>
<a name="routeandfilterdatad"></a><h2> <a name="routeandfilterdatad_route_and_filter_data"><span class="mw-headline" id="Route_and_filter_data"> Route and filter data</span></a></h2>
<p>Forwarders can filter and route data to specific receivers based on criteria such as source, source type, or patterns in the events themselves. For example, a forwarder can send all data from one group of hosts to one indexer and all data from a second group of hosts to a second indexer. Heavy forwarders can also look inside the events and filter or route accordingly. For example, you could use a heavy forwarder to inspect WMI event codes to filter or route Windows events. This topic describes a number of typical routing scenarios.
</p><p>Besides routing to receivers, forwarders can also filter and route data to specific queues or discard the data altogether by routing to the null queue.
</p><p><b>Important:</b> Only heavy forwarders can route or filter data at the event level. Universal forwarders and light forwarders do not have the ability to inspect individual events except in the case of file header extractions, but they can still forward data based on a data stream's host, source, or source type. They can also route based on the data's input stanza, as described below, in the subtopic, <a href="#routeandfilterdatad_route_inputs_to_specific_indexers_based_on_the_data.27s_input" class="external text">"Route inputs to specific indexers based on the data's input"</a>.
</p><p>Here's a simple illustration of a forwarder routing data to three indexers:
</p><p><img alt="30 admin13 forwardreceive-datarouting 60.png" src="images/b/be/30_admin13_forwardreceive-datarouting_60.png" width="700" height="554"></p><p>This topic describes how to filter and route event data to Splunk Enterprise instances. See <a href="#forwarddatatothird-partysystemsd" class="external text">"Forward data to third-party systems"</a> in this manual for information on routing to non-Splunk systems.
</p><p>This topic also describes how to perform selective indexing and forwarding, in which you index some data locally on a heavy forwarder and forward the non-indexed data to one or more separate indexers. See <a href="#routeandfilterdatad_perform_selective_indexing_and_forwarding" class="external text">"Perform selective indexing and forwarding"</a> later in this topic for details.
</p>
<h3> <a name="routeandfilterdatad_configure_routing"><span class="mw-headline" id="Configure_routing"> Configure routing </span></a></h3>
<p>This is the basic pattern for defining most routing scenarios (using a heavy forwarder):
</p><p><b>1.</b> Determine what criteria to use for routing. How will you identify categories of events, and where will you route them?
</p><p><b>2.</b> Edit props.conf to add a TRANSFORMS-routing attribute to determine routing based on event metadata:
</p>
<code><font size="2"><br>[&lt;spec&gt;]<br>TRANSFORMS-routing=&lt;transforms_stanza_name&gt;<br></font></code>
<p>Note the following:
</p>
<ul><li> <code><font size="2">&lt;spec&gt;</font></code> can be:
<ul><li><code><font size="2">&lt;sourcetype&gt;</font></code>, the source type of an event
</li><li><code><font size="2">host::&lt;host&gt;</font></code>, where &lt;host&gt; is the host for an event
</li><li><code><font size="2">source::&lt;source&gt;</font></code>, where &lt;source&gt; is the source for an event
</li></ul></li><li> If you have multiple TRANSFORMS attributes, use a unique name for each. For example: "TRANSFORMS-routing1", "TRANSFORMS-routing2", and so on.
</li><li> <code><font size="2">&lt;transforms_stanza_name&gt;</font></code> must be unique. 
</li></ul><p>Use the <code><font size="2">&lt;transforms_stanza_name&gt;</font></code> specified here when creating an entry in <code><font size="2">transforms.conf</font></code> (below). 
</p><p>Examples later in this topic show how to use this syntax.
</p><p><b>3.</b> Edit transforms.conf to specify target groups and to set additional criteria for routing based on event patterns:
</p>
<code><font size="2"><br>[&lt;transforms_stanza_name&gt;]<br>REGEX=&lt;routing_criteria&gt;<br>DEST_KEY=_TCP_ROUTING<br>FORMAT=&lt;target_group&gt;,&lt;target_group&gt;,....<br></font></code>
<p>Note: 
</p>
<ul><li> <code><font size="2">&lt;transforms_stanza_name&gt;</font></code> must match the name you defined in <code><font size="2">props.conf</font></code>.
</li><li> In <code><font size="2">&lt;routing_criteria&gt;</font></code>, enter the regex rules that determine which events get routed. This line is required. Use "<code><font size="2">REGEX = .</font></code>" if you don't need additional filtering beyond the metadata specified in <code><font size="2">props.conf</font></code>.
</li><li> <code><font size="2">DEST_KEY</font></code> should be set to <code><font size="2">_TCP_ROUTING</font></code> to send events via TCP. It can also be set to <code><font size="2">_SYSLOG_ROUTING</font></code> or <code><font size="2">_HTTPOUT_ROUTING</font></code> for other output processors.
</li><li> Set <code><font size="2">FORMAT</font></code> to a <code><font size="2">&lt;target_group&gt;</font></code> that matches a target group name you defined in <code><font size="2">outputs.conf</font></code>. A comma separated list will clone events to multiple target groups.
</li></ul><p>Examples later in this topic show how to use this syntax.
</p><p><b>4.</b> Edit outputs.conf to define the target group(s) for the routed data:
</p>
<code><font size="2"><br>[tcpout:&lt;target_group&gt;]<br>server=&lt;ip&gt;:&lt;port&gt;<br></font></code>
<p>Note:
</p>
<ul><li> Set <code><font size="2">&lt;target_group&gt;</font></code> to match the name you specified in <code><font size="2">transforms.conf</font></code>.
</li><li> Set the IP address and port to match the receiving server.
</li></ul><p>The use cases described in this topic generally follow this pattern.
</p>
<h3> <a name="routeandfilterdatad_filter_and_route_event_data_to_target_groups"><span class="mw-headline" id="Filter_and_route_event_data_to_target_groups"> Filter and route event data to target groups </span></a></h3>
<p>In this example, a heavy forwarder filters three types of events, routing them to different target groups. The forwarder filters and routes according to these criteria:
</p>
<ul><li> Events with a source type of "syslog" to a load-balanced target group
</li><li> Events containing the word "error" to a second target group
</li><li> All other events to a default target group
</li></ul><p>Here's how you do it:
</p><p><b>1.</b> Edit <code><font size="2">props.conf</font></code> in <code><font size="2">$SPLUNK_HOME/etc/system/local</font></code> to set two TRANSFORMS-routing attributes &mdash; one for syslog data and a default for all other data:
</p>
<code><font size="2"><br>[default]<br>TRANSFORMS-routing=errorRouting<br><br>[syslog]<br>TRANSFORMS-routing=syslogRouting<br></font></code>
<p><b>2.</b> Edit <code><font size="2">transforms.conf</font></code> to set the routing rules for each routing transform:
</p>
<code><font size="2"><br>[errorRouting]<br>REGEX=error<br>DEST_KEY=_TCP_ROUTING<br>FORMAT=errorGroup<br><br>[syslogRouting]<br>REGEX=.<br>DEST_KEY=_TCP_ROUTING<br>FORMAT=syslogGroup<br></font></code>
<p><b>Note:</b> In this example, if a syslog event contains the word "error", it will route to <code><font size="2">syslogGroup</font></code>, not <code><font size="2">errorGroup</font></code>. This is due to the settings previously specified in <code><font size="2">props.conf</font></code>. Those settings dictated that all syslog events be filtered through the <code><font size="2">syslogRouting</font></code> transform, while all non-syslog (default) events be filtered through the <code><font size="2">errorRouting</font></code> transform. Therefore, only non-syslog events get inspected for errors.
</p><p><b>3.</b> Edit <code><font size="2">outputs.conf</font></code> to define the target groups:
</p>
<code><font size="2"><br>[tcpout]<br>defaultGroup=everythingElseGroup<br><br>[tcpout:syslogGroup]<br>server=10.1.1.197:9996, 10.1.1.198:9997<br><br>[tcpout:errorGroup]<br>server=10.1.1.200:9999<br><br>[tcpout:everythingElseGroup]<br>server=10.1.1.250:6666<br></font></code>
<p>syslogGroup and errorGroup receive events according to the rules specified in <code><font size="2">transforms.conf</font></code>. All other events get routed to the default group, everythingElseGroup.
</p>
<h3> <a name="routeandfilterdatad_replicate_a_subset_of_data_to_a_third-party_system"><span class="mw-headline" id="Replicate_a_subset_of_data_to_a_third-party_system">Replicate a subset of data to a third-party system</span></a></h3>
<p>This example uses data filtering to route two data streams. It forwards:
</p>
<ul><li> All the data, in cooked form, to a Splunk Enterprise indexer (10.1.12.1:9997) 
</li><li> A replicated subset of the data, in raw form, to a third-party server (10.1.12.2:1234)
</li></ul><p>The example sends both streams as TCP. To send the second stream as syslog data, first route the data through an indexer.
</p><p><b>1.</b> Edit <code><font size="2">props.conf</font></code>:
</p>
<code><font size="2"><br>[syslog]<br>TRANSFORMS-routing = routeAll, routeSubset<br></font></code>
<p><b>2.</b> Edit <code><font size="2">transforms.conf</font></code>:
</p>
<code><font size="2"><br>[routeAll]<br>REGEX=(.)<br>DEST_KEY=_TCP_ROUTING<br>FORMAT=Everything<br><br>[routeSubset]<br>REGEX=(SYSTEM|CONFIG|THREAT)<br>DEST_KEY=_TCP_ROUTING<br>FORMAT=Subsidiary,Everything<br></font></code>
<p><b>3.</b> Edit <code><font size="2">outputs.conf</font></code>:
</p>
<code><font size="2"><br>[tcpout]<br>defaultGroup=nothing<br><br>[tcpout:Everything]<br>disabled=false<br>server=10.1.12.1:9997<br><br>[tcpout:Subsidiary]<br>disabled=false<br>sendCookedData=false<br>server=10.1.12.2:1234<br></font></code>
<p>For more information, see <a href="#forwarddatatothird-partysystemsd" class="external text">"Forward data to third party systems"</a> in this manual.
</p>
<h3> <a name="routeandfilterdatad_filter_event_data_and_send_to_queues"><span class="mw-headline" id="Filter_event_data_and_send_to_queues"> Filter event data and send to queues </span></a></h3>
<p>Although similar to forwarder-based routing, queue routing can be performed by an indexer, as well as a heavy forwarder. It does not use the <code><font size="2">outputs.conf</font></code> file, just <code><font size="2">props.conf</font></code> and <code><font size="2">transforms.conf</font></code>. 
</p><p>You can eliminate unwanted data by routing it to <code><font size="2">nullQueue</font></code>, the Splunk Enterprise equivalent of the <code><font size="2">/dev/null</font></code> device. When you filter out data in this way, the filtered data is not forwarded or added to the Splunk Enterprise index at all, and doesn't count toward your indexing volume. 
</p><p><b>Note:</b> See "<a href="#routeandfilterdatad_caveats_for_routing_and_filtering_structured_data" class="external text">Caveats for routing and filtering structured data</a>" later in this topic.
</p>
<h4><font size="3"><b><i> <a name="routeandfilterdatad_discard_specific_events_and_keep_the_rest"><span class="mw-headline" id="Discard_specific_events_and_keep_the_rest"> Discard specific events and keep the rest </span></a></i></b></font></h4>
<p>This example discards all <code><font size="2">sshd</font></code> events in <code><font size="2">/var/log/messages</font></code> by sending them to <code><font size="2">nullQueue</font></code>:
</p><p><b>1.</b> In <code><font size="2">props.conf</font></code>, set the TRANSFORMS-null attribute:
</p>
<code><font size="2"><br>[source::/var/log/messages]<br>TRANSFORMS-null= setnull<br></font></code>
<p><b>2.</b> Create a corresponding stanza in <code><font size="2">transforms.conf</font></code>. Set <code><font size="2">DEST_KEY</font></code> to "queue" and <code><font size="2">FORMAT</font></code> to "nullQueue":
</p>
<code><font size="2"><br>[setnull]<br>REGEX = \[sshd\]<br>DEST_KEY = queue<br>FORMAT = nullQueue<br></font></code>
<p>That does it.
</p>
<h4><font size="3"><b><i> <a name="routeandfilterdatad_keep_specific_events_and_discard_the_rest"><span class="mw-headline" id="Keep_specific_events_and_discard_the_rest"> Keep specific events and discard the rest </span></a></i></b></font></h4>
<p>Here's the opposite scenario. In this example, you use two transforms to keep <i>only</i> the <code><font size="2">sshd</font></code> events. One transform routes <code><font size="2">sshd</font></code> events to <code><font size="2">indexQueue</font></code>, while another routes all other events to <code><font size="2">nullQueue.</font></code> 
</p><p><b>Note:</b> In this example, the order of the transforms in <code><font size="2">props.conf</font></code> matters. The null queue transform must come first; if it comes later, it will invalidate the previous transform and route all events to the null queue. 
</p><p><b>1.</b> In <code><font size="2">props.conf</font></code>:
</p>
<code><font size="2"><br>[source::/var/log/messages]<br>TRANSFORMS-set= setnull,setparsing<br></font></code>
<p><b>2.</b> In <code><font size="2">transforms.conf</font></code>:
</p>
<code><font size="2"><br>[setnull]<br>REGEX = .<br>DEST_KEY = queue<br>FORMAT = nullQueue<br><br>[setparsing]<br>REGEX = \[sshd\]<br>DEST_KEY = queue<br>FORMAT = indexQueue<br></font></code>
<h4><font size="3"><b><i> <a name="routeandfilterdatad_filter_wmi_events"><span class="mw-headline" id="Filter_WMI_events"> Filter WMI events </span></a></i></b></font></h4>
<p>You can filter WinEventLog directly at the forwarder level.
</p><p>Otherwise to filter on WMI events, use [WMI:WinEventLog:Security] source type stanza in <code><font size="2">props.conf</font></code>.  The following example uses regex to filter out two Windows event codes, 592 and 593:
</p><p>In <code><font size="2">props.conf</font></code>:
</p>
<code><font size="2"><br>[WinEventLog:Security]<br>TRANSFORMS-wmi=wminull<br><br></font></code>
<p><b>Note:</b> In pre-4.2.x versions of Splunk Enterprise, you must use [wmi] or [WMI::WinEventLog:Security] as the source type in order to send events to nullQueue.
</p><p>In <code><font size="2">transforms.conf</font></code>:
</p>
<code><font size="2"><br>[wminull]<br>REGEX=(?m)^EventCode=(592|593)<br>DEST_KEY=queue<br>FORMAT=nullQueue<br></font></code>
<h3> <a name="routeandfilterdatad_filter_data_by_target_index"><span class="mw-headline" id="Filter_data_by_target_index">Filter data by target index </span></a></h3>
<p>Forwarders have a <b>forwardedindex</b> filter that allows you to specify whether data gets forwarded, based on the data's target index. For example, if you have one data input targeted to "index1" and another targeted to "index2", you can use the filter to forward only the data targeted to index1, while ignoring the index2 data. The forwardedindex filter uses  <b>whitelists</b> and <b>blacklists</b> to specify the filtering. For information on setting up multiple indexes, see the topic "Set up multiple indexes".
</p><p><b>Note:</b> The forwardedindex filter is only applicable under the global <code><font size="2">[tcpout]</font></code> stanza. This filter does not work if it is created under any other stanza in <code><font size="2">outputs.conf</font></code>.   
</p><p>Use the <code><font size="2">forwardedindex.&lt;n&gt;.whitelist|blacklist</font></code> attributes in <code><font size="2">outputs.conf</font></code> to specify which data should get forwarded on an index-by-index basis. You set the attributes to regexes that filter the target indexes. 
</p>
<h4><font size="3"><b><i> <a name="routeandfilterdatad_default_behavior"><span class="mw-headline" id="Default_behavior">Default behavior</span></a></i></b></font></h4>
<p>By default, the forwarder forwards data targeted for all external indexes, including the default index and any user-created indexes. Regarding data for internal indexes, the default behavior varies according to who is doing the forwarding:
</p>
<ul><li> The <b>universal forwarder</b> forwards the data for the <code><font size="2">_audit</font></code> internal index only. It does not forward data for other internal indexes. Its default <code><font size="2">outputs.conf</font></code> file located in <code><font size="2">$SPLUNK_HOME/etc/apps/SplunkUniversalForwarder/default</font></code> specifies that behavior with these attributes:
</li></ul><code><font size="2"><br>&nbsp;&nbsp;&nbsp;[tcpout]<br>&nbsp;&nbsp;&nbsp;forwardedindex.0.whitelist = .*<br>&nbsp;&nbsp;&nbsp;forwardedindex.1.blacklist = _.*<br>&nbsp;&nbsp;&nbsp;forwardedindex.2.whitelist = _audit<br></font></code>
<ul><li> <b>Heavy forwarder and full Splunk instances with forwarding enabled</b> (for example, a search head with forwarding enabled) forward the data for the <code><font size="2">_audit</font></code> and <code><font size="2">_internal</font></code> internal indexes. Their default <code><font size="2">outputs.conf</font></code> file, located in <code><font size="2">$SPLUNK_HOME/etc/system/default</font></code>, specifies that behavior with these attributes:
</li></ul><code><font size="2"><br>&nbsp;&nbsp;&nbsp;[tcpout]<br>&nbsp;&nbsp;&nbsp;forwardedindex.0.whitelist = .*<br>&nbsp;&nbsp;&nbsp;forwardedindex.1.blacklist = _.*<br>&nbsp;&nbsp;&nbsp;forwardedindex.2.whitelist = (_audit|_internal)<br></font></code>
<p><b>Note:</b> The default behavior for heavy forwarders and full Splunk Enterprise instances changed in Splunk Enterprise version 5.0.2. In earlier versions, the <code><font size="2">_internal</font></code> index was not forwarded by default. Those forwarder types had the same behavior as the universal forwarder: only data for the <code><font size="2">_audit</font></code> internal index was forwarded.
</p><p>In most deployments, you will not need to override the default settings.  See outputs.conf for more information on how to whitelist and blacklist indexes. For more information on default and custom <code><font size="2">outputs.conf</font></code> files and their locations, see <a href="#configureforwarderswithoutputs.confd_types_of_outputs.conf_files" class="external text">"Types of outputs.conf files"</a>.
</p>
<h4><font size="3"><b><i> <a name="routeandfilterdatad_forward_all_external_and_internal_index_data"><span class="mw-headline" id="Forward_all_external_and_internal_index_data"> Forward all external and internal index data </span></a></i></b></font></h4>
<p>If you want to forward all internal index data, as well as all external data, you can override the default forwardedindex filter attributes like this:
</p>
<code><font size="2"><br>#Forward everything<br>[tcpout]<br>forwardedindex.0.whitelist = .*<br># disable these<br>forwardedindex.1.blacklist =<br>forwardedindex.2.whitelist =<br></font></code>
<h4><font size="3"><b><i> <a name="routeandfilterdatad_forward_data_for_a_single_index_only"><span class="mw-headline" id="Forward_data_for_a_single_index_only"> Forward data for a single index only </span></a></i></b></font></h4>
<p>If you want to forward <i>only</i> the data targeted for a single index (for example, as specified in <code><font size="2">inputs.conf</font></code>), and drop any data that's not target for that index, here's how to do it:
</p>
<code><font size="2"><br>[tcpout]<br>#Disable the current filters from the defaults outputs.conf<br>forwardedindex.0.whitelist = <br>forwardedindex.1.blacklist =<br>forwardedindex.2.whitelist =<br><br>#Forward data for the "myindex" index<br>forwardedindex.0.whitelist = myindex<br></font></code>
<p>This first disables all filters from the default <code><font size="2">outputs.conf</font></code> file. It then sets the filter for your own index. Be sure to start the filter numbering with 0: <code><font size="2">forwardedindex.0</font></code>.
</p><p><b>Note:</b> If you've set other filters in another copy of <code><font size="2">outputs.conf</font></code> on your system, you must disable those as well.
</p><p>You can use the CLI <code><font size="2">btools</font></code> command to ensure that there aren't any other filters located in other <code><font size="2">outputs.conf</font></code> files on your system:
</p>
<code><font size="2"><br>splunk cmd btool outputs list tcpout<br></font></code>
<p>This command returns the content of the <code><font size="2">tcpout</font></code> stanza, after all versions of the configuration file have been combined.
</p>
<h4><font size="3"><b><i> <a name="routeandfilterdatad_use_the_forwardedindex_attributes_with_local_indexing"><span class="mw-headline" id="Use_the_forwardedindex_attributes_with_local_indexing">Use the forwardedindex attributes with local indexing</span></a></i></b></font></h4>
<p>On a heavy forwarder, you can index locally. To do that, you must set <code><font size="2">indexAndForward</font></code> attribute to "true". Otherwise, the forwarder just forwards your data and does not save it on the forwarder. On the other hand, the <code><font size="2">forwardedindex</font></code> attributes only filter forwarded data; they do not filter any data that gets saved to the local index. 
</p><p>In a nutshell, local indexing and forwarder filtering are entirely separate operations, which do not coordinate with each other. This can have unexpected implications when you're performing blacklist filtering:
</p>
<ul><li> If you set <code><font size="2">indexAndForward</font></code> to "true" and then filter out some data through <code><font size="2">forwardedindex</font></code> blacklist attributes, the blacklisted data will not get forwarded, but it will still get locally indexed.
</li><li> If you set <code><font size="2">indexAndForward</font></code> to "false" (no local indexing) and then filter out some data, the filtered data will get dropped entirely, since it doesn't get forwarded and it doesn't get saved (indexed) on the forwarder.
</li></ul><h3> <a name="routeandfilterdatad_route_inputs_to_specific_indexers_based_on_the_data.27s_input"><span class="mw-headline" id="Route_inputs_to_specific_indexers_based_on_the_data.27s_input">Route inputs to specific indexers based on the data's input</span></a></h3>
<p>There is one type of routing that doesn't require a heavy forwarder. In this scenario, you use <code><font size="2">inputs.conf</font></code> and <code><font size="2">outputs.conf</font></code> to route data to specific indexers, based on the data's input.
</p><p>Here's an example that shows how this works.
</p><p><b>1.</b> In <code><font size="2">outputs.conf</font></code>, you create stanzas for each receiving indexer:
</p>
<code><font size="2"><br>[tcpout:systemGroup]<br>server=server1:9997<br><br>[tcpout:applicationGroup]<br>server=server2:9997<br></font></code>
<p><b>2.</b> In <code><font size="2">inputs.conf</font></code>, you use <code><font size="2">_TCP_ROUTING</font></code> to specify the stanza in <code><font size="2">outputs.conf</font></code> that each input should use for routing:
</p>
<code><font size="2"><br>[monitor://.../file1.log]<br>_TCP_ROUTING = systemGroup<br><br>[monitor://.../file2.log]<br>_TCP_ROUTING = applicationGroup<br></font></code>
<p>The forwarder will route data from <code><font size="2">file1.log</font></code> to <code><font size="2">server1</font></code> and data from <code><font size="2">file2.log</font></code> to <code><font size="2">server2</font></code>.
</p>
<h3> <a name="routeandfilterdatad_perform_selective_indexing_and_forwarding"><span class="mw-headline" id="Perform_selective_indexing_and_forwarding"> Perform selective indexing and forwarding </span></a></h3>
<p>With a heavy forwarder <b>only</b>, you can index and store data locally, as well as forward the data onwards to a receiving indexer. There are two ways to do this:
</p>
<ul><li> <b>Index all the data before forwarding it.</b> To do this, just enable the <code><font size="2">indexAndForward</font></code> attribute in <code><font size="2">outputs.conf</font></code>. 
</li></ul><ul><li> <b>Index a subset of the data before forwarding it or other data.</b>  This is called <b>selective indexing</b>. With selective indexing, you can index just some of the data locally and then forward it on to a receiving indexer. Alternatively, you can choose to forward only the data that you don't index locally. 
</li></ul><p><b>Important:</b> Do not enable the <code><font size="2">indexAndForward</font></code> attribute in the <code><font size="2">[tcpout]</font></code> stanza if you're also enabling selective indexing. 
</p>
<h4><font size="3"><b><i> <a name="routeandfilterdatad_configure_selective_indexing"><span class="mw-headline" id="Configure_selective_indexing">Configure selective indexing </span></a></i></b></font></h4>
<p>To use selective indexing, you need to modify both your <code><font size="2">inputs.conf</font></code> and <code><font size="2">outputs.conf</font></code> files:
</p><p><b>1.</b> In <code><font size="2">outputs.conf</font></code>:
</p><p><b>a.</b> Add the <code><font size="2">[indexAndForward]</font></code> stanza:
</p>
<code><font size="2"><br>[indexAndForward]<br>index=true<br>selectiveIndexing=true <br></font></code>
<p>The presence of this stanza, including the <code><font size="2">index</font></code> and <code><font size="2">selectiveIndexing</font></code> attributes, turns on selective indexing for the forwarder. It enables local indexing for any input (specified in <code><font size="2">inputs.conf</font></code>) that has the <code><font size="2">_INDEX_AND_FORWARD_ROUTING</font></code> attribute. Use the entire <code><font size="2">[indexAndForward]</font></code> stanza exactly as shown here.
</p><p><b>Note:</b> This is a global stanza, which only needs to appear once in <code><font size="2">outputs.conf</font></code>.
</p><p><b>b.</b> Include the usual target group stanzas for each set of receiving indexers:
</p>
<code><font size="2"><br>[tcpout:&lt;target_group&gt;]<br>server = &lt;ip address&gt;:&lt;port&gt;, &lt;ip address&gt;:&lt;port&gt;, ...<br>... <br></font></code>
<p>The named <code><font size="2">&lt;target_group&gt;</font></code> is used in <code><font size="2">inputs.conf</font></code> to route the inputs, as described below.
</p><p><b>2.</b> In <code><font size="2">inputs.conf</font></code>:
</p><p><b>a.</b> Add the <code><font size="2">_INDEX_AND_FORWARD_ROUTING</font></code> attribute to the stanzas of each input that you want to index locally: 
</p>
<code><font size="2"><br>[input_stanza]<br>_INDEX_AND_FORWARD_ROUTING=&lt;any_string&gt;<br>...<br></font></code>
<p>The presence of the <code><font size="2">_INDEX_AND_FORWARD_ROUTING</font></code> attribute tells the heavy forwarder to index that input locally. You can set the attribute to any string value you want. The forwarder just looks for the attribute itself; the string value has no effect at all on behavior. 
</p><p><b>b.</b> Add the <code><font size="2">_TCP_ROUTING</font></code> attribute to the stanzas of each input that you want to forward:
</p>
<code><font size="2"><br>[input_stanza]<br>_TCP_ROUTING=&lt;target_group&gt;<br>...<br></font></code>
<p>The <code><font size="2">&lt;target_group&gt;</font></code> is the name used in <code><font size="2">outputs.conf</font></code> to specify the target group of receiving indexers. 
</p><p>The next several sections show how to use selective indexing in a variety of scenarios.
</p>
<h4><font size="3"><b><i> <a name="routeandfilterdatad_index_one_input_locally_and_then_forward_the_remaining_inputs"><span class="mw-headline" id="Index_one_input_locally_and_then_forward_the_remaining_inputs">Index one input locally and then forward the remaining inputs </span></a></i></b></font></h4>
<p>In this example, the forwarder indexes data from one input locally but does not forward it. It also forwards data from two other inputs but does not index those inputs locally.
</p><p><b>1.</b> In <code><font size="2">outputs.conf</font></code>, create these stanzas:
</p>
<code><font size="2"><br>[tcpout]<br>defaultGroup=noforward<br>disabled=false<br><br>[indexAndForward]<br>index=true<br>selectiveIndexing=true<br><br>[tcpout:indexerB_9997]<br>server = indexerB:9997<br><br>[tcpout:indexerC_9997]<br>server = indexerC:9997<br></font></code>
<p>Since the <code><font size="2">defaultGroup</font></code> is set to the non-existent group "noforward" (meaning that there is no <code><font size="2">defaultGroup</font></code>), the forwarder will only forward data that's been routed to explicit target groups in <code><font size="2">inputs.conf</font></code>. All other data will get dropped.
</p><p><b>2.</b> In <code><font size="2">inputs.conf</font></code>, create these stanzas:
</p>
<code><font size="2"><br>[monitor:///mydata/source1.log]<br>_INDEX_AND_FORWARD_ROUTING=local<br><br>[monitor:///mydata/source2.log]<br>_TCP_ROUTING=indexerB_9997<br><br>[monitor:///mydata/source3.log]<br>_TCP_ROUTING=indexerC_9997<br></font></code>
<p>The result is that the forwarder:
</p>
<ul><li> indexes the <code><font size="2">source1.log</font></code> data locally but does not forward it (because there's no explicit routing in its input stanza and there's no default group in <code><font size="2">outputs.conf</font></code>). 
</li><li> forwards the <code><font size="2">source2.log</font></code> data to indexerB but does not index it locally.
</li><li> forwards the <code><font size="2">source3.log</font></code> data to indexerC but does not index it locally.
</li></ul><h4><font size="3"><b><i> <a name="routeandfilterdatad_index_one_input_locally_and_then_forward_all_inputs"><span class="mw-headline" id="Index_one_input_locally_and_then_forward_all_inputs">Index one input locally and then forward all inputs </span></a></i></b></font></h4>
<p>This example is nearly identical to the previous one. The difference is that  here, you index just one input locally, but then you forward all inputs, including the one you've indexed locally.
</p><p><b>1.</b> In <code><font size="2">outputs.conf</font></code>, create these stanzas:
</p>
<code><font size="2"><br>[tcpout]<br>defaultGroup=noforward<br>disabled=false<br><br>[indexAndForward]<br>index=true<br>selectiveIndexing=true<br><br>[tcpout:indexerB_9997]<br>server = indexerB:9997<br><br>[tcpout:indexerC_9997]<br>server = indexerC:9997<br></font></code>
<p>This <code><font size="2">outputs.conf</font></code> is identical to the previous example.
</p><p><b>2.</b> In <code><font size="2">inputs.conf</font></code>, create these stanzas:
</p>
<code><font size="2"><br>[monitor:///mydata/source1.log]<br>_INDEX_AND_FORWARD_ROUTING=local<br>_TCP_ROUTING=indexerB_9997<br><br>[monitor:///mydata/source2.log]<br>_TCP_ROUTING=indexerB_9997<br><br>[monitor:///mydata/source3.log]<br>_TCP_ROUTING=indexerC_9997<br></font></code>
<p>The only difference from the previous example is that here, you've specified the <code><font size="2">_TCP_ROUTING</font></code> attribute for the input that you're indexing locally. The forwarder will route both <code><font size="2">source1.log</font></code> and <code><font size="2">source2.log</font></code> to the <code><font size="2">indexerB_9997</font></code> target group, but it will only locally index the data from <code><font size="2">source1.log</font></code>.
</p>
<h4><font size="3"><b><i> <a name="routeandfilterdatad_another_way_to_index_one_input_locally_and_then_forward_all_inputs"><span class="mw-headline" id="Another_way_to_index_one_input_locally_and_then_forward_all_inputs">Another way to index one input locally and then forward all inputs </span></a></i></b></font></h4>
<p>You can achieve the same result as in the previous example by setting the <code><font size="2">defaultGroup</font></code> to a real target group.
</p><p><b>1.</b> In <code><font size="2">outputs.conf</font></code>, create these stanzas:
</p>
<code><font size="2"><br>[tcpout]<br>defaultGroup=indexerB_9997<br>disabled=false<br><br>[indexAndForward]<br>index=true<br>selectiveIndexing=true<br><br>[tcpout:indexerB_9997]<br>server = indexerB:9997<br><br>[tcpout:indexerC_9997]<br>server = indexerC:9997<br></font></code>
<p>This <code><font size="2">outputs.conf</font></code> sets the <code><font size="2">defaultGroup</font></code> to <code><font size="2">indexerB_9997</font></code>.
</p><p><b>2.</b> In <code><font size="2">inputs.conf</font></code>, create these stanzas:
</p>
<code><font size="2"><br>[monitor:///mydata/source1.log]<br>_INDEX_AND_FORWARD_ROUTING=local<br><br>[monitor:///mydata/source2.log]<br>_TCP_ROUTING=indexerB_9997<br><br>[monitor:///mydata/source3.log]<br>_TCP_ROUTING=indexerC_9997<br></font></code>
<p>Even though you haven't set up an explicit routing for <code><font size="2">source1.log</font></code>, the forwarder will still forward it to the <code><font size="2">indexerB_9997</font></code> target group, since <code><font size="2">outputs.conf</font></code> specifies that group as the <code><font size="2">defaultGroup</font></code>.
</p>
<h4><font size="3"><b><i> <a name="routeandfilterdatad_selective_indexing_and_internal_logs"><span class="mw-headline" id="Selective_indexing_and_internal_logs">Selective indexing and internal logs</span></a></i></b></font></h4>
<p>Once you enable selective indexing in <code><font size="2">outputs.conf</font></code>, the forwarder will only index locally those inputs with the <code><font size="2">_INDEX_AND_FORWARD_ROUTING</font></code> attribute. This applies to the internal logs in the <code><font size="2">/var/log/splunk</font></code> directory (specified in the default <code><font size="2">etc/system/default/inputs.conf</font></code>). By default, they will not be indexed. If you want to index them, you must add their input stanza to your local <code><font size="2">inputs.conf</font></code> file (which takes precedence over the default file) and include the <code><font size="2">_INDEX_AND_FORWARD_ROUTING</font></code> attribute:
</p>
<code><font size="2"><br>[monitor://$SPLUNK_HOME/var/log/splunk]<br>index = _internal<br>_INDEX_AND_FORWARD_ROUTING=local<br></font></code>
<h3> <a name="routeandfilterdatad_caveats_for_routing_and_filtering_structured_data"><span class="mw-headline" id="Caveats_for_routing_and_filtering_structured_data">Caveats for routing and filtering structured data </span></a></h3>
<h4><font size="3"><b><i> <a name="routeandfilterdatad_splunk_enterprise_does_not_parse_structured_data_that_has_been_forwarded_to_an_indexer"><span class="mw-headline" id="Splunk_Enterprise_does_not_parse_structured_data_that_has_been_forwarded_to_an_indexer">Splunk Enterprise does not parse structured data that has been forwarded to an indexer </span></a></i></b></font></h4>
<p>When you forward structured data to an indexer, Splunk Enterprise does not parse this data once it arrives at the indexer, even if you have configured <code><font size="2">props.conf</font></code> on that indexer with <code><font size="2">INDEXED_EXTRACTIONS</font></code>. Forwarded data skips the following queues on the indexer, which precludes any parsing of that data on the indexer:
</p>
<ul><li> <code><font size="2">parsing</font></code>
</li><li> <code><font size="2">aggregation</font></code>
</li><li> <code><font size="2">typing</font></code>
</li></ul><p>The forwarded data must arrive at the indexer already parsed. To achieve this, you must also set up <code><font size="2">props.conf</font></code> on the forwarder that sends the data. This includes configuration of <code><font size="2">INDEXED_EXTRACTIONS</font></code> and any other parsing, filtering, anonymizing, and routing rules. Universal forwarders are capable of performing these tasks solely for structured data. See "Forward data extracted from header files".
</p>
<a name="forwarddatatothird-partysystemsd"></a><h2> <a name="forwarddatatothird-partysystemsd_forward_data_to_third-party_systems"><span class="mw-headline" id="Forward_data_to_third-party_systems"> Forward data to third-party systems </span></a></h2>
<p>Splunk Enterprise forwarders can forward raw data to non-Splunk systems. They can send the data over a plain TCP socket or packaged in standard syslog. Because they are forwarding to a non-Splunk system, they can send only raw data.
</p><p>By editing <code><font size="2">outputs.conf</font></code>, <code><font size="2">props.conf</font></code>, and <code><font size="2">transforms.conf,</font></code> you can configure a heavy forwarder to route data conditionally to third-party systems, in the same way that it routes data conditionally to other Splunk Enterprise instances. You can filter the data by host, source, or source type. You can also use regex to further qualify the data.
</p><p><b>Note:</b> Data forwarding to third-party systems is one of several search result export methods offered by Splunk Enterprise. For information about the other export methods available to you, see "Export search results" in the <i>Search Manual</i>.
</p>
<h3> <a name="forwarddatatothird-partysystemsd_tcp_data"><span class="mw-headline" id="TCP_data"> TCP data </span></a></h3>
<p>To forward TCP data to a third-party system, edit the forwarder's <a href="#configureforwarderswithoutputs.confd" class="external text">outputs.conf</a> file to specify the receiving server and port. You must also configure the receiving server to expect the incoming data stream on that port. You can use any kind of forwarder, such as a universal forwarder, to perform this type of forwarding.
</p><p>To route the data, you need to use a heavy forwarder, which has the ability to parse data.  Edit the forwarder's <a href="#routeandfilterdatad" class="external text">props.conf</a> and <a href="#routeandfilterdatad" class="external text">transforms.conf</a> files as well as <code><font size="2">outputs.conf</font></code>. 
</p>
<h4><font size="3"><b><i> <a name="forwarddatatothird-partysystemsd_edit_the_configuration_files"><span class="mw-headline" id="Edit_the_configuration_files"> Edit the configuration files </span></a></i></b></font></h4>
<p>To simply forward data, edit <code><font size="2">outputs.conf</font></code>:
</p>
<ul><li> Specify target groups for the receiving servers.
</li><li> Specify the IP address and TCP port for each receiving server.
</li><li> Set <code><font size="2">sendCookedData</font></code> to <code><font size="2">false</font></code>, so that the forwarder sends raw data.
</li></ul><p>To route and filter the data (heavy forwarders only), also edit <code><font size="2">props.conf</font></code> and <code><font size="2">transforms.conf</font></code>:
</p>
<ul><li> In <code><font size="2">props.conf</font></code>, specify the host, source, or sourcetype of your data stream. Specify a transform to perform on the input. 
</li><li> In <code><font size="2">transforms.conf</font></code>, define the transform and specify <code><font size="2">_TCP_ROUTING</font></code>. You can also use regex to further filter the data.
</li></ul><h4><font size="3"><b><i> <a name="forwarddatatothird-partysystemsd_forward_all_data"><span class="mw-headline" id="Forward_all_data"> Forward all data </span></a></i></b></font></h4>
<p>This example shows how to send all the data from a universal forwarder to a third-party system. Since you are sending all the data, you only need to edit <code><font size="2">outputs.conf</font></code>: 
</p>
<code><font size="2"><br>[tcpout]<br><br>[tcpout:fastlane]<br>server = 10.1.1.35:6996<br>sendCookedData = false<br></font></code>
<h4><font size="3"><b><i> <a name="forwarddatatothird-partysystemsd_forward_a_subset_of_data"><span class="mw-headline" id="Forward_a_subset_of_data"> Forward a subset of data </span></a></i></b></font></h4>
<p>This example shows how to use a heavy forwarder to filter a subset of data and send the subset to a third-party system:
</p><p><b>1.</b> Edit <code><font size="2">props.conf</font></code> and <code><font size="2">transforms.conf</font></code> to specify the filtering criteria. 
</p><p>In <code><font size="2">props.conf</font></code>, apply the <code><font size="2">bigmoney</font></code> transform to all host names beginning with <code><font size="2">nyc</font></code>:
</p>
<code><font size="2"><br>[host::nyc*]<br>TRANSFORMS-nyc = bigmoney<br></font></code>
<p>In <code><font size="2">transforms.conf</font></code>, configure the <code><font size="2">bigmoney</font></code> transform to specify <code><font size="2">TCP_ROUTING</font></code> as the <code><font size="2">DEST_KEY</font></code> and the <code><font size="2">bigmoneyreader</font></code> target group as the <code><font size="2">FORMAT</font></code>:
</p>
<code><font size="2"><br>[bigmoney]<br>REGEX = .<br>DEST_KEY=_TCP_ROUTING<br>FORMAT=bigmoneyreader<br></font></code>
<p><b>2.</b> In <code><font size="2">outputs.conf</font></code>, define both a <code><font size="2">bigmoneyreader</font></code> target group for the non-Splunk server and a default target group to receive any other data:
</p>
<code><font size="2"><br>[tcpout]<br>defaultGroup = default-clone-group-192_168_1_104_9997<br><br>[tcpout:default-clone-group-192_168_1_104_9997]<br>server = 192.168.1.104:9997<br><br>[tcpout:bigmoneyreader]<br>server=10.1.1.197:7999<br>sendCookedData=false<br></font></code>
<p>The forwarder will send all data from host names beginning with <code><font size="2">nyc</font></code> to the non-Splunk server specified in the <code><font size="2">bigmoneyreader</font></code> target group. It will send data from all other hosts to the server specified in the <code><font size="2">default-clone-group-192_168_1_104_9997</font></code> target group.
</p><p><b>Note:</b> If you want to forward only the data specifically identified in <code><font size="2">props.conf</font></code> and <code><font size="2">transforms.conf</font></code>, set <code><font size="2">defaultGroup=nothing</font></code>.
</p>
<h3> <a name="forwarddatatothird-partysystemsd_syslog_data"><span class="mw-headline" id="Syslog_data"> Syslog data </span></a></h3>
<p>You can configure a heavy forwarder to send data in standard syslog format. The forwarder sends the data through a separate output processor. You can also filter the data with <code><font size="2">props.conf</font></code> and <code><font size="2">transforms.conf</font></code>. You'll need to specify _SYSLOG_ROUTING as the DEST_KEY.
</p><p><b>Note:</b> The syslog output processor is not available for universal or light forwarders.
</p><p>The syslog output processor sends RFC 3164 compliant events to a TCP/UDP-based server and port, making the payload of any non-compliant data RFC 3164 compliant. Yes, that means Windows event logs!
</p><p>To forward syslog data, identify the third-party receiving server and specify it in a <code><font size="2">syslog</font></code> target group in the forwarder's <code><font size="2">outputs.conf</font></code> file. 
</p><p><b>Note:</b> If you have defined multiple event types for syslog data, the event type names must all include the string "syslog".
</p>
<h4><font size="3"><b><i> <a name="forwarddatatothird-partysystemsd_forward_syslog_data"><span class="mw-headline" id="Forward_syslog_data"> Forward syslog data </span></a></i></b></font></h4>
<p>In <code><font size="2">outputs.conf</font></code>, specify the <code><font size="2">syslog</font></code> target group:
</p>
<code><font size="2"><br>[syslog:&lt;target_group&gt;]<br>&lt;attribute1&gt; = &lt;val1&gt;<br>&lt;attribute2&gt; = &lt;val2&gt;<br>...<br></font></code>
<p>The target group stanza requires this attribute:
</p>
<table cellpadding="5" cellspacing="0" border="1" width="100%"><tr><th bgcolor="#C0C0C0"> Required Attribute
</th><th bgcolor="#C0C0C0"> Default
</th><th bgcolor="#C0C0C0"> Value
</th></tr><tr><td width="15%" valign="center" align="left"> server
</td><td width="10%" valign="center" align="left"> n/a
</td><td valign="center" align="left">This must be in the format <code><font size="2">&lt;ipaddress_or_servername&gt;:&lt;port&gt;</font></code>. This is a combination of the IP address or servername of the syslog server and the port on which the syslog server is listening. Note that syslog servers use port 514 by default.
</td></tr></table><p><br>
These attributes are optional:
</p>
<table cellpadding="5" cellspacing="0" border="1" width="100%"><tr><th bgcolor="#C0C0C0"> Optional Attribute
</th><th bgcolor="#C0C0C0"> Default
</th><th bgcolor="#C0C0C0"> Value
</th></tr><tr><td width="15%" valign="center" align="left"> type
</td><td width="10%" valign="center" align="left"> udp
</td><td valign="center" align="left"> The transport protocol. Must be set to "tcp" or "udp".
</td></tr><tr><td valign="center" align="left"> priority
</td><td valign="center" align="left"> &lt;13&gt; - this signifies a facility of 1 ("user") and a severity of 5 ("notice")
</td><td valign="center" align="left"> Syslog priority. This must be an integer 1 to 3 digits in length, surrounded by angle brackets; for example: &lt;34&gt;. This value will appear in the syslog header.
<p>Mimics the number passed via syslog interface call; see outputs.conf for more information.
</p><p>Compute the priority value as (&lt;facility&gt;  * 8) + &lt;severity&gt;. If facility is 4 (security/authorization messages) and severity is 2 (critical 
conditions), priority value will be: (4 * 8) + 2 = 34, which you specify in the conf file as &lt;34&gt;. 
</p>
</td></tr><tr><td valign="center" align="left">syslogSourceType
</td><td valign="center" align="left">n/a
</td><td valign="center" align="left">This must be in the format <code><font size="2">sourcetype::syslog</font></code>, the source type for syslog messages.
</td></tr><tr><td valign="center" align="left">timestampformat
</td><td valign="center" align="left">""
</td><td valign="center" align="left">The format used when adding a timestamp to the header. This must be in the format: &lt;%b&nbsp;%e&nbsp;%H:%M:%S&gt;. See "Configure timestamps" in the Getting Data In manual for details.
</td></tr></table><p><br></p>
<h4><font size="3"><b><i> <a name="forwarddatatothird-partysystemsd_send_a_subset_of_data_to_a_syslog_server"><span class="mw-headline" id="Send_a_subset_of_data_to_a_syslog_server"> Send a subset of data to a syslog server </span></a></i></b></font></h4>
<p>This example shows how to configure a heavy forwarder to forward data from hosts whose names begin with "nyc" to a syslog server named "loghost.example.com" over port 514:
</p><p><b>1.</b> Edit <code><font size="2">props.conf</font></code> and <code><font size="2">transforms.conf</font></code> to specify the filtering criteria. 
</p><p>In <code><font size="2">props.conf</font></code>, apply the <code><font size="2">send_to_syslog</font></code> transform to all host names beginning with <code><font size="2">nyc</font></code>:
</p>
<code><font size="2"><br>[host::nyc*]<br>TRANSFORMS-nyc = send_to_syslog<br></font></code>
<p>In <code><font size="2">transforms.conf</font></code>, configure the <code><font size="2">send_to_syslog</font></code> transform to specify <code><font size="2">_SYSLOG_ROUTING</font></code> as the <code><font size="2">DEST_KEY</font></code> and the <code><font size="2">my_syslog_group</font></code> target group as the <code><font size="2">FORMAT</font></code>:
</p>
<code><font size="2"><br>[send_to_syslog]<br>REGEX = .<br>DEST_KEY = _SYSLOG_ROUTING<br>FORMAT = my_syslog_group<br></font></code>
<p><b>2.</b> In <code><font size="2">outputs.conf</font></code>, define the <code><font size="2">my_syslog_group</font></code> target group for the non-Splunk server:
</p>
<code><font size="2"><br>[syslog:my_syslog_group]<br>server = loghost.example.com:514<br></font></code>

<h1>Heavy and light forwarders</h1><a name="deployaheavyforwarder"></a><h2> <a name="deployaheavyforwarder_deploy_a_heavy_forwarder"><span class="mw-headline" id="Deploy_a_heavy_forwarder"> Deploy a heavy forwarder</span></a></h2>
<p>To enable forwarding and receiving, you configure both a <b>receiver</b> and a <b>forwarder</b>. The receiver is the Splunk Enterprise instance receiving the data; the forwarder sends data to the receiver. 
</p><p>You must first set up the receiver, as described in <a href="#enableareceiver" class="external text">"Enable a receiver"</a>. You can then set up forwarders to send data to that receiver.
</p><p>Setting up a <b>heavy</b> forwarder is a two step process:
</p><p><b>1.</b> Install a full Splunk Enterprise instance.
</p><p><b>2.</b> Enable forwarding on the instance.
</p><p>The sections that follow describe these steps in detail.
</p><p><b>Important:</b> This topic describes deployment and configuration issues specific to heavy forwarders. For information on how to deploy a <b>universal forwarder</b>, see <a href="#deploymentoverview" class="external text">"Universal forwarder deployment overview"</a>. 
</p>
<h3> <a name="deployaheavyforwarder_install_a_full_splunk_enterprise_instance"><span class="mw-headline" id="Install_a_full_Splunk_Enterprise_instance"> Install a full Splunk Enterprise instance </span></a></h3>
<p>To deploy a heavy forwarder, you must first install a full Splunk Enterprise instance. For detailed information about installing Splunk Enterprise, including system requirements and licensing issues, see the Installation manual.
</p><p>Once the instance has been installed, you can enable forwarder functionality on it.
</p>
<h3> <a name="deployaheavyforwarder_set_up_forwarding"><span class="mw-headline" id="Set_up_forwarding"> Set up forwarding </span></a></h3>
<p>You can use Splunk Web or the CLI as a quick way to enable forwarding in a Splunk Enterprise instance. 
</p><p>You can also enable, as well as configure, forwarding by creating an <code><font size="2">outputs.conf</font></code> file on the Splunk Enterprise instance. Although setting up forwarders with <code><font size="2">outputs.conf</font></code> requires a bit more initial knowledge, there are obvious advantages to performing all forwarder configurations in a single location. Most advanced configuration options are  available only through <code><font size="2">outputs.conf</font></code>. In addition, if you will be enabling and configuring a number of forwarders, you can easily accomplish this by editing a single <code><font size="2">outputs.conf</font></code> file and making a copy for each forwarder. See the topic <a href="#configureforwarderswithoutputs.confd" class="external text">"Configure forwarders with outputs.conf"</a> for more information.
</p>
<h4><font size="3"><b><i> <a name="deployaheavyforwarder_set_up_heavy_forwarding_with_splunk_web"><span class="mw-headline" id="Set_up_heavy_forwarding_with_Splunk_Web"> Set up heavy forwarding with Splunk Web </span></a></i></b></font></h4>
<p>You can use Splunk Web to set up a heavy forwarder: 
</p><p><b>1.</b> Log into Splunk Web as admin on the server that will be forwarding data.
</p><p><b>2.</b> Click the <b>Settings</b> link at the top of the page.
</p><p><b>3.</b> Select <b>Forwarding and receiving</b> in the Data area.
</p><p><b>4.</b> Click <b>Add new</b> in the <b>Forward data</b> section.
</p><p><b>5.</b> Enter the hostname or IP address for the receiving Splunk Enterprise instance(s), along with the <b>receiving port</b> specified when the receiver was configured. For example, you might enter: <code><font size="2">receivingserver.com:9997.</font></code> To implement load-balanced forwarding, you can enter multiple hosts as a comma-separated list.  
</p><p><b>6.</b> Click <b>Save.</b> You must restart the instance to complete the process. 
</p><p>You can use Splunk Web to perform one other configuration. To store a copy of indexed data local to the forwarder:
</p><p><b>1.</b> From <b>Forwarding and receiving,</b> select <b>Forwarding defaults.</b>
</p><p><b>2.</b> Select <b>Yes</b> to store and maintain a local copy of the indexed data on the forwarder.
</p><p><b>Important:</b> A heavy forwarder has a key advantage over light and universal forwarders in that it can index your data locally, as well as forward the data to another index.  However, local indexing is turned off by default. If you want to store data on the forwarder, you must enable that capability - either in the manner described above or by editing <code><font size="2">outputs.conf</font></code>.
</p><p>All other configuration must be done in <code><font size="2">outputs.conf.</font></code>
</p>
<h4><font size="3"><b><i> <a name="deployaheavyforwarder_set_up_heavy_forwarding_with_the_cli"><span class="mw-headline" id="Set_up_heavy_forwarding_with_the_CLI"> Set up heavy forwarding with the CLI </span></a></i></b></font></h4>
<p>With the CLI, setting up forwarding is a two step process. First you enable forwarding on the Splunk Enterprise instance. Then you start forwarding to a specified receiver.
</p><p>To access the CLI, first navigate to <code><font size="2">$SPLUNK_HOME/bin/</font></code>. 
</p><p><b>To enable the forwarder mode,</b> enter: 
</p>
<code><font size="2"><br>splunk enable app SplunkForwarder -auth &lt;username&gt;:&lt;password&gt;<br></font></code>
<p><b>To disable the forwarder mode,</b> enter:
</p>
<code><font size="2"><br>splunk disable app SplunkForwarder -auth &lt;username&gt;:&lt;password&gt;<br></font></code>
<p>By disabling forwarding, this command reverts the fowarder to a full Splunk Enterprise instance.
</p><p><b>Important:</b> After invoking either of these commands, restart the forwarder.
</p>
<h4><font size="3"><b><i> <a name="deployaheavyforwarder_start_forwarding_activity_from_the_cli"><span class="mw-headline" id="Start_forwarding_activity_from_the_CLI"> Start forwarding activity from the CLI </span></a></i></b></font></h4>
<p>To access the CLI, first navigate to <code><font size="2">$SPLUNK_HOME/bin/</font></code>. 
</p><p><b>To start forwarding activity,</b> specify the receiver with the <code><font size="2">splunk add forward-server</font></code> command:
</p>
<code><font size="2"><br>splunk add forward-server &lt;host&gt;:&lt;port&gt; -auth &lt;username&gt;:&lt;password&gt;<br></font></code>
<p><b>To end forwarding activity,</b> enter:
</p>
<code><font size="2"><br>splunk remove forward-server &lt;host&gt;:&lt;port&gt; -auth &lt;username&gt;:&lt;password&gt;<br></font></code>
<p><b>Note:</b> Although this command ends forwarding activity, the instance remains configured as a forwarder. To revert the forwarder to a full Splunk Enterprise instance, use the <code><font size="2">disable</font></code> command, as described earlier in this topic.
</p><p><b>Important:</b> After invoking either of these commands, restart the forwarder.
</p>
<h3> <a name="deployaheavyforwarder_upgrade_a_forwarder"><span class="mw-headline" id="Upgrade_a_forwarder">Upgrade a forwarder </span></a></h3>
<p>To upgrade a forwarder to a new version, just upgrade the instance in the usual fashion. For details, read the upgrade section of the Installation manual.
</p><p><b>Important:</b> Before doing an upgrade, consider whether you really need to. In many cases, there's no compelling reason to upgrade a forwarder. Forwarders are always compatible with later version indexers, so you do not need to upgrade them just because you've upgraded the indexers they're sending data to.
</p>
<h4><font size="3"><b><i> <a name="deployaheavyforwarder_back_up_your_files_first"><span class="mw-headline" id="Back_up_your_files_first">Back up your files first</span></a></i></b></font></h4>
<p>Before you perform the upgrade, we strongly recommend that you back up all of your files. Most importantly, back up your Splunk Enterprise configuration files. For information on backing up configurations, read "Back up configuration information" in the Admin manual. 
</p><p>If you're upgrading a heavy forwarder that's indexing data locally, you also need to back up the indexed data. For information on backing up data, read "Back up indexed data" in the <i>Managing Indexers and Clusters of Indexers</i> manual. 
</p><p>You cannot downgrade to a previous version; if you need to revert to an older forwarder release, reinstall the instance.
</p>
<a name="deployaforwarder"></a><h2> <a name="deployaforwarder_deploy_a_light_forwarder"><span class="mw-headline" id="Deploy_a_light_forwarder"> Deploy a light forwarder</span></a></h2>
<p><b>Note:</b> The light forwarder has been deprecated in Splunk Enterprise version 6.0. For a list of all deprecated features, see the topic "Deprecated features" in the Release Notes.
</p><p>To enable forwarding and receiving, you configure both a <b>receiver</b> and a <b>forwarder</b>. The receiver is the Splunk Enterprise instance receiving the data; the forwarder sends data to the receiver. 
</p><p>You must first set up the receiver. You can then set up forwarders to send data to that receiver.
</p><p>Setting up a <b>light</b> forwarder is a two step process:
</p><p><b>1.</b> Install a full Splunk Enterprise instance.
</p><p><b>2.</b> Enable forwarding on the instance.
</p><p>The sections that follow describe these steps in detail.
</p><p><b>Important:</b> This topic describes deployment and configuration issues specific to light forwarders. For information on how to deploy a <b>universal forwarder</b>, see <a href="#deploymentoverview" class="external text">"Universal forwarder deployment overview"</a>. 
</p>
<h3> <a name="deployaforwarder_install_a_full_splunk_enterprise_instance"><span class="mw-headline" id="Install_a_full_Splunk_Enterprise_instance"> Install a full Splunk Enterprise instance </span></a></h3>
<p>To deploy a light forwarder, you must first install a full Splunk Enterprise instance. For detailed information about installing Splunk Enterprise, including system requirements and licensing issues, see the Installation manual.
</p><p>Once the instance has been installed, you can enable light forwarder functionality on it. 
</p><p><b>Note:</b> When you install a Splunk Enterprise instance to be used as a light forwarder, select the forwarder license. For more information, see "Types of Splunk licenses".
</p>
<h3> <a name="deployaforwarder_set_up_forwarding"><span class="mw-headline" id="Set_up_forwarding"> Set up forwarding </span></a></h3>
<p>You can use the CLI as a quick way to enable forwarding. 
</p><p>You can also enable, as well as configure, forwarding by creating an <code><font size="2">outputs.conf</font></code> file on the Splunk Enterprise instance. Although setting up forwarders with <code><font size="2">outputs.conf</font></code> requires a bit more initial knowledge, there are obvious advantages to performing all forwarder configurations in a single location. Most advanced configuration options are  available only through <code><font size="2">outputs.conf</font></code>. In addition, if you will be enabling and configuring a number of forwarders, you can easily accomplish this by editing a single <code><font size="2">outputs.conf</font></code> file and making a copy for each forwarder. See the topic <a href="#configureforwarderswithoutputs.confd" class="external text">"Configure forwarders with outputs.conf"</a> for more information.
</p>
<h4><font size="3"><b><i> <a name="deployaforwarder_set_up_light_forwarding_with_the_cli"><span class="mw-headline" id="Set_up_light_forwarding_with_the_CLI"> Set up light forwarding with the CLI </span></a></i></b></font></h4>
<p>With the CLI, setting up forwarding is a two step process. First you enable forwarding on the instance. Then you start forwarding to a specified receiver.
</p><p>To access the CLI, first navigate to <code><font size="2">$SPLUNK_HOME/bin/</font></code>.  
</p><p><b>To enable the light forwarder mode,</b> enter: 
</p>
<code><font size="2"><br>splunk enable app SplunkLightForwarder -auth &lt;username&gt;:&lt;password&gt;<br></font></code>
<p><b>To disable the light forwarder mode,</b> enter:
</p>
<code><font size="2"><br>splunk disable app SplunkLightForwarder -auth &lt;username&gt;:&lt;password&gt;<br></font></code>
<p>By disabling forwarding, this command reverts the forwarder to a full Splunk Enterprise instance.
</p><p><b>Important:</b> After invoking either of these commands, restart the forwarder.
</p>
<h4><font size="3"><b><i> <a name="deployaforwarder_start_forwarding_activity_from_the_cli"><span class="mw-headline" id="Start_forwarding_activity_from_the_CLI"> Start forwarding activity from the CLI </span></a></i></b></font></h4>
<p>To access the CLI, first navigate to <code><font size="2">$SPLUNK_HOME/bin/</font></code>. 
</p><p><b>To start forwarding activity,</b> specify the receiver with the <code><font size="2">splunk add forward-server</font></code> command:
</p>
<code><font size="2"><br>splunk add forward-server &lt;host&gt;:&lt;port&gt; -auth &lt;username&gt;:&lt;password&gt;<br></font></code>
<p><b>To end forwarding activity,</b> enter:
</p>
<code><font size="2"><br>splunk remove forward-server &lt;host&gt;:&lt;port&gt; -auth &lt;username&gt;:&lt;password&gt;<br></font></code>
<p><b>Note:</b> Although this command ends forwarding activity, the instance remains configured as a forwarder. To revert the instance to a full Splunk Enterprise instance, use the <code><font size="2">disable</font></code> command, as described earlier in this topic.
</p><p><b>Important:</b> After invoking either of these commands, restart the forwarder.
</p>
<h3> <a name="deployaforwarder_upgrade_a_forwarder"><span class="mw-headline" id="Upgrade_a_forwarder">Upgrade a forwarder </span></a></h3>
<p>To upgrade a forwarder to a new version, just upgrade the instance in the usual fashion. For details, read the upgrade section of the Installation manual.
</p><p><b>Important:</b> Before doing an upgrade, consider whether you really need to. In many cases, there's no compelling reason to upgrade a forwarder. Forwarders are always compatible with later version indexers, so you do not need to upgrade them just because you've upgraded the indexers they're sending data to.
</p>
<h4><font size="3"><b><i> <a name="deployaforwarder_back_up_your_files_first"><span class="mw-headline" id="Back_up_your_files_first">Back up your files first</span></a></i></b></font></h4>
<p>Before you perform the upgrade, we strongly recommend that you back up all of your files. Most importantly, back up your configuration files. For information on backing up configurations, read "Back up configuration information" in the Admin manual.
</p>
<a name="forwardercapabilities"></a><h2> <a name="forwardercapabilities_heavy_and_light_forwarder_capabilities"><span class="mw-headline" id="Heavy_and_light_forwarder_capabilities"> Heavy and light forwarder capabilities</span></a></h2>
<p>Certain capabilities are disabled in heavy and light forwarders. This section describes forwarder capabilities in detail.
</p><p><b>Note:</b> The light forwarder has been deprecated in Splunk Enterprise version 6.0. For a list of all deprecated features, see the topic "Deprecated features" in the Release Notes.
</p>
<h3> <a name="forwardercapabilities_heavy_forwarder_details"><span class="mw-headline" id="Heavy_forwarder_details"> Heavy forwarder details </span></a></h3>
<p>The heavy forwarder has all Splunk Enterprise functions and modules enabled by default, with the exception of the distributed search module. The file <code><font size="2">$SPLUNK_HOME/etc/apps/SplunkForwarder/default/default-mode.conf</font></code> includes this stanza: 
</p>
<code><font size="2"><br>[pipeline:distributedSearch]<br>disabled = true<br></font></code>
<p>For a detailed view of the exact configuration, see the configuration files for the SplunkForwarder application in <code><font size="2">$SPLUNK_HOME/etc/apps/SplunkForwarder/default</font></code>.
</p>
<h3> <a name="forwardercapabilities_light_forwarder_details"><span class="mw-headline" id="Light_forwarder_details"> Light forwarder details </span></a></h3>
<p>Most features of Splunk Enterprise are disabled in the light forwarder. Specifically, the light forwarder: 
</p>
<ul><li> Disables event signing and checking whether the disk is full (<code><font size="2">$SPLUNK_HOME/etc/apps/SplunkLightForwarder/default/default-mode.conf</font></code>).
</li><li> Limits internal data inputs to <code><font size="2">splunkd</font></code> and metrics logs only (<code><font size="2">$SPLUNK_HOME/etc/apps/SplunkLightForwarder/default/inputs.conf</font></code>).
</li><li> Disables all indexing (<code><font size="2">$SPLUNK_HOME/etc/apps/SplunkLightForwarder/default/indexes.conf</font></code>).
</li><li> Does not use <code><font size="2">transforms.conf</font></code> and does not fully parse incoming data, but the <code><font size="2">CHARSET, CHECK_FOR_HEADER, NO_BINARY_CHECK, PREFIX_SOURCETYPE,</font></code> and <code><font size="2">sourcetype</font></code> properties from <code><font size="2">props.conf</font></code> are used. 
</li><li> Disables the Splunk Web interface (<code><font size="2">$SPLUNK_HOME/etc/apps/SplunkLightForwarder/default/web.conf</font></code> ).
</li><li> Limits throughput to 256KBps (<code><font size="2">$SPLUNK_HOME/etc/apps/SplunkLightForwarder/default/limits.conf</font></code>).
</li><li> Disables the following modules in <code><font size="2">$SPLUNK_HOME/etc/apps/SplunkLightForwarder/default/default-mode.conf</font></code>:
</li></ul><code><font size="2"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[pipeline:indexerPipe]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;disabled_processors= indexandforward, diskusage, signing,tcp-output-generic-processor, syslog-output-generic-processor, http-output-generic-processor, stream-output-processor<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[pipeline:distributedDeployment]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;disabled = true<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[pipeline:distributedSearch]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;disabled = true<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[pipeline:fifo]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;disabled = true<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[pipeline:merging]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;disabled = true<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[pipeline:typing]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;disabled = true<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[pipeline:udp]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;disabled = true<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[pipeline:tcp]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;disabled = true<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[pipeline:syslogfifo]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;disabled = true<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[pipeline:syslogudp]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;disabled = true<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[pipeline:parsing]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;disabled_processors=utf8, linebreaker, header, sendOut<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[pipeline:scheduler]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;disabled_processors = LiveSplunks <br></font></code>
<p>These modules include the deployment server (not the deployment client), distributed search, named pipes/FIFOs, direct input from network ports, and the scheduler.
</p><p>The defaults for the light forwarder can be tuned to meet your needs by overriding the settings in <code><font size="2">$SPLUNK_HOME/etc/apps/SplunkLightForwarder/default/default-mode.conf</font></code> on a case-by-case basis.
</p>
<h4><font size="3"><b><i> <a name="forwardercapabilities_purge_old_indexes"><span class="mw-headline" id="Purge_old_indexes">Purge old indexes</span></a></i></b></font></h4>
<p>When you convert an indexer instance to a light forwarder, among other things, you disable indexing. In addition, you no longer have access to any data previously indexed on that instance. However, the data still exists. 
</p><p>If you want to purge that data from your system, you must first disable the SplunkLightForwarder app, then run the CLI <code><font size="2">clean</font></code> command, and then renable the app. For information on the <code><font size="2">clean</font></code> command, see "Remove indexed data from Splunk" in the <i>Managing Indexers and Clusters of Indexers</i> manual.
</p>
<h3> <a name="forwardercapabilities_considerations_for_forwarding_structured_data"><span class="mw-headline" id="Considerations_for_forwarding_structured_data">Considerations for forwarding structured data</span></a></h3>
<p><b>Note:</b> When you forward structured data (data with source types that use the <code><font size="2">INDEXED_EXTRACTIONS</font></code> feature) you must perform any parsing, extraction, or filtering changes on the forwarder, not the indexer. See Forward data extracted from header files" in the Getting Data In manual.
</p>
<h1>Troubleshoot forwarding</h1><a name="receiverconnection"></a><h2> <a name="receiverconnection_troubleshoot_forwarder.2freceiver_connection"><span class="mw-headline" id="Troubleshoot_forwarder.2Freceiver_connection"> Troubleshoot forwarder/receiver connection</span></a></h2>
<h3> <a name="receiverconnection_receiver_doesn.27t_accept_new_connections_on_its_receiving_port"><span class="mw-headline" id="Receiver_doesn.27t_accept_new_connections_on_its_receiving_port">Receiver doesn't accept new connections on its receiving port</span></a></h3>
<p>If the internal queue on the receiving indexer gets blocked, the indexer shuts down the receiving/listening (<code><font size="2">splunktcp</font></code>) port after a specified interval of being unable to insert data into the queue. Once the queue is again able to start accepting data, the indexer reopens the port. 
</p><p>However, sometimes (on Windows machines only) the indexer is unable to reopen the port once its queue is unblocked.  To remediate, you must restart the indexer. 
</p><p>If you find you have this issue, you can set the receiver's <code><font size="2">stopAcceptorAfterQBlock</font></code> attribute in inputs.conf to a higher value, so that it does not close the port as quickly. This attribute determines the amount of time the indexer waits before closing the port. The default is 300 seconds (five minutes).
</p><p>If you are using load-balanced forwarders, they will switch their data stream to another indexer in the load-balanced group based to their time-out interval, set in outputs.conf  with the <code><font size="2">writeTimeout</font></code> attribute. This results in automatic failover when the receiving indexers have blocked queues.
</p>
</body>  <script src='http://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js'></script>

        <script src="js/index.js"></script></html>
