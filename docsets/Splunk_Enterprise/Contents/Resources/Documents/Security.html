<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:og="http://ogp.me/ns#" xmlns:fb="http://ogp.me/ns/fb#" charset="utf-8"><head><meta charset="UTF-8"><title></title>
<link rel="stylesheet" href="css/normalize.css">
<link rel="stylesheet" type="text/css" href="css/main.css">
<link rel="stylesheet" href="css/style.css">
<style>
html,body {
margin: 0px;
padding: 10px;
width: 210mm;
max-width: 210mm;
overflow-x: hidden;
}
pre {
	width: 100%;
	overflow-x: hidden;
}
</style>
    <script src="js/prefixfree.min.js"></script>
</head><body><h1>About securing Splunk Enterprise</h1><a name="hardeningstandards"></a><div class="all-questions"><h2> <a name="hardeningstandards_about_securing_splunk_enterprise"><span class="mw-headline" id="About_securing_Splunk_Enterprise"> About securing Splunk Enterprise</span></a></h2>
<p>As soon as you set up and begin using your new Splunk Enterprise installation or upgrade, you should perform a few additional steps to ensure that Splunk Enterprise and your data are secure. Taking the proper steps to secure Splunk Enterprise reduces its attack surface and mitigates the risk and impact of most vulnerabilities.
</p>

<a name="whatyoucansecurewithsplunk"></a><h2> <a name="whatyoucansecurewithsplunk_ways_you_can_secure_splunk"><span class="mw-headline" id="Ways_you_can_secure_Splunk"> Ways you can secure Splunk</span></a></h2>
<p>This manual documents some of the many ways to secure your Splunk configuration and describes how to do the following:
</p>
<ul><li> Set up <b>user authentication</b> to create users and manage user access by assigning <b>roles</b>.
</li><li> Use SSL to secure communications for your Splunk configuration.   
</li><li> Use <b>auditing</b> to secure your data.
</li><li> Harden your Splunk instances to reduce vulnerability and risk.
</li></ul>


<h3> <a name="whatyoucansecurewithsplunk_user_authentication_and_role-based_access_control"><span class="mw-headline" id="User_authentication_and_role-based_access_control">User authentication and role-based access control</span></a></h3>
<p>Set up users and use roles to control access. Splunk allows you to configure users in three ways:
</p>
<ul><li> Splunk's own built-in system, described in <a href="#setupbuilt-inauthentication" class="external text">"Set up user authentication with Splunk's built-in system."</a>
</li><li> LDAP, described in <a href="#setupuserauthenticationwithldap" class="external text">"Set up user authentication with LDAP."</a>
</li><li> A scripted authentication API for use with an external authentication system, such as PAM or RADIUS, described in <a href="#configuresplunktousepamorradiusauthentication" class="external text">"Set up user authentication with external systems."</a>
</li></ul><p>Once you've configured users you can assign roles that determine and control capabilities and access levels. For more information about roles and capabilities, read <a href="#aboutusersandroles" class="external text">"About role-based user access."</a>
</p>
<h3> <a name="whatyoucansecurewithsplunk_encryption_and_authentication_with_ssl"><span class="mw-headline" id="Encryption_and_authentication_with_SSL"> Encryption and authentication with SSL </span></a></h3>
<p>Splunk comes with a set of default certificates and keys that, when enabled, provide encryption and data compression. You can also use your own certificates and keys to secure communications between your browser and Splunk Web as well as data sent from forwarders to a <b>receiver</b>, such as an indexer. 
</p><p>Under certain conditions, you can also secure communications in distributed search environments, configuration data sent to clients by a deployment server, and communications from Splunk Web to splunkd.
</p><p>For more information about securing Splunk communications with SSL, see <a href="#aboutsecuringyoursplunkconfigurationwithssl" class="external text">"About securing Splunk with SSL"</a> in this manual.
</p>
<h3> <a name="whatyoucansecurewithsplunk_auditing"><span class="mw-headline" id="Auditing"> Auditing </span></a></h3>
<p>Keep an eye on activities within Splunk (such as searches or configuration changes).
</p>
<ul><li>Monitoring<br> You can use monitoring to index all <code><font size="2">.conf</font></code> files using a white list as a best practice, and for user attribution of changes, you can use the file system-based monitoring available out of the box on most Splunk-supported operating systems.<br>For more information about monitoring, see "Monitor Files and Directories" in the Getting Data In manual.
</li></ul><ul><li>Audit events<br>Watch your Splunk instance by monitoring audit events.  Audit events are generated whenever anyone accesses any of your Splunk instances -- including any searches, configuration changes or administrative activities.  Each audit event contains information that shows you what changed where and when and who implemented the change.  Audit events are especially useful in distributed Splunk configurations for detecting configuration and access control changes across many Splunk Servers.<br>To learn more, see <a href="#audityoursystemactivity" class="external text">"Audit Splunk Enterprise activity"</a> in this manual.
</li></ul><h1>Install Splunk securely</h1><a name="installsplunksecurely"></a><h2> <a name="installsplunksecurely_install_splunk_enterprise_securely"><span class="mw-headline" id="Install_Splunk_Enterprise_securely"> Install Splunk Enterprise securely </span></a></h2>
<p>Take the following steps when downloading and installing Splunk
</p>
<h3> <a name="installsplunksecurely_verify_integrity"><span class="mw-headline" id="Verify_Integrity"> Verify Integrity </span></a></h3>
<p>Verify your Splunk Enterprise download using hash functions such as Message Digest 5 (MD5) and SHA-512 to compare the hashes. Be sure to use a trusted version of OpenSSL. For example:
<br><code><font size="2">./openssl dgst -md5 &lt;filename-splunk-downloaded.zip&gt;</font></code>
<br>
or
<br><code><font size="2">./openssl dgst -sha512 &lt;filename-splunk-downloaded.zip&gt;</font></code>
</p><p><br></p>
<h3> <a name="installsplunksecurely_verify_signatures"><span class="mw-headline" id="Verify_Signatures"> Verify Signatures </span></a></h3>
<p>You can verify the authenticity of the downloaded RPM package using our GnuPG Public key as follows
</p><p><b>1.</b> Download the GnuPG Public key file (yes, this link is over TLS).
</p><p><b>2.</b> Install the key using:
</p>
<code><font size="2"><br>rpm --import &lt;filename&gt;<br></font></code>
<p><b>3.</b> Verify the package signature using:
</p>
<code><font size="2"><br>rpm -K &lt;filename&gt;<br></font></code>

<a name="securesplunkonyournetwork"></a><h2> <a name="securesplunkonyournetwork_secure_splunk_enterprise_on_your_network"><span class="mw-headline" id="Secure_Splunk_Enterprise_on_your_network"> Secure Splunk Enterprise on your network</span></a></h2>
<p>Under certain conditions, Splunk Enterprise ports can become susceptible to attacks. Prevent access by shielding your Splunk Enterprise configuration from the Internet.
</p><p>If possible, use a host-based firewall to restrict access to Splunkweb, management, and data ports. Keep Splunk Enterprise within a host-based firewall. Have your remote users access Splunk Enterprise on a Virtual Private Network.
</p><p>You also can protect Splunk Enterprise from attacks in the following ways:
</p>
<ul><li> Restrict CLI security by restricting this port to local calls only, from behind a host firewall.
</li><li> Unless necessary, do not allow access to forwarders on any port.
</li><li> Install Splunk Enterprise on an isolated network segment that only trustworthy machines can access.
</li><li> Limit port accessibility to only necessary connections. The necessary connections are:
<ul><li> End users and administrators must access Splunkweb (TCP port 8000 by default).
</li><li> Search heads must access search peers on the management port (TCP port 8089 by default).
</li><li> Deployment clients must access the deployment server on the management port (TCP port 8089 by default).
</li><li> Forwarders must access the index server data port (TCP port 9997 by default).
</li><li> Remote CLI calls use the management port.
</li></ul></li></ul><a name="hardenyourserversandsecureyouroperatingsystem"></a><h2> <a name="hardenyourserversandsecureyouroperatingsystem_some_best_practices_for_your_servers_and_operating_system"><span class="mw-headline" id="Some_best_practices_for_your_servers_and_operating_system"> Some best practices for your servers and operating system</span></a></h2>
<h3> <a name="hardenyourserversandsecureyouroperatingsystem_operating_system"><span class="mw-headline" id="Operating_System">Operating System</span></a></h3>
<p>Splunk strongly recommends hardening all Splunk server operating systems.
</p>
<ul><li> If your organization does not have internal hardening standards, Splunk recommends the CIS hardening benchmarks.
</li><li> As a minimum, limit shell/command line access to your Splunk servers.
</li></ul><h3> <a name="hardenyourserversandsecureyouroperatingsystem_splunk"><span class="mw-headline" id="Splunk">Splunk</span></a></h3>
<ul><li> Configure redundant Splunk instances, both indexing a copy of the same data.
</li><li> Backup Splunk data and configurations, regularly.
</li><li> Execute a periodic recovery test by attempting to restore Splunk from backup.
</li><li> Verify your Splunk download using a hash function such as MD5 to compare the hashes. For example:
</li></ul><p><code><font size="2">./openssl dgst md5 &lt;filename-splunk-downloaded.zip&gt;</font></code>
</p>
<h3> <a name="hardenyourserversandsecureyouroperatingsystem_client_browser"><span class="mw-headline" id="Client_browser">Client browser</span></a></h3>
<ul><li> Use a current version of a supported browser, such as Firefox or Internet Explorer.
</li><li> Use a client-side JavaScript blocker such as noscript on Firefox or Internet Explorer 8 Filters to help protect against XSS, XSRF, and similar exploits.
</li><li> Ensure that users have the latest Flash version installed.
</li></ul><h3> <a name="hardenyourserversandsecureyouroperatingsystem_physical_security"><span class="mw-headline" id="Physical_security">Physical security</span></a></h3>
<ul><li> Secure physical access to all Splunk servers.
</li><li> Ensure that Splunk end users practice sound physical and endpoint security.
<ul><li> Set a short time-out for Splunk Web user sessions. See   Configure timeouts for more information.
</li></ul></li></ul><a name="hardenyourconfiguration"></a><h2> <a name="hardenyourconfiguration_harden_your_configuration"><span class="mw-headline" id="Harden_your_configuration"> Harden your configuration</span></a></h2>
<p>Consider the following opportunities to secure your configuration:
</p>
<ul><li> Use a configuration management tool, such as subversion, to provide version control for Splunk configurations.
</li><li> Integrate Splunk configuration changes into your existing change management framework.
</li><li> Configure Splunk to monitor its own configuration files and alert on changes.
</li></ul><a name="disableunnecessarysplunkcomponents"></a><h2> <a name="disableunnecessarysplunkcomponents_disable_unnecessary_splunk_enterprise_components"><span class="mw-headline" id="Disable_unnecessary_Splunk_Enterprise_components"> Disable unnecessary Splunk Enterprise components</span></a></h2>
<p>For single-server Splunk Enterprise deployments:
</p>
<ul><li> Forwarders should not run Splunkweb and should not be configured to receive data on TCP or UDP ports or from other Splunk Enterprise instances.
</li></ul><p>For multiserver Splunk Enterprise deployments:
</p>
<ul><li> Search heads should not receive data on TCP or UDP ports or from other Splunk Enterprise instances.
</li><li> If users are not logging in to Splunkweb on indexers in a distributed environment, Splunkweb should be disabled on the indexers.
</li><li> Forwarders should not run Splunkweb and should not be configured to receive data on TCP or UDP ports or from other Splunk instances.
</li></ul><h1>Users and role-based access control</h1><a name="useaccesscontroltosecuresplunkdata"></a><h2> <a name="useaccesscontroltosecuresplunkdata_use_access_control_to_secure_splunk_data"><span class="mw-headline" id="Use_access_control_to_secure_Splunk_data"> Use access control to secure Splunk data</span></a></h2>
<table cellpadding="10" cellspacing="0" border="1" width="100%"><tr><td valign="center" align="left"> This page is currently a work in progress; expect frequent near-term updates.
</td></tr></table><p>Splunk's role-based access control provides flexible and effective tools that you can use to protect Splunk data. In some cases, protecting data with role-based access controls can even be more effective (and simple to configure) than encryption or SSL certifications. 
</p><p>The way that Splunk masks data to the user can be considered similar to a relational databases' role-based access control. In some cases total segmentation of data may be necessary. In other cases, however, controlling the searches and results at the presentation layer (something you can do with many of our Splunk Apps) may meet your security needs. 
</p><p>Consider your use cases when deciding how to set up your configurations and whether role-based access might fit your needs. For example:
</p>
<ul><li> For extremely sensitive data, where even allowing access to a system that might have sensitive data incurs legal risk, consider installing and configuring more than one instance of Splunk, and then configuring each instance with the data for the appropriate audience. 
</li></ul><ul><li> When intentionally or unintentionally exposing sensitive data to the wrong user might incur legal ramifications, then consider creating indexes specifically for privileged and non-privileged accounts and assigning them to roles created for each level of access.
</li></ul><ul><li> When there are security concerns but not so much legal risk, you can restrict access using Apps. For example, you can create an App with static dashboards and assign roles with lower clearance to those dashboard, limiting the type of information the user assigned to the role may access. 
</li></ul><ul><li> Field encryption, search exclusions, and field aliasing to redacted data are also great ways to tighten up a limited search case.
</li></ul><a name="setupuserauthenticationwithsplunk"></a><h2> <a name="setupuserauthenticationwithsplunk_about_user_authentication"><span class="mw-headline" id="About_user_authentication"> About user authentication</span></a></h2>
<p>Splunk Enterprise authentication allows you to add users, assign them to <b>roles</b>, and give those roles custom permissions as needed for your organization. 
</p><p>Splunk ships with support for three types of authentication systems: 
</p>
<ul><li> Splunk's own built-in system: In addition to Splunk's default roles of <b>Admin</b>, <b>Power</b> or <b>User</b>, you can define your own roles using a list of <b>capabilities</b>. Splunk with an Enterprise license comes with Splunk's built-in authentication enabled by default. See <a href="#setupbuilt-inauthentication" class="external text">"Set up user authentication with Splunk's built-in system"</a> for more information. 
</li></ul><ul><li> LDAP: Splunk supports authentication with its internal authentication services or your existing LDAP server. See <a href="#setupuserauthenticationwithldap" class="external text">"Set up user authentication with LDAP"</a>  for more information.
</li></ul><ul><li> Scripted authentication API: Use scripted authentication to tie Splunk's authentication into an external authentication system, such as RADIUS or PAM. See <a href="#configuresplunktousepamorradiusauthentication" class="external text">"Set up user authentication with external systems"</a> for more information.
</li></ul><p><b>Note:</b> Authentication, including native authentication, LDAP, and scripted authentication, is not available in Splunk Free.
</p><p>You can create and assign users to flexible roles either in Splunk Web or by editing authorize.conf. For more information about roles and capabilities, read <a href="#aboutusersandroles" class="external text">"About role-based user access."</a>
</p><p><b>Important:</b> Splunk's built-in system always takes precedence over any external systems. This is the order in which Splunk authenticates a user:
</p><p><b>1.</b> Splunk built-in authentication
</p><p><b>2.</b> LDAP or Scripted authentication (if enabled).
</p>
<a name="aboutusersandroles"></a><h2> <a name="aboutusersandroles_about_configuring_role-based_user_access"><span class="mw-headline" id="About_configuring_role-based_user_access"> About configuring role-based user access</span></a></h2>
<p>If you're running Splunk Enterprise, you can create users with passwords and assign them to <b>roles</b>. Roles determine the access and <b>permissions</b> of any user assigned to that role.
</p><p>For more information about users, see <a href="#setupuserauthenticationwithsplunk" class="external text">"About user authentication."</a>
</p><p>By default, Splunk comes with the following roles predefined:
</p>
<ul><li> admin: this role is intended for administrators who will manage all or most of the users, objects, and configuration and comes predefined with the most assigned <b>capabilities</b>.
</li><li> power: this role can edit all shared objects (saved searches, etc) and alerts, tag events, and other similar tasks.
</li><li> user: this role can create and edit its own saved searches, run searches, edit its own preferences, create and edit event types, and other similar tasks.
</li><li> can_delete: This role allows the user to delete by keyword. This capability is necessary when using the delete search operator.
</li></ul><p>You can also create custom roles and assign your users to those roles. When you create a custom role, you determine the following:
</p>
<ul><li> Allowed searches: you can define the searches that an user assigned to the role is allowed to perform.
</li><li>Role inheritance: you can have your role inherit certain properties of one or more existing roles. Role inheritance is discussed later in this topic.
</li><li>Assign capabilities: you can specify the allowed actions (change their password, change forwarder settings, etc) of the user assigned to the role. See <a href="#rolesandcapabilities" class="external text">"About defining roles with capabilities"</a> for more information. 
</li><li>Set allowed and default indexes: you can limit access to specific indexes and set the index that is searched by default.
</li></ul><p>To create roles in Splunk Web, see <a href="#addandeditroles" class="external text">"Add and edit roles with Splunk Web"</a>. To create roles by editing authorize.conf, see <a href="#addandeditroleswithauthorizeconf" class="external text">"Add and edit roles with authorize.conf"</a>
</p>
<h3> <a name="aboutusersandroles_inheritance"><span class="mw-headline" id="Inheritance">Inheritance</span></a></h3>
<p>As a rule, members of multiple roles inherit properties from the role with the broadest permissions. 
</p>
<h3> <a name="aboutusersandroles_how_users_inherit_search_filter_restrictions"><span class="mw-headline" id="How_users_inherit_search_filter_restrictions">How users inherit search filter restrictions</span></a></h3>
<p>You can create roles that inherit the characteristics of other roles. Users assigned to multiple roles inherit properties from the assigned roles.
</p><p>In the case of search filters, if a user is assigned to roles with different search filters, the filters are all combined and thus the restrictions of each role are applied. 
</p><p>For example, by default, the Power and User roles do not have search filters defined to restrict searches. If a user has a combination of these roles and another role with filters defined (for example, srchFilter=x), the user will inherit the restrictions of that role, despite the association with roles that have no filter.
</p>
<h3> <a name="aboutusersandroles_how_users_inherit_allowed_indexes"><span class="mw-headline" id="How_users_inherit_allowed_indexes">How users inherit allowed indexes</span></a></h3>
<p>In the case of allowed indexes, the user is given the highest level of access granted to any role to which they are assigned. 
</p><p>For example, if a user is assigned to the role "simple user" which limits access to one particular index, and also to a role "advanced user" which has more capabilities and allows access to all indexes, the user will have access to all indexes. If you wanted to grant the capabilities of the "advanced user" but continue to limit their index access to the single index defined for the "simple user", you should create a new role specifically for that user.
</p>
<h3> <a name="aboutusersandroles_how_users_inherit_capabilities"><span class="mw-headline" id="How_users_inherit_capabilities">How users inherit capabilities</span></a></h3>
<p>In the case of capabilities, the user is given the highest level of abilities granted to any role to which they are assigned. 
</p><p>For example, if a user is assigned to the role "admin" which has the most capabilities, and also to a role "advanced user" which a different set of capabilities, the user will have the capabilities of both roles.
</p>
<a name="rolesandcapabilities"></a><h2> <a name="rolesandcapabilities_about_defining_roles_with_capabilities"><span class="mw-headline" id="About_defining_roles_with_capabilities"> About defining roles with capabilities</span></a></h2>
<p>When you create a user in Splunk Web you assign that user to one  role. See <a href="#aboutusersandroles" class="external text">"About role-based user access"</a> for more information.
</p><p>Each role contains a set of  <b>capabilities</b>. You can add or edit capabilities for new, existing, and default roles. For example, you might give a role the capability to add inputs or edit saved searches.
</p><p>To add or change the capabilties to a role in Splunk Web, see <a href="#addandeditroles" class="external text">"Add and edit roles with Splunk Web."</a> To create roles by editing authorize.conf, see <a href="#addandeditroleswithauthorizeconf" class="external text">"Add and edit roles with authorize.conf."</a>
</p>
<h3> <a name="rolesandcapabilities_list_of_available_capabilities"><span class="mw-headline" id="List_of_available_capabilities">List of available capabilities</span></a></h3>
<p>This list shows the capabilities that you can add to any role. Check authorize.conf for the most up-to-date version of this list. The admin role has all the capabilities in this list except for the "delete_by_keyword" capability. 
</p>
<table cellpadding="5" cellspacing="0" border="1"><tr><th bgcolor="#C0C0C0"> Capability name
</th><th bgcolor="#C0C0C0"> What it lets you do
</th></tr><tr><td valign="center" align="left"> <code><font size="2">accelerate_datamodel</font></code>
</td><td valign="center" align="left"> Enable or disable acceleration for data models.
</td></tr><tr><td valign="center" align="left"> <code><font size="2">accelerate_search</font></code>
</td><td valign="center" align="left"> Enable or disable acceleration for reports. For a role to use this it must also have the <code><font size="2">schedule_search</font></code> capability.
</td></tr><tr><td valign="center" align="left"> <code><font size="2">admin_all_objects</font></code>
</td><td valign="center" align="left"> Access and modify any object in the system (user objects, search jobs, etc.). (Overrides any limits set in the objects.)
</td></tr><tr><td valign="center" align="left"> <code><font size="2">change_authentication</font></code>
</td><td valign="center" align="left"> Change authentication settings and reload authentication.
</td></tr><tr><td valign="center" align="left"> <code><font size="2">change_own_password</font></code>
</td><td valign="center" align="left"> User can change their own password.
</td></tr><tr><td valign="center" align="left"> <code><font size="2">delete_by_keyword</font></code>
</td><td valign="center" align="left"> Use the "delete" operator in searches.
</td></tr><tr><td valign="center" align="left"> <code><font size="2">edit_deployment_client</font></code>
</td><td valign="center" align="left"> Change deployment client settings.
</td></tr><tr><td valign="center" align="left"> <code><font size="2">edit_deployment_server</font></code>
</td><td valign="center" align="left"> Change deployment server settings.
</td></tr><tr><td valign="center" align="left"> <code><font size="2">edit_dist_peer</font></code>
</td><td valign="center" align="left"> Add and edit peers for distributed search.
</td></tr><tr><td valign="center" align="left"> <code><font size="2">edit_forwarders</font></code>
</td><td valign="center" align="left"> Change forwarder settings.
</td></tr><tr><td valign="center" align="left"> <code><font size="2">edit_httpauths</font></code>
</td><td valign="center" align="left"> Edit and end user sessions.
</td></tr><tr><td valign="center" align="left"> <code><font size="2">edit_input_defaults</font></code>
</td><td valign="center" align="left"> Change default hostnames for input data.
</td></tr><tr><td valign="center" align="left"> <code><font size="2">edit_monitor</font></code>
</td><td valign="center" align="left"> Add inputs and edit settings for monitoring files.
</td></tr><tr><td valign="center" align="left"> <code><font size="2">edit_roles</font></code>
</td><td valign="center" align="left"> Edit roles and change user/role mappings.
</td></tr><tr><td valign="center" align="left"> <code><font size="2">edit_scripted</font></code>
</td><td valign="center" align="left"> Create and edit scripted inputs.
</td></tr><tr><td valign="center" align="left"><code><font size="2">edit_search_head_clustering</font></code>
</td><td valign="center" align="left"> Edit search head clustering settings.
</td></tr><tr><td valign="center" align="left"> <code><font size="2">edit_search_server</font></code>
</td><td valign="center" align="left"> Edit general distributed search settings like timeouts, heartbeats, and blacklists.
</td></tr><tr><td valign="center" align="left"> <code><font size="2">edit_server</font></code>
</td><td valign="center" align="left"> Edit general server settings like server name, log levels, etc.
</td></tr><tr><td valign="center" align="left"> <code><font size="2">edit_splunktcp</font></code>
</td><td valign="center" align="left"> Change settings for receiving TCP inputs from another Splunk instance.
</td></tr><tr><td valign="center" align="left"> <code><font size="2">edit_splunktcp_ssl</font></code>
</td><td valign="center" align="left"> Can list or edit any SSL-specific settings for Splunk TCP input.
</td></tr><tr><td valign="center" align="left"> <code><font size="2">edit_tcp</font></code>
</td><td valign="center" align="left"> Change settings for receiving general TCP inputs.
</td></tr><tr><td valign="center" align="left"> <code><font size="2">edit_udp</font></code>
</td><td valign="center" align="left"> Change settings for UDP inputs.
</td></tr><tr><td valign="center" align="left"> <code><font size="2">edit_user</font></code>
</td><td valign="center" align="left"> Create, edit, or remove users.
</td></tr><tr><td valign="center" align="left"> <code><font size="2">edit_view_html</font></code>
</td><td valign="center" align="left"> Create, edit, or modify HTML-based views.
</td></tr><tr><td valign="center" align="left"> <code><font size="2">edit_web_settings</font></code>
</td><td valign="center" align="left"> Change settings for web.conf.
</td></tr><tr><td valign="center" align="left"> <code><font size="2">embed_reports</font></code>
</td><td valign="center" align="left"> Embed reports and disable embedding for embedded reports.
</td></tr><tr><td valign="center" align="left"> <code><font size="2">get_diag</font></code>
</td><td valign="center" align="left"> Use the /streams/diag endpoint to get a remote diag from a Splunk instance.
</td></tr><tr><td valign="center" align="left"> <code><font size="2">get_metadata</font></code>
</td><td valign="center" align="left"> Use the "metadata" search processor.
</td></tr><tr><td valign="center" align="left"> <code><font size="2">get_typeahead</font></code>
</td><td valign="center" align="left"> Use typeahead.
</td></tr><tr><td valign="center" align="left"> <code><font size="2">indexes_edit</font></code>
</td><td valign="center" align="left"> Change index settings like file size and memory limits.
</td></tr><tr><td valign="center" align="left"> <code><font size="2">input_file</font></code>
</td><td valign="center" align="left"> Add a file as an input.
</td></tr><tr><td valign="center" align="left"> <code><font size="2">license_tab</font></code>
</td><td valign="center" align="left"> Access and change the license.
</td></tr><tr><td valign="center" align="left"> <code><font size="2">license_edit</font></code>
</td><td valign="center" align="left"> Edit the license.
</td></tr><tr><td valign="center" align="left"> <code><font size="2">list_deployment_client</font></code>
</td><td valign="center" align="left"> View deployment client settings.
</td></tr><tr><td valign="center" align="left"> <code><font size="2">list_deployment_server</font></code>
</td><td valign="center" align="left"> View deployment server settings.
</td></tr><tr><td valign="center" align="left"> <code><font size="2">list_forwarders</font></code>
</td><td valign="center" align="left"> View forwarder settings.
</td></tr><tr><td valign="center" align="left"> <code><font size="2">list_httpauths</font></code>
</td><td valign="center" align="left"> View user sessions.
</td></tr><tr><td valign="center" align="left"> <code><font size="2">list_inputs</font></code>
</td><td valign="center" align="left"> View list of various inputs, including input from files, TCP, UDP, scripts, etc.
</td></tr><tr><td valign="center" align="left"> <code><font size="2">output_file</font></code>
</td><td valign="center" align="left"> Add a file as an output.
</td></tr><tr><td valign="center" align="left"> <code><font size="2">pattern_detect</font></code>
</td><td valign="center" align="left"> Controls ability to see and use the Patterns tab in the Search view.
</td></tr><tr><td valign="center" align="left"> <code><font size="2">request_remote_tok</font></code>
</td><td valign="center" align="left"> Get a remote authentication token.
</td></tr><tr><td valign="center" align="left"> <code><font size="2">rest_apps_management</font></code>
</td><td valign="center" align="left"> Edit settings in the python remote apps handler.
</td></tr><tr><td valign="center" align="left"> <code><font size="2">rest_apps_view</font></code>
</td><td valign="center" align="left"> List properties in the python remote apps handler.
</td></tr><tr><td valign="center" align="left"> <code><font size="2">rest_properties_get</font></code>
</td><td valign="center" align="left"> Can get information from the services/properties endpoint.
</td></tr><tr><td valign="center" align="left"> <code><font size="2">rest_properties_set</font></code>
</td><td valign="center" align="left"> Edit the services/properties endpoint.
</td></tr><tr><td valign="center" align="left"> <code><font size="2">restart_splunkd</font></code>
</td><td valign="center" align="left"> Restart Splunk through the server control handler.
</td></tr><tr><td valign="center" align="left"> <code><font size="2">rtsearch</font></code>
</td><td valign="center" align="left"> Run real-time searches.
</td></tr><tr><td valign="center" align="left"> <code><font size="2">run_debug_commands</font></code>
</td><td valign="center" align="left"> Run debug commands.
</td></tr><tr><td valign="center" align="left"> <code><font size="2">schedule_search</font></code>
</td><td valign="center" align="left"> Schedule saved searches, create and update alerts, and review triggered alert information.
</td></tr><tr><td valign="center" align="left"> <code><font size="2">schedule_rtsearch</font></code>
</td><td valign="center" align="left"> Schedule real-time saved searches. In order for a user to use this capability their role must also have the <code><font size="2">schedule_search</font></code> capability.
</td></tr><tr><td valign="center" align="left"> <code><font size="2">search</font></code>
</td><td valign="center" align="left"> Run searches.
</td></tr><tr><td valign="center" align="left"> <code><font size="2">use_file_operator</font></code>
</td><td valign="center" align="left"> Use the "file" search operator.
</td></tr></table><a name="addandeditroles"></a><h2> <a name="addandeditroles_add_and_edit_roles_with_splunk_web"><span class="mw-headline" id="Add_and_edit_roles_with_Splunk_Web"> Add and edit roles with Splunk Web</span></a></h2>
<p>When you create users, you assign them to roles that determine the level of access to Splunk Enterprise and the tasks that they can perform. Splunk Enterprise comes with a set of default roles that you can use. You can also create your own.
</p><p>For information about roles and how capabilitites and permissions are inherited, see <a href="#aboutusersandroles" class="external text">"About role-based user access."</a>
</p><p><b>Note:</b> Custom roles that inherit from Admin or Power users do not automatically inherit management access. For information about granting management access to custom roles, see <a href="#addmanagementaccesstocustomroles" class="external text">"Add access controls to custom roles."</a>
</p>
<h3> <a name="addandeditroles_add_or_edit_a_role"><span class="mw-headline" id="Add_or_edit_a_role"> Add or edit a role</span></a></h3>
<p>To create or edit roles in Splunk Web:
</p><p><b>1.</b> Click <b>Settings &gt; Access Controls</b>. 
</p><p><b>2.</b> Click <b>Access controls</b> page click <b>Roles</b>.
</p><p><b>3.</b> Click <b>New</b> or select and edit an existing role. Role names must use lowercase characters only. They cannot contain spaces, colons, or forward slashes.
</p><p><b>4.</b> Specify <b>Search restrictions</b> for this role. You create and restrict data access control and search capacity by specifying search restrictions. 
</p>
<ul><li> <b>Restrict search terms:</b> You can create search strings that determine what data will (or will not) display for a user assigned to the role. See <a href="#addandeditroles_search_filter_format" class="external text">"Search filter format"</a> in this topic.
</li><li> <b>Restrict search time range:</b> specify over how large of a window of time this role can search.
</li><li> <b>User-level concurrent search jobs limit:</b> specify the maximum number of search jobs that can be run at one time for users of this role.
</li><li> <b>User-level concurrent real-time search jobs limit:</b> Specify the number of real-time  search jobs that can be run at the same time for a user of this role.
</li><li> <b>Role-level concurrent search jobs limit:</b> specify the maximum number of search jobs that can be run at one time for this role. 
</li><li> <b>Role-level concurrent real-time search jobs limit:</b> Specify the number of real-time  search jobs that can be run at the same time for this role.
</li><li> <b>Limit total jobs disk quota:</b> Specify the total disc space you want to dedicate to search jobs for each user assigned to the role.
</li></ul><p><b>5.</b> In the <b>Inheritance</b> section, select roles that you want your new role from which you want to inherit capabilities and properties. A user assigned to multiple roles inherits properties from the role with the broadest permissions. See <a href="#aboutusersandroles_role_inheritance" class="external text">"Role inheritance"</a> in the <a href="#aboutusersandroles" class="external text">"About role-based user access"</a> topic for more information.
</p><p><b>6.</b> In the <b>Capabilities</b> section, choose any individual capabilities you want to provide to this role. See <a href="#rolesandcapabilities" class="external text">"About defining roles with capabilities"</a> for more information.
</p><p><b>7.</b> In <b>Indexes searched by default</b> specify the indexes that this role will automatically search of no index is specified in the search.
</p><p><b>8.</b> In <b>Indexes</b> select indexes the user is allowed to search. If you add at least one index, a user with this role will only be able to conduct searches on the index or indexes selected. If you do not specify any indexes at all, the user assigned to the role is able to search all indexes.
</p><p><b>9.</b> Click <b>Save</b>.
</p>
<h3> <a name="addandeditroles_search_filter_format"><span class="mw-headline" id="Search_filter_format"> Search filter format </span></a></h3>
<p>The Search filter field can include any of the following search terms:
</p>
<ul><li> <code><font size="2">source=</font></code>
</li><li> <code><font size="2">host=</font></code> 
</li><li> <code><font size="2">index=</font></code> 
</li><li> <code><font size="2">eventtype=</font></code> 
</li><li> <code><font size="2">sourcetype=</font></code>
</li><li> search fields
</li><li> wildcards
</li><li> use <code><font size="2">OR</font></code> to use multiple terms, or <code><font size="2">AND</font></code> to make searches more restrictive
</li></ul><p>The search terms cannot include:
</p>
<ul><li> saved searches
</li><li> time operators
</li><li> regular expressions
</li><li> any fields or modifiers Splunk Web can overwrite
</li></ul><a name="addandeditroleswithauthorizeconf"></a><h2> <a name="addandeditroleswithauthorizeconf_add_and_edit_roles_with_authorize.conf"><span class="mw-headline" id="Add_and_edit_roles_with_authorize.conf"> Add and edit roles with authorize.conf</span></a></h2>
<p>You can add or modify roles by editing authorize.conf.  Users are assigned to roles which determine the level of access to Splunk and the tasks that they can perform with Splunk. For more information about roles and capabilities, read <a href="#aboutusersandroles" class="external text">"About role-based user access."</a>
</p><p><b>Caution:</b> Do not edit or delete any roles in <code><font size="2">$SPLUNK_HOME/etc/system/default/authorize.conf</font></code>.  This could break your admin capabilities.  Edit this file in <code><font size="2">$SPLUNK_HOME/etc/system/local/</font></code>, or your own custom application directory in <code><font size="2">$SPLUNK_HOME/etc/apps/</font></code>.  For more information on configuration files in general, see "About configuration files" in the Admin Manual.
</p><p><b>Note:</b> Distributed search configurations have slightly different authorization needs. When you use search head pooling, you must make sure that the search heads and the search peers all use the same set of authorize.conf file(s). To make sure your authorization is properly set up for search pooling, see "How authorization works in distributed searches."
</p>
<h3> <a name="addandeditroleswithauthorizeconf_add_roles"><span class="mw-headline" id="Add_roles"> Add roles </span></a></h3>
<p>Here's the syntax for adding roles through <code><font size="2">$SPLUNK_HOME/etc/system/local/authorize.conf</font></code>:
</p>
<code><font size="2"><br>[role_&lt;roleName&gt;]<br>&lt;attribute&gt; = &lt;value&gt;<br>&lt;attribute&gt; = &lt;value&gt;<br>...<br></font></code>
<p>The <code><font size="2">&lt;roleName&gt;</font></code> in the stanza header is the name you want to give your role.  For example: <code><font size="2">security</font></code>, <code><font size="2">compliance</font></code>, <code><font size="2">ninja</font></code>. 
</p><p>Role names must use lowercase characters only. They cannot contain spaces, colons, or forward slashes.
</p><p>You can include these attributes in the role stanza:
</p>
<ul><li> <code><font size="2">&lt;capability&gt; = enabled</font></code>
<ul><li> You can add any number of capabilities to a role. See <a href="#rolesandcapabilities" class="external text">"About defining roles with capabilities"</a> for more information.
</li><li> Capabilities are disabled by default. To add a capability to a role, just set it to "enabled".
</li></ul></li><li> <code><font size="2">importRoles = &lt;role&gt;;&lt;role&gt;;...</font></code>
<ul><li> When set, the current role will inherit all the capabilities from <code><font size="2">&lt;role&gt;</font></code>. Members assigned to multiple roles inherit properties from the role with the broadest permissions. See <a href="#aboutusersandroles_role_inheritance" class="external text">"Role inheritance"</a> in the "About users and roles" topic for more information.
</li><li> Separate multiple roles, if any, with semicolons.
</li></ul></li><li> <code><font size="2">srchFilter = &lt;search_string&gt;</font></code>
<ul><li> Use this field for fine-grained access controls.  Searches for this role will be filtered by this expression. See <a href="#addandeditroleswithauthorizeconf_search_filter_format" class="external text">"Search filter format"</a> in this topic for more information.
</li></ul></li><li> <code><font size="2">srchTimeWin = &lt;string&gt;</font></code>
<ul><li> Maximum time span (in seconds) of a search executed by this role.
</li></ul></li><li> <code><font size="2">srchDiskQuota = &lt;int&gt;</font></code>
<ul><li> Maximum amount of disk space (MB) that can be taken by search jobs of a user that belongs to this role.
</li></ul></li><li> <code><font size="2">cumulativeSrchJobsQuota = &lt;number&gt;</font></code>
<ul><li> Maximum number of concurrently running historical searches that all members of this role can have.
</li><li> <b>NOTE:</b> When a user belongs to multiple roles, then the user uses searches from the roles with the largest cumulative search quota first. When the quota that role is completely used up, roles with lower quotas are used.
</li></ul></li><li> <code><font size="2">cumulativeRTSrchJobsQuota = &lt;number&gt;</font></code>
<ul><li> Maximum number of concurrently running real-time searches that all members of this role can have.
</li><li> <b>NOTE:</b> When a user belongs to multiple roles, then the user uses searches from the roles with the largest cumulative search quota first. When the quota that role is completely used up, roles with lower quotas are used.* <code><font size="2">srchJobsQuota = &lt;int&gt;</font></code>
</li><li> Maximum number of concurrently running searches a member of this role can have.
</li></ul></li><li> <code><font size="2">rtSrchJobsQuota = &lt;number&gt;</font></code>
<ul><li> Maximum number of concurrently running real-time searches a member of this role can have.
</li></ul></li><li> <code><font size="2">srchIndexesDefault = &lt;string&gt;</font></code>
<ul><li> Semicolon delimited list of indexes to search when no index is specified.
</li><li> These indexes can be wildcarded, with the exception that '*' does not match internal indexes.
</li><li> To match internal indexes, start with '_'. All internal indexes are represented by '_*'.
</li></ul></li><li> <code><font size="2">srchIndexesAllowed = &lt;string&gt;</font></code>
<ul><li> Semicolon delimited list of indexes this role is allowed to search.
</li><li> Follows the same wildcarding semantics as <code><font size="2">srchIndexesDefault</font></code>.
</li></ul></li></ul><p><b>Note:</b> You must reload authentication or restart Splunk after making changes to <code><font size="2">authorize.conf</font></code>.  Otherwise, your new roles will not appear in the <b>Role</b> list. To reload authentication, go to the <b>Manager &gt; Authentication</b> section of Splunk Web. This refreshes the authentication caches, but does not boot current users.
</p>
<h3> <a name="addandeditroleswithauthorizeconf_search_filter_format"><span class="mw-headline" id="Search_filter_format"> Search filter format </span></a></h3>
<p>The <code><font size="2">srchFilter</font></code>/ field can include any of the following search terms:
</p>
<ul><li> <code><font size="2">source=</font></code>
</li><li> <code><font size="2">host=</font></code> and host tags
</li><li> <code><font size="2">index=</font></code> and index names
</li><li> <code><font size="2">eventtype=</font></code> and event type tags
</li><li> <code><font size="2">sourcetype=</font></code>
</li><li> search fields
</li><li> wildcards
</li><li> use <code><font size="2">OR</font></code> to use multiple terms, or <code><font size="2">AND</font></code> to make searches more restrictive.
</li></ul><p>The search terms cannot include:
</p>
<ul><li> saved searches
</li><li> time operators
</li><li> regular expressions
</li><li> any fields or modifiers Splunk Web can overwrite
</li></ul><h3> <a name="addandeditroleswithauthorizeconf_example_of_creating_a_role_in_authorize.conf"><span class="mw-headline" id="Example_of_creating_a_role_in_authorize.conf"> Example of creating a role in authorize.conf </span></a></h3>
<p>This example creates the role "ninja", which inherits capabilities from the default "user" role. ninja has almost the same capabilities as the default "power" role, except it cannot schedule searches. In addition:
</p>
<ul><li> The search filter limits ninja to searching on <code><font size="2">host=foo</font></code>. 
</li><li>ninja is allowed to search all public indexes (those that do not start with underscore) and will search the indexes <code><font size="2">mail</font></code> and <code><font size="2">main</font></code> if no index is specified in the search.
</li><li> ninja is allowed to run 8 search jobs and 8 real-time search jobs concurrently. (These counts are independent.)
</li><li> ninja is allowed to occupy up to 500MB total space on disk for all its jobs.
</li></ul><code><font size="2"><br>[role_ninja]<br>rtsearch = enabled<br>importRoles = user<br>srchFilter = host=foo<br>srchIndexesAllowed = *<br>srchIndexesDefault = mail;main<br>srchJobsQuota &nbsp;&nbsp;= 8<br>rtSrchJobsQuota = 8<br>srchDiskQuota &nbsp;&nbsp;= 500<br></font></code>

<a name="addmanagementaccesstocustomroles"></a><h2> <a name="addmanagementaccesstocustomroles_setting_access_to_manager_consoles_and_apps"><span class="mw-headline" id="Setting_access_to_manager_consoles_and_apps"> Setting access to manager consoles and apps</span></a></h2>
<p>The local.meta file is handy for allowing you to grant and restrict access to certain parts of your Splunk instance. For example, you can:
</p>
<ul><li> Restrict users in custom roles to a specific app
</li><li> Give users in custom roles the ability to access admin level features
</li></ul><h3> <a name="addmanagementaccesstocustomroles_granting_admin_roles_to_users"><span class="mw-headline" id="Granting_admin_roles_to_users">Granting admin roles to users</span></a></h3>
<p>Some management abilities that belong to the Admin role are unique to that specific label. These abilities are not automatically inherited from the Admin role when you configure a role in Splunk Web or <code><font size="2">authorize.conf</font></code>. 
</p><p>For example, say you want to create a custom role that inherits all of the Admin abilities but has limited access to your search jobs. To do this, you would create a new role called "SpecialAdmin" and set it to inherit all of the capabilities of an Admin as described in <a href="#rolesandcapabilities" class="external text">"About defining roles with capabilities"</a> then set your search limits <a href="#aboutusersandroles" class="external text">"About configuring role-based user access</a>. 
</p><p>"SpecialAdmin" will have every capability you assign to the Admin role. However it will not automatically have access to the same manager pages as the Admin, including:
</p>
<ul><li> System related functionality: The ability to view or modify your system settings and cluster configuration, update or view your license, and restart Splunk.
</li><li> Data features: The ability to view or add data inputs, configure forwarding and receiving, manage indexes, and report acceleration.
</li><li> Distributed Environment: Set up distributed search, view deployment client and server status.
</li><li> Users and Authentication: Manage you LDAP configuration, users (other than their own) and roles.
</li></ul><h3> <a name="addmanagementaccesstocustomroles_restricting_access_to_specific_apps"><span class="mw-headline" id="Restricting_access_to_specific_apps">Restricting access to specific apps</span></a></h3>
<p>The <code><font size="2">local.meta</font></code> file can also be used to restrict access. 
</p><p>For example, say you want to allow a user access to only one dashboard view. To accomplish this, you could create an app for that view and assign the user's role to that app. You should use meta.local to permit the role to view that app.
</p>
<h3> <a name="addmanagementaccesstocustomroles_how_to_add_and_remove_access_via_local.meta_files"><span class="mw-headline" id="How_to_add_and_remove_access_via_local.meta_files"> How to add and remove access via local.meta files</span></a></h3>
<p>You can give or restrict access by editing the local.meta file to add the new role wherever you want it.  
</p><p><b>1.</b> Locate the <code><font size="2">local.meta</font></code> file. If you are editing access for the main search page (ie, the manager controls), look in <code><font size="2">$SPLUNK_HOME/etc/system/metadata/</font></code>. If you want to edit access to a particular app, look in <code><font size="2">$SPLUNK_HOME/etc/apps/&lt;app_name&gt;/metadata/</font></code>. If the directory for the desired location does not contain the file, you can copy the default version <code><font size="2">default.meta</font></code> and rename it.
</p><p><b>Note:</b> Do <b>NOT</b> edit the <code><font size="2">default.meta</font></code> file directly, you may need the default values in that file at a future time.
</p><p><b>2.</b> In the <code><font size="2">local.meta</font></code> file, add the name of the new role to the stanza that corresponds with the desired access.
</p>
<table cellpadding="5" cellspacing="0" border="1"><tr><th bgcolor="#C0C0C0"> Default stanza
</th><th bgcolor="#C0C0C0"> What it does
</th></tr><tr><td valign="center" align="left"> <code><font size="2">[manager/accesscontrols]
<p>access = read&nbsp;: [ * ], write&nbsp;: [ admin, power ] </p></font></code>

</td><td valign="center" align="left"> Allow all users to read this app's contents, or access functions in the Splunk Manager page, depending on the directory you are in. Unless overridden by other metadata, allows only admin and power users to share objects into this app.
</td></tr><tr><td valign="center" align="left"> <code><font size="2">
<p>[views]
[manager/accesscontrols]
access = read&nbsp;: [ * ], write&nbsp;: [ admin ]
</p></font></code>

</td><td valign="center" align="left"> Determines the access controls for the Manager page access.
</td></tr></table><p><b>3.</b> When you have made all of your changes, restart Splunk.
</p>
<h3> <a name="addmanagementaccesstocustomroles_examples"><span class="mw-headline" id="Examples"> Examples </span></a></h3>
<p><b>Example 1:</b> A new role called "usermanager" only inherits capabilities from a user and has no searches or indexes inherited. The intent is to create a role that has no access to data and is solely used to create and manage user accounts.
</p><p>To create this role you would edit the following stanza:
</p>
<div class="samplecode"><code><font size="2">[manager/accesscontrols]<br>access = read&nbsp;: [ admin ], write&nbsp;: [ admin ]</font></code></div>
<p>To include the following:
</p>
<div class="samplecode"><code><font size="2">[manager/accesscontrols]<br>access = read&nbsp;: [ admin, usermanager ], write&nbsp;: [ admin, usermanager ]</font></code></div>
<p>You have just given "usermanager" the ability to see and edit stuff in the "Access controls" pages in Manager. 
</p><p><b>Example 2:</b> To enable the role "userview," to access but not edit the pages, only add the role to the read value: 
</p>
<div class="samplecode"><code><font size="2">[manager/accesscontrols]<br>access = read&nbsp;: [ admin, userview, usermanager ], write&nbsp;: [ admin, usermanager ]</font></code></div>
<p>You can also grant access to read the manager pages to EVERY role using the wildcard:
</p>
<div class="samplecode"><code><font size="2">[manager/accesscontrols]<br>access = read&nbsp;: [ * ], write&nbsp;: [ admin ]</font></code></div>
<p><b>Example 3:</b> You want to have a subset of users who can only read sales data that you specify. To accomplish this you can create an app for the dashboard and then create a new role "salesusers."  
</p><p>In the <code><font size="2">local.meta</font></code> file in your app directory (remember that you can create one from the <code><font size="2">default.meta</font></code> file), you then edit the following stanza:
</p>
<div class="samplecode"><code><font size="2"><br>[viewstates]<br>access = read&nbsp;: [ * ], write&nbsp;: [ * ]<br><br>to read:<br><br>[viewstates]<br>access = read&nbsp;: [ salesusers ], write&nbsp;: [ admin ]</font></code></div>

<a name="findexistingusersandroles"></a><h2> <a name="findexistingusersandroles_find_existing_users_and_roles"><span class="mw-headline" id="Find_existing_users_and_roles"> Find existing users and roles</span></a></h2>
<p>First, locate the existing user or role in Splunk Web, click <b>System</b> in the main menu and select <b>Access Controls</b> to go to the Access Controls page. From there you can click on <b>Users</b> or <b>Roles</b> to search for your user and role. Splunk Search supports wildcards. 
</p><p>Splunk searches for the string you enter in all available fields by default. To search a particular field, specify that field. 
</p><p>For example, to search only email addresses, type "email=&lt;<i>email address or address fragment</i>&gt;:, or to search only the "Full name" field, type "realname=&lt;<i>name or name fragment</i>&gt;. To search for users in a given role, use "roles=". 
</p><p><img alt="Search bar.jpg" src="images/8/89/Search_bar.jpg" width="366" height="48"></p>
<a name="deletealluseraccounts"></a><h2> <a name="deletealluseraccounts_delete_all_user_accounts"><span class="mw-headline" id="Delete_all_user_accounts"> Delete all user accounts </span></a></h2>
<p>Remove all the user data (user accounts) from your Splunk installation by typing <code><font size="2">./splunk clean</font></code> followed by the <code><font size="2">userdata</font></code> argument. This deletes all the user accounts other than the default user accounts included with Splunk (admin, power, user). 
</p><p><b>Caution:</b> Removing user data is irreversible; if you accidentally delete user data, you must re-add the accounts manually. 
</p><p><b>To remove all of the user accounts in the system:</b>
</p>
<code><font size="2"><br>./splunk clean userdata<br></font></code>
<p><b>To remove the user accounts in the system and force Splunk to skip the confirmation prompt:</b>
</p>
<code><font size="2"><br>./splunk clean userdata -f<br></font></code>

<a name="securingaccessforsplunkknowledgeobjects"></a><h2> <a name="securingaccessforsplunkknowledgeobjects_secure_access_for_splunk_knowledge_objects"><span class="mw-headline" id="Secure_access_for_Splunk_knowledge_objects"> Secure access for Splunk knowledge objects</span></a></h2>
<p>As you use Splunk, you create a variety of Splunk <b>knowledge objects</b> such as <b>event types</b>, <b>tags</b>, <b>lookups</b>, <b>field extractions</b>, <b>workflow actions</b>, and <b>saved searches</b>. 
Splunk Web lets you restrict and expand access to knowledge objects within your Splunk implementation. You can use it to:
</p>
<ul><li> Make an object available to users of all apps. 
</li><li> Make an object available to users of a particular app.
</li><li> Restrict object access by user role.  
</li><li> Disable or delete objects.
</li><li> Allow users to share or delete objects they do not own. 
</li></ul><p>For more information about securing your knowledge objects, see "Manage knowledge object permissions" and "Disable or delete knowledge objects" in the Knowledge Manager Manual.
</p>
<h1>Set up users with Splunk Enterprise's built in Authentication</h1><a name="setupbuilt-inauthentication"></a><h2> <a name="setupbuilt-inauthentication_set_up_user_authentication_with_splunk_enterprise_native_authentication"><span class="mw-headline" id="Set_up_user_authentication_with_Splunk_Enterprise_native_authentication"> Set up user authentication with Splunk Enterprise native authentication</span></a></h2>
<p>Splunk Enterprise native <b>authentication</b>  allows you to easily set up users within your system. Splunk Enterprise offers three ways to configure users, but native authentication always takes precedence over any external systems. This is the order in which users are authenticated:
</p><p><b>1.</b> Splunk Enterprise native authentication.
</p><p><b>2.</b> Either LDAP or Scripted authentication (if enabled). For more information, see <a href="#setupuserauthenticationwithldap" class="external text">"Set up user authentication with LDAP"</a> and  <a href="#configuresplunktousepamorradiusauthentication" class="external text">"Set up user authentication with external systems."</a>
</p><p><b>Note:</b> LDAP and scripted authentication cannot be used together.
</p><p>You can create new users and assign those users to <b>roles</b> with a role-based access control system in two ways:
</p>
<ul><li> Use Splunk Web to create users and assign roles. For more information see <a href="#configureuserswithsplunkweb" class="external text">"Configure users with Splunk Web."</a>
</li><li> Use the CLI to create users and then assign them to roles with Splunk Web. For more information see <a href="#configureuserswiththecli" class="external text">"Configure users with the CLI."</a>
</li></ul><h3> <a name="setupbuilt-inauthentication_important_naming_guidelines_when_creating_users_and_roles"><span class="mw-headline" id="Important_naming_guidelines_when_creating_users_and_roles"> Important naming guidelines when creating users and roles </span></a></h3>
<p>Usernames stored in native authentication cannot contain spaces, colons, or forward slashes. Names are case-insensitive, for example: "Jacque", "jacque", "JacQue" are all the same to Splunk Enterprise.
</p><p>Role names must use lowercase characters only. They cannot contain spaces, colons, or forward slashes.
</p>
<a name="configureuserswithsplunkweb"></a><h2> <a name="configureuserswithsplunkweb_configure_users_with_splunk_web"><span class="mw-headline" id="Configure_users_with_Splunk_Web"> Configure users with Splunk Web</span></a></h2>
<p>To configure users and roles In Splunk Web:
</p><p><b>1.</b> Navigate to <b>Settings &gt; Users and Authentication &gt; Access controls</b>.
</p><p><b>3.</b> Click <b>Users</b>.
</p><p><b>4.</b> Click <b>New</b> or select an existing user to edit. 
</p><p><b>5.</b> Specify or change the information for the user. You can specify the user's:
</p>
<ul><li> full name.
</li><li> email address.
</li><li> time zone. This allows users to view events and other information in their own time zone.
</li><li> default app. This overrides the default app inherited from the user's role.
</li><li> password.
</li></ul><p><b>6.</b> Assign the user to an existing role or roles and click <b>Save</b>. 
</p><p>You can also create a role specifically for a user, defining exactly what access that user has to Splunk. You can then assign the user to that role. For information about roles, read <a href="#aboutusersandroles" class="external text">"About role-based user access."</a>
</p><p>For information about managing user settings, see the Splunk Enterprise Administration Guide.
</p>
<a name="configureuserswiththecli"></a><h2> <a name="configureuserswiththecli_configure_users_with_the_cli"><span class="mw-headline" id="Configure_users_with_the_CLI"> Configure users with the CLI</span></a></h2>
<p>In the CLI, use the <code><font size="2">add user</font></code> command. Here are some examples:
</p>
<ul><li> To add a new administrator user with the password "changeme2":
</li></ul><div class="samplecode">./splunk add user admin2 -password changeme2 -role admin -auth admin:changeme</div>
<ul><li> To change an existing user's password to "fflanda":
</li></ul><div class="samplecode">./splunk edit user admin -password fflanda -role admin -auth admin:changeme</div>
<p><b>Important:</b> Passwords with special characters that would be interpreted by the shell (for example '$' or '!') must be either escaped or single-quoted. For example:
</p>
<div class="samplecode">./splunk edit user admin -password 'fflanda$' -role admin -auth admin:changeme</div>
<p>or
</p>
<div class="samplecode">./splunk edit user admin -password fflanda\$ -role admin -auth admin:changeme</div>

<a name="mapausertoarolewithsplunkweb"></a><h2> <a name="mapausertoarolewithsplunkweb_add_a_user_to_a_role_with_splunk_web"><span class="mw-headline" id="Add_a_user_to_a_role_with_Splunk_Web"> Add a user to a role with Splunk Web</span></a></h2>
<p>You can add a user to a default role or to a custom role you create yourself.  For more information, see <a href="#aboutusersandroles" class="external text">"About role-based user access."</a>  
</p><p>To add a user or users to a role with Splunk Web:
</p><p><b>1.</b> Click <b>Settings &gt; Access Control &gt; Access Controls</b> in the main menu.
</p><p><b>2.</b> Click <b>Users</b>.
</p><p><b>3.</b> Edit an existing user or create a new one.
</p><p><b>4.</b> Choose which role to map to from the <b>Role</b> list.
Any custom roles you have created in <code><font size="2">authorize.conf</font></code> will be listed here.
</p>
<h1>Set up user authentication with Lightweight Directory Access Protocol</h1><a name="setupuserauthenticationwithldap"></a><h2> <a name="setupuserauthenticationwithldap_set_up_user_authentication_with_ldap"><span class="mw-headline" id="Set_up_user_authentication_with_LDAP"> Set up user authentication with LDAP</span></a></h2>
<p>Splunk supports three types of <b>authentication</b> systems: 
</p>
<ul><li> Splunk's own built-in system, described in <a href="#setupbuilt-inauthentication" class="external text">"Set up user authentication with Splunk's built-in system."</a>
</li><li> LDAP, described in the topic you're now reading.
</li><li> A scripted authentication API for use with an external authentication system, such as PAM or RADIUS, described in <a href="#configuresplunktousepamorradiusauthentication" class="external text">"Set up user authentication with external systems."</a>
</li></ul><h3> <a name="setupuserauthenticationwithldap_about_configuring_ldap_authentication_for_splunk"><span class="mw-headline" id="About_configuring_LDAP_authentication_for_Splunk">About configuring LDAP authentication for Splunk</span></a></h3>
<p>Splunk allows user and role configuration for LDAP users and groups. You can configure one or many LDAP servers and map users and user groups from your servers to roles created in Splunk.
</p><p>For more information about configuring multiple LDAP servers, see <a href="#configuresplunkwithmultipleldapservers" class="external text">"How Splunk works with multiple LDAP servers."</a>
</p><p>Before you configure LDAP, take a look at  <a href="#ldapconfigurationconsiderations" class="external text">"LDAP prerequisites and considerations."</a>
</p>
<h3> <a name="setupuserauthenticationwithldap_how_to_configure_splunk_to_use_ldap"><span class="mw-headline" id="How_to_configure_Splunk_to_use_LDAP"> How to configure Splunk to use LDAP </span></a></h3>
<p>These are the main steps to configure Splunk to work with LDAP:
</p><p><b>1.</b> Configure one or more LDAP strategies (typically, you configure one strategy per LDAP server).
</p><p><b>2.</b> Map your LDAP groups to one or more Splunk roles.
</p><p><b>3.</b> If you have multiple LDAP servers, specify the connection order of their servers.
</p><p>You can perform these steps in Splunk Web or by editing the configuration file. See <a href="#configureldapwithsplunkweb" class="external text">"Configure LDAP with Splunk Web"</a> or <a href="#configureldapwithconfigurationfiles" class="external text">"Configure LDAP with the configuration file"</a> for more information.
</p>
<h3> <a name="setupuserauthenticationwithldap_authentication_precedence"><span class="mw-headline" id="Authentication_precedence">Authentication precedence</span></a></h3>
<p>Splunk's built-in system always takes precedence over any external systems. This is the order in which Splunk authenticates a user:
</p><p><b>1.</b> Splunk built-in authentication
</p><p><b>2.</b> Either LDAP or scripted authentication, if one of these methods is enabled. For more information about scripted authentication see  <a href="#configuresplunktousepamorradiusauthentication" class="external text">"Set up user authentication with external systems."</a>
</p>
<h3> <a name="setupuserauthenticationwithldap_answers"><span class="mw-headline" id="Answers">Answers</span></a></h3>
<p>Have questions? Visit Splunk Answers and see what questions and answers the Splunk community has around LDAP authentication with Splunk.
</p>
<a name="managesplunkuserroleswithldap"></a><h2> <a name="managesplunkuserroleswithldap_manage_splunk_user_roles_with_ldap"><span class="mw-headline" id="Manage_Splunk_user_roles_with_LDAP"> Manage Splunk user roles with LDAP</span></a></h2>
<p>To configure Splunk to use LDAP authentication, first create a Splunk strategy for each LDAP server and then map Splunk roles to that server's groups. When a user attempts to log in, Splunk queries the server(s) to find the user. It grants the user permissions based on any roles associated with the LDAP groups the user is a member of.
</p><p>When it comes to changing a user's permissions, you have several options:
</p>
<ul><li> To change the permissions for a group of users, you can remap the LDAP group to a different Splunk role. You can also update the role itself to specify a different set of permissions for it. You do this on Splunk.
</li><li> To change the permissions for an individual user, you can move the user to an LDAP group mapped to a different Splunk role. You do this on the LDAP server.
</li></ul><p>Here are some other user management activities:
</p>
<ul><li> To add a user to a Splunk role: First, on Splunk Web, make sure that you've mapped the Splunk role to an LDAP group. Then, on your LDAP server, add the user to that LDAP group. 
</li><li> To remove a user from a Splunk role: On your LDAP server, remove the user from the corresponding LDAP group.  
</li></ul><p>A user can have membership in several roles. In that case, Splunk gives the user access to all the capabilities available for any of those roles. For example, if the user is a member of both the docs and eng groups, and docs is mapped to "user" and eng is mapped to "admin", the user obtains all permissions assigned to both the "user" or "admin" roles.
</p><p><b>Note:</b> Splunk automatically checks LDAP membership information when a user attempts to log into Splunk. You do not need to reload the authentication configuration when adding or removing users.
</p>
<a name="ldapconfigurationconsiderations"></a><h2> <a name="ldapconfigurationconsiderations_ldap_prerequisites_and_considerations"><span class="mw-headline" id="LDAP_prerequisites_and_considerations"> LDAP prerequisites and considerations</span></a></h2>
<p>Before configuring LDAP for Splunk, make the preparations described in this topic. 
</p>
<h3> <a name="ldapconfigurationconsiderations_determine_your_user_and_group_base_dn"><span class="mw-headline" id="Determine_your_User_and_Group_Base_DN"> Determine your User and Group Base DN </span></a></h3>
<p>Before you map your LDAP settings in Splunk, figure out your user and group base DN, or distinguished name. The DN is the location in the directory where authentication information is stored. 
</p><p>If group membership information for users is kept in a separate entry, enter a separate DN identifying the subtree in the directory where the group information is stored. Users and groups will be searched recursively on all the subnodes under this DN. If your LDAP tree does not have group entries, you can set the group base DN to the same as the user base DN to treat users as their own group. This requires further configuration, described later.
</p><p>If you are unable to get this information, contact your LDAP Administrator for assistance.
</p><p><b>Note:</b> For best results when integrating Splunk with Active Directory, place your Group Base DN in a separate hierarchy than the User Base DN.
</p>
<h3> <a name="ldapconfigurationconsiderations_additional_considerations"><span class="mw-headline" id="Additional_considerations">Additional considerations </span></a></h3>
<p>When configuring Splunk to work with LDAP, note the following:
</p>
<ul><li> Entries in Splunk Web and <code><font size="2">authentication.conf</font></code> are case sensitive.
</li><li> Any user created locally through <a href="#setupbuilt-inauthentication" class="external text">Splunk native authentication</a> will have precedence over an LDAP user of the same name. For example, if the LDAP server has a user with a username attribute (for instance, cn or uid) of 'admin' and the default Splunk user of the same name is present, the Splunk user will win. Only the local password will be accepted, and upon login the roles mapped to the local user will be in effect. 
</li><li> The number of LDAP groups Splunk Web can display for mapping to roles is limited to the number your LDAP server can return in a query. You can use the <b>Search request size limit</b> and <b>Search request time limit</b> settings to configure this.
<ul><li> To prevent Splunk from listing unnecessary groups, use the <code><font size="2">groupBaseFilter</font></code>.  For example:  <code><font size="2">groupBaseFilter = (|(cn=SplunkAdmins)(cn=SplunkPowerUsers)(cn=Help Desk))</font></code>
</li><li> If you must role map more than the maximum number of groups, you can edit  <code><font size="2">authentication.conf</font></code> directly.  In this example, "roleMap_AD" specifies the name of the Splunk strategy. Each attribute/value pair maps a Splunk role to one or more LDAP groups:
</li></ul></li></ul><code><font size="2"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[roleMap_AD]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;admin = SplunkAdmins1;SplunkAdmins2<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;power = SplunkPowerUsers<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;user = SplunkUsers<br></font></code>

<a name="configuresplunkwithmultipleldapservers"></a><h2> <a name="configuresplunkwithmultipleldapservers_how_splunk_works_with_multiple_ldap_servers"><span class="mw-headline" id="How_Splunk_works_with_multiple_LDAP_servers"> How Splunk works with multiple LDAP servers </span></a></h2>
<p>Splunk can search against multiple LDAP servers when authenticating users. To configure multiple LDAP servers, you set up multiple LDAP "strategies," one for each LDAP server. 
</p><p>Once you create your strategies, you can then specify the order in which you want Splunk to query these strategies when searching for LDAP users. If you do not specify a search order, Splunk assigns a default "connection order" based on the order in which the strategies are created.
</p><p>For more about the steps to configure LDAP strategies, see <a href="#configureldapwithsplunkweb" class="external text">"Configure LDAP with Splunk Web"</a> or <a href="#configureldapwithconfigurationfiles" class="external text">"Configure LDAP with the configuration file"</a> for more information.
</p>
<h3> <a name="configuresplunkwithmultipleldapservers_how_connection_order_works_during_a_search"><span class="mw-headline" id="How_connection_order_works_during_a_search">How connection order works during a search</span></a></h3>
<p>During authentication, Splunk searches based on the strategies you created for your servers in the specified connection order. Once Splunk locates the user on a server, it quits searching and takes those credentials. If the user also has credentials on a server later in the search order, Splunk ignores them.
</p><p>For example, assume you configure and enable three strategies in this order: A, B, C. Splunk will search their servers in that same order: A, B, C. If it finds the user on A, it stops looking. It doesn't matter whether the user also exists on B and C; Splunk will only use A's credentials for that user. If it doesn't find the user on A, then it will continue to search the remaining servers: first B, then C. 
</p><p>If you later disable strategy A, Splunk will search the remaining strategies in the order: B, C.
</p><p>You can change the connection order at any time by editing the strategies' properties in <a href="#configureldapwithsplunkweb" class="external text">Splunk Web</a> or by changing the order of the strategies in the <code><font size="2">authSettings</font></code> attribute, as described in <a href="#editauthenticationconf" class="external text">"authentication.conf"</a>.
</p><p><b>Important:</b> Any user created locally through <a href="#setupbuilt-inauthentication" class="external text">Splunks built-in authentication</a> will have precedence over an LDAP user of the same name. See <a href="#setupuserauthenticationwithsplunk" class="external text">"About user authentication"</a>, for details.
</p>
<a name="configureldapwithsplunkweb"></a><h2> <a name="configureldapwithsplunkweb_configure_ldap_with_splunk_web"><span class="mw-headline" id="Configure_LDAP_with_Splunk_Web"> Configure LDAP with Splunk Web</span></a></h2>
<p>This section describes how to configure LDAP through Splunk Web. If you want to configure LDAP by directly editing <code><font size="2">authentication.conf</font></code>, see <a href="#configureldapwithconfigurationfiles" class="external text">"Configure LDAP with the configuration file"</a>.
</p><p>There are three main steps to configuring LDAP with Splunk Web:
</p><p><b>1.</b> Create an LDAP strategy.
</p><p><b>2.</b> Map LDAP groups to Splunk roles.
</p><p><b>3.</b> Specify the connection order (for multiple LDAP servers only)
</p>
<h3> <a name="configureldapwithsplunkweb_create_an_ldap_strategy"><span class="mw-headline" id="Create_an_LDAP_strategy"> Create an LDAP strategy </span></a></h3>
<p>To create an LDAP strategy:
</p><p><b>1.</b> Click <b>Settings &gt; Users and authentication &gt; Access controls</b>. 
</p><p><b>3.</b> Click <b>Authentication method</b>.
</p><p><b>4.</b> Check <b>LDAP</b>.
</p><p><b>5.</b> Click <b>Configure Splunk to use LDAP and map groups</b>. This takes you to the <b>LDAP strategies</b> page.
</p><p><b>6.</b> Click <b>New</b>. This takes you to the <b>Add new</b> page.
</p><p><b>7.</b> Enter an <b>LDAP strategy name</b> for your configuration. 
</p><p><b>8.</b> Enter the <b>Host</b> name of your LDAP server.  Be sure that your Splunk Server can resolve the host name. <b>Note: At this time, Splunk does not support IPv6 address formats for Windows.</b>
</p><p><b>9.</b> Enter the <b>Port</b> that Splunk should use to connect to your LDAP server.  
</p>
<ul><li> By default LDAP servers listen on TCP port 389.
</li><li> LDAPS (LDAP with SSL) defaults to port 636.
</li></ul><p><b>10.</b> To turn on SSL, check <b>SSL enabled</b>.
</p>
<ul><li> This setting is recommended for security.
</li><li> You must also have SSL enabled on your LDAP server.
</li></ul><p><b>11.</b> Enter the <b>Bind DN</b>.
</p>
<ul><li> This is  the distinguished name used to bind to the LDAP server.
</li><li> This is typically, but not necessarily, the administrator. This user needs to have read access to all LDAP user and group entries you want to retrieve. 
</li><li> Leave blank if anonymous bind is sufficient.
</li></ul><p><b>12.</b> Enter and confirm the <b>Bind DN password</b> for the binding user.
</p><p><b>13.</b> Specify the <b>User base DN</b>. You can specify multiple user base DN entries by separating them with semicolons.
</p>
<ul><li> Splunk uses this attribute to locate user information. 
</li><li> You must set this attribute for authentication to work.
</li></ul><p><b>14.</b> Enter the <b>User base filter</b> for the object class you want to filter your users on.
</p>
<ul><li> This is recommended to return only applicable users. For example: (department=IT).
</li><li> Default value is empty, meaning no user entry filtering.
</li></ul><p><b>15.</b> Enter the <b>User name attribute</b> that contains the user name.
</p>
<ul><li> The username attribute cannot contain white spaces.
</li><li> In Active Directory, this is typically <code><font size="2">sAMAccountName</font></code>, but you can also authenticate on other attributes, like <code><font size="2">cn</font></code>.
</li><li> The value <code><font size="2">uid</font></code> should work for most other configurations.
</li></ul><p><b>16.</b> Enter the <b>Real name attribute</b> (common name) of the user.
</p>
<ul><li> Typical values are <code><font size="2">displayName</font></code> or <code><font size="2">cn</font></code> (common name).
</li></ul><p><b>17.</b> Enter an <b>Email attribute</b>
</p><p><b>18.</b> Enter the <b>Group mapping attribute</b>.
</p>
<ul><li> This is the user attribute that group entries use to define their members.
</li><li> The default is <code><font size="2">dn</font></code> for active directory; set this attribute only if groups are mapped using some other attribute besides user DN.
</li><li> For example, a typical attribute used to map users to groups is <code><font size="2">dn</font></code>.  
</li></ul><p><b>19.</b> Enter the <b>Group base DN</b>. You can specify multiple group base DN entries by separating them with semicolons.
</p>
<ul><li> This is the location of the user groups in LDAP. 
</li><li> If your LDAP environment does not have group entries, you can treat each user as its own group:
<ul><li> Set groupBaseDN to the same value as userBaseDN. This means you will search for groups in the same place as users.
</li><li> Next, set the groupMemberAttribute and groupMappingAttribute to the same attribute as userNameAttribute. This means the entry, when treated as a group, will use the username value as its only member.
</li><li> For clarity, you should probably also set groupNameAttribute to the same value as userNameAttribute.
</li></ul></li></ul><p><b>Note:</b> For best results when integrating Active Directory, place your Group Base DN in a separate hierarchy than the User Base DN.
</p><p><b>20.</b> Enter the <b>Static group search filter</b> for the object class you want to filter your static groups on.
</p>
<ul><li> This is recommended to return only applicable groups. For example: <code><font size="2">(|(objectclass=groupofNames)(objectclass=groupofUniqueNames))</font></code>
</li><li> Default value is empty, meaning no static group entry filtering.
</li></ul><p><b>21.</b> Enter the <b>Group name attribute</b>.
</p>
<ul><li> This is the group entry attribute whose value stores the group name.  
</li><li> This is usually <code><font size="2">cn</font></code>.
</li></ul><p><b>22.</b> Enter the <b>Static member attribute</b>.  
</p>
<ul><li> This is the group attribute whose values are the group's members.
</li><li> This is typically <code><font size="2">member</font></code>, <code><font size="2">uniqueMember</font></code>, or <code><font size="2">memberUid</font></code>.
</li></ul><p><b>22.</b> To expand nested groups, check <b>Nested groups</b>.
</p>
<ul><li> This controls whether Splunk will expand nested groups using the 'memberof' attribute. Only check this if you have nested groups that leverage the 'memberof' attribute to resolve their members. On OpenLDAP, you need to explicitly enable the 'memberof' overlay.
</li></ul><p><b>23.</b> Enter the <b>Dynamic group search filter</b> to retrieve dynamic groups, if any.
</p>
<ul><li> This must match the object class of your dynamic groups definition to ensure that those groups get returned to Splunk. For example: <code><font size="2">(objectclass=groupOfURLs)</font></code>
</li><li> Default value is empty, meaning Splunk will not look for dynamic group entries during authentication and authorization.
</li></ul><p><b>24.</b> Enter the <b>Dynamic member attribute</b>.  
</p>
<ul><li> This is the group attribute that uses the form of an LDAP search URL (such as <code><font size="2">ldap:///o=Acme, c=US??sub?(objectclass=person)</font></code> ) to define its members.
</li><li> This is typically <code><font size="2">memberURL</font></code>.
</li></ul><p><b>25.</b> If you check <b>Advanced settings</b>, there are several additional options you can set:
</p>
<ul><li> <b>Enable referrals with anonymous bind only</b>. 
<ul><li> This setting is on by default. Turn this off if you have no need for referrals.
</li><li> Splunk can chase referrals with anonymous bind only. You must also have anonymous search enabled on your LDAP server. 
</li><li> If you are seeing long LDAP search timeouts (likely in Active Directory) and "Operations error" in <code><font size="2">splunkd.log</font></code> for ScopedLDAPConnection, the issues might be related to referrals. 
</li></ul></li><li> <b>Search request size limit</b>
<ul><li> To avoid performance-related issues, you can set the search request size limit. Splunk will then request that the LDAP server return the specified maximum number of entries in response to a search request. In a large deployment with millions of users, setting this limit to a high value could result in a long response, depending on the search filter set in the LDAP strategy configuration. If this limit is reached, <code><font size="2">splunkd.log</font></code> should contain a <code><font size="2">size limit exceeded</font></code> message.
</li><li> You should set the <b>search request time limit</b> and <b>search request size limit</b> values in conjunction with the <code><font size="2">splunkweb</font></code> timeout property, described in "Configure user session timeouts". If you have a group that is not showing up in the Splunk console, it was likely excluded due to one of these limits. Tune these properties as needed.
</li><li> To set the request size limit higher than 1000, you must also edit <code><font size="2">max_users_to_precache</font></code> in <code><font size="2">limits.conf</font></code> to accomodate the number of users you set for your request size limit.
</li></ul></li><li> <b>Search request time limit</b>
<ul><li> To avoid performance-related issues, you can set the search request time limit. Splunk will then request that the LDAP server complete its search within the specified number of seconds. In a large deployment with millions of users, setting this limit to a high value could cause Splunk Web to timeout. If this limit is reached, <code><font size="2">splunkd.log</font></code> should contain a <code><font size="2">time limit exceeded</font></code> message.
</li><li> You should set the <b>search request time limit</b> and <b>search request size limit</b> values in conjunction with the <code><font size="2">splunkweb</font></code> timeout property, described in "Configure user session timeouts". If you have a group that is not showing up in the Splunk console, it was likely excluded due to one of these limits. Tune these properties as needed.
</li></ul></li><li> <b>Network socket timeout</b>
<ul><li> This property is used to break the loop in the authentication chain when one of the LDAP servers in a multiple strategy configuration is unreachable due to network congestion or otherwise takes too long to respond. After waiting the specified number of seconds, the authentication process will continue with the next available strategy, if any.
</li><li> When an LDAP strategy is first created, Splunk validates the LDAP server/port and other parameters. If the LDAP server is down or one of the parameters cannot be validated at that time, the LDAP strategy does not get created.
</li></ul></li></ul><p><b>26.</b> Click <b>Save</b>.
</p>
<h3> <a name="configureldapwithsplunkweb_map_your_new_ldap_groups_to_splunk_roles"><span class="mw-headline" id="Map_your_new_LDAP_groups_to_Splunk_roles"> Map your new LDAP groups to Splunk roles </span></a></h3>
<p>Once you have configured Splunk to authenticate via your LDAP server, map your LDAP groups to <a href="#addandeditroles" class="external text">Splunk roles</a>. If you do not use groups, you can map users individually. 
</p><p><b>Note:</b> You can map either users or groups, but not both. If you are using groups, all users you want to access Splunk must be members of an appropriate group.  Groups inherit capabilities from the highest level role they're a member of.
</p><p>All users are visible in the <b>Users</b> page in Splunk Manager.  To assign roles to groups in Splunk Web:
</p><p><b>1.</b> From the main menu, select <b>System &gt; Users and Authentication &gt; Access Controls</b>.
</p><p><b>2.</b> In the <b>Access Controls</b> page, click <b>Authentication method</b>.
</p><p><b>3.</b> Select the <b>LDAP</b> radio button then click <b>Configure Splunk to use LDAP and map groups</b>. This takes you to the <b>LDAP strategies</b> page.
</p><p><b>4.</b> Click <b>Map groups</b> in the Actions column for a specific strategy. This takes you to the <b>LDAP Groups</b> page. You can use the search field in the upper right corner of the page to qualify the list of groups; for example, to search for groups containing specific users.
</p><p><b>5.</b> Click on a group name. This takes you the mapping page, which includes a list of available roles and a list of LDAP users for that group. 
</p><p><b>6.</b> To map a role to a group, click the arrow to the left of a role in the "Available Roles" list. This moves the group into the "Selected Roles" list. You can map multiple roles to the group.
</p><p><b>7.</b> Click <b>Save</b>. This takes you back to the <b>LDAP Groups</b> page.
</p><p><b>8.</b> Repeat the process for each group that you want to assign Splunk roles to.
</p>
<h3> <a name="configureldapwithsplunkweb_specify_the_server_connection_order"><span class="mw-headline" id="Specify_the_server_connection_order">Specify the server connection order</span></a></h3>
<p>If you have enabled multiple LDAP strategies, you can specify the order in which Splunk searches their servers to find a user, as described in <a href="#configuresplunkwithmultipleldapservers" class="external text">"How Splunk works with multiple LDAP servers"</a>. 
</p><p>By default, Splunk searches the servers in the order in which they were enabled. To change the connection (search) order, you need to edit the properties for each strategy individually:
</p><p><b>1.</b> From the main menu, select <b>System &gt; Users and Authentication &gt; Access Controls</b>.
</p><p><b>2.</b> Click <b>Authentication method</b>.
</p><p><b>3.</b> Select the <b>LDAP</b> radio button.
</p><p><b>4.</b> Click <b>Configure Splunk to use LDAP and map groups</b>. This takes you to the <b>LDAP strategies</b> page.
</p><p><b>5.</b> Click on the strategy whose connection order you want to specify. This takes you to the properties page for that strategy.
</p><p><b>6.</b> Edit the <b>Connection order</b> field near the top of the page. This field appears only if multiple strategies are enabled.
</p><p><b>Note:</b> The <b>Connection order</b> field does not appear when you initially create the strategy. It only appears when you later edit its properties. Also, the field will be grayed out if the strategy has been disabled.
</p><p><b>7.</b> Click <b>Save</b>.
</p><p><b>8.</b> Repeat the process for any other enabled strategy whose connection order you want to change.
</p>
<a name="mapldapgroupstosplunkroles"></a><h2> <a name="mapldapgroupstosplunkroles_map_ldap_groups_to_splunk_roles_in_splunk_web"><span class="mw-headline" id="Map_LDAP_groups_to_Splunk_roles_in_Splunk_Web"> Map LDAP groups to Splunk roles in Splunk Web</span></a></h2>
<p>If you have configured Splunk to authenticate via your LDAP server, you can map your LDAP groups to <a href="#addandeditroles" class="external text">Splunk roles</a>. If you do not use groups, you can also map LDAP users individually. 
</p><p>For information about setting up LDAP groups in Splunk Web, see <a href="#configureldapwithsplunkweb" class="external text">"Configure LDAP with Splunk Web"</a> in this manual.
</p><p><b>Note:</b> You can map either users or groups, but not both. If you are using groups, all users you want to access Splunk must be members of an appropriate group.  Groups inherit capabilities from the highest level role they're a member of.
</p><p>All users are visible in the <b>Users</b> page in Splunk Manager.  To assign roles to groups in Splunk Web:
</p><p><b>1.</b> Click <b>Settings</b> in Splunk Web.
</p><p><b>2.</b> In the <b>Users and authentication</b> section, click <b>Access controls</b>. 
</p><p><b>3.</b> Click <b>Authentication method</b>.
</p><p><b>4.</b> Select the <b>LDAP</b> radio button.
</p><p><b>5.</b> Click <b>Configure Splunk to use LDAP and map groups</b>. This takes you to the <b>LDAP strategies</b> page.
</p><p><b>6.</b> Click <b>Map groups</b> in the Actions column for a specific strategy. This takes you to the <b>LDAP Groups</b> page. You can use the search field in the upper right corner of the page to qualify the list of groups; for example, to search for groups containing specific users.
</p><p><b>7.</b> Click on a group name. This takes you the mapping page, which includes a list of available roles and a list of LDAP users for that group. 
</p><p><b>8.</b> To map a role to a group, click the arrow to the left of a role in the "Available Roles" list. This moves the group into the "Selected Roles" list. You can map multiple roles to the group.
</p><p><b>9.</b> Click <b>Save</b>. This takes you back to the <b>LDAP Groups</b> page.
</p><p><b>10.</b> Repeat the process for each group that you want to assign Splunk roles to.
</p>
<a name="configureldapwithconfigurationfiles"></a><h2> <a name="configureldapwithconfigurationfiles_configure_ldap_with_the_configuration_file"><span class="mw-headline" id="Configure_LDAP_with_the_configuration_file"> Configure LDAP with the configuration file</span></a></h2>
<p>As an alternative to using Splunk Web to configure LDAP, you can directly edit the authentication.conf file. 
</p><p>This example steps you through the process of setting up <code><font size="2">authentication.conf</font></code>. If you prefer to configure LDAP with Splunk Web, see <a href="#configureldapwithsplunkweb" class="external text">"Configure LDAP with Splunk Web"</a>.
</p><p><b>Note:</b> If you configure LDAP authentication and decide later to return to using the default Splunk authentication, the simplest way is to move the existing <code><font size="2">authentication.conf</font></code> file out of the way (for example, by renaming it to <code><font size="2">authentication.conf.disabled</font></code>) and restart Splunk.  
</p><p>You can see some more examples at the end of the authentication.conf spec file.
</p><p>Edit <code><font size="2">authentication.conf</font></code> in <code><font size="2">$SPLUNK_HOME/etc/system/local/</font></code>.  For information on configuration files in general, see "About configuration files" In the Administration Manual.
</p>
<h3> <a name="configureldapwithconfigurationfiles_set_authentication_type_and_strategy_name.28s.29"><span class="mw-headline" id="Set_authentication_type_and_strategy_name.28s.29"> Set authentication type and strategy name(s) </span></a></h3>
<p>By default, Splunk uses its own authentication type.  Change the type to LDAP in the <code><font size="2">[authentication]</font></code> stanza:
</p>
<div class="samplecode">
<p>[authentication]<br>
authType = LDAP<br>
authSettings = ldaphost1,ldaphost2<br></p>
</div>
<p>Note the following:
</p>
<ul><li> Turn on LDAP by setting <code><font size="2">authType = LDAP</font></code>.
</li><li> The <code><font size="2">authSettings</font></code> attribute identifies one or more LDAP strategies. Each strategy has its own stanza, as described below.
</li></ul><h3> <a name="configureldapwithconfigurationfiles_configure_ldap_strategy_stanzas"><span class="mw-headline" id="Configure_LDAP_strategy_stanzas"> Configure LDAP strategy stanzas </span></a></h3>
<p>Each LDAP strategy needs its own stanza.  Map the LDAP values to attribute/value pairs in the strategy's stanza. 
</p><p><b>Note:</b> At this time, Splunk does not support IPv6 address formats for Windows.
</p><p>Here's an example stanza for the "ldaphost1" strategy, specified earlier in the <code><font size="2">authSettings</font></code> attribute:
</p>
<div class="samplecode"><code><font size="2"><br>[ldaphost1]<br>host = ldaphost1.domain.com<br>port = 389<br>SSLEnabled = 0<br>bindDN = cn=bind_user<br>bindDNpassword = bind_user_password<br>groupBaseDN = ou=Groups,dc=splunk,dc=com<br>groupBaseFilter = (objectclass=*)<br>groupMappingAttribute = dn<br>groupMemberAttribute = uniqueMember<br>groupNameAttribute = cn<br>realNameAttribute = displayName<br>userBaseDN = ou=People,dc=splunk,dc=com<br>userBaseFilter = (objectclass=*)<br>userNameAttribute = uid<br></font></code></div>
<p><b>Note:</b> For best results when integrating Active Directory, place your Group Base DN in a separate hierarchy than the User Base DN.
</p>
<h3> <a name="configureldapwithconfigurationfiles_configure_multiple_ldap_strategies"><span class="mw-headline" id="Configure_multiple_LDAP_strategies">Configure multiple LDAP strategies</span></a></h3>
<p>Splunk can search across multiple LDAP servers, as described in <a href="#configuresplunkwithmultipleldapservers" class="external text">"How Splunk works with multiple LDAP servers"</a>. To configure this, set the <code><font size="2">authSettings</font></code> attribute to a comma-separated list of all strategies, in the order in which you want Splunk to query them. Then, specify separate stanzas for each strategy.
</p>
<h3> <a name="configureldapwithconfigurationfiles_map_groups_to_roles"><span class="mw-headline" id="Map_groups_to_roles"> Map groups to roles </span></a></h3>
<p>To map Splunk roles to a strategy's LDAP groups, you need to set up a <code><font size="2">roleMap</font></code> stanza for that strategy. Each strategy requires its own <code><font size="2">roleMap</font></code> stanza. This example maps roles for groups in the "ldaphost1" strategy:
</p>
<div class="samplecode"><code><font size="2"><br>[roleMap_ldaphost1]<br>admin = SplunkAdmins<br>itusers = ITAdmins<br></font></code></div>
<h3> <a name="configureldapwithconfigurationfiles_map_users_directly_to_roles"><span class="mw-headline" id="Map_users_directly_to_roles"> Map users directly to roles </span></a></h3>
<p>If you need to map users directly to Splunk roles, you can do so by setting the <code><font size="2">groupBaseDN</font></code> to the value of <code><font size="2">userBaseDN</font></code>.  Also, set the attributes for <code><font size="2">groupMappingAttribute</font></code>, <code><font size="2">groupMemberAttribute</font></code>, and <code><font size="2">groupNameAttribute</font></code> to the same attribute as <code><font size="2">userNameAttribute</font></code>. For example:
</p>
<div class="samplecode"><code><font size="2"><br>[supportLDAP]<br>SSLEnabled = 0<br>bindDN = cn=Directory Manager<br>bindDNpassword = #########<br>groupBaseDN = ou=People,dc=splunksupport,dc=com<br>groupBaseFilter = (objectclass=*)<br>groupMappingAttribute = uid<br>groupMemberAttribute = uid<br>groupNameAttribute = uid<br>host = supportldap.splunksupport.com<br>port = 389<br>realNameAttribute = cn<br>userBaseDN = ou=People,dc=splunksupport,dc=com<br>userBaseFilter = (objectclass=*)<br>userNameAttribute = uid<br><br>[roleMap_supportLDAP]<br>admin = rlee;bsmith<br></font></code></div>

<a name="mapldapgroupsanduserstosplunkroles"></a><h2> <a name="mapldapgroupsanduserstosplunkroles_map_ldap_groups_and_users_to_splunk_roles_in_the_configuration_files"><span class="mw-headline" id="Map_LDAP_groups_and_users_to_Splunk_roles_in_the_configuration_files"> Map LDAP groups and users to Splunk roles in the configuration files</span></a></h2>
<p>Once you've set up LDAP authentication and users, you can map your LDAP groups and users to roles in Splunk Web. To set up LDAP for Splunk see <a href="#configureldapwithconfigurationfiles" class="external text">"Configure LDAP with the configuration file"</a> in this manual.
</p>
<h3> <a name="mapldapgroupsanduserstosplunkroles_map_groups_to_roles"><span class="mw-headline" id="Map_groups_to_roles"> Map groups to roles </span></a></h3>
<p>To map Splunk roles to a strategy's LDAP groups, you need to set up a <code><font size="2">roleMap</font></code> stanza for that strategy. Each strategy requires its own <code><font size="2">roleMap</font></code> stanza. This example maps roles for groups in the "ldaphost1" strategy:
</p>
<div class="samplecode"><code><font size="2"><br>[roleMap_ldaphost1]<br>admin = SplunkAdmins<br>itusers = ITAdmins<br></font></code></div>
<h3> <a name="mapldapgroupsanduserstosplunkroles_map_users_directly_to_roles"><span class="mw-headline" id="Map_users_directly_to_roles"> Map users directly to roles </span></a></h3>
<p>If you need to map users directly to Splunk roles, you can do so by setting the <code><font size="2">groupBaseDN</font></code> to the value of <code><font size="2">userBaseDN</font></code>.  Also, set the attributes for <code><font size="2">groupMappingAttribute</font></code>, <code><font size="2">groupMemberAttribute</font></code>, and <code><font size="2">groupNameAttribute</font></code> to the same attribute as <code><font size="2">userNameAttribute</font></code>. For example:
</p>
<div class="samplecode"><code><font size="2"><br>[supportLDAP]<br>SSLEnabled = 0<br>bindDN = cn=Directory Manager<br>bindDNpassword = #########<br>groupBaseDN = ou=People,dc=splunksupport,dc=com<br>groupBaseFilter = (objectclass=*)<br>groupMappingAttribute = uid<br>groupMemberAttribute = uid<br>groupNameAttribute = uid<br>host = supportldap.splunksupport.com<br>port = 389<br>realNameAttribute = cn<br>userBaseDN = ou=People,dc=splunksupport,dc=com<br>userBaseFilter = (objectclass=*)<br>userNameAttribute = uid<br><br>[roleMap_supportLDAP]<br>admin = rlee;bsmith<br></font></code></div>

<a name="testyourldapconfiguration"></a><h2> <a name="testyourldapconfiguration_test_your_ldap_configuration"><span class="mw-headline" id="Test_your_LDAP_configuration"> Test your LDAP configuration</span></a></h2>
<p>If you find that Splunk is not able to connect to your LDAP server, try these troubleshooting steps:
</p><p><b>1.</b> Check <code><font size="2">$SPLUNK_HOME/var/log/splunk/splunkd.log</font></code> for any authentication errors.
</p><p><b>2.</b> Remove any custom values you've added for <b>userBaseFilter</b> and <b>groupBaseFilter</b>.
</p><p><b>3.</b> Use <code><font size="2">ldapsearch</font></code> to confirm that the variables you are specifying will return the expected entries:
</p>
<div class="samplecode">
<p>ldapsearch  -x &acirc;&#128;&#147;h &lt;ldap_host&gt; &acirc;&#128;&#147;p &lt;ldap_port&gt; &acirc;&#128;&#147;D "bind_dn" -w "bind_passwd" -b "user_basedn"  "userNameAttribute=*"
</p><p>ldapsearch -x &acirc;&#128;&#147;h &lt;ldap_host&gt; &acirc;&#128;&#147;p &lt;ldap_port&gt; &acirc;&#128;&#147;D "bind_dn" -w "bind_passwd" &acirc;&#128;&#147;b "group_basedn"  "groupNameAttribute=*"
</p>
</div>
<p>If these commands return matching entries, then your backend LDAP system is properly configured. Continue to troubleshoot the Splunk LDAP strategy configuration.
</p>
<a name="usernameprecedence"></a><h2> <a name="usernameprecedence_convert_to_ldap_from_splunk.27s_built_in_authentication"><span class="mw-headline" id="Convert_to_LDAP_from_Splunk.27s_built_in_authentication">Convert to LDAP from Splunk's built in authentication</span></a></h2>
<p>If you move from built-in authentication to LDAP, it's important to note that the accounts created in Splunk are not automatically disabled and take precedence over LDAP accounts. 
</p><p>If you have converted from Splunk's built-in authentication system to LDAP, you might need to delete users from Splunk's built-in system to ensure that you're using LDAP credentials. This is only necessary if usernames are the same in both systems.
</p>
<h3> <a name="usernameprecedence_secure_local_splunk_accounts"><span class="mw-headline" id="Secure_local_Splunk_accounts"> Secure local Splunk accounts</span></a></h3>
<p>If you have configured Splunk to use LDAP authentication, it's important to be aware that all local accounts using Splunk built-in authentication are still present and active. This includes the "admin" account. You need to consider the security implications of this.
</p><p>To remove all the current local accounts when enabling LDAP authentication:
</p>
<ul><li> Move the <code><font size="2">$SPLUNK_HOME/etc/passwd</font></code> file to <code><font size="2">passwd.bak</font></code>.
</li><li> Create a blank <code><font size="2">$SPLUNK_HOME/etc/passwd</font></code> file.
</li><li> Restart Splunk.
</li></ul><p>Keep in mind that local Splunk accounts can still be created when Splunk is in LDAP authentication mode. Also, any local Splunk accounts that must remain for backup or disaster-recovery purposes should use a very strong password.
</p><p>When using LDAP, make sure that your LDAP implementation enforces:
</p>
<ul><li> Strong password requirements for length and complexity.
</li><li> A low incorrect attempt threshold for password lockout.
</li></ul><h3> <a name="usernameprecedence_saved_searches"><span class="mw-headline" id="Saved_searches"> Saved searches</span></a></h3>
<p>If your LDAP usernames are the same as the names you previously used in the built-in system (but then deleted), saved searches should work without any conversion.
</p><p>If you have existing saved searches created when your system was using Splunk's built-in authentication and you'd like to transfer them to an LDAP user of a different name, edit the metadata:
</p><p><b>1.</b> Modify <code><font size="2">$SPLUNK_HOME/etc/apps/&lt;app_name&gt;/metadata/local.meta</font></code> and swap the <code><font size="2">owner = &lt;username&gt;</font></code> field under each <code><font size="2">savedsearch</font></code> permission stanza to the corresponding LDAP username and save your changes.
</p><p><b>2.</b> Restart Splunk for your changes to take effect.
</p>
<a name="bestpracticeforremovinganldapuser"></a><h2> <a name="bestpracticeforremovinganldapuser_best_practice_for_removing_an_ldap_user"><span class="mw-headline" id="Best_practice_for_removing_an_LDAP_user"> Best practice for removing an LDAP user</span></a></h2>
<p>If you remove a user from your LDAP directory, Splunk does not automatically remove it from the Splunk native authentication directory. Usually this is not an issue, but if the user has global permissions of any sort, LDAP may generates errors. 
</p><p>To more information about working with LDAP users in Splunk, see <a href="#setupuserauthenticationwithldap" class="external text">"Set up user authentication with LDAP"</a> in this maual.
</p><p>Take the following steps to safely remove a user name from Splunk's directory:
</p><p><b>1.</b> First, back up the <code><font size="2">$HOME/splunk/etc/users/$userid</font></code> folder.
</p><p><b>2.</b> Search the files under <code><font size="2">$HOME/splunk/etc/apps/</font></code> for the user id string to see if the user owns any searches or objects with global permissions.
</p><p><b>3.</b> For any searches or objects that the user owns,  change the owner. You change it an admin user or maintenance account, or whatever you prefer.
</p><p><b>4.</b> Check <code><font size="2">splunkd.log</font></code> on the search head to make sure there are no further LDAP authentication errors.
</p><p><b>5.</b> Once you have redirected any object ownership, you can safely remove the <code><font size="2">$HOME/splunk/etc/users/$userid</font></code> folder.
</p>
<h1>Set up user authentication with external systems</h1><a name="configuresplunktousepamorradiusauthentication"></a><h2> <a name="configuresplunktousepamorradiusauthentication_set_up_user_authentication_with_external_systems"><span class="mw-headline" id="Set_up_user_authentication_with_external_systems">Set up user authentication with external systems</span></a></h2>
<p>Splunk ships with support for three types of authentication systems: 
</p>
<ul><li> Splunk's own built-in system, described in <a href="#setupbuilt-inauthentication" class="external text">"Set up user authentication with Splunk's built-in system."</a>
</li><li> LDAP, described in <a href="#setupuserauthenticationwithldap" class="external text">"Set up user authentication with LDAP."</a>
</li><li> A scripted authentication API for use with an external authentication system, such as PAM or RADIUS, described in this section.
</li></ul><p><b>Important:</b> Splunk's built-in system always takes precedence over any external systems. This is the order in which Splunk authenticates a user:
</p><p><b>1.</b> Splunk built-in authentication
<b>2.</b> LDAP or scripted authentication (if enabled). For more information about LDAP, see <a href="#setupuserauthenticationwithldap" class="external text">"Set up user authentication with LDAP"</a>.
</p>
<h3> <a name="configuresplunktousepamorradiusauthentication_how_scripted_authentication_works"><span class="mw-headline" id="How_scripted_authentication_works"> How scripted authentication works </span></a></h3>
<p>In scripted authentication, a user-generated Python script serves as the middleman between the Splunk server and an external authentication system such as PAM or RADIUS. 
</p><p>The API consists of a few functions that handle communications between Splunk and the authentication system. You need to create a script with handlers that implement those functions.
</p><p>To use your authentication system with Splunk, make sure the authentication system is running and then do the following:
</p><p><b>1.</b> Create a Python authentication script. See <a href="#createtheauthenticationscript" class="external text">"Create the authentication script"</a> for the procedure.
</p><p><b>2.</b> Enable your script by editing authentication.conf to specify scripted authentication and associated settings. See <a href="#editauthenticationconf" class="external text">"Edit authentication.conf"</a> for the procedure.
</p>
<h3> <a name="configuresplunktousepamorradiusauthentication_examples"><span class="mw-headline" id="Examples"> Examples </span></a></h3>
<p>Splunk provides several example authentication scripts and associated configuration files, including one set for RADIUS and another for PAM. There is also a simple script called <code><font size="2">dumbScripted.py</font></code>, which focuses on the interaction between the script and Splunk. 
</p><p>You can use an example script and configuration file as the starting point for creating your own script. You must modify them for your environment.
</p><p>You can find these examples in <code><font size="2">$SPLUNK_HOME/share/splunk/authScriptSamples/</font></code>. That directory also contains a README file with information on the examples, as well as additional information on setting up the connection between Splunk and external systems. 
</p><p><b>Important:</b> Splunk does not provide support for these scripts, nor does it guarantee that they will fully meet your authentication and security needs. They are meant to serve as examples that you can modify or extend as needed.
</p>
<a name="createtheauthenticationscript"></a><h2> <a name="createtheauthenticationscript_create_the_authentication_script"><span class="mw-headline" id="Create_the_authentication_script"> Create the authentication script</span></a></h2>
<p>To use your authentication system with Splunk, make sure the authentication system is running and then do the following:
</p><p><b>1.</b> Create a Python authentication script. See <a href="#createtheauthenticationscript_create_a_python_script" class="external text">"Create a Python script"</a> in this topic for the procedure.
</p><p><b>2.</b> Test the new script. See <a href="#createtheauthenticationscript_test_the_script" class="external text">"Test the script"</a> in this topic for the procedure.
</p><p><b>3.</b> Enable your script by editing authentication.conf to specify scripted authentication and associated settings. See <a href="#editauthenticationconf" class="external text">"Edit authentication.conf"</a> for the procedure.
</p>
<h3> <a name="createtheauthenticationscript_create_a_python_script"><span class="mw-headline" id="Create_a_Python_script">Create a Python script</span></a></h3>
<p>You must create a Python script that implements these authentication functions:
</p>
<ul><li> userLogin
</li><li> getUserInfo
</li><li> getUsers
</li></ul><p>The Splunk server will call these functions as necessary, either to authenticate user login or to obtain information on a user's roles.
</p><p>The script can optionally also include a handler for this function:
</p>
<ul><li> getSearchFilter
</li></ul><p>This table summarizes the authentication functions, their arguments, and their return values:
</p>
<table cellpadding="5" cellspacing="0" border="1" width="100%"><tr><th bgcolor="#C0C0C0">Function
</th><th bgcolor="#C0C0C0">Description
</th><th bgcolor="#C0C0C0">Argument string
</th><th bgcolor="#C0C0C0">Return value string
</th></tr><tr><td valign="center" align="left"><code><font size="2">userLogin</font></code>
</td><td valign="center" align="left">Login with user credentials.
</td><td valign="center" align="left"><code><font size="2">--username=&lt;username&gt;</font></code><br><p><code><font size="2">--password=&lt;password&gt;</font></code><br></p><p>(values passed one per line over <code><font size="2">stdin</font></code>)
</p>
</td><td valign="center" align="left">fail
<p>(safely passed over <code><font size="2">stdout</font></code>)
</p>
</td></tr><tr><td valign="center" align="left"><code><font size="2">getUserInfo</font></code>
</td><td valign="center" align="left">Return a user's information, including name and role(s).
</td><td valign="center" align="left"><code><font size="2">--username=&lt;username&gt;</font></code>
</td><td valign="center" align="left"><code><font size="2">--status=success|fail <br>--userInfo=&lt;userId&gt;;&lt;username&gt;;&lt;realname&gt;;&lt;roles&gt; </font></code>
<p>Note the following: 
</p>
<ul><li> <code><font size="2">userInfo</font></code> must specify a semicolon-delimited list. 
</li><li> <code><font size="2">&lt;userId&gt;</font></code> is deprecated; you should return just the associated semicolon. 
</li><li> <code><font size="2">&lt;username&gt;</font></code> is required.
</li><li> <code><font size="2">&lt;realname&gt;</font></code> is optional, but its semicolon is required.
</li><li> <code><font size="2">&lt;roles&gt;</font></code> is required. To return multiple roles, use colons to separate the roles.<br>   For example: <code><font size="2">admin:power</font></code>
</li><li> This example returns just the roles for a user named "docsplunk": 
</li></ul><code><font size="2"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<code><font size="2">--status=success --userInfo=;docsplunk;;admin:power</font></code><br></font></code>
</td></tr><tr><td valign="center" align="left"><code><font size="2">getUsers</font></code>
</td><td valign="center" align="left">Return information for all Splunk users.
</td><td valign="center" align="left">none
</td><td valign="center" align="left"><code><font size="2">--status=success|fail <br>--userInfo=&lt;userId&gt;;&lt;username&gt;;&lt;realname&gt;;&lt;roles&gt; <br>--userInfo=&lt;userId&gt;;&lt;username&gt;;&lt;realname&gt;;&lt;roles&gt; <br>--userInfo=&lt;userId&gt;;&lt;username&gt;;&lt;realname&gt;;&lt;roles&gt; ... </font></code>
<p>Note the following: 
</p>
<ul><li> See <code><font size="2">getUserInfo</font></code> for information on the syntax to use to return each user's information.
</li><li> Separate each user's information with a space.
</li><li> <code><font size="2">&lt;roles&gt;</font></code> is required. To return multiple roles, use colons to separate the roles.<br>   For example: <code><font size="2">admin:power</font></code> 
</li></ul></td></tr><tr><td valign="center" align="left"><code><font size="2">getSearchFilter</font></code>
</td><td valign="center" align="left">Optional. Returns the filters applied specifically to this user, along with those applied to the user's roles. The filters are OR'd together.
</td><td valign="center" align="left"><code><font size="2">--username=&lt;username&gt;</font></code>
</td><td valign="center" align="left"><code><font size="2">--status=success|fail --search_filter=&lt;filter&gt; <br>--search_filter=&lt;filter&gt; ... </font></code>
<p><b>Note:</b> User-based search filters are optional and not recommended. A better approach is to assign search filters to roles and then assign users to the appropriate roles.
</p><p>For more information, see <a href="#usethegetsearchfilterfunction" class="external text">"Use the getSearchFilter function to filter at search time"</a>
</p>
</td></tr></table><p>See the example scripts for detailed information on how to implement these functions.
</p>
<h3> <a name="createtheauthenticationscript_test_the_script"><span class="mw-headline" id="Test_the_script">Test the script</span></a></h3>
<p>Since the communication between Splunk and the script occurs via <code><font size="2">stdin</font></code> and <code><font size="2">stdout</font></code>, you can test the script interactively in your command shell, without needing to call it from Splunk. Be sure to send one argument per line and end each function call with an EOF (Ctrl-D).
</p><p>Test each function individually, using this pattern:
</p>
<div class="samplecode"><code><font size="2"><br>&gt; python [script] [function name]<br>[pass arguments here, one per line]<br>[send eof, with Ctrl-D]<br>[output appears here, check that it's correct]<br>&gt;<br></font></code></div>
<p>The following example shows a debugging session that does some simple testing of a fictional script called "example.py", with two users "alice" and "bob". "alice" is a member of the "admin" and "super" roles, and "bob" is a member of the "user" role.
</p>
<div class="samplecode"><code><font size="2"><br>&gt; python example.py userLogin<br>--username=alice<br>--password=correctpassword<br>&lt;send an EOF&gt;<br>--status=success<br>&gt; python example.py userLogin<br>--username=bob<br>--password=wrongpassword<br>&lt;send an EOF&gt;<br>--status=fail<br>&gt; python example.py getUsers<br>&lt;no arguments for this function, send an EOF&gt; <br>--status=success --userInfo=bob;bob;bob;user --userInfo=alice;alice;alice;admin:super<br>&gt; python example.py getUserInfo<br>--username=bob<br>&lt;send an EOF&gt;<br>--status=success --userInfo=bob;bob;bob;user<br>&gt; python example.py getUserInfo<br>--username=userdoesnotexist<br>&lt;send an EOF&gt;<br>--status=fail<br>&gt;<br></font></code></div>
<p><b>Important:</b> This is just an example of how to go about testing a script. It does not attempt to perform exhaustive debugging of any real script.
</p>
<a name="editauthenticationconf"></a><h2> <a name="editauthenticationconf_edit_authentication.conf"><span class="mw-headline" id="Edit_authentication.conf"> Edit authentication.conf</span></a></h2>
<p>To use your authentication system with Splunk, make sure the authentication system is running and then do the following:
</p><p><b>1.</b> Create and test a Python authentication script. See <a href="#createtheauthenticationscript" class="external text">"Create the authentication script"</a> for the procedure.
</p><p><b>2.</b> Edit authentication.conf to enable your authentication script. See <a href="#editauthenticationconf_enable_your_script" class="external text">"Enable your script"</a> in this topic.
</p><p><b>3.</b> Edit authentication.conf to set your cache duration. See <a href="#editauthenticationconf_set_cache_durations" class="external text">"Set cache durations"</a> in this topic.
</p>
<h3> <a name="editauthenticationconf_enable_your_script"><span class="mw-headline" id="Enable_your_script">Enable your script</span></a></h3>
<p>Once you create a Python script to implement authentication, you update the <code><font size="2">authentication.conf</font></code> in <code><font size="2">$SPLUNK_HOME/etc/system/local/</font></code> to enable your script. You can also copy and edit a sample <code><font size="2">authentication.conf</font></code> from <code><font size="2">$SPLUNK_HOME/share/splunk/authScriptSamples/</font></code>.
</p><p>Specify <code><font size="2">Scripted</font></code> as your authentication type under the <code><font size="2">[authentication]</font></code> stanza heading:
</p>
<div class="samplecode"><code><font size="2"><br>[authentication]<br>authType = Scripted<br>authSettings = script<br></font></code></div>
<p>Set script variables under the <code><font size="2">[script]</font></code> stanza heading. For example:
</p>
<div class="samplecode"><code><font size="2"><br>[script]<br>scriptPath = $SPLUNK_HOME/bin/python $SPLUNK_HOME/bin/&lt;scriptname.py&gt;<br></font></code></div>
<h3> <a name="editauthenticationconf_set_cache_durations"><span class="mw-headline" id="Set_cache_durations"> Set cache durations </span></a></h3>
<p>To significantly speed authentication performance when using scripted authentication, make use of Splunk's authentication caching capability. You do so by adding the optional <code><font size="2">[cacheTiming]</font></code> stanza. Each script function (except <code><font size="2">getSearchFilter</font></code>) has a settable <code><font size="2">cacheTiming</font></code> attribute, which turns on caching for that function and specifies its cache duration. For example, to specify the cache timing for the <code><font size="2">getUserInfo</font></code> function, use the <code><font size="2">getUserInfoTTL</font></code> attribute. Caching for a function occurs only if its associated attribute is specified.
</p><p>The <code><font size="2">cacheTiming</font></code> settings specify the frequency at which Splunk calls your script to communicate with the external authentication system. You can specify time in seconds (s), minutes (m), hours (h), days (d), etc. Typically, you'll limit the cache frequency to seconds or minutes. If a unit is not specified, the value defaults to seconds. So, a value of "5" is equivalent to "5s". 
</p><p>This example shows typical values for the caches:  
</p>
<div class="samplecode"><code><font size="2"><br>[cacheTiming]<br>userLoginTTL &nbsp;&nbsp;&nbsp;= 10s<br>getUserInfoTTL &nbsp;= 1m<br>getUsersTTL &nbsp;&nbsp;&nbsp;&nbsp;= 2m<br></font></code></div>
<p>You'll want to set <code><font size="2">userLoginTTL</font></code> to a low value, since this determines how long user login/password validity is cached.
</p><p>To refresh all caches immediately, use the CLI command <code><font size="2">reload auth</font></code>:
</p>
<div class="samplecode"><code><font size="2"><br>./splunk reload auth<br></font></code></div>
<p><b>Note:</b> This command does not boot current users off the system.
</p><p>You can also refresh caches in Splunk Web:
</p><p><b>1.</b> In the <b>System</b> menu, under <b>Users and authentication</b> select <b>Access controls</b>.  
</p><p><b>2.</b> Click <b>Authentication method</b>.
</p><p><b>3.</b> Click <b>Reload authentication configuration</b> to refresh the caches.
</p><p>Each specified function, except <code><font size="2">getUsers</font></code>, has a separate cache for each user. So, if you have 10 users logged on and you've specified the <code><font size="2">getUserInfoTTL</font></code> attribute, the <code><font size="2">getUserInfo</font></code> function will have 10 user-based caches. The <code><font size="2">getUsers</font></code> function encompasses all users, so it has a single, global cache.
</p>
<a name="usepamauthentication"></a><h2> <a name="usepamauthentication_use_pam_authentication"><span class="mw-headline" id="Use_PAM_authentication"> Use PAM authentication</span></a></h2>
<p>You can configure Splunk for PAM authentication by following the steps in the example directory's README, which is located at <code><font size="2">$SPLUNK_HOME/share/splunk/authScriptSamples/</font></code>.
</p><p>If you are still unable to authenticate, then edit <code><font size="2">/etc/pam.d/pamauth</font></code> and add this line:
</p>
<code><font size="2"><br>auth sufficient pam_unix.so<br></font></code>

<a name="usethegetsearchfilterfunction"></a><h2> <a name="usethegetsearchfilterfunction_use_the_getsearchfilter_function_to_filter_at_search_time"><span class="mw-headline" id="Use_the_getSearchFilter_function_to_filter_at_search_time"> Use the getSearchFilter function to filter at search time</span></a></h2>
<p>This function is optional and can be used to implement a user-based filter at search time. When <code><font size="2">getSearchFilter</font></code> is enabled, Splunk will call it every time a search is run. A user-based search filter supplements any filters specified for that user's role(s). The returned filter(s) will be applied to each search, along with any configured at the role level. Caching of the filter does not occur with this function.    
</p><p><b>Note:</b> User-based search filters are optional and not recommended. A better approach is to assign search filters to roles and then assign users to the appropriate roles.
</p><p>To enable <code><font size="2">getSearchFilter</font></code> function, set the <code><font size="2">scriptSearchFilters</font></code> parameter in <code><font size="2">authentication.conf</font></code>:
</p>
<div class="samplecode"><code><font size="2"><br>[script]<br>scriptPath = $SPLUNK_HOME/bin/python $SPLUNK_HOME/bin/&lt;scriptname.py&gt;<br>scriptSearchFilters = 1<br></font></code></div>
<p><b>Note:</b> In previous releases, <code><font size="2">getSearchFilter</font></code> could also be used to implement search filters for users who had been authenticated by Splunk's built-in system.  This is no longer the case. Starting with 4.2, Splunk calls <code><font size="2">getSearchFilter</font></code> only for users who have been authenticated by scripted auth.  
</p><p>In addition, if a call to <code><font size="2">getSearchFilter</font></code> fails, Splunk will cancel the user's search and return an error message. This ensures that users cannot view results from unauthorized searches.
</p>
<h1>Configure single sign-on with reverse proxy</h1><a name="howsplunkssoworks"></a><h2> <a name="howsplunkssoworks_about_single_sign-on"><span class="mw-headline" id="About_Single_Sign-On"> About Single Sign-On</span></a></h2>
<p>Splunk SSO allows you to use a web proxy to handle Splunk <b>authentication</b>, meaning that once the user has logged into their proxy, they can seamlessly access Splunk Web (and presumably any other applications configured to your proxy).
</p><p>The Splunk Enterprise SSO implementation supports logging into Splunk Enterprise via Splunk Web only. Since SSO relies on cookies to save authentication information, SSO cannot be used for CLI authentication to Splunk Enterprise. Invoking <code><font size="2">https://localhost:8089</font></code> (or the assigned management port) still requires independent authentication. 
</p><p>To utilize SSO, you need the following:
</p>
<ul><li>A Proxy Server (Splunk Enterprise supports IIS or Apache).
</li><li>An LDAP Server or other external authentication system.
</li><li>A working Splunk Enterprise configuration.
</li></ul><p>For more information about how to configure these items and set up SSO, see <a href="#configuresplunksso" class="external text">Configure Single Sign-On</a>
</p>
<h3> <a name="howsplunkssoworks_how_it_works"><span class="mw-headline" id="How_it_works">How it works</span></a></h3>
<p>When Splunk Web SSO is properly configured, Splunk administrators and users invoke Splunk Web via a proxy URL that is deployed with Splunk Web. The proxy authenticates the incoming request against your authentication system. Upon successful authentication the proxy sets a request header with the authenticated identity&acirc;&#128;&#153;s attribute and sends this information to Splunk Enterprise. 
</p><p>Splunk Enterprise accepts the incoming HTTP request from the proxy, and if Splunk Enterprise recognizes the user contained in the header, the user bypasses the login page and is automatically authorized.
</p><p>For successful single-sign on, all requests from the proxy to Splunk Web must include this authenticated header. If the header is not included in a request, then the user is returned to the login page or an error page, depending on your configuration. Splunk continues using this authenticated header until the identity closes the browser session. 
</p>
<h4><font size="3"><b><i> <a name="howsplunkssoworks_how_splunk_processes_the_proxy_request"><span class="mw-headline" id="How_Splunk_processes_the_proxy_request">How Splunk processes the proxy request</span></a></i></b></font></h4>
<p>When the proxy server makes a request to Splunk Web, Splunk Web looks to the <code><font size="2">trustedIP</font></code> value in <code><font size="2">web.conf</font></code> to verify that the proxy's IP is on the trusted IP list. 
</p><p>If the IP is not trusted, the request is rejected and the sign-on attempt fails. If the IP address is trusted, then Splunk Web queries for the identity in the request header and sends splunkd an authorization request containing that header information.
</p><p>Upon receiving the authorization request from Splunk Web, splunkd verifies whether the incoming IP address of the client (e.g. usually Splunk Web) matches the value of the <code><font size="2">trustedIP</font></code> property of the <code><font size="2">server.conf</font></code> file. 
</p><p>If the IP addresses are not in the <code><font size="2">trustedIP</font></code> list the request is rejected and the sign-on attempt fails. The user is either returned to a login page or shown an error page, depending upon your <code><font size="2">SSOmode</font></code> configuration in web.conf. For more on this attribute and other configuration information, see <a href="#configuresplunksso" class="external text">Configure Splunk Single Sign-On</a>.
</p><p>If the IP is trusted, then splunkd uses the information contained in the request header and conducts the authorization process. 
</p><p><img alt="High-level overview of of single sign on" src="images/7/77/SSOProcess.png" width="600" height="712"></p>
<h4><font size="3"><b><i> <a name="howsplunkssoworks_how_splunk_authorizes_the_user"><span class="mw-headline" id="How_Splunk_authorizes_the_user"> How Splunk authorizes the user</span></a></i></b></font></h4>
<p>Splunk first checks to see if the given identity and role matches any of the users in your Splunk native user configuration. If Splunk fails to find a match there, it looks to see if there are any LDAP matches. (For information about how Splunk authenticates users, see <a href="#setupuserauthenticationwithldap" class="external text">Set up user authentication with LDAP</a> in this manual.)
</p><p>If no match is found and the user contained in the header cannot be authorized, then the browser redirects to an error page.
</p><p>If a match is found, Splunk authorizes the user and checks to see if an existing session is present. If a session already exists, Splunk uses that session identifier and creates the necessary cookies to allow the user access to Splunk Web. If a session does not exist, then Splunk creates a new session as well as the necessary cookies for Splunk Web authorization.
</p><p>Once the cookies are created, Splunk Web resumes its normal flow. Any subsequent access to Splunk via the proxy URL does not require re-authorization as long as the request header contains the trusted identity and until the user closes the browser session.
</p>
<a name="configuresplunksso"></a><h2> <a name="configuresplunksso_configure_single_sign-on"><span class="mw-headline" id="Configure_Single_Sign-On"> Configure Single Sign-On</span></a></h2>
<p>Before you configure proxy-based SSO with Splunk Enterprise, make sure you have the following:
</p>
<ul><li>A Proxy Server (Splunk Enterprise supports IIS or Apache) configured as a reverse proxy to authenticate to external systems.
</li><li>An LDAP Server or other external authentication system provisioned with appropriate groups and users for your proxy to authenticate against.
</li><li>A working Splunk Enterprise configuration that is either configured to use the same external authentication system as your proxy (usually LDAP) or that has native Splunk Enterprise users that match the user and group IDs contained in your external authentication system.
</li></ul><p>Configuring SSO requires the following steps:
</p><p><b>1.</b> Edit the properties on your proxy  server to authenticate against your external authentication system.
</p><p><b>2.</b> Edit Splunk's <code><font size="2">server.conf</font></code> file.
</p><p><b>3.</b> Edit Splunk's <code><font size="2">web.conf</font></code> file.
</p><p><b>Note:</b> For optimal security, any HTTP header-based solutions should be implemented over a TLS/SSL enabled deployment.
</p>
<h3> <a name="configuresplunksso_configure_server.conf"><span class="mw-headline" id="Configure_server.conf">Configure <code><font size="2">server.conf</font></code></span></a></h3>
<p>Edit the <code><font size="2">trustedIP</font></code> in the <code><font size="2">general settings</font></code> stanza to add the IP address that will make secure authentication requests to splunkd. This is typically Splunk Web and therefore the localhost. You can only enter one IP address per splunkd instance.
</p>
<div class="samplecode">trustedIP=127.0.0.1</div>
<p>If no IP addresses are provided in the <code><font size="2">trustedIP</font></code> list, Splunk SSO is disabled by default.
</p>
<h3> <a name="configuresplunksso_configure_web.conf"><span class="mw-headline" id="Configure_web.conf">Configure web.conf</span></a></h3>
<p>To enable SSO, configure the following in the <code><font size="2">[settings]</font></code> stanza in <code><font size="2">web.conf</font></code> (<code><font size="2">SPLUNK_HOME/etc/system/local</font></code>):
</p>
<div class="samplecode"><code><font size="2"><br>SSOMode = strict<br>trustedIP = 127.0.0.1,10.3.1.61,10.1.8.81<br>remoteUser = X-Remote-User<br>tools.proxy.on = True</font></code></div>
<table cellpadding="5" cellspacing="0" border="1"><tr><th bgcolor="#C0C0C0"> Attribute
</th><th bgcolor="#C0C0C0"> Default
</th><th bgcolor="#C0C0C0"> Value
</th></tr><tr><td valign="center" align="left"> <code><font size="2">SSOMode</font></code>
</td><td valign="center" align="left"> no
</td><td valign="center" align="left">The <code><font size="2">SSOMode</font></code> attribute determines whether the Splunk Web SSO operates in <code><font size="2">strict</font></code> or <code><font size="2">permissive</font></code> mode.
<p>Strict mode restricts authentication to identities that match the IP addresses listed in <code><font size="2">trustedIP</font></code> property. If the IP attempting to connect does not match any IP address, an error page appears to the user. Strict mode is recommended for SSO.
</p><p>Permissive mode also restricts authentication to requests from IPs found in the <code><font size="2">trustedIP</font></code> list. In permissive mode, if the IP attempting to connect does not match any IP address, a login page is displayed to allow the user to re-authenticate.
</p>
</td></tr><tr><td valign="center" align="left"> <code><font size="2">trustedIP</font></code>
</td><td valign="center" align="left"> n/a
</td><td valign="center" align="left"> Set this to the IP address of the authenticating proxy or proxies. Specify a single address or a comma-separated list of addresses; IP ranges and netmask notation are not supported.
</td></tr><tr><td valign="center" align="left"> <code><font size="2">remoteUser</font></code>
</td><td valign="center" align="left"> <code><font size="2">REMOTE_USER</font></code>
</td><td valign="center" align="left"> The <code><font size="2">remoteUser</font></code> attribute determines the authenticated identity&acirc;&#128;&#153;s attribute that is passed by the proxy server via the HTTP request header. Splunk defaults this value to <code><font size="2">REMOTE_USER</font></code> but any LDAP attribute can be passed via this request header as long as the proxy sets this attribute properly after authentication.  When you configure your <code><font size="2">remoteUser</font></code> attribute, you must also configure the <code><font size="2">RequestHeader</font></code> property in your proxy configuration to pass the identity&acirc;&#128;&#153;s attribute to Splunk. This process is described in <a href="#howsplunkssoworks" class="external text">"About Splunk Single Sign-On"</a>.
<p>The default Splunk header used is <code><font size="2">REMOTE_USER</font></code>, but if your proxy uses a different header, you can change the name of the header here.
</p>
</td></tr><tr><td valign="center" align="left"> <code><font size="2">tools.proxy.on</font></code>
</td><td valign="center" align="left"> false
</td><td valign="center" align="left"> To use Splunk SSO, set <code><font size="2">tools.proxy.on</font></code> to <code><font size="2">true</font></code>
<p>When set to "false," Splunk Enterprise uses the IP address of the computer logging on, however, in Splunk Enterprise SSO, it is the proxy that is requesting login on behalf of the user. Since requests are rejected if the IP address is not listed in the trustedIP property, setting this value to <code><font size="2">True</font></code> means that Splunk Web looks at the proxy&acirc;&#128;&#153;s IP address. 
</p>
</td></tr></table><p>If you host Splunk Web behind a proxy that does not place Splunk Web at the proxy's root, you may also need to configure the <code><font size="2">root_endpoint</font></code> setting in <code><font size="2">$SPLUNK_HOME/etc/system/local/web.conf</font></code>.
</p><p>For example if your proxy hosts Splunk Web at "yourhost.com:9000/splunk", <code><font size="2">root_endpoint</font></code> should be set to <code><font size="2">/splunk</font></code>. 
</p><p>For example:
</p>
<div class="samplecode"><code><font size="2">root_endpoint=/lzone<br>ProxyPass /lzone http://splunkweb.splunk.com:8000/lzone<br>ProxyPassReverse /lzone http://splunkweb.splunk.com:8000/lzone</font></code></div>
<p>In the above example, Splunk Web is accessed via <code><font size="2">http://splunk.example.com:8000/lzone</font></code> instead of <code><font size="2">http://splunk.example.com:8000/</font></code>. 
</p><p>You would next make it visible to the proxy by mapping it in <code><font size="2">httpd.conf</font></code>:
</p>
<div class="samplecode"><code><font size="2">ProxyPass /lzone http://splunkweb.splunk.com:8000/lzone<br>ProxyPassReverse /lzone http://splunkweb.splunk.com:8000/lzone</font></code></div>
<h3> <a name="configuresplunksso_session_management"><span class="mw-headline" id="Session_management">Session management</span></a></h3>
<p>Since there is no simple log out for a session and Splunk Enterprise will preserve a session as long as the correct header information is contained in the proxy header, you should set your proxy's session timeout value with this in mind.
</p><p>If you need to end a session before the timeout has occurred, you can use the REST end point along with the session identifier to destroy the session:
</p>
<div class="samplecode"><code><font size="2">curl -s -uadmin:changeme &nbsp;-k -X DELETE https://localhost:8089/services/authentication/httpauth-tokens/990cb3e61414376554a39e390471fff0</font></code></div>

<a name="troubleshootsplunksso"></a><h2> <a name="troubleshootsplunksso_troubleshoot_sso"><span class="mw-headline" id="Troubleshoot_SSO"> Troubleshoot SSO</span></a></h2>
<p>Splunk Web provides an interface that allows you to analyze the environment and the run-time data to help you debug your deployment. This page can be accessed via the proxy or the direct URL. The request headers will not be available if you do not access this page through the proxy server. 
</p><p>This URL is located at:
</p>
<code><font size="2"><br>http://YourSplunkServer:8000/debug/sso<br></font></code>
<p>Consider the following when using the troubleshooting page to analyze your deployment:
</p>
<ul><li> Compare the IP provided as the <b>Splunk trusted IP</b> with that of the <b>Host IP</b>. The values must be the same (they should be the IP of your proxy). If they are not the same in the troubleshooting page, you must edit the <code><font size="2">trustedIP</font></code> value in <code><font size="2">server.conf</font></code>.
</li></ul><ul><li> Check the value for <b>Incoming request IP received by splunkweb</b> to make sure that it displays your client's IP address. If the IP does not match that of your client, you must:
<ul><li>Edit <code><font size="2">web.conf</font></code> to correct this. 
</li><li>Make sure that <code><font size="2">tools.proxy.on</font></code> is set to <code><font size="2">true</font></code>.
</li></ul></li></ul><ul><li> Make sure that your proxy is providing a header. Check the <b>Authorization</b> field under <b>Other HTTP Headers</b>. If there is no value present, check the <code><font size="2">http.conf</font></code> file in your proxy to make sure that the remote header attribute value is properly set. Splunk is configured to accept the remote header value of <code><font size="2">X_REMOTE_USER</font></code>, which is the default for most proxies. If your proxy's remote header is different, and you wish to keep that value, you can edit the remote header value in <code><font size="2">web.conf</font></code> to change the header that Splunk will accept. See <a href="#configuresplunksso" class="external text">Configure SSO</a> for more information.
</li></ul><ul><li> Make sure that Splunk Web is creating a cookie to send to splunkd. Check the <b>Cookie</b> field under <b>Other HTTP headers</b> to make sure that a cookie is set. If a cookie is not set, then check your <code><font size="2">web.conf</font></code> file to make sure your file is properly configured. <a href="#configuresplunksso" class="external text">Configure SSO</a> for more information.
</li></ul><h1>About securing Splunk Enterprise with SSL</h1><a name="aboutsecuringyoursplunkconfigurationwithssl"></a><h2> <a name="aboutsecuringyoursplunkconfigurationwithssl_about_securing_splunk_with_ssl"><span class="mw-headline" id="About_securing_Splunk_with_SSL"> About securing Splunk with SSL</span></a></h2>
<p>This section describes the types of Splunk configurations you may want to secure with SSL. 
</p><p>Splunk ships with, and is configured to use, a set of default certificates. These certificates will discourage casual snoopers but could still leave you vulnerable because the root certificate that ships with Splunk is the same root certificate in every download, and anyone with the same root certificate can authenticate. 
</p><p>The default certificates are generated and configured at startup and can be found in <code><font size="2">$SPLUNK_HOME/etc/auth/</font></code>.
</p><p>The default certificates are set to expire three years after they are generated and new certificates must be created and configured at that time using one of the methods described in this manual.
</p>
<ul><li> For information about the default certificate for Splunk Web, see <a href="#turnonbasicencryptionwithsplunkweb" class="external text">"Turn on encryption (https) with Splunk Web."</a> or <a href="#turnonbasicencryptionusingweb.conf" class="external text">"Turn on encryption (https) using web.conf."</a>
</li><li> For information about SSL for forwarding with the default certificate, see <a href="#configuresplunkforwardingtousethedefaultcertificate" class="external text">"Configure Splunk forwarding to use the default certificate."</a>
</li></ul><p>There are three main configuration scenarios to which you can apply encryption and/or authentication:
</p>
<ul><li>Communications between the browser and <b>Splunk Web</b>
</li><li>Communication from Splunk <b>forwarders</b> to <b>indexers</b>
</li><li>Communication between Splunk instances over the management port
</li></ul><p>The table below describes the most common scenarios and the default SSL settings:
</p>
<table cellpadding="5" cellspacing="0" border="1"><tr><th bgcolor="#C0C0C0"> Type of exchange
</th><th bgcolor="#C0C0C0"> Client function
</th><th bgcolor="#C0C0C0"> Server function
</th><th bgcolor="#C0C0C0"> Encryption
</th><th bgcolor="#C0C0C0"> Certificate Authentication
</th><th bgcolor="#C0C0C0"> Common Name checking
</th><th bgcolor="#C0C0C0"> Type of data exchanged
</th></tr><tr><td valign="center" align="left"> Browser to Splunk Web
</td><td valign="center" align="left"> Browser
</td><td valign="center" align="left"> Splunk Web
</td><td valign="center" align="left"> NOT enabled by default
</td><td valign="center" align="left"> dictated by client (browser)
</td><td valign="center" align="left"> dictated by client (browser)
</td><td valign="center" align="left"> search term results
</td></tr><tr><td valign="center" align="left"> Inter-Splunk communication
</td><td valign="center" align="left"> Splunk Web
</td><td valign="center" align="left"> <code><font size="2">splunkd</font></code>
</td><td valign="center" align="left"> enabled by default
</td><td valign="center" align="left"> NOT enabled by default
</td><td valign="center" align="left"> NOT enabled by default
</td><td valign="center" align="left"> search term results
</td></tr><tr><td valign="center" align="left"> Forwarding
</td><td valign="center" align="left"> <code><font size="2">splunkd</font></code> as a forwarder
</td><td valign="center" align="left"> <code><font size="2">splunkd</font></code> as an indexer
</td><td valign="center" align="left"> NOT enabled by default
</td><td valign="center" align="left"> NOT enabled by default
</td><td valign="center" align="left"> NOT enabled by default
</td><td valign="center" align="left"> data to be indexed
</td></tr><tr><td valign="center" align="left"> Inter-Splunk communication
</td><td valign="center" align="left"> <code><font size="2">splunkd</font></code> as a deployment client
</td><td valign="center" align="left"> <code><font size="2">splunkd</font></code> as deployment server
</td><td valign="center" align="left"> enabled by default
</td><td valign="center" align="left"> NOT enabled by default
</td><td valign="center" align="left"> NOT enabled by default
</td><td valign="center" align="left"> configuration data
</td></tr><tr><td valign="center" align="left"> Inter-Splunk communication
</td><td valign="center" align="left"> <code><font size="2">splunkd</font></code> as a search head
</td><td valign="center" align="left"> <code><font size="2">splunkd</font></code> as search peer
</td><td valign="center" align="left"> Enabled by default
</td><td valign="center" align="left"> NOT enabled by default
</td><td valign="center" align="left"> NOT enabled by default
</td><td valign="center" align="left"> search data
</td></tr></table><h4><font size="3"><b><i> <a name="aboutsecuringyoursplunkconfigurationwithssl_communications_between_the_browser_and_splunk_web"><span class="mw-headline" id="Communications_between_the_browser_and_Splunk_Web">Communications between the browser and Splunk Web</span></a></i></b></font></h4>
<p>Browser to Splunk Web data most commonly consists of search requests and returned data. 
</p><p>Data encryption (HTTPS) can be easily turned on using Splunk Web, or by editing the <b>configuration files</b>. Keep in mind that encryption with the default certificate protects against casual listening but is not fully secure. 
</p><p>For better security, replace the default certificates with certificates signed by a trusted CA. We strongly recommend using CA certs rather than signing your own in this case. Unless you have the ability to add your CA to the certificate stores in every browser that will access Splunk Web, a self-signed certificate is considered untrusted by users' browsers. For more information, see <a href="#aboutsecuringauthenticationtosplunkweb" class="external text">"About securing Splunk Web."</a>
</p>
<h4><font size="3"><b><i> <a name="aboutsecuringyoursplunkconfigurationwithssl_splunk_forwarders_to_indexers"><span class="mw-headline" id="Splunk_forwarders_to_indexers">Splunk forwarders to indexers</span></a></i></b></font></h4>
<p>Data sent from forwarders to indexers is the data that your indexers use for your searches and reports. Depending upon your organization and the nature and format of the data being transmitted and Splunk configuration, this data may or may not be readable or sensitive. 
</p><p>Securing sensitive raw data helps to avoid snooping and man-in-the-middle attacks. 
</p><p>Turning on SSL encryption uses the default certificate and will provide encryption and compression. However, communication using the default certificate does not provide secure authentication, as the certificate password is supplied with every installation of Splunk. The default certificates are set to expire three years after initial startup, and forwarder to indexer communications will fail at this point.
</p><p>For better security, require certificate authentication using a signed certificate. Note that a certificate signed by a known and mutually trusted Certificate Authority is considered more secure by outside parties than a certificate you sign yourself. For more information about using certificates with Splunk forwarders and indexers, see <a href="#aboutsecuringdatafromforwarders" class="external text">"About securing data from forwarders."</a>
</p>
<h4><font size="3"><b><i> <a name="aboutsecuringyoursplunkconfigurationwithssl_inter-splunk"><span class="mw-headline" id="Inter-Splunk">Inter-Splunk</span></a></i></b></font></h4>
<p>Inter-Splunk communications happen between different instances of Splunk over the management port, usually but not always in a distributed environment. An example of this is configuration data sent by a deployment server to clients. 
</p><p>SSL encryption is enabled by default for intra-splunk communication. For most configurations this is adequate and is the recommended security type for intra-splunk communication. However, if you do need to secure your Splunk to Splunk communications with SSL authentication, we've provided some guidelines to help you in <a href="#aboutsecuringsplunktosplunkcommunication" class="external text">"About securing Splunk to Splunk communication"</a> in this manual.
</p>
<h4><font size="3"><b><i> <a name="aboutsecuringyoursplunkconfigurationwithssl_common_name_checking"><span class="mw-headline" id="Common_name_checking">Common name checking</span></a></i></b></font></h4>
<p>For added security, provide a common name when you you build your certificates and configure Splunk to check for that common name when authenticating the certificate. You can configure common name checking for any signed certificate.
</p>
<h4><font size="3"><b><i> <a name="aboutsecuringyoursplunkconfigurationwithssl_specify_a_cipher_suite"><span class="mw-headline" id="Specify_a_cipher_suite">Specify a cipher suite</span></a></i></b></font></h4>
<p>You can select and specify a cipher suite for inter-Splunk as well as Splunk forwarder to indexer communications. You add your cipher suite by appending a line at the end of your server SSL configuration stanza. 
</p><p>See <a href="#determineyourciphersuite" class="external text">Detemine your cipher suite</a> for more information.
</p>
<h3> <a name="aboutsecuringyoursplunkconfigurationwithssl_getting_your_certificates"><span class="mw-headline" id="Getting_your_certificates">Getting your certificates</span></a></h3>
<p>If you are experienced with SSL certificates, you can create them as you normally would and go straight to configuring your Splunk instances to use them.
</p><p>If you need help getting your certificates together, we've provided very simple examples using OpenSSL commands. (OpenSSL ships with Splunk)
</p>
<ul><li> <a href="#howtoself-signcertificates" class="external text">How to self-sign certificates</a>
</li><li> <a href="#howtogetthird-partycertificates" class="external text">How to get third-party certificates</a>
</li><li> <a href="#self-signcertificatesforsplunkweb" class="external text">How to self-sign certificates for Splunk Web</a>
</li><li> <a href="#getthird-partycertificatesforsplunkweb" class="external text">How to get third-party certificates for Splunk Web</a>
</li></ul><h3> <a name="aboutsecuringyoursplunkconfigurationwithssl_what_to_do_when_you_have_your_certificates"><span class="mw-headline" id="What_to_do_when_you_have_your_certificates"> What to do when you have your certificates</span></a></h3>
<p>The following topics provide more information about configuring Splunk to use your certificates once you have them:
</p>
<ul><li> <a href="#securesplunkwebusingasignedcertificate" class="external text">Secure Splunk Web with your own certificate</a>
</li><li> <a href="#configuresplunkforwardingtousesignedcertificates" class="external text">Configure Splunk forwarding to use your own certificates</a>
</li><li> <a href="#aboutsecuringsplunktosplunkcommunication" class="external text">About securing inter-splunk communication</a>
</li></ul><a name="aboutusingssltoolsinwindowsandlinux"></a><h2> <a name="aboutusingssltoolsinwindowsandlinux_about_using_ssl_tools_on_windows_and_linux"><span class="mw-headline" id="About_using_SSL_tools_on_Windows_and_Linux"> About using SSL tools on Windows and Linux</span></a></h2>
<p>This manual describes how to configure Splunk to use default, self-signed, or Certificate Authority signed certificates. For those who may not have certificates, we also provide simple examples for generating the certificates and keys using the command line and a version of OpenSSL that is packaged with Splunk.
</p>
<h3> <a name="aboutusingssltoolsinwindowsandlinux_using_the_openssl_command-line_examples"><span class="mw-headline" id="Using_the_OpenSSL_command-line_examples">Using the OpenSSL command-line examples</span></a></h3>
<p>This manual provides a few basic examples for creating certificates using Splunk's version of OpenSSL in the command line. In order to perform these tasks you must have root administrator permissions. If you are working on a remote or virtual machine, you may have to take an extra step to ensure that you are able to perform all tasks:
</p>
<ul><li> When working on a Windows platform, you may need to open the command line as the administrator: In the Start Menu, right click the .exe application and select <b>run as administrator</b>.
</li></ul><ul><li> When working on a *nix platform, you might need to use sudo to log in as the root administrator. 
</li></ul><p>For more information about the differences between Windows and *nix, see
the Administration Guide.
</p>
<h3> <a name="aboutusingssltoolsinwindowsandlinux_about_ssl_tools"><span class="mw-headline" id="About_SSL_tools">About SSL tools</span></a></h3>
<p>Splunk ships with a recent version of OpenSSL at <code><font size="2">$SPLUNK_HOME/splunk/lib</font></code>. For 6.0, Splunk supports OpenSSL with FIPS 140-2 enabled.
</p><p>A variety of other SSL tools are available for purchase and download that you can use to create and set up certificates. If you do choose to use OpenSSL for certificate configuration, we strongly recommend that you use the version that ships with Splunk to avoid compatibility issues. To make sure that you are using the version provided with Splunk, set your environment to the version in <code><font size="2">$SPLUNK_HOME/splunk/lib</font></code> or <code><font size="2">$SPLUNK_HOME\splunk\bin</font></code> for Windows:
</p><p>The following is an example of the library path for *nix:
</p>
<div class="samplecode"><code><font size="2"> export LD_LIBRARY_PATH=$SPLUNK_HOME/splunk/lib</font></code></div>
<p>The following is an example of the path for Windows:
</p>
<div class="samplecode"><code><font size="2">set PATH =&nbsp;%PATH%;%SPLUNK_HOME%\bin</font></code></div>
<h4><font size="3"><b><i> <a name="aboutusingssltoolsinwindowsandlinux_about_fips"><span class="mw-headline" id="About_FIPS">About FIPS</span></a></i></b></font></h4>
<p>FIPS uses government-certified versions of some algorithms to meet regulatory guidelines. It should not be considered a security enhancement by itself and  may potentially make your system slower. Splunk recommends that you only enable FIPS if it is a regulatory requirement for your environment. 
</p><p>If you are considering whether to enable FIPS, keep the following in mind:
</p>
<ul><li> Splunk only supports OpenSSL with FIPS 140-2 (64-bit x86) on Linux, Windows, and Solaris.
</li><li> Though FIPS is disabled by default, it will be automatically enabled if you are running Splunk on a Linux machine with a kernel in FIPS mode.
</li><li> The FIPS module disables the use of some cryptographic algorithms in the instance of Python that Splunk uses to run apps (such as md5 and rc4). Make sure that any Splunk apps you intend to run are certified to run in FIPS mode and don't have dependencies on these algorithms.
</li></ul><p><b>To enable FIPS:</b>
</p><p>Before you start Splunk for the first time, edit <code><font size="2">$SPLUNK_HOME/etc/splunk-launch.conf</font></code> to add the following line:
</p>
<div class="samplecode"><code><font size="2">SPLUNK_FIPS=1</font></code></div> 
<p><b>Note:</b> Upgrading a non-FIPS install to FIPS is not supported by Splunk &acirc;&#128;&#147; the decision to use FIPS must be made at the original installation.
</p>
<a name="setyoursslversion"></a><h2> <a name="setyoursslversion_configure_allowed_and_restricted_ssl_versions"><span class="mw-headline" id="Configure_allowed_and_restricted_SSL_versions">Configure allowed and restricted SSL versions</span></a></h2>
<p>Splunk Enterprise 6.2 provides the <code><font size="2">sslVersions</font></code> keyword to restrict older versions of protocols.&acirc;&#128;&#130; SSLv3 is shipped out of box to support easy upgrades but should be disabled as soon as upgrades are complete. By default, Splunk Enterprise allows communications on SSLv3 and all subsequent versions.
</p><p>When Splunk Enterprise is <a href="#aboutusingssltoolsinwindowsandlinux_about_fips" class="external text">configured in FIPS mode</a>, sslv2 and sslv3 are always disabled regardless of any additional configuration.
</p><p><b>CAUTION:</b> In response to the v3 "POODLE" vulnerability, Splunk Enterprise strongly recommends updating your configuration to remove SSLv3 as upgrades are applied to your environment.
</p><p><b>1.</b> In <code><font size="2">web.conf</font></code>, update the <code><font size="2">sslVersions</font></code> attribute to list or limit the versions (separated by commas) you want Splunk Enterprise to support. By defaults this attribute is set to <code><font size="2">*,-sslv2</font></code>, which is any version newer than sslv2 (not recommended). For 6.2 the allowed SSL versions are: 
</p>
<ul><li> sslv2 (not recommended)
</li><li> sslv3 (not recommended)
</li><li> tls1.0
</li><li> tls1.1
</li><li> tls1.2
</li></ul><p>For example:
</p>
<div class="samplecode"><code><font size="2">sslVersions = tls1.0, tls1.1, tls1.2<br></font></code></div>
<p><b>Syntax options</b>
</p><p>To select all supported versions use "*": 
</p>
<div class="samplecode"><code><font size="2">sslVersions = *<br></font></code></div>
<p>To include all versions tls1.0 or newer use "tls":
</p>
<div class="samplecode"><code><font size="2">sslVersions = tls<br></font></code></div>
<p>To restrict a particular version prefix it with "-"&nbsp;:
</p>
<div class="samplecode"><code><font size="2">sslVersions = *, -sslv3<br></font></code></div>
<p><b>Note:</b> When Splunk Enterprise is configured in FIPS mode, sslv2 and sslv3 are always disabled regardless of this configuration.
</p><p><b>2.</b> In <code><font size="2">inputs.conf</font></code>, update the <code><font size="2">sslVersions</font></code> attribute to list or limit the versions (separated by commas) you want Splunk Enterprise to support.
</p>
<div class="samplecode"><code><font size="2">sslVersions = sslv2, tls1.0, tls1.1, tls1.2<br></font></code></div>
<p>You can use "*" to select all supported versions: 
</p>
<div class="samplecode"><code><font size="2">sslVersions = *<br></font></code></div>
<p>Simply use "tls"to include all versions tls1.0 or newer:
</p>
<div class="samplecode"><code><font size="2">sslVersions = tls<br></font></code></div>
<p>The prefix a version with "-" to restrict a particular version:
</p>
<div class="samplecode"><code><font size="2">sslVersions = *, -sslv3<br></font></code></div>
<p><b>3.</b> Configure forwarders to be compatible with your indexer. Changing or limiting the SSL versions (and restricting SSLV3) can create compatibility issues with forwarders, particularly those that run earlier versions of Splunk Enterprise. For forwarders running 6.2 you can mitigate compatibility issues by also updating each forwarder's <code><font size="2">inputs.conf</font></code> and <code><font size="2">web.conf</font></code> settings in addition to your indexer.
</p><p>Update any forwarders to 6.2 to be consistent with your indexer and the SSL settings (For purposes of backward compatibility, 6.0 can support up to tls1.0.)
</p><p><b>4.</b> Configure your server to accept connections with clients (for example, <code><font size="2">web.conf</font></code> by editing the <code><font size="2">sslVersions</font></code> attribute so that it is the same as your client(s).
</p>
<h1>Getting your SSL certificates</h1><a name="howtoself-signcertificates"></a><h2> <a name="howtoself-signcertificates_how_to_self-sign_certificates"><span class="mw-headline" id="How_to_self-sign_certificates"> How to self-sign certificates</span></a></h2>
<p>This topic describes one way you can use OpenSSL to self-sign certificates for securing forwarder-to-indexer and Inter-Splunk communication. 
</p><p>If you already possess or know how to generate the needed certificates, you can skip this topic and go directly to the configuration steps, described later in this manual: 
</p>
<ul><li> <a href="#howtoprepareyoursignedcertificatesforsplunk" class="external text">How to prepare your signed certificates for Splunk</a> 
</li><li> <a href="#configuresplunkforwardingtousesignedcertificates" class="external text">Configure Splunk forwarding to use your own certificates</a> 
</li><li> <a href="#aboutsecuringsplunktosplunkcommunication" class="external text">About securing inter-Splunk communication</a>
</li></ul><p>Self-signed certificates are best used for data communication that happens within an organization or between known entities. If you are for any reason communicating with unknown entities we recommend using CA-signed certificates to secure your data.
</p>
<h3> <a name="howtoself-signcertificates_before_you_begin"><span class="mw-headline" id="Before_you_begin">Before you begin</span></a></h3>
<p>In this discussion, <code><font size="2">$SPLUNK_HOME</font></code> refers to the Splunk installation directory. On Windows, Splunk is installed at <code><font size="2">C:\Program Files\splunk</font></code> by default. For most Unix platforms, the default installation directory is at <code><font size="2">/opt/splunk</font></code>; for Mac OS, it is <code><font size="2">/Applications/splunk</font></code>.  See the Administration Guide to learn more about working with Windows and *nix.
</p><p>Make sure to use the version of OpenSSL provided with Splunk by setting your environment to the version in  <code><font size="2">$SPLUNK_HOME/splunk/lib</font></code> in *nix or <code><font size="2">$SPLUNK_HOME\splunk\bin</font></code> in Windows. To do this, you can:
</p>
<ul><li> Run <code><font size="2">$SPLUNK_HOME/bin/setSplunkEnv</font></code> before you create your certificates.
</li></ul><p>or
</p>
<ul><li> Navigate to <code><font size="2">$SPLUNK_HOME/bin/</font></code> and use <code><font size="2">./openssl</font></code> to run the certificate-generating commands.
</li></ul><h3> <a name="howtoself-signcertificates_create_a_new_directory_for_your_certificates"><span class="mw-headline" id="Create_a_new_directory_for_your_certificates">Create a new directory for your certificates</span></a></h3>
<p>Create a new directory to work from when creating your certificates. In our example, we are using <code><font size="2">$SPLUNK_HOME/etc/auth/mycerts</font></code>:
</p>
<div class="samplecode"><code><font size="2"># mkdir $SPLUNK_HOME/etc/auth/mycerts<br># cd $SPLUNK_HOME/etc/auth/mycerts</font></code></div>
<p>Splunk strongly recommends that you create a new folder and do not overwrite the existing certificates stored in <code><font size="2">$SPLUNK_HOME/etc/auth</font></code>.  Working in a new directory protects the certificates that ship with Splunk in <code><font size="2">$SPLUNK_HOME/etc/auth</font></code> and lets you use them for other Splunk components as necessary.
</p>
<h3> <a name="howtoself-signcertificates_create_the_root_certificate"><span class="mw-headline" id="Create_the_root_certificate">Create the root certificate</span></a></h3>
<p>First you create a root certificate that serves as your root certificate authority. You use this root CA to sign the server certificates that you generate and distribute to your Splunk instances.
</p>
<h4><font size="3"><b><i> <a name="howtoself-signcertificates_generate_a_private_key_for_your_root_certificate"><span class="mw-headline" id="Generate_a_private_key_for_your_root_certificate">Generate a private key for your root certificate </span></a></i></b></font></h4>
<p><b>1.</b> Create a key to sign your certificates. 
</p><p>In *nix:
</p>
<div class="samplecode"><code><font size="2"># openssl genrsa -des3 -out myCAPrivateKey.key 1024</font></code></div>
<p>In Windows you may need to append the location of the <code><font size="2">openssl.cnf</font></code> file:
</p>
<div class="samplecode"><code><font size="2"> &gt;openssl genrsa -des3 -out myCAPrivateKey.key 1024</font></code></div>
<p>Note that for this example we are using: DES3 encryption and a 1024 bit key length. For sensitive data we recommend a length of 2048 or higher when possible. 
</p><p><b>2.</b> When prompted, create a password for the key. 
</p><p>When the step is completed, the private key <code><font size="2">myCAPrivateKey.key</font></code> appears in your directory.
</p>
<h4><font size="3"><b><i> <a name="howtoself-signcertificates_generate_and_sign_the_certificate"><span class="mw-headline" id="Generate_and_sign_the_certificate">Generate and sign the certificate</span></a></i></b></font></h4>
<p><b>1.</b> Generate a new Certificate Signing Request (CSR):
</p><p>In *nix:
</p>
<div class="samplecode"><code><font size="2"># openssl req -new -key myCAPrivateKey.key -out myCACertificate.csr</font></code></div>
<p>In Windows:
</p>
<div class="samplecode"><code><font size="2"> &gt;openssl req -new -key myCAPrivateKey.key -out myCACertificate.csr -config $SPLUNK_HOME\openssl.cnf</font></code></div>
<p><b>2.</b> When prompted, enter the password you created for the private key in <code><font size="2">$SPLUNK_HOME/etc/auth/mycerts/myCAPrivateKey.key</font></code>. 
</p><p><b>3.</b> Provide the requested certificate information, including the common name if you plan to use common name checking in your Splunk configuration.
</p><p>A new CSR <code><font size="2">myCACertificate.csr</font></code> appears in your directory.
</p><p><b>4.</b> Use the CSR <code><font size="2">myCACertificate.csr</font></code> to generate the public certificate:
</p><p>In *nix:
</p>
<div class="samplecode"><code><font size="2"># openssl x509 -req -in myCACertificate.csr -sha1 -signkey myCAPrivateKey.key -CAcreateserial -out myCACertificate.pem -days 1095</font></code></div>
<p>In Windows:
</p>
<div class="samplecode"><code><font size="2"> &gt;openssl x509 -req -in myCACertificate.csr -sha1 -signkey myCAPrivateKey.key -CAcreateserial -out myCACertificate.pem -days 1095</font></code></div>
<p><b>5.</b> When prompted, enter the password for the private key <code><font size="2">myCAPrivateKey.key</font></code>.
</p><p>A new file <code><font size="2">myCACertificate.pem</font></code> appears in your directory. This is the public CA certificate that you will distribute to your Splunk instances.
</p>
<h3> <a name="howtoself-signcertificates_create_the_server_certificate"><span class="mw-headline" id="Create_the_server_certificate">Create the server certificate</span></a></h3>
<p>Now that you have created a root certificate to serve as your CA, you must create and sign your server certificate.
</p><p><b>Important:</b> This example shows you how to create a new private key and server certificate. You can distribute this server certificate to all forwarders, indexers as well your Splunk instances that communicate on the management port. If you want to use a different common names for each instance, you simply repeat the process described here to create different certificates (each with a different common name) for your Splunk instances.
</p><p>For example, if configuring multiple forwarders, you can use the following example to create the certificate <code><font size="2">myServerCertificate.pem</font></code> for your indexer, then create another certificate <code><font size="2">myForwarderCertificate.pem</font></code> using the same root CA and install that certificate on your forwarder. Note that an indexer will only accept a properly generated and configured certificate from a forwarder that is signed by the same root CA. 
</p><p>See <a href="#configuresplunkforwardingtousesignedcertificates" class="external text">"Configure Splunk forwarding to use your own certificates"</a> for more information about configuring your forwarders and indexers.
</p>
<h4><font size="3"><b><i> <a name="howtoself-signcertificates_generate_a_key_for_your_server_certificate"><span class="mw-headline" id="Generate_a_key_for_your_server_certificate">Generate a key for your server certificate</span></a></i></b></font></h4>
<p><b>1.</b> Generate a new RSA private key for your server certificate. In this example we are again using DES3 encryption and a 1024 bit key length:
</p><p>In *nix:
</p>
<div class="samplecode"><code><font size="2"># openssl genrsa -des3 -out myServerPrivateKey.key 1024</font></code></div>
<p>In Windows:
</p>
<div class="samplecode"><code><font size="2"># openssl genrsa -des3 -out myServerPrivateKey.key 1024</font></code></div>
<p><b>2.</b> When prompted, create a new password for your key. 
</p><p>A new key <code><font size="2">myServerPrivateKey.key</font></code> is created.  This key will be used to encrypt the outgoing data on any Splunk instance where you install it as part of the server certificate.
</p>
<h4><font size="3"><b><i> <a name="howtoself-signcertificates_generate_and_sign_a_new_server_certificate"><span class="mw-headline" id="Generate_and_sign_a_new_server_certificate">Generate and sign a new server certificate</span></a></i></b></font></h4>
<p><b>1.</b> Use your new server private key <code><font size="2">myServerPrivateKey.key</font></code> to generate a CSR for your server certificate.
</p><p>In *nix:
</p>
<div class="samplecode"><code><font size="2"># openssl req -new -key myServerPrivateKey.key -out myServerCertificate.csr</font></code></div>
<p>In Windows:
</p>
<div class="samplecode"><code><font size="2">openssl req -new -key myServerPrivateKey.key -out myServerCertificate.csr -config $SPLUNK_HOME\openssl.cnf</font></code></div>
<p><b>2.</b> When prompted, provide the password to the private key <code><font size="2">myServerPrivateKey.key</font></code>.
</p><p><b>3.</b> Provide the requested information for your certificate, including a Common Name if you plan to configure Splunk to authenticate via common-name checking.  
</p><p>A new CSR <code><font size="2">myServerCertificate.csr</font></code> appears in your directory.
</p><p><b>4.</b> Use the CSR <code><font size="2">myServerCertificate.csr</font></code> and your CA certificate and private key to generate a server certificate. 
</p><p>In *nix:
</p>
<div class="samplecode"><code><font size="2"># openssl x509 -req -in myServerCertificate.csr -sha1 -CA myCACertificate.pem -CAkey myCAPrivateKey.key -CAcreateserial -out myServerCertificate.pem -days 1095</font></code></div>
<p>In Windows:
</p>
<div class="samplecode"><code><font size="2"># openssl x509 -req -in myServerCertificate.csr -sha1 -CA myCACertificate.pem -CAkey myCAPrivateKey.key -CAcreateserial -out myServerCertificate.pem -days 1095</font></code></div>
<p><b>5.</b> When prompted, provide the password for the certificate authority private key <code><font size="2">myCAPrivateKey.key</font></code>. Make sure to sign this with your private key and not the server key you just created.
</p><p>A new public server certificate <code><font size="2">myServerCertificate.pem</font></code> appears in your directory.
</p>
<h2> <a name="howtoself-signcertificates_next_steps"><span class="mw-headline" id="Next_steps">Next steps</span></a></h2>
<p>You should now have the following files in the directory you created, which is everything you need to configure indexers, forwarders, and Splunk instances that communicate over the management port:
</p>
<ul><li> <code><font size="2">myServerCertificate.pem</font></code> 
</li><li> <code><font size="2">myServerPrivateKey.key</font></code>
</li><li> <code><font size="2">myCACertificate.pem</font></code>
</li></ul><p>Now that you have the certificates you need, you must prepare your server certificate (including appending any intermediate certificates), and then configure Splunk to find and use them:
</p>
<ul><li> See <a href="#howtoprepareyoursignedcertificatesforsplunk" class="external text">"How to prepare your signed certificates for Splunk"</a> to learn how to set up your certificates to work with Splunk.
</li><li> See <a href="#configuresplunkforwardingtousesignedcertificates" class="external text">"Configure Splunk forwarding to use your own certificates"</a> to learn more about configuring certificate authentication for forwarding.
</li><li> See <a href="#aboutsecuringsplunktosplunkcommunication" class="external text">About securing inter-Splunk communication</a> to learn more about configuring certificate authentication for Splunk to Splunk communications.
</li></ul><a name="howtogetthird-partycertificates"></a><h2> <a name="howtogetthird-partycertificates_how_to_get_certificates_signed_by_a_third-party"><span class="mw-headline" id="How_to_get_certificates_signed_by_a_third-party"> How to get certificates signed by a third-party</span></a></h2>
<p>This topic describes one way you can use the version of OpenSSL that ships with Splunk to obtain third-party certificates that you can use to secure your forwarder-to-indexer and inter-Splunk communication. 
</p><p>To get certificates that you can use to secure for browser-to-Splunk Web communication, see <a href="#getthird-partycertificatesforsplunkweb" class="external text">"Get certificates signed by a third-party for Splunk Web."</a>
</p><p>If you already possess or know how to generate the certificates you can, skip this topic and go directly to the configuration steps, which are described later in this manual: 
</p>
<ul><li> <a href="#configuresplunkforwardingtousesignedcertificates" class="external text">Configure Splunk forwarding to use your own certificates</a> 
</li><li> <a href="#aboutsecuringsplunktosplunkcommunication" class="external text">About securing inter-Splunk communication</a>
</li></ul><p><b>Note:</b> If you plan to use multiple common names in your configurations, you can repeat the steps described here to create a different server certificate using the same root CA for each instance with it's own common name and then configure your Splunk instances to use them. See <a href="#configuresplunkforwardingtousesignedcertificates" class="external text">"Configure Splunk forwarding to use your own certificates"</a> for more information about configuring your forwarders and indexers.
</p>
<h3> <a name="howtogetthird-partycertificates_before_you_begin"><span class="mw-headline" id="Before_you_begin">Before you begin</span></a></h3>
<p>In this discussion, <code><font size="2">$SPLUNK_HOME</font></code> refers to the Splunk installation directory. On Windows, Splunk is installed at <code><font size="2">C:\Program Files\splunk</font></code> by default. For most Unix platforms, the default installation directory is at <code><font size="2">/opt/splunk</font></code>; for Mac OS, it is <code><font size="2">/Applications/splunk</font></code>.  See the Administration Guide to learn more about working with Windows and *nix.
</p><p>Make sure that you are using the version of OpenSSL provided with Splunk by setting your environment to the version in  <code><font size="2">$SPLUNK_HOME/splunk/lib</font></code> in *nix or <code><font size="2">$SPLUNK_HOME/splunk/bin</font></code> in Windows.
</p>
<h3> <a name="howtogetthird-partycertificates_create_a_new_directory_for_your_certificates"><span class="mw-headline" id="Create_a_new_directory_for_your_certificates">Create a new directory for your certificates</span></a></h3>
<p>Create a new directory to work from when creating your certificates. In our example, we are using <code><font size="2">$SPLUNK_HOME/etc/auth/mycerts</font></code>:
</p>
<div class="samplecode"><code><font size="2"># mkdir $SPLUNK_HOME/etc/auth/mycerts<br># cd $SPLUNK_HOME/etc/auth/mycerts</font></code></div>
<p>Splunk strongly recommends that you make a new folder so that you do not overwrite the existing certificates in <code><font size="2">$SPLUNK_HOME/etc/auth</font></code> for your new certificates and keys. Working in a new directory protects the certificates that ship with Splunk and lets you use them for other Splunk components as necessary.
</p>
<h3> <a name="howtogetthird-partycertificates_request_your_server_certificate"><span class="mw-headline" id="Request_your_server_certificate">Request your server certificate</span></a></h3>
<p>Create and sign a Certificate Signing Request (CSR) to send to your Certificate Authority.
</p><p><b>Important:</b> This example shows you how to create a new private key and request a server certificate. You can distribute this server certificate to all forwarders, indexers as well your Splunk instances that communicate on the management port. If you want to use a different common names for each instance, you simply repeat the process described here to create different certificates (each with a different common name) for your Splunk instances.
</p><p>For example, if configuring multiple forwarders, you can use the following example to create the certificate <code><font size="2">myServerCertificate.pem</font></code> for your indexer, then create another certificate <code><font size="2">myForwarderCertificate.pem</font></code> using the same root CA and install that certificate on your forwarder. Note that an indexer will only accept a properly generated and configured certificate from a forwarder that is signed by the same root CA. 
</p><p>See <a href="#configuresplunkforwardingtousesignedcertificates" class="external text">"Configure Splunk forwarding to use your own certificates"</a> for more information about configuring your forwarders and indexers.
</p>
<h4><font size="3"><b><i> <a name="howtogetthird-partycertificates_generate_a_private_key_for_your_server_certificate"><span class="mw-headline" id="Generate_a_private_key_for_your_server_certificate">Generate a private key for your server certificate</span></a></i></b></font></h4>
<p><b>1.</b> Create a new private key. The following example uses DES3 encryption and a 1024 bit key length, we recommend a key length of 2048 or higher when possible.
</p><p>In *nix:
</p>
<div class="samplecode"><code><font size="2"># openssl genrsa -des3 -out myServerPrivateKey.key 1024</font></code></div>
<p>In Windows:
</p>
<div class="samplecode"><code><font size="2"> &gt;openssl genrsa -des3 -out myServerPrivateKey.key 1024 -config $SPLUNK_HOME\openssl.cnf</font></code></div>
<p><b>2.</b> When prompted, create a password for your key. 
</p><p>When you are done, a new private key <code><font size="2">myServerPrivateKey.key</font></code> is created in your directory. You will use this key to sign your Certificate Signing Request (CSR).
</p>
<h4><font size="3"><b><i> <a name="howtogetthird-partycertificates_generate_a_new_certificate_signing_request_.28csr.29"><span class="mw-headline" id="Generate_a_new_Certificate_Signing_Request_.28CSR.29">Generate a new Certificate Signing Request (CSR) </span></a></i></b></font></h4>
<p><b>1.</b> Use your private key <code><font size="2">myServerPrivateKey.key</font></code> to generate a CSR for your server certificate:
</p><p>In *nix:
</p>
<div class="samplecode"><code><font size="2"># openssl req -new -key myServerPrivateKey.key -out myServerCertificate.csr</font></code></div>
<p>In Windows:
</p>
<div class="samplecode"><code><font size="2"> &gt;openssl req -new -key myServerPrivateKey.key -out myServerCertificate.csr -config $SPLUNK_HOME\openssl.cnf</font></code></div>
<p><b>2.</b> When prompted, provide the password you created for your private key <code><font size="2">myServerPrivateKey.key</font></code>.
</p><p><b>3.</b> Provide the requested information for your certificate. To use common-name checking, make sure to provide a Common Name when entering your certificate details. 
</p><p>When you are done, a new CSR <code><font size="2">myServerCertificate.csr</font></code> appears in your directory.
</p>
<h3> <a name="howtogetthird-partycertificates_download_and_verify_the_server_certificate_and_public_key"><span class="mw-headline" id="Download_and_verify_the_server_certificate_and_public_key">Download and verify the server certificate and public key</span></a></h3>
<p><b>1.</b> Send your CSR to your Certificate Authority (CA) to request a new server certificate. The request process varies based on the Certificate Authority you use. 
</p><p><b>2.</b> When it's ready, download the new server certificate from your Certificate Authority. For the examples in this manual, let's call this <code><font size="2">myServerCertificate.pem</font></code>.
</p><p><b>3.</b> Also download your Certificate Authority's public CA certificate. For the examples in this manual, let's call this <code><font size="2">myCACertificate.pem</font></code>.
</p><p>If your Certificate Authority does not provide you with certificates in PEM format, you must convert them using the OpenSSL command appropriate to your existing file type, consult your OpenSSL documentation for more information about converting different file types.
</p><p><b>4.</b> View the contents to make sure it has everything you need:
</p>
<ul><li> The &acirc;&#128;&#156;Issuer&acirc;&#128;&#157; entry should refer to your CA&acirc;&#128;&#153;s information. 
</li><li> The &acirc;&#128;&#156;Subject&acirc;&#128;&#157; entry should show the information (country name, organization name, Common Name, etc) that you entered when creating the CSR earlier.
</li></ul><h3> <a name="howtogetthird-partycertificates_next_steps"><span class="mw-headline" id="Next_steps">Next steps</span></a></h3>
<p>You should now have the following files in the directory you created, which is everything you need to configure indexers, forwarders, and Splunk instances that communicate over the management port:
</p>
<ul><li> <code><font size="2">myServerCertificate.pem</font></code> 
</li><li> <code><font size="2">myServerPrivateKey.key</font></code>
</li><li> <code><font size="2">myCACertificate.pem</font></code>
</li></ul><p>Now that you have the certificates you need, you must prepare your server certificate (including appending any intermediate certificates), and then configure Splunk to find and use your certificates:
</p>
<ul><li> See <a href="#howtoprepareyoursignedcertificatesforsplunk" class="external text">"How to prepare your signed certificates for Splunk"</a> to learn how to set up your certificates to work with Splunk.
</li><li> See <a href="#configuresplunkforwardingtousesignedcertificates" class="external text">"Configure Splunk forwarding to use your own certificates"</a> to learn more about configuring certificate authentication for forwarding.
</li><li> See <a href="#aboutsecuringsplunktosplunkcommunication" class="external text">"About securing inter-Splunk communication"</a> to learn more about configuring certificate authentication for inter-Splunk communications.
</li></ul><a name="howtoprepareyoursignedcertificatesforsplunk"></a><h2> <a name="howtoprepareyoursignedcertificatesforsplunk_how_to_prepare_your_signed_certificates_for_splunk"><span class="mw-headline" id="How_to_prepare_your_signed_certificates_for_Splunk"> How to prepare your signed certificates for Splunk</span></a></h2>
<p>Once you have your certificates, you must combine the server certificate and your keys into a single file that Splunk can use. 
</p><p>If you do not have your certificates and need help getting them, we provide some basic examples using OpenSSL in the following topics:
</p>
<ul><li><a href="#howtoself-signcertificates" class="external text">How to self-sign certificates.</a>
</li><li><a href="#howtogetthird-partycertificates" class="external text">How to get certificates signed by a third party.</a>
</li></ul><p><b>Note:</b> To configure SSL for Splunk, make sure your certificates and public key are in x509 format and that your private key is in RSA format.
</p>
<h3> <a name="howtoprepareyoursignedcertificatesforsplunk_create_a_single_pem_file"><span class="mw-headline" id="Create_a_single_PEM_file">Create a single PEM file</span></a></h3>
<p>Consolidate the signed server certificate, the server private key and the CA public key in a single PEM file. 
</p><p>For the examples here, we are using the file names described in <a href="#howtoself-signcertificates" class="external text">"How to self-sign certificates"</a> and 
<a href="#howtogetthird-partycertificates" class="external text">"How to get certificates signed by a third party."</a>
</p><p>The following is an example for *nix: 
</p>
<div class="samplecode"><code><font size="2"># cat myServerCertificate.pem myServerPrivateKey.key myCACertificate.pem &gt; myNewServerCertificate.pem</font></code></div>
<p>The following is an example for Windows:
</p>
<div class="samplecode"><code><font size="2"> &gt;type myServerCertificate.pem myServerPrivateKey.key myCACertificate.pem &gt; myNewServerCertificate.pem</font></code></div>
<p>Once created, the contents of the file <code><font size="2">myNewServerCertificate</font></code> should contain, in the following order:
</p>
<ul><li> The server certificate (<code><font size="2">myServerCertificate.pem</font></code>) 
</li><li> The private key  (<code><font size="2">myServerPrivateKey.key</font></code>)
</li><li> The certificate authority public key (<code><font size="2">myCACertificate.pem</font></code>)
</li></ul><p>Here's an example of a properly concatenated certificate:
</p>
<div class="samplecode"><code><font size="2"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-----BEGIN CERTIFICATE-----<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MIICUTCCAboCCQCscBkn/xey1TANBgkqhkiG9w0BAQUFADBtMQswCQYDVQQGEwJV<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;Server Certificate&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8/PZr3EuXYk1c+N5hgIQys5a/HIn<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-----END CERTIFICATE-----<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-----BEGIN RSA PRIVATE KEY-----<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Proc-Type: 4,ENCRYPTED<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEK-Info: DES-EDE3-CBC,CFCECC7976725DE5<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S+DPcQ0l2Z1bk71N3cBqr/nwEXPNDQ4uqtecCd3iGMV3B/WSOWAQxcWzhe9JnIsl<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;Server Private Key &acirc;&#128;&#147; Passphrase protected&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-----END RSA PRIVATE KEY-----<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-----BEGIN CERTIFICATE-----<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MIICUTCCAboCCQCscBkn/xey1TANBgkqhkiG9w0BAQUFADBtMQswCQYDVQQGEwJV<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;Certificate Authority Public Key&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8/PZr3EuXYk1c+N5hgIQys5a/HIn<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-----END CERTIFICATE-----</font></code></div>
<h3> <a name="howtoprepareyoursignedcertificatesforsplunk_how_to_configure_certificate_chains"><span class="mw-headline" id="How_to_configure_certificate_chains">How to configure certificate chains</span></a></h3>
<p>To use multiple certificates, append the intermediate certificate to the end of the server's certificate file. You can add as many certificates you need to in decreasing order of hierarchy, up to the root. 
</p><p>The certificates should be concatenated in the following order:
</p>
<code><font size="2">[ server certificate]<br>[ intermediate certificate]<br>[ root certificate (if required) ]</font></code>
<p>So for example, a certificate chain might look like this:
</p>
<div class="samplecode"><code><font size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>-----BEGIN CERTIFICATE-----<br>... (certificate for your server)...<br>-----END CERTIFICATE-----<br>-----BEGIN CERTIFICATE-----<br>... (the intermediate certificate)...<br>-----END CERTIFICATE-----<br>-----BEGIN CERTIFICATE-----<br>... (the root certificate for the CA)...<br>-----END CERTIFICATE-----</font></code></div>
<h3> <a name="howtoprepareyoursignedcertificatesforsplunk_next_steps"><span class="mw-headline" id="Next_steps">Next steps</span></a></h3>
<p>Now that you have the certificates you need, you must configure Splunk to find and use them:
</p>
<ul><li> See <a href="#configuresplunkforwardingtousesignedcertificates" class="external text">"Configure Splunk forwarding to use your own certificates"</a> to learn more about configuring certificate authentication for forwarding.
</li><li> See <a href="#aboutsecuringsplunktosplunkcommunication" class="external text">"About securing inter-Splunk communication"</a> to learn more about configuring certificate authentication for inter-Splunk communications.
</li></ul><a name="self-signcertificatesforsplunkweb"></a><h2> <a name="self-signcertificatesforsplunkweb_self-sign_certificates_for_splunk_web"><span class="mw-headline" id="Self-sign_certificates_for_Splunk_Web"> Self-sign certificates for Splunk Web</span></a></h2>
<p>This topic provides basic examples for creating the self-signed certificates in the command line using the version of OpenSSL included with Splunk. 
</p><p>There are multiple ways you can create signed certificates, depending upon your organizations policies, your platform, and the tools that you are using. If you have already generated these certificates and key, or if you are experienced in generating certificates, you can skip this task and go directly to the configuration topic <a href="#securesplunkwebusingasignedcertificate" class="external text">"Secure Splunk Web with your own certificate"</a> in this manual.
</p><p>Since self-signed certificates are signed by your organization, they are not contained in browser certificate stores. As a result, web browsers consider self-signed certificates "untrusted". This produces a warning page to users and may even prevent access for the user. 
</p><p>Self-signed certificates are best used for browser to Splunk Web communication that happens within an organization or between known entities where you can add your own CA to all browser stores that will contact Splunk Web. For any other scenario, CA-signed certificates are recommended. See <a href="#getthird-partycertificatesforsplunkweb" class="external text">"Get certificates signed by a third party for Splunk Web"</a> for more information.
</p>
<h3> <a name="self-signcertificatesforsplunkweb_before_you_begin"><span class="mw-headline" id="Before_you_begin">Before you begin</span></a></h3>
<p>In this discussion, <code><font size="2">$SPLUNK_HOME</font></code> refers to the Splunk installation directory. On Windows, Splunk is installed at <code><font size="2">C:\Program Files\splunk</font></code> by default. For most Unix platforms, the default installation directory is at <code><font size="2">/opt/splunk</font></code>; for Mac OS, it is <code><font size="2">/Applications/splunk</font></code>.  See the Administration Guide to learn more about working with Windows and *nix.
</p><p>Make sure that you are using the version of OpenSSL provided with Splunk by setting your environment to the version in  <code><font size="2">$SPLUNK_HOME/splunk/lib</font></code> in *nix or <code><font size="2">$SPLUNK_HOME/splunk/bin</font></code> in Windows.
</p>
<h3> <a name="self-signcertificatesforsplunkweb_generate_a_new_root_certificate_to_be_your_certificate_authority"><span class="mw-headline" id="Generate_a_new_root_certificate_to_be_your_Certificate_Authority">Generate a new root certificate to be your Certificate Authority</span></a></h3>
<p><b>1.</b> Create a new directory to host your certificates and keys. For this example we will use <code><font size="2">$SPLUNK_HOME/etc/auth/mycerts</font></code>.
</p><p>We recommend that you place your new certificates in a different directory than <code><font size="2">$SPLUNK_HOME/etc/auth/splunkweb</font></code> so that you don't overwrite the existing certificates.  This ensures that you are able to use the certificates that ship with Splunk in <code><font size="2">$SPLUNK_HOME/etc/auth/splunkweb</font></code> for other Splunk components as necessary.
</p><p><b>Note:</b> If you created a self-signed certificate as described in <a href="#howtoself-signcertificates" class="external text">"How to self-sign certificates"</a>, you can copy that root certificate into your directory and skip to the next step: "Create a new private key for Splunk Web".
</p><p><br><b>2.</b> Generate a new RSA private key. This example uses 1024 bit length: 
</p>
<div class="samplecode"><code><font size="2"># openssl genrsa -des3 -out myCAPrivateKey.key 1024</font></code></div>
<p>Note that in Windows you may need to append the location of the <code><font size="2">openssl.cnf</font></code> file:
</p>
<div class="samplecode"><code><font size="2"> &gt;openssl genrsa -des3 -out myCAPrivateKey.key 1024 &nbsp;-config $SPLUNK_HOME\openssl.cnf</font></code></div>
<p>Our example uses a key length of 1024, but you can specify key lengths above 1024 if they are supported by your browser. For sensitive data we recommend a length of 2048 or higher when possible. 
</p><p><b>3.</b> When prompted, create a password.
</p><p>The private key <code><font size="2">myCAPrivateKey.key</font></code> appears in your directory. This is your root certificate private key.
</p><p><b>4.</b> Generate a certificate signing request using the root certificate private key <code><font size="2">myCAPrivateKey.key</font></code>: 
</p><p>In *nix:
</p>
<div class="samplecode"><code><font size="2"># openssl req -new -key myCAPrivateKey.key -out myCACertificate.csr</font></code></div>
<p>In Windows:
</p>
<div class="samplecode"><code><font size="2"> &gt;openssl req -new -key myCAPrivateKey.key -out myCACertificate.csr &nbsp;-config $SPLUNK_HOME\openssl.cnf</font></code></div>
<p><b>5.</b> Provide the password to the private key <code><font size="2">myCAPrivateKey.key</font></code>.
</p><p>A new CSR <code><font size="2">myCACertificate.csr</font></code> appears in your directory.
</p><p><b>6.</b> Use the CSR to generate a new root certificate and sign it with your private key: 
</p><p>In *nix:
</p>
<div class="samplecode"><code><font size="2"># openssl x509 -req -in myCACertificate.csr -signkey myCAPrivateKey.key -out myCACertificate.pem -days 3650</font></code></div>
<p>In Windows:
</p>
<div class="samplecode"><code><font size="2"> &gt;openssl x509 -req -in myCACertificate.csr -signkey myCAPrivateKey.key -out myCACertificate.pem -days 3650 &nbsp;-config $SPLUNK_HOME\openssl.cnf</font></code></div>
<p><b>7.</b> When prompted, provide for the password to the private key <code><font size="2">myCAPrivateKey.key</font></code>.
</p><p>A new certificate <code><font size="2">myCACertificate.pem</font></code> appears in your directory. This is your public certificate.
</p>
<h3> <a name="self-signcertificatesforsplunkweb_create_a_new_private_key_for_splunk_web"><span class="mw-headline" id="Create_a_new_private_key_for_Splunk_Web">Create a new private key for Splunk Web</span></a></h3>
<p><b>1.</b> Generate a new private key: 
</p><p>In *nix:
</p>
<div class="samplecode"><code><font size="2"># openssl genrsa -des3 -out mySplunkWebPrivateKey.key 1024</font></code></div>
<p>In Windows:
</p>
<div class="samplecode"><code><font size="2"> &gt;openssl genrsa -des3 -out mySplunkWebPrivateKey.key 1024 -config $SPLUNK_HOME\openssl.cnf</font></code></div>
<p><b>2.</b> When prompted, create a password.
</p><p>A new key, <code><font size="2">mySplunkWebPrivateKey.key</font></code> appears in your directory.
</p><p><b>3.</b> Remove the password from your key. (Splunk Web does not currently support password-protected private keys.) 
</p><p>In *nix:
</p>
<div class="samplecode"><code><font size="2"># openssl rsa -in mySplunkWebPrivateKey.key -out mySplunkWebPrivateKey.key</font></code></div>
<p>In Windows:
</p>
<div class="samplecode"><code><font size="2"> &gt;openssl rsa -in mySplunkWebPrivateKey.key -out mySplunkWebPrivateKey.key -config $SPLUNK_HOME\openssl.cnf</font></code></div>
<p>You can make sure your password is gone by issuing the following command: 
</p><p>In *nix:
</p>
<div class="samplecode"><code><font size="2"># openssl rsa -in mySplunkWebPrivateKey.key -text</font></code></div>
<p>In Windows:
</p>
<div class="samplecode"><code><font size="2"> &gt;openssl rsa -in mySplunkWebPrivateKey.key -text -config $SPLUNK_HOME\openssl.cnf</font></code></div>
<p><br>
You should be able to read the contents of your certificate without providing a password.
</p>
<h3> <a name="self-signcertificatesforsplunkweb_create_and_sign_a_server_certificate"><span class="mw-headline" id="Create_and_sign_a_server_certificate">Create and sign a server certificate</span></a></h3>
<p><b>1.</b> Create a new certificate signature request using your private key<code><font size="2">mySplunkWebPrivateKey.key</font></code>: 
</p><p>In *nix:
</p>
<div class="samplecode"><code><font size="2"># openssl req -new -key mySplunkWebPrivateKey.key -out mySplunkWebCert.csr</font></code></div>
<p>In Windows:
</p>
<div class="samplecode"><code><font size="2"> &gt;openssl req -new -key mySplunkWebPrivateKey.key -out mySplunkWebCert.csr -config $SPLUNK_HOME\openssl.cnf</font></code></div>
<p>The CSR <code><font size="2">mySplunkWebCert.csr</font></code> appears in your directory.
</p><p><b>2.</b> Self-sign the CSR with the root certificate private key <code><font size="2">myCAPrivateKey.key</font></code>: 
</p><p>In *nix:
</p>
<div class="samplecode"><code><font size="2"># openssl x509 -req -in mySplunkWebCert.csr -CA myCACertificate.pem -CAkey myCAPrivateKey.key -CAcreateserial -out mySplunkWebCert.pem -days 1095</font></code></div>
<p>In Windows:
</p>
<div class="samplecode"><code><font size="2"> &gt;openssl x509 -req -in mySplunkWebCert.csr -CA myCACertificate.pem -CAkey myCAPrivateKey.key -CAcreateserial -out mySplunkWebCert.pem -days 1095 -config $SPLUNK_HOME\openssl.cnf</font></code></div>
<p><b>3.</b> When prompted, provide the password to the root certificate private key <code><font size="2">myCAPrivateKey.key</font></code>.
</p><p>The certificate <code><font size="2">mySplunkWebCert.pem</font></code> is added to your directory. This is your server certificate.
</p>
<h3> <a name="self-signcertificatesforsplunkweb_create_a_single_pem_file"><span class="mw-headline" id="Create_a_single_PEM_file">Create a single PEM file</span></a></h3>
<p>Combine your server certificate and public certificates, in that order, into a single PEM file. 
</p><p><br></p>
<h4><font size="3"><b><i> <a name="self-signcertificatesforsplunkweb_set_up_certificate_chains"><span class="mw-headline" id="Set_up_certificate_chains">Set up certificate chains</span></a></i></b></font></h4>
<p>To use multiple certificates, append the intermediate certificate to the end of the server's certificate file in the following order:
</p>
<code><font size="2">[ server certificate]<br>[ intermediate certificate]<br>[ root certificate (if required) ]</font></code>
<p>So for example, a certificate chain might look like this:
</p>
<div class="samplecode"><code><font size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>-----BEGIN CERTIFICATE-----<br>... (certificate for your server)...<br>-----END CERTIFICATE-----<br>-----BEGIN CERTIFICATE-----<br>... (the intermediate certificate)...<br>-----END CERTIFICATE-----<br>-----BEGIN CERTIFICATE-----<br>... (the root certificate for the CA)...<br>-----END CERTIFICATE-----</font></code></div>
<h3> <a name="self-signcertificatesforsplunkweb_next_steps"><span class="mw-headline" id="Next_steps">Next steps</span></a></h3>
<p>Now that you have your certificates, you need to distribute them and configure Splunkd and Splunk Web to use them. See <a href="#securesplunkwebusingasignedcertificate" class="external text">"Secure Splunk Web with your own certificate"</a> in this manual for more information.
</p>
<a name="getthird-partycertificatesforsplunkweb"></a><h2> <a name="getthird-partycertificatesforsplunkweb_get_certificates_signed_by_a_third-party_for_splunk_web"><span class="mw-headline" id="Get_certificates_signed_by_a_third-party_for_Splunk_Web"> Get certificates signed by a third-party for Splunk Web</span></a></h2>
<p>This topic provides basic examples for creating the third-party signed certificates necessary to configure Splunk Web for SSL authentication and encryption. 
</p><p>The steps provided here are not tasks specific to Splunk. There are multiple ways you can create these certificates, depending upon your organization's policies, your network structure and the tools that you are using. If you have already generated these certificates and key, or if you are experienced with third-party certificates, you may prefer to skip this step and go directly to the configuration topic in this manual at <a href="#securesplunkwebusingasignedcertificate" class="external text">"Secure Splunk Web with your own certificate."</a>
</p>
<h3> <a name="getthird-partycertificatesforsplunkweb_before_you_begin"><span class="mw-headline" id="Before_you_begin">Before you begin</span></a></h3>
<p>In this discussion, <code><font size="2">$SPLUNK_HOME</font></code> refers to the Splunk installation directory. On Windows, Splunk is installed at <code><font size="2">C:\Program Files\splunk</font></code> by default. For most Unix platforms, the default installation directory is at <code><font size="2">/opt/splunk</font></code>; for Mac OS, it is <code><font size="2">/Applications/splunk</font></code>.  See the Administration Guide to learn more about working with Windows and *nix.
</p><p>Make sure that you are using the version of OpenSSL provided with Splunk by setting your environment to the version in  <code><font size="2">$SPLUNK_HOME/lib</font></code> in *nix or <code><font size="2">$SPLUNK_HOME/bin</font></code> in Windows.
</p>
<h3> <a name="getthird-partycertificatesforsplunkweb_create_a_new_private_key_for_splunk_web"><span class="mw-headline" id="Create_a_new_private_key_for_Splunk_Web">Create a new private key for Splunk Web</span></a></h3>
<p><b>1.</b> Create a new directory to host your own certificates and keys. In this example we will use <code><font size="2">$SPLUNK_HOME/etc/auth/mycerts</font></code>.  
</p><p>We recommend that you place your new certificates in a different directory than <code><font size="2">$SPLUNK_HOME/etc/auth/splunkweb</font></code> so that you don't overwrite the existing certificates.  This ensures that you can use the certificates that ship with Splunk for other Splunk components as necessary.
</p><p><br><b>2.</b> Generate a new private key. Our example uses a key length of 1024, but you can specify key lengths above 1024 if they are supported by your browser. For sensitive data we recommend a length of 2048 or higher when possible. 
</p>
<div class="samplecode"># openssl genrsa -des3 -out mySplunkWebPrivateKey.key 1024</div>
<p>Note that in Windows you may need to append the location of the <code><font size="2">openssl.cnf</font></code> file:
</p>
<div class="samplecode"><code><font size="2"> &gt;openssl genrsa -des3 -out mySplunkWebPrivateKey.key 1024 -config $SPLUNK_HOME\openssl.cnf</font></code></div>
<p><b>3.</b> Create a password when prompted.
</p><p>A new private key <code><font size="2">mySplunkWebPrivateKey.key</font></code> is added to your directory. You can use this key to sign your CSR.
</p><p><b>4.</b> Remove the password from the private key (Splunk Web does not support private key passwords):
</p><p>In *nix:
</p>
<div class="samplecode"># openssl rsa -in mySplunkWebPrivateKey.key -out mySplunkWebPrivateKey.key</div>
<p>In Windows:
</p>
<div class="samplecode"><code><font size="2"> &gt;openssl rsa -in mySplunkWebPrivateKey.key -text -config $SPLUNK_HOME\openssl.cnf</font></code></div>
<p>You can use to following command to make sure that your password was successfully removed:
</p><p>In *nix:
</p>
<div class="samplecode"># openssl rsa -in mySplunkWebPrivateKey.key -text</div>
<p>In Windows:
</p>
<div class="samplecode"><code><font size="2"> &gt;openssl rsa -in mySplunkWebPrivateKey.key -text -config $SPLUNK_HOME\openssl.cnf</font></code></div>
<p>You will be prompted to enter the passphrase for the original key. (to authorize the removal of the passphrase from the key) 
</p><p>If the password was successfully removed, you can view the certificate contents without providing a password.
</p>
<h3> <a name="getthird-partycertificatesforsplunkweb_create_a_certificate_authority_.28ca.29_request_and_obtain_your_server_certificate"><span class="mw-headline" id="Create_a_Certificate_Authority_.28CA.29_request_and_obtain_your_server_certificate">Create a Certificate Authority (CA) request and obtain your server certificate</span></a></h3>
<p><b>1.</b> Create a new certificate signature request using your private key <code><font size="2">mySplunkWebPrivateKey.key</font></code>:
</p><p>In *nix:
</p>
<div class="samplecode"># openssl req -new -key mySplunkWebPrivateKey.key -out mySplunkWebCert.csr</div>
<p>In Windows:
</p>
<div class="samplecode"><code><font size="2"> &gt;openssl req -new -key mySplunkWebPrivateKey.key -out mySplunkWebCert.csr -config $SPLUNK_HOME\openssl.cnf</font></code></div>
<p><b>Note for Windows platforms:</b> If you see an error similar to this:
</p>
<div class="samplecode">Unable to load config info from c:\\build-amd64-5.0.2-20130120-1800\\splunk/ssl/openssl.cnf</div>
<p>Try typing the following in your command prompt then run the <code><font size="2">openssl</font></code> command again:
</p>
<div class="samplecode">set OPENSSL_CONF=c:/Program Files/Splunk/openssl.cnf</div>
<p><b>2.</b> Use this CSR <code><font size="2">mySplunkWebCert.csr</font></code> to request a new signed certificate from your Certificate Authority (CA). The process for requesting a signed certificate varies depending on how your Certificate Authority handles a certificate signature request. Contact your CA for more information. 
</p><p><b>3.</b> Download the server certificate returned by your Certificate Authority. For this example, let's call it "<code><font size="2">mySplunkWebCert.pem</font></code>."
</p><p><b>4.</b> Download your Certificate Authority's public CA certificate. For this example, let's call it "<code><font size="2">myCAcert.pem</font></code>."
</p><p><b>5.</b> Make sure that both the server certificate and the public CA certificate are both in PEM format. If the certificates are not in PEM format, convert them using the <code><font size="2">openssl</font></code> command appropriate to your existing file type. Here's an example of a command that you can use for DER formats:
</p>
<div class="samplecode">x509 -in input.crt -inform DER -out output.crt -outform PEM/x509 -in input.crt -inform DER -out output.crt -outform PEM</div>
<p><b>6.</b> Check both certificates to make sure they have the necessary information and are not password protected.
</p>
<div class="samplecode"><code><font size="2"># openssl x509 -in myCACert.pem -text<br># openssl x509 -in mySplunkWebCert.pem -text</font></code></div>
<div class="samplecode"><code><font size="2"> &gt;openssl x509 -in myCACert.pem -text -config $SPLUNK_HOME\openssl.cnf<br>&gt;openssl x509 -in mySplunkWebCert.pem -text -config $SPLUNK_HOME\openssl.cnf</font></code></div>
<p>The issuer information for <code><font size="2">mySplunkWebCert.pem</font></code> should be the subject information for <code><font size="2">myCACert.pem</font></code> (unless you are using intermediary certificates).
</p>
<h3> <a name="getthird-partycertificatesforsplunkweb_combine_your_certificate_and_keys_into_a_single_file"><span class="mw-headline" id="Combine_your_certificate_and_keys_into_a_single_file">Combine your certificate and keys into a single file</span></a></h3>
<p>Combine your server certificate and public certificate, in that order, into a single PEM file. 
</p>
<h4><font size="3"><b><i> <a name="getthird-partycertificatesforsplunkweb_set_up_certificate_chains"><span class="mw-headline" id="Set_up_certificate_chains">Set up certificate chains</span></a></i></b></font></h4>
<p>To use multiple certificates, append the intermediate certificate to the end of the server's certificate file in the following order:
</p>
<code><font size="2">[ server certificate]<br>[ intermediate certificate]<br>[ root certificate (if required) ]</font></code>
<p>So for example, a certificate chain might look like this:
</p>
<div class="samplecode"><code><font size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>-----BEGIN CERTIFICATE-----<br>... (certificate for your server)...<br>-----END CERTIFICATE-----<br>-----BEGIN CERTIFICATE-----<br>... (the intermediate certificate)...<br>-----END CERTIFICATE-----<br>-----BEGIN CERTIFICATE-----<br>... (the root certificate for the CA)...<br>-----END CERTIFICATE-----</font></code></div>
<p>Note that the root CA that signed the intermediate certificate as well as all intermediary certificates must be in the browser certificate stores.
</p>
<h3> <a name="getthird-partycertificatesforsplunkweb_next_steps"><span class="mw-headline" id="Next_steps">Next steps</span></a></h3>
<p>Configure Splunk's Web.conf file to find and use your certificates for authentication. See
<a href="#securesplunkwebusingasignedcertificate" class="external text">"Secure Splunk Web with your own certificate"</a> for more information.
</p>
<a name="determineyourciphersuite"></a><h2> <a name="determineyourciphersuite_determine_your_cipher_suite"><span class="mw-headline" id="Determine_your_cipher_suite"> Determine your cipher suite</span></a></h2>
<p>You can select and specify a cipher suite for inter-Splunk, Splunk Web, and Splunk forwarder to indexer communications. You add your cipher suite by appending a line at the end of your server SSL configuration stanza. 
</p><p>The following is an example of how you would updated <code><font size="2">inputs.conf</font></code> when configuring forwarder to indexer certificate authentication:
</p>
<div class="samplecode"><code><font size="2"><br>[splunktcp-ssl:9998]<br>[SSL]<br>password = password<br>requireClientCert = false<br>rootCA = $SPLUNK_HOME/etc/auth/cacert.pem<br>serverCert = $SPLUNK_HOME/etc/auth/server.pem<br>cipherSuite = AES256-SHA256:DHE-RSA-AES256-SHA256<br></font></code></div>
<p>To see which ciphers are available to you:
</p>
<div class="samplecode"><code><font size="2"> $SPLUNK_HOME/bin/splunk cmd openssl ciphers -v<br>&nbsp;$SPLUNK_HOME/bin/splunk cmd openssl ciphers -v "TLSv1.2"<br>&nbsp;$SPLUNK_HOME/bin/splunk cmd openssl ciphers -v "HIGH"</font></code></div>
<p>Cipher suites are available to you based on your version of OpenSSL. To see which version of OpenSSL you are running:
</p>
<div class="samplecode"><code><font size="2"><br>&nbsp;$SPLUNK_HOME/bin/splunk cmd openssl version</font></code></div>

<h1>Secure browser to Splunk Web communication with SSL</h1><a name="aboutsecuringauthenticationtosplunkweb"></a><h2> <a name="aboutsecuringauthenticationtosplunkweb_about_securing_splunk_web"><span class="mw-headline" id="About_securing_Splunk_Web">About securing Splunk Web</span></a></h2>
<p>Information transmitted to <b>Splunk Web</b> mostly consists of search requests and results.
</p><p>Note that browser to Splunk Web transmission does not always need to be secured. For example, if your users only access Splunk Web from a local browser behind the same firewall as Splunk Web, security may not be a concern. In this case simple encryption using Splunk's default certificates might be adequate. 
</p>
<ul><li> For information about the default certificate for Splunk Web, see <a href="#turnonbasicencryptionwithsplunkweb" class="external text">"Turn on encryption (https) with Splunk Web."</a> or <a href="#turnonbasicencryptionusingweb.conf" class="external text">"Turn on encryption (https) using web.conf."</a>
</li><li> For information about SSL for forwarding with the default certificate, see <a href="#configuresplunkforwardingtousethedefaultcertificate" class="external text">"Configure Splunk forwarding to use the default certificate."</a>
</li></ul><p>To turn on basic encryption, see
<a href="#turnonbasicencryptionwithsplunkweb" class="external text">"Turn on encryption (https) with Splunk Web."</a>
</p><p>On the other hand, if your Splunk configuration lives in a distributed environment where Splunk Web is accessed from browsers outside of firewalls from varied locations, stronger security should be implemented using signed certificates. For information about configuring Splunk Web to use signed certificates, see <a href="#securesplunkwebusingasignedcertificate" class="external text">"Secure Splunk Web using your own certificate."</a>
</p><p>There are several ways you can use signed certificates to improve security for your browser to Splunk Web communications:
</p>
<ul><li> <b>For secured encryption with authentication, you can replace the default certificate with a signed certificate.</b><br>You replace the default certificate provided by Splunk with one that you request from a trusted Certificate Authority. This is the most secure option and recommended if security is a concern. <br>For more information about obtaining CA certificates for Splunk, see <a href="#getthird-partycertificatesforsplunkweb" class="external text">"Get certificates signed by a third-party for Splunk Web."</a><br>Note that you may also use self-signed certificates to secure authentication, however, because they are signed by you rather than a known and trusted Certificate Authority, browsers will not have you as a CA in their certificate store and as a result will not trust you or your certificates. For self-signed certificates to be effective you would need the ability to add your certificate to a the certificate store of every single browser that will access Splunk Web.<br>For more information about creating self-signed certificates for Splunk, see <a href="#self-signcertificatesforsplunkweb" class="external text">"Self-sign certificates for Splunk Web."</a>
</li></ul><ul><li> <b>When you use a signed certificate, you can further strengthen your SSL configuration by turning on common name checking.</b><br>Common name checking adds an extra layer of security by requiring that the common name provided in the certificates on each communicating instance are a match. You can enable common name checking when setting up your certificate and instruct Splunk to check for that common name when authenticating.
</li></ul><p>For more information about configuring Splunk to use certificates and learn more about common name checking, see <a href="#securesplunkwebusingasignedcertificate" class="external text">"Secure Splunk Web using your own certificate."</a>
</p>
<a name="turnonbasicencryptionwithsplunkweb"></a><h2> <a name="turnonbasicencryptionwithsplunkweb_turn_on_encryption_.28https.29_with_splunk_web"><span class="mw-headline" id="Turn_on_encryption_.28https.29_with_Splunk_Web"> Turn on encryption (https) with Splunk Web</span></a></h2>
<p>This topic explains how to use Splunk Web to enable HTTPS for browser to Splunk Web communication. Splunk can listen on HTTPS or HTTP, but not both.  
</p><p>The simple encryption that can be turned on in Splunk Web uses the default certificate that is provided in the "out of box" installation. Since every installation provides the same default certificate, this method is not highly secure.
If security is a priority, Splunk strongly recommends you change the default certificate and configure authentication for better security. See 
<a href="#securesplunkwebusingasignedcertificate" class="external text">"Secure Splunk Web with your own certificate"</a> for information about replacing the default certificates. 
</p><p>To enable HTTPS with Splunk Web:
</p><p><b>1.</b> In Splunk Web, select  <b>System &gt; System settings</b>.
</p><p><b>2.</b> For <b>Enable SSL (HTTPS) in Splunk Web</b>, select the <b>Yes</b> radio button.
</p><p>Splunk is already set to point to the default certificates when encryption is turned on. The following default configuration can be found in <code><font size="2">$SPLUNK_HOME/etc/auth/web.conf</font></code>: 
</p>
<div class="samplecode"><code><font size="2">[settings]<br>enableSplunkWebSSL = true<br>privKeyPath = etc/auth/splunkweb/privkey.pem<br>caCertPath = etc/auth/splunkweb/cert.pem</font></code></div>
<p><b>3.</b> Restart Splunk Web. 
</p><p>You must now prepend "https://" to the URL you use to access Splunk Web.
</p>
<a name="turnonbasicencryptionusingweb.conf"></a><h2> <a name="turnonbasicencryptionusingweb.conf_turn_on_encryption_.28https.29_using_web.conf"><span class="mw-headline" id="Turn_on_encryption_.28https.29_using_web.conf"> Turn on encryption (https) using web.conf</span></a></h2>
<p>You can enable HTTPS through the <code><font size="2">web.conf</font></code> configuration file. If it is not already present in your local directory, copy the default version of the file from <code><font size="2">$SPLUNK_HOME/etc/system/default</font></code> to your local directory <code><font size="2">$SPLUNK_HOME/etc/system/local/</font></code> or your own custom application directory in <code><font size="2">$SPLUNK_HOME/etc/apps/</font></code>. For information on configuration files in general, see "About configuration files."
</p><p>The encryption that can be turned on in the task described here is not secure. If security is a priority, Splunk strongly recommends you change the default certificate and configure authentication for better security.
See <a href="#securesplunkwebusingasignedcertificate" class="external text">"Secure Splunk Web with your own certificate"</a> for information about replacing the default certificates. 
</p><p>To enable HTTPS through <code><font size="2">web.conf</font></code>:
</p><p><b>1.</b> Set the <code><font size="2">enableSplunkWebSSL</font></code> attribute to <code><font size="2">true</font></code>:
</p>
<div class="samplecode"><code><font size="2"><br>[settings]<br>httpport = &lt;https port number&gt;<br>enableSplunkWebSSL = true<br></font></code></div>
<p><b>Note:</b> By default, Splunk is set to point to the default certificates when encryption is turned on. This configuration can be found in <code><font size="2">$SPLUNK_HOME/etc/auth/web.conf</font></code>: 
</p>
<div class="samplecode">[settings]<code><font size="2"><br>enableSplunkWebSSL = true<br>privKeyPath = etc/auth/splunkweb/privkey.pem<br>caCertPath = etc/auth/splunkweb/cert.pem</font></code></div>
<p><b>2.</b> Restart Splunk Web, as described in "Start Splunk". 
</p><p>You must now prepend "https://" to the URL you use to access Splunk Web.
</p>
<a name="securesplunkwebusingasignedcertificate"></a><h2> <a name="securesplunkwebusingasignedcertificate_secure_splunk_web_with_your_own_certificate"><span class="mw-headline" id="Secure_Splunk_Web_with_your_own_certificate"> Secure Splunk Web with your own certificate</span></a></h2>
<p>This example assumes that you have already generated self-signed certificates or purchased third-party certificates. If you have not done this and are unsure how to proceed, we've provided some simple examples:
</p>
<ul><li><a href="#self-signcertificatesforsplunkweb" class="external text">Self-sign certificates for Splunk Web.</a>
</li><li><a href="#getthird-partycertificatesforsplunkweb" class="external text">Get a certificates signed by a third-party for Splunk Web.</a>
</li></ul><p><b>Note:</b> Splunk Web does not currently support password-protected private keys. You should remove the password from your key before configuring Splunk Web for the certificate. 
</p>
<h3> <a name="securesplunkwebusingasignedcertificate_before_you_begin:_copy_your_certificates_to_a_new_folder"><span class="mw-headline" id="Before_you_begin:_Copy_your_certificates_to_a_new_folder">Before you begin: Copy your certificates to a new folder</span></a></h3>
<p>Copy the server certificate to <code><font size="2">$SPLUNK_HOME/etc/auth/splunkweb</font></code> or to your own certificate repository in <code><font size="2">$SPLUNK_HOME/etc/auth</font></code>. 
</p><p>In the following example our web certificate is  called <code><font size="2">mySplunkWebCertificate.pem</font></code> and our private key is called <code><font size="2">mySplunkWebPrivateKey.key</font></code>: 
</p><p>*nix: 
</p>
<div class="samplecode"># cp $SPLUNK_HOME/etc/auth/mycerts/mySplunkWebCertificate.pem $SPLUNK_HOME/etc/auth/mycerts/mySplunkWebPrivateKey.key $SPLUNK_HOME/etc/auth/splunkweb</div>
<p>Windows:
</p>
<div class="samplecode"><code><font size="2">copy $SPLUNK_HOME\etc\auth\mycerts\mySplunkWebCertificate.pem $SPLUNK_HOME\etc\auth\splunkweb\<br><br>copy $SPLUNK_HOME\etc\auth\mycerts\mySplunkWebPrivateKey.key $SPLUNK_HOME\etc\auth\splunkweb\</font></code></div>
<p><b>Note:</b> Do not overwrite or delete the existing certificates located in <code><font size="2">$SPLUNK_HOME/etc/auth/splunkweb/</font></code>. The certificates at this location are automatically generated upon startup, meaning that any changes you make will be overwritten at startup. Instead, in the next steps, we will rewrite the relevant configuration file to point to your new certificate location.
</p>
<h3> <a name="securesplunkwebusingasignedcertificate_configure_splunk_web_to_use_the_key_and_certificate_files"><span class="mw-headline" id="Configure_Splunk_Web_to_use_the_key_and_certificate_files">Configure Splunk Web to use the key and certificate files</span></a></h3>
<p><b>Note:</b> Splunk Web does not support passwords for private keys, so you must remove the password from the key before using the key to secure Splunk Web.
</p><p><b>1.</b> In <code><font size="2">$SPLUNK_HOME/etc/system/local/web.conf</font></code> (or any other applicable location, if you are using a deployment server), make the following changes to the <code><font size="2">[settings]</font></code> stanza: 
</p><p>The following is an example of an edited settings stanza:
</p>
<div class="samplecode"><code><font size="2">[settings]<br>enableSplunkWebSSL = true<br>privKeyPath = etc/auth/splunkweb/mySplunkWebPrivateKey.key<br>caCertPath = etc/auth/splunkweb/mySplunkWebCertificate.pem</font></code></div>
<p><b>2.</b> Restart Splunk Web: 
</p>
<div class="samplecode"># $SPLUNK_HOME/bin/splunk restart splunkweb</div>
<h4><font size="3"><b><i> <a name="securesplunkwebusingasignedcertificate_important_note_about_the_cacertpath_attribute"><span class="mw-headline" id="Important_note_about_the_caCertPath_attribute">Important note about the <code><font size="2">caCertPath</font></code> attribute</span></a></i></b></font></h4>
<p>When you use the <code><font size="2">caCertPath</font></code> attribute to specify a new default certificate, make sure that the certificate file you specify:
</p>
<ul><li> Contains at least a server SSL certificate and a certificate authority (CA) certificate.
</li><li> Contains multiple certificates in the proper sequence:
<ul><li> The server's SSL certificate.
</li><li> Any intermediate certificates, if required.
</li><li> The root certificate, if required.
</li></ul></li><li> Uses absolute paths to certificate files, for best results. While you can use relative paths, those paths are relative to <code><font size="2">$SPLUNK_HOME</font></code>, and you cannot change this setting.
</li></ul><p>The <code><font size="2">caCertPath</font></code> attribute cannot point to a file that contains only a CA certificate, because with only a CA certificate, SSL cannot properly establish a secure connection. If you specify a certificate file that only contains a CA certificate, Splunk Web over HTTPS will not work.
</p><p>For more information on how to set the <code><font size="2">caCertPath</font></code> attribute, read about web.conf in the Admin Manual.
</p>
<h3> <a name="securesplunkwebusingasignedcertificate_verify_your_configuration"><span class="mw-headline" id="Verify_your_configuration">Verify your configuration</span></a></h3>
<p>If your configuration is successful, you should be able to view your certificate using your browser tools. You will also see successful connection messages in <code><font size="2">web_service.log</font></code> (located in <code><font size="2">$SPLUNK_HOME/var/log/splunk</font></code>.
</p><p>If you are not able to verify successful connection, see <a href="#troubleshootyoursplunkwebauthentication" class="external text">"Troubleshoot your Splunk Web authentication"</a> for troubleshooting tips.
</p>
<a name="troubleshootyoursplunkwebauthentication"></a><h2> <a name="troubleshootyoursplunkwebauthentication_troubleshoot_your_splunk_web_authentication"><span class="mw-headline" id="Troubleshoot_your_Splunk_Web_authentication"> Troubleshoot your Splunk Web authentication</span></a></h2>
<p>If you are unable to verify your certificate configuration, you can use the <code><font size="2">web_service.log</font></code> in <code><font size="2">$SPLUNK_HOME/var/log/splunk</font></code> to view and troubleshoot any errors that occur upon restart. 
</p><p>Look for SSL configuration warnings. For example, if you provide an incorrect path to the server certificate declared in <code><font size="2">caCertPath</font></code>, Splunk Web fails to start and the following error appears:
</p>
<div class="samplecode">2010-12-21 16:25:02,804 ERROR [4d11455df3182e6710] root:442 - [Errno 2] No such file or directory: '/opt/splunk/share/splunk/mycerts/mySplunkWebCertificate.pem'</div>
<p><b>Note:</b> If the private key is provided in <code><font size="2">privKeyPath</font></code> is password protected, no error is provided but your browser won't load Splunk Web.
</p><p>See <a href="#self-signcertificatesforsplunkweb" class="external text">"Self-sign certificates for Splunk Web"</a> or <a href="#getthird-partycertificatesforsplunkweb" class="external text">"Get certificates signed by a third party for Splunk Web"</a> for information about removing your password.
</p>
<h1>Secure Splunk forwarder to indexer communication with SSL</h1><a name="aboutsecuringdatafromforwarders"></a><h2> <a name="aboutsecuringdatafromforwarders_about_securing_data_from_forwarders"><span class="mw-headline" id="About_securing_data_from_forwarders"> About securing data from forwarders</span></a></h2>
<p><b>Forwarders</b> send raw data to your <b>indexers</b>. This data can be vulnerable to snooping and corruption. If data is forwarded outside of a closed or co-located network, or if your data is very sensitive you should use SSL certificates to secure your data.
</p><p>Using the default certificates will discourage casual snoopers but could still leave you vulnerable because the root certificate that ships with Splunk is the same root certificate in every download, and anyone with the same root certificate can authenticate. 
The default certificates are generated and configured at startup and can be found in <code><font size="2">$SPLUNK_HOME/etc/auth/</font></code>.
</p><p><b>Important:</b> If you use the default certificates, keep in mind that they are set to expire three years after they are generated and new certificates must be created and configured at that time using one of the methods described in this manual.
</p><p>For information about setting up SSL with the default certificate, see <a href="#configuresplunkforwardingtousethedefaultcertificate" class="external text">"Configure Splunk forwarding to use the default certificate."</a>
</p><p>To ensure that no one can easily snoop on your traffic or send data to your indexers, we recommend that you use new signed certificates that are either self-signed or purchased from a third-party certificate authority. To configure your forwarders and indexers to use certificates, see <a href="#configuresplunkforwardingtousesignedcertificates" class="external text">"Configure Splunk forwarding to use your own certificates."</a>
</p><p>There are several ways you can use self or CA-signed certificates to improve security for your forwarder to indexer:
</p>
<ul><li> <b>You can replace the default certificates with certificates signed by your own root CA. </b><br>You replace the default certificate provided by Splunk with one that you generate and sign yourself. For information about generating and self-signing certificates, see <a href="#howtoself-signcertificates" class="external text">"How to self-sign certificates."</a>
</li></ul><ul><li> <b>You can replace the default certificates with certificates signed by a trusted certificate authority.</b><br>See <a href="#howtogetthird-partycertificates" class="external text">"How to get certificates signed by a third-party."</a>
</li></ul><ul><li> <b>You can further strengthen security by configuring common name checking.</b><br>Common name checking adds an extra layer of security by requiring that the common name provided in the certificates on each indexer match the common name specified in the configuration file on the forwarder. You can also configure multiple certificates with different common names and distribute them to your indexers. You enable common name checking when setting up your certificate. See <a href="#configuresplunkforwardingtousesignedcertificates" class="external text">"Configure Splunk forwarding to use your own certificates"</a> for more information.
</li></ul><a name="configuresplunkforwardingtousethedefaultcertificate"></a><h2> <a name="configuresplunkforwardingtousethedefaultcertificate_configure_splunk_forwarding_to_use_the_default_certificate"><span class="mw-headline" id="Configure_Splunk_forwarding_to_use_the_default_certificate"> Configure Splunk forwarding to use the default certificate</span></a></h2>
<p>The default root certificate that ships with Splunk is the same root certificate in every download. That means that anyone who has downloaded Splunk has server certificates that have been signed by the same root certificate and would be able to authenticate to your certificates. To ensure that no one can easily snoop on your traffic or wrongfully send data to your indexers, we recommend that you replace them with signed certificates.
</p><p><b>Important:</b> The default certificates are set to expire three years after they are generated and new certificates must be created and configured at that time using one of the methods described in this manual. 
</p><p>To configure your forwarders to use certificates signed by your own root CA or a third-party CA see <a href="#configuresplunkforwardingtousesignedcertificates" class="external text">"Configure Splunk forwarding to use your own certificates."</a>
</p><p>In this topic we describe how to:
</p>
<ul><li> Configure the indexer to use the default certificates that ship with Splunk
</li><li> Configure the forwarder to use the default certificates that ship with Splunk
</li></ul><p><b>Note:</b> When configuring multiple forwarders, configure each forwarder to use the default certificate separately. 
</p>
<h3> <a name="configuresplunkforwardingtousethedefaultcertificate_set_up_the_indexer_to_use_the_default_server_certificate"><span class="mw-headline" id="Set_up_the_indexer_to_use_the_default_server_certificate">Set up the indexer to use the default server certificate</span></a></h3>
<p>1. In <code><font size="2">$SPLUNK_HOME/etc/system/local/inputs.conf</font></code> (or the appropriate directory of any app you are using to distribute your forwarding configuration), set up the following stanzas: 
</p><p>For this example, we are using port 9997 to receive data from forwarders.
</p>
<div class="samplecode"><code><font size="2">[SSL]<br>rootCA = $SPLUNK_HOME/etc/auth/cacert.pem<br>serverCert = $SPLUNK_HOME/etc/auth/server.pem<br>password = password<br><br>[splunktcp-ssl:9997]<br>disabled=0<br></font></code></div>
<p>Where <code><font size="2">rootCA</font></code> is the path to the CA public key and <code><font size="2">serverCert</font></code> is the path to the default server certificate.
</p><p>The default certificate can be found at <code><font size="2">$SPLUNK_HOME/etc/auth/server.pem</font></code>.
</p><p><b>Note:</b> When using the default certificate it is not necessary to set <code><font size="2">requireClientCert = true</font></code> since we do not need to check the validity of the default server certificate.
</p><p>2. Restart splunkd: 
</p>
<div class="samplecode">$SPLUNK_HOME/bin/splunk restart splunkd</div>
<h3> <a name="configuresplunkforwardingtousethedefaultcertificate_configure_the_forwarder"><span class="mw-headline" id="Configure_the_forwarder">Configure the forwarder</span></a></h3>
<p>Set up your forwarder to use the same default certificates as your indexer and configure the forwarder to send data to the configured listening port.
</p><p>In the following example, the indexer IP address is 10.1.12.112.
</p><p>1. Define the following stanzas in <code><font size="2">$SPLUNK_HOME/etc/system/local/outputs.conf</font></code> (or in the appropriate directory of any app you are using to distribute your forwarding configuration): 
</p>
<div class="samplecode">[tcpout]<br>
defaultGroup = splunkssl</div>
<div class="samplecode"><code><font size="2">[tcpout:splunkssl]<br>server = 10.1.12.112:9997<br>sslVerifyServerCert = false<br>sslRootCAPath = $SPLUNK_HOME/etc/auth/cacert.pem<br>sslCertPath = $SPLUNK_HOME/etc/auth/server.pem<br>sslPassword = password</font></code></div>
<p>Where <code><font size="2">rootCA</font></code> is the path to the CA public key and <code><font size="2">serverCert</font></code> is the path to the default server certificate.
</p><p>Note again that you do not need to set <code><font size="2">sslVerifyServerCert = true</font></code>. It is not necessary to ask the forwarders to check the validity of the default server certificate.
</p><p>2. Restart splunkd: 
</p>
<div class="samplecode"># $SPLUNK_HOME/bin/splunk restart splunkd</div>
<h3> <a name="configuresplunkforwardingtousethedefaultcertificate_next_steps"><span class="mw-headline" id="Next_steps">Next steps</span></a></h3>
<p>Next, you should check your connection to make sure your configuration works. See <a href="#validateyourconfiguration" class="external text">"Validate your configuration"</a> for more information.
</p>
<a name="configuresplunkforwardingtousesignedcertificates"></a><h2> <a name="configuresplunkforwardingtousesignedcertificates_configure_splunk_forwarding_to_use_your_own_certificates"><span class="mw-headline" id="Configure_Splunk_forwarding_to_use_your_own_certificates"> Configure Splunk forwarding to use your own certificates</span></a></h2>
<p>This topic describes how to configure Splunk to send data from your forwarders to your indexers using your own SSL certificates. Using certificates to secure the data from forwarders helps ensure that your data is securely encrypted when in transit on your network. This topic describes the following steps:
</p>
<ul><li> Configure the indexer(s) to use a new signed certificate, as described in this topic.
</li><li> Configure the forwarder(s) to use a new signed certificate, as described in this topic. 
</li></ul><p>Before you begin, you must procure and prepare your certificates. Make sure your certificates are PEM files in x509 format and that your key is in RSA format. If you need help, we've provided a few simple examples to help you create and prepare your own certificates. See <a href="#configuresplunkforwardingtousesignedcertificates" class="external text">"Configure Splunk forwarding to use your own certificates"</a> and <a href="#aboutsecuringsplunktosplunkcommunication" class="external text">"About securing inter-Splunk communication"</a>  for more information. 
</p><p>You can also create multiple certificates (signed by the same CA ) with different common names and distribute those to your indexers for added security. 
</p>
<h3> <a name="configuresplunkforwardingtousesignedcertificates_configure_your_indexer_to_use_your_certificates"><span class="mw-headline" id="Configure_your_indexer_to_use_your_certificates">Configure your indexer to use your certificates</span></a></h3>
<p>1. Copy your server certificate and CA public certificate into an accessible folder on the indexer(s) you intend to configure. 
</p><p>For this example, we are calling these certificates <code><font size="2">myNewServerCertificate.pem</font></code> and <code><font size="2">myCACertificate.pem</font></code> and are placing the certificates in the following path:
</p>
<div class="samplecode"><code><font size="2">$SPLUNK_HOME/etc/auth/mycerts/</font></code></div>
<p><b>Warning:</b> If you configure inputs.conf or outputs.conf in an app directory, the password is NOT encrypted and the clear-text value remains in the file. For this reason, you may prefer to create different certificates (signed by the same root CA) to use when configuring SSL in app directories.
</p><p>2. Configure <code><font size="2">inputs.conf</font></code> on the indexer(s) to use the new server certificate. In <code><font size="2">$SPLUNK_HOME/etc/system/local/inputs.conf</font></code> (or in the appropriate directory of any app you are using to distribute your forwarding configuration), set up the [SSL] stanzas: 
</p><p>Note that this example uses port 9997 (which is the default) to receive data from the forwarders.
</p>
<div class="samplecode"><code><font size="2">[SSL]<br>rootCA = $SPLUNK_HOME/etc/auth/mycerts/myCACertificate.pem<br>serverCert = $SPLUNK_HOME/etc/auth/mycerts/myNewServerCertificate.pem<br>password = &lt;server certificate private key password&gt;<br>cipherSuite = &lt;your chosen cipher suite (optional)&gt;<br><br>[splunktcp-ssl:9997]<br>compressed = true</font></code></div>
<p>Note that when you edit the file in <code><font size="2">$SPLUNK_HOME/etc/system/local/inputs.conf</font></code>, Splunk encrypts the password and overwrites the clear-text server certificate password you provided when you restart Splunk. 
</p><p>3. Restart splunkd.
</p>
<div class="samplecode"># $SPLUNK_HOME/bin/splunk restart splunkd</div>
<h3> <a name="configuresplunkforwardingtousesignedcertificates_configure_your_forwarders_to_use_your_certificates"><span class="mw-headline" id="Configure_your_forwarders_to_use_your_certificates">Configure your forwarders to use your certificates</span></a></h3>
<p>1. Copy the server certificate (this can be your existing server certificate or a new certificate you created specifically for this forwarder. For convenience we are calling it <code><font size="2">myNewServerCertificate.pem</font></code> in this example) and the CA public certificate <code><font size="2">myCACertificate.pem</font></code> into an accessible folder on the forwarders you plan to configure. For this example, we are placing them in <code><font size="2">$SPLUNK_HOME/etc/auth/mycerts/</font></code>. 
</p><p><b>Warning:</b> If you configure inputs.conf or outputs.conf in an app directory, the password is NOT encrypted and the clear-text value remains in the file. For this reason, you may prefer to create different certificates (signed by the same root CA) to use when configuring SSL in app directories.
</p><p>2. Define the [SSL] stanza in <code><font size="2">$SPLUNK_HOME/etc/system/local/outputs.conf</font></code> (or in the appropriate directory of any app you are using to distribute your forwarding configuration): 
</p>
<div class="samplecode"><code><font size="2">[tcpout]<br>defaultGroup = splunkssl<br><br>[tcpout:splunkssl]<br>server = 10.1.12.112:9997<br>compressed = true<br>sslRootCAPath = $SPLUNK_HOME/etc/auth/mycerts/myCACertificate.pem<br>sslCertPath = $SPLUNK_HOME/etc/auth/mycerts/myNewServerCertificate.pem<br>sslPassword = default<br>sslVerifyServerCert = true</font></code></div>
<p>Note that when you save the file in <code><font size="2">$SPLUNK_HOME/etc/system/local/outputs.conf</font></code>, Splunk encrypts  and overwrites the clear-text server certificate password when splunkd restarts. 
</p><p>3. Restart splunkd. 
</p>
<div class="samplecode"># $SPLUNK_HOME/bin/splunk restart splunkd</div>
<h2> <a name="configuresplunkforwardingtousesignedcertificates_other_configuration_options"><span class="mw-headline" id="Other_configuration_options">Other configuration options</span></a></h2>
<h3> <a name="configuresplunkforwardingtousesignedcertificates_to_forward_data_to_more_than_one_indexer"><span class="mw-headline" id="To_forward_data_to_more_than_one_indexer">To forward data to more than one indexer</span></a></h3>
<p>To configure a forwarder to authenticate to multiple indexers, simply add their HOST:PORT address as a comma-separated list in the "server" configuration parameter of the target group definition stanza.
</p><p>The following example uses the same certificate for the indexer and the forwarders:
</p>
<div class="samplecode"><code><font size="2">[tcpout]<br>defaultGroup = splunkssl<br><br>[tcpout:splunkssl]<br>server = 10.1.12.112:9997,10.1.12.111:9999<br>compressed = true<br>sslRootCAPath = $SPLUNK_HOME/etc/auth/mycerts/myCACertificate.pem<br>sslCertPath = $SPLUNK_HOME/etc/certs/auth/mycerts/myNewServerCertificate.pem<br>sslPassword = &lt;your server private key password&gt;<br>sslVerifyServerCert = true</font></code></div>
<p>The following example uses the certificate <code><font size="2">myForwarderCertificate.pem</font></code>
</p>
<div class="samplecode"><code><font size="2">[tcpout]<br>defaultGroup = splunkssl<br>[tcpout:splunkssl]<br>server = 10.1.12.112:9997,10.1.12.111:9999<br>compressed = true<br>sslRootCAPath = $SPLUNK_HOME/etc/auth/mycerts/myCACertificate.pem<br>sslCertPath = $SPLUNK_HOME/etc/auth/mycerts/myForwarderCertificate.pem<br>sslPassword = &lt;your server certificate private key password&gt;<br>sslVerifyServerCert = true</font></code></div>
<h3> <a name="configuresplunkforwardingtousesignedcertificates_to_forward_data_to_multiple_indexers_using_certificates_with_different_common_names"><span class="mw-headline" id="To_forward_data_to_multiple_indexers_using_certificates_with_different_common_names">To forward data to multiple indexers using certificates with different common names</span></a></h3>
<p>You can create and configure one server certificate for each indexer by configuring the forwarder's outputs.conf with one server-specific [SSLConfig] stanza per indexer. 
</p><p>If you have created one server certificate per indexer and you have set a unique common name (CN) in each indexer certificate to be checked by the forwarders, you will need to configure one <code><font size="2">[tcpout-server://HOST:PORT]</font></code> configuration stanza per indexer in outputs.conf. This is so that you can specify which common name to check for which indexer.
</p><p>The example below shows a forwarder that will check that the indexer @10.1.12.112 displays a server certificate with CN="phobos" and that the indexer @10.1.12.113 displays a server certificate with CN="deimos". If one of those conditions is not matched, the forwarder will refuse to send data to that indexer&nbsp;:
</p>
<div class="samplecode"><code><font size="2">[tcpout]<br>defaultGroup = splunkssl<br><br>[tcpout:splunkssl]<br>server = 10.1.12.112:9997<br>compressed = true<br><br>[tcpout-server://10.1.12.112:9997]<br>sslRootCAPath = $SPLUNK_HOME/etc/certs/myCACertificate.pem<br>sslCertPath = $SPLUNK_HOME/etc/certs/myNewServerCertificate.pem<br>sslPassword = &lt;your server private key password&gt;<br>sslVerifyServerCert = true<br>sslCommonNameToCheck = phobos</font></code></div>
<p><br></p>
<div class="samplecode"><code><font size="2">[tcpout-server://10.1.12.113:9997]<br>sslRootCAPath = $SPLUNK_HOME/etc/certs/myCACertificate.pem<br>sslCertPath = $SPLUNK_HOME/etc/certs/myNewServerCertificate.pem<br>sslPassword = &lt;your server private key password&gt;<br>sslVerifyServerCert = true<br>sslCommonNameToCheck = deimos</font></code></div>
<p>This ensures that the forwarder will only send data to an indexer presenting a certificate signed by the same CA and that this certificate was issued to someone with the expected name (CN). Splunk matches the name in the Splunk configuration file ("sslCommonNameToCheck") and the common name signed into the indexer's certificate.
</p>
<h3> <a name="configuresplunkforwardingtousesignedcertificates_next_steps"><span class="mw-headline" id="Next_steps">Next steps</span></a></h3>
<p>Next, you should check your connection to make sure your configuration works. See <a href="#validateyourconfiguration" class="external text">"Validate your configuration"</a> for more information.
</p>
<a name="validateyourconfiguration"></a><h2> <a name="validateyourconfiguration_validate_your_configuration"><span class="mw-headline" id="Validate_your_configuration"> Validate your configuration</span></a></h2>
<p>Before you deploy your configuration, you can use <code><font size="2">splunkd.log</font></code> to validate and troubleshoot your configuration. Splunkd.log is located on your indexer and forwarder at <code><font size="2">$SPLUNK_HOME/var/log/splunkd.log</font></code>.
</p><p>On the indexer, look for the following or similar messages at the start-up sequence to verify a successful connection:
</p>
<div class="samplecode"><code><font size="2">02-06-2011 19:19:01.552 INFO TcpInputProc - using queueSize 1000<br>02-06-2011 19:19:01.552 INFO TcpInputProc - SSL cipherSuite=ALL:!aNULL:!eNULL:!LOW:!EXP:RC4+RSA:+HIGH:+MEDIUM<br>02-06-2011 19:19:01.552 INFO TcpInputProc - supporting SSL v2/v3<br>02-06-2011 19:19:01.555 INFO TcpInputProc - port 9997 is reserved for splunk 2 splunk (SSL)<br>02-06-2011 19:19:01.555 INFO TcpInputProc - Port 9997 is compressed<br>02-06-2011 19:19:01.556 INFO TcpInputProc - Registering metrics callback for: tcpin_connections</font></code></div>
<p>On the forwarder, look for the following or similar messages at the start-up sequence to verify a successful connection:
</p>
<div class="samplecode"><code><font size="2">02-06-2011 19:06:10.844 INFO TcpOutputProc - Retrieving configuration from properties<br>02-06-2011 19:06:10.848 INFO TcpOutputProc - found Whitelist forwardedindex.0.whitelist , RE&nbsp;: forwardedindex.0.whitelist<br>02-06-2011 19:06:10.848 INFO TcpOutputProc - found Whitelist forwardedindex.1.blacklist , RE&nbsp;: forwardedindex.1.blacklist<br>02-06-2011 19:06:10.848 INFO TcpOutputProc - found Whitelist forwardedindex.2.whitelist , RE&nbsp;: forwardedindex.2.whitelist<br>02-06-2011 19:06:10.850 INFO TcpOutputProc - Will retry at max backoff sleep forever<br>02-06-2011 19:06:10.850 INFO TcpOutputProc - Using SSL for server 10.1.12.112:9997, sslCertPath=/opt/splunk/etc/aut/server.pem<br>02-06-2011 19:06:10.854 INFO TcpOutputProc - ALL Connections will use SSL with sslCipher=<br>02-06-2011 19:06:10.859 INFO TcpOutputProc - initializing single connection with retry strategy for 10.1.12.112:9997</font></code></div>
<p><br>
For help troubleshooting your configuration issues, see <a href="#troubleshootyouforwardertoindexerauthentication" class="external text">"Troubleshoot your forwarder to indexer configuration"</a> in this manual.
</p>
<a name="troubleshootyouforwardertoindexerauthentication"></a><h2> <a name="troubleshootyouforwardertoindexerauthentication_troubleshoot_your_forwarder_to_indexer_authentication"><span class="mw-headline" id="Troubleshoot_your_forwarder_to_indexer_authentication"> Troubleshoot your forwarder to indexer authentication</span></a></h2>
<p>1. Check <code><font size="2">$SPLUNK_HOME/var/log/splunk/splunkd.log</font></code> (indexer and forwarder) for errors. On the indexer, check for the messages from the TCP input processor <code><font size="2">TcpInputProc</font></code>. On the forwarder, check the messages from the TCP output processor <code><font size="2">TcpOutputProc</font></code>. 
</p><p>2. Increase the logging level of the appropriate processors on the indexer and the forwarder in <code><font size="2">$SPLUNK_HOME/etc/log.cfg</font></code>.
</p><p>On the forwarder, set <code><font size="2">category.TcpOutputProc=DEBUG</font></code>, on the indexer set <code><font size="2">category.TcpInputProc=DEBUG</font></code>. 
</p><p>3. Restart Splunk for these to take effect and observe the start-up sequence for the pertinent component. Most configuration issues are explicitly revealed by this method. 
</p><p>4. Check the SSL configuration as it is seen by Splunk using <code><font size="2">btool</font></code>.
</p><p>On the indexer&nbsp;:
</p>
<div class="samplecode">$SPLUNK_HOME/bin/splunk cmd btool inputs list --debug</div>
<p>On the forwarder&nbsp;:
</p>
<div class="samplecode"> $SPLUNK_HOME/bin/splunk cmd btool outputs list --debug</div> 
<h4><font size="3"><b><i> <a name="troubleshootyouforwardertoindexerauthentication_common_problems"><span class="mw-headline" id="Common_problems">Common problems</span></a></i></b></font></h4>
<ul><li>The path to the server certificate file set as the value of <code><font size="2">serverCert</font></code> in inputs.conf is wrong, or the file cannot be read. This will generate the following error&nbsp;:
</li></ul><div class="samplecode">12-16-2010 16:07:30.965 ERROR SSLCommon - Can't read certificate file /opt/splunk/etc/auth/server.pem errno=33558530 error:02001002:system library:fopen:No such file or directory</div>
<ul><li>The password to the RSA private key contained in the server certificate file is wrong.
</li></ul><div class="samplecode">12-07-2010 07:56:45.663 ERROR SSLCommon - Can't read key file /opt/splunk/etc/auth/server.pem</div>
<p>On *nix, you can manually test the password of the RSA key contained in the file with the comand:
</p>
<div class="samplecode"># openssl rsa -in /opt/splunk/etc/auth/server.pem -text</div>
<p>On Windows, you can manually test the password of the RSA key using the following command:
</p>
<div class="samplecode"> &gt;openssl.exe rsa -in "c:\Program Files\Splunk\etc\auth\server.pem" -text</div>

<h1>Secure inter-splunk communication with SSL</h1><a name="aboutsecuringsplunktosplunkcommunication"></a><h2> <a name="aboutsecuringsplunktosplunkcommunication_about_securing_inter-splunk_communication"><span class="mw-headline" id="About_securing_inter-Splunk_communication"> About securing inter-Splunk communication</span></a></h2>
<p>For the purposes of this chapter, "inter-splunk communication" refers to encryption and authentication of communication that occurs over the management port. This includes things such as:
</p>
<ul><li> <b>Distributed search</b>: communication between search heads and peers.
</li><li> <b>Deployment server</b>: communication between deployment servers and clients.
</li><li> <b>Cluster configurations</b>: data and configuration information replicated between designated indexers.
</li><li> <b>Splunk Web</b>: communication between Splunk Web and <b>splunkd</b>.
</li></ul><p><br><b>Note:</b> This chapter only describes how to use SSL for communication over the management port. To turn on SSL for browser to Splunk Web communication, see <a href="#aboutsecuringauthenticationtosplunkweb" class="external text">"About securing Splunk Web."</a> To use SSL to communicate between forwarders and receivers, see <a href="#aboutsecuringdatafromforwarders" class="external text">"About securing data from forwarders."</a>
</p>
<h3> <a name="aboutsecuringsplunktosplunkcommunication_ways_to_use_ssl_to_secure_splunk_to_splunk_communication"><span class="mw-headline" id="Ways_to_use_SSL_to_secure_Splunk_to_Splunk_communication"> Ways to use SSL to secure Splunk to Splunk communication</span></a></h3>
<p>Here are some ways you can implement SSL security for inter-Splunk communications:
</p>
<ul><li> You can use SSL with the default certificates provided by Splunk.<br>This out-of-the-box setting provides you with encryption and compression. This is the recommended method for most configurations and is already turned on by default. If your SSL has been turned off, or if for any reason your system cannot find the certificates, you can use the task provided in this manual to turn on encryption and direct Splunk to your default certificates. See <a href="#securesplunktosplunkcommunicationsusingthedefaultcertificate" class="external text">"About inter-Splunk communications using the default certificate."</a>
</li></ul><ul><li> For secured authentication, you can replace the default certificate provided by Splunk with one that you sign with your own CA or purchase from a trusted Certificate Authority. This is not the recommended path for most Splunk configurations and is not usually necessary. It is considered advanced configuration and should only be attempted by an administrator that is experienced in complex SSL configurations. For more information, see the following topics:
<ul><li><a href="#typesofsplunkconfigurationsthatcanusessl" class="external text">Securing communication between Splunk Web and splunkd</a> 
</li><li><a href="#securingdistributedsearchheadsandpeers" class="external text">Securing distributed search heads and peers</a>
</li><li><a href="#securingyourdeploymentserverandclients" class="external text">Securing deployment server and clients</a>
</li><li><a href="#aboutsecuringclusters" class="external text">About securing clusters</a>
</li></ul></li></ul><a name="typesofsplunkconfigurationsthatcanusessl"></a><h2> <a name="typesofsplunkconfigurationsthatcanusessl_securing_communications_between_splunk_web_and_splunkd"><span class="mw-headline" id="Securing_communications_between_Splunk_Web_and_Splunkd">Securing communications between Splunk Web and Splunkd</span></a></h2>
<p>Splunk Web to splunkd communications consist of search requests, data results, and REST API calls. 
</p><p>SSL encryption with the default certificate is enabled out of the box. This should be adequate for most configurations, however, if your Splunk Web and splunkd instances communicate with one instance outside the firewall and your data is sensitive, you may want to use a signed certificate. You must also configure Splunk Web to present a certificate to splunkd if you have configured <code><font size="2">server.conf</font></code> to require certificates from your clients.
</p><p><br>
To configure Splunk Web to splunkd communication to use certificates:
</p><p><b>1.</b> Configure one or more certificates.
</p><p><b>2.</b> Point splunkd to your certificate files by editing <code><font size="2">server.conf</font></code>. Here's an example of an edited <code><font size="2">sslConfig</font></code> stanza:
</p>
<div class="samplecode"><code><font size="2"><br>[sslConfig]<br>enableSplunkdSSL = true<br>sslKeysfile = server.pem<br>sslKeysfilePassword = password<br>caCertFile = cacert.pem<br>caPath = $SPLUNK_HOME/etc/auth<br>cipherSuite = &lt;your chosen cipher suite (optional)&gt;</font></code></div>
<p><b>3.</b> In <code><font size="2">server.conf</font></code>, require that any HTTPS client that connects to <code><font size="2">splunkd</font></code> have a certificate signed by the Splunk certificate authority by setting <code><font size="2">requireClientCert=true</font></code> in <code><font size="2">server.conf</font></code>.
</p><p><b>Warning:</b> When <code><font size="2">requireClientCert</font></code> is turned on, splunkd will require that all clients present certificates in order to communicate and your CLI is unable to connect.  
</p><p><b>4.</b> Configure <code><font size="2">web.conf</font></code> to present the certificate that will be validated by splunkd. 
</p><p>The following is an example of an edited settings stanza:
</p>
<div class="samplecode"><code><font size="2">[settings]<br>enableSplunkWebSSL = true<br>privKeyPath = etc/auth/splunkweb/mySplunkWebPrivateKey.key<br>caCertPath = etc/auth/splunkweb/mySplunkWebCertificate.pem<br>cipherSuite = &lt;your chosen cipher suite (optional)&gt;</font></code></div>
<p>Note that there is no attribute for the password to the private key. Splunk Web does not support passwords, so you must remove the password from the key. For more information, see <a href="#getthird-partycertificatesforsplunkweb" class="external text">"Get certificates signed by a third party for Splunk Web."</a>
</p>
<a name="securingdistributedsearchheadsandpeers"></a><h2> <a name="securingdistributedsearchheadsandpeers_securing_distributed_search_heads_and_peers"><span class="mw-headline" id="Securing_distributed_search_heads_and_peers"> Securing distributed search heads and peers</span></a></h2>
<p><b>Distributed search</b> configurations share search information, knowledge objects and app and configuration information over the management port. 
</p><p>Communication between search heads and peers relies on public-key encryption. Upon startup, Splunk generates a private key and public key on your Splunk installation. When you configure distributed search on the search head, the public keys are distributed by search heads to peers and those keys are used to secure communication. This default configuration provides built-in encryption as well as data compression that improves performance. 
</p><p>It is possible to swap these generated keys out with your own keys. However, it is not recommended and considered generally unnecessary. To configure public-key encryption for distributed search setups, you create your keys and distribute them to your search heads and peers. To learn more about distributing key files to distributed search peers, look in the section on configuring distributed search in the Distributed Search manual: "Distribute the key files".
</p>
<a name="securingyourdeploymentserverandclients"></a><h2> <a name="securingyourdeploymentserverandclients_securing_deployment_server_and_clients"><span class="mw-headline" id="Securing_deployment_server_and_clients">Securing deployment server and clients</span></a></h2>
<p>Communication between the deployment server and client involve  configuration information over the management port. These components do not transmit search data. 
</p><p>SSL encryption using the default certificates, which is enabled out-of-the-box, is strongly recommended for any data communicated over the management port. Splunk's default SSL configuration provides built-in encryption as well as data compression that improves performance. See <a href="#securesplunktosplunkcommunicationsusingthedefaultcertificate" class="external text">"About inter-Splunk communications using the default values"</a> for more information.
</p><p>It's important to know that configuring certificate authentication for a deployment server and clients impacts the rest of your configuration:
</p>
<ul><li> Splunk Web will fail to authenticate unless you configure it to also use your certificate.
</li><li> The CLI will be unable to communicate with the deployment server. 
</li></ul><p>However, you may find it necessary in certain distributed configurations, perhaps where extremely sensitive server configuration data is sent to a variety of locations outside your firewall. 
</p><p>With that in mind, we've provided some guidelines for configuring SSL for Splunk to Splunk communications.
</p><p>To configure SSL certificates between search heads or peers, you should:
</p><p><b>1.</b> Create one or more certificates using the same root CA.
</p><p><b>2.</b> Distribute the certificates to your deployment server and clients.
</p><p><b>3.</b> Edit <code><font size="2">server.conf</font></code> to provide the location of your certificates:
</p>
<div class="samplecode"><code><font size="2"><br>[sslConfig]<br>enableSplunkdSSL = true<br>sslKeysfile = server.pem<br>sslKeysfilePassword = password<br>caCertFile = cacert.pem<br>caPath = $SPLUNK_HOME/etc/auth<br>cipherSuite = &lt;your chosen cipher suite (optional)&gt;</font></code></div>
<p><b>4.</b> Edit <code><font size="2">server.conf</font></code> to authenticate against your certificates:
</p>
<div class="samplecode"><code><font size="2">requireClientCert = [true|false]<br></font></code></div>
<p><b>Important:</b> This <code><font size="2">requireClientCert</font></code> is set to "false" by default. If you change it to true to force Splunk to check your client's certificates, Splunk Web and the CLI will also be checked for certificates. Your CLI connection will no longer work because your CLI is unable to present a certificate as a client.
</p><p><b>5.</b> Edit <code><font size="2">web.conf</font></code> to present a certificate signed by the same root CA so that Splunk Web can connect to the server.   
</p><p>The following is an example of an edited settings stanza:
</p>
<div class="samplecode"><code><font size="2">[settings]<br>enableSplunkWebSSL = true<br>privKeyPath = etc/auth/splunkweb/mySplunkWebPrivateKey.key<br>caCertPath = etc/auth/splunkweb/mySplunkWebCertificate.pem<br>cipherSuite = &lt;your chosen cipher suite (optional)&gt;</font></code></div>
<p><b>Note:</b> Splunk Web does not support passwords, so you must remove the password from the private key. For more information, see <a href="#getthird-partycertificatesforsplunkweb" class="external text">"Get certificates signed by a third party for Splunk Web."</a>
</p>
<a name="aboutsecuringclusters"></a><h2> <a name="aboutsecuringclusters_about_securing_clusters"><span class="mw-headline" id="About_securing_clusters"> About securing clusters</span></a></h2>
<p>Splunk provides a "shared secret" capability to help your clustering nodes authenticate to each other. When you set up a cluster, you determine the shared secret. You give each node the same secret.
</p><p>For optimal performance, Splunk recommends that you use the default SSL encryption for your inter-Splunk data communication (already turned on by default) and then leverage Splunk's built-in "shared secret" functionality. 
</p><p>For more information about setting a shared secret using Splunk Web, see "Enable the master node".
</p><p>For more information about using the shared secret in the CLI, see "Configure the cluster in server.conf" in Managing Indexers and Clusters.
</p>
<a name="securesplunktosplunkcommunicationsusingthedefaultcertificate"></a><h2> <a name="securesplunktosplunkcommunicationsusingthedefaultcertificate_about_inter-splunk_communications_using_the_default_values"><span class="mw-headline" id="About_inter-Splunk_communications_using_the_default_values"> About inter-Splunk communications using the default values </span></a></h2>
<p>When the Splunk server is turned on for the first time, the server generates a certificate for that instance. This certificate is stored in the <code><font size="2">$SPLUNK_HOME/etc/auth/</font></code> directory by default.
</p><p>When you use signed certificates, you create a new directory for them and modify server.conf to use the path to the new certificates. To return your system to using the default certificate, you simply edit <code><font size="2">server.conf</font></code> to the default settings, directing it to use the automatically generated default certificates. 
</p><p>The default settings in <code><font size="2">server.conf</font></code> for the Splunk-generated certificate are as follows:
</p>
<div class="samplecode"><code><font size="2">[sslConfig]<br>enableSplunkdSSL = true<br>sslKeysfile = server.pem<br>sslKeysfilePassword = password<br>caCertFile = cacert.pem<br>caPath = $SPLUNK_HOME/etc/auth</font></code></div>

<h1>Audit Splunk Enterprise activity</h1><a name="audityoursystemactivity"></a><h2> <a name="audityoursystemactivity_use_splunk_to_audit_your_system_activity"><span class="mw-headline" id="Use_Splunk_to_audit_your_system_activity"> Use Splunk to audit your system activity</span></a></h2>
<p>Knowing what is happening in your system is vital to keeping it secure.
</p><p>To make the most of your system and keep it secure, we recommend the following best practices: 
</p>
<ul><li> Perform a periodic review of Splunk access and audit logs.
</li><li> Perform a periodic review of Splunk server audit and security logs.
</li><li> Perform a periodic review of all Splunk users and roles.
</li></ul><a name="auditsplunkactivity"></a><h2> <a name="auditsplunkactivity_audit_splunk_activity"><span class="mw-headline" id="Audit_Splunk_activity"> Audit Splunk activity</span></a></h2>
<h3> <a name="auditsplunkactivity_what.27s_in_an_audit_event.3f"><span class="mw-headline" id="What.27s_in_an_audit_event.3F"> What's in an audit event? </span></a></h3>
<ul><li> Timestamp:  
<ul><li> date and time of the event.
</li></ul></li><li> User information:
<ul><li> the user who generated the event.  
</li><li> If the event contains no user information, Splunk sets the user to whoever is currently logged in.
</li></ul></li><li> Additional information: 
<ul><li> available event details -- what file, success/denial, etc.
</li></ul></li></ul><h3> <a name="auditsplunkactivity_activities_that_generate_audit_events"><span class="mw-headline" id="Activities_that_generate_audit_events"> Activities that generate audit events</span></a></h3>
<p>Audit events are generated from monitoring: 
</p>
<ul><li> all files in Splunk's configuration directory <code><font size="2">$SPLUNK_HOME/etc/*</font></code>
<ul><li> files are monitored for add/change/delete using the file system change monitor.
</li></ul></li><li> system start and stop.
</li><li> users logging in and out.
</li><li> adding / removing a new user.
</li><li> changing a user's information (password, role, etc).
</li><li> execution of any capability in the system.
<ul><li> capabilities are listed in authorize.conf
</li></ul></li></ul><h3> <a name="auditsplunkactivity_audit_event_storage"><span class="mw-headline" id="Audit_event_storage"> Audit event storage</span></a></h3>
<p>Splunk stores audit events locally in the audit index (<code><font size="2">index=_audit</font></code>).  Audit events are logged in the log file: <code><font size="2">$SPLUNK_HOME/var/log/splunk/audit.log</font></code>.
</p><p>If you have configured Splunk as a forwarder in a distributed setting, audit events are forwarded like any other event.  Signing can happen on the forwarder, or on the receiving Splunk instance.
</p>
<a name="searchforauditevents"></a><h2> <a name="searchforauditevents_search_for_audit_events"><span class="mw-headline" id="Search_for_audit_events"> Search for audit events</span></a></h2>
<p>Search audit events in Splunk Web or in Splunk's CLI.  To do this, pipe your searches to the audit command. The audit search command is most useful if audit event signing <i>has</i> been configured. However, if you want to search for all audit events where audit event signing <i>has not</i> been configured (or to skip integrity validation) you may search the whole audit index.
</p>
<ul><li> To search for all audit events, specify the <code><font size="2">_audit</font></code> index:
</li></ul><div class="inlineQuery splunk_search_4_3"><code><font size="2">index=_audit</font></code><br></div>
<p>This search returns all audit events.
</p>
<ul><li> Pipe your search to the audit command:
</li></ul><div class="inlineQuery splunk_search_4_3"><code><font size="2">index=_audit | audit</font></code><br></div>
<p>This search returns the entire audit index, and processes the audit events it finds through the <code><font size="2">audit</font></code> command. 
</p><p>Narrow your search before piping to the audit command.  However, you can only narrow the time range, or constrain by a single host.  This is because each host has its own ID number sequence.  Since sequential IDs exist to enable detection of gaps in audit events, narrowing a search across multiple hosts causes false gap detection.
</p><p>The field that contains the status of the event is called "validity".  Values can be:
</p>
<ul><li> VALIDATED - no gap before this event and event signature matches
</li><li> TAMPERED - event signature does not match
</li><li> NO SIGNATURE - the signature was not found
</li></ul><p>The field that contains the gap status is called "gap".  Values can be:
</p>
<ul><li> TRUE - a gap was found
</li><li> FALSE - no gap was found
</li><li> N/A - no id was found
</li></ul><h1>Password and access security with Splunk Enterprise</h1><a name="deploysecurepasswordsacrossmultipleservers"></a><h2> <a name="deploysecurepasswordsacrossmultipleservers_deploy_secure_passwords_across_multiple_servers"><span class="mw-headline" id="Deploy_secure_passwords_across_multiple_servers"> Deploy secure passwords across multiple servers</span></a></h2>
<p>At initial startup, Splunk creates a file <code><font size="2">$SPLUNK_HOME/etc/auth/splunk.secret</font></code>. This file contains a key used to encrypt some of your authentication information in configuration files:
</p>
<ul><li> <code><font size="2">web.conf</font></code>: Your SSL passwords on every instance.
</li><li> <code><font size="2">authentication.conf</font></code>: Your LDAP passwords, if you have any.
</li><li> <code><font size="2">inputs.conf</font></code>: Your SSL passwords, if you use <code><font size="2">splunktcp-ssl</font></code>.
</li><li> <code><font size="2">outputs.conf:</font></code>: Your SSL passwords, if you use <code><font size="2">splunktcp-ssl</font></code>.
</li></ul><p>When Splunk starts, if it detects a clear-text password, in one of these settings, it will create or overwrite the configuration in the equivalent local folder with the encrypted password.
</p><p>When deploying Splunk on multiple servers, you can do the following to encrypt these passwords and ensure that they are consistent across your deployment. You should perform these steps at initial deployment and also any time you need to deploy a new password for your instances:
</p><p><b>1.</b> Configure one Splunk instance and modify any passwords as necessary. (If this is a new configuration, do not start any other instances yet.)
</p><p><b>2.</b> Restart the configured instance to encrypt the passwords in the file. Password information is stored in clear text until it is encrypted at restart.
</p><p><b>3.</b> Copy the encrypted <code><font size="2">splunk.secret</font></code> file from your configured instance to all of your other instances.
</p><p><b>4.</b> Start all new instances to which you copied the file or restart existing instances if you are distributing a modified file after deployment.
</p>
<h3> <a name="deploysecurepasswordsacrossmultipleservers_to_secure_search_head_clustering"><span class="mw-headline" id="To_secure_search_head_clustering">To secure search head clustering</span></a></h3>
<p>The <code><font size="2">-secret</font></code> parameter specifies the security key that authenticates communication between the cluster members and between each member and the deployer. This parameter is optional, but if you configure it for one member, you must configure it for all. The key must be the same across all cluster members and the deployer.  See "Set a secret key for the search head cluster."<br><br><b>Important:</b>  Splunk strongly recommends that you set a secret key.
</p><p>For example:
</p>
<div class="samplecode">
<code><font size="2"><br>splunk init shcluster-config -auth admin:changed -mgmt_uri https://sh1.ajax.com:8089 -replication_port 34567 -replication_factor 2 -conf_deploy_fetch_url https://10.160.31.200:8089 -secret mykey<br><br>splunk restart <br></font></code>
</div>
<p>Once you have done this, for each instance run the <code><font size="2">splunk init shcluster-config</font></code> command and restart the instance:
</p>
<div class="samplecode">
<code><font size="2"><br>splunk init shcluster-config -auth &lt;username&gt;:&lt;password&gt; -mgmt_uri &lt;URI&gt;:&lt;management_port&gt; -replication_port &lt;replication_port&gt; -replication_factor &lt;n&gt; -conf_deploy_fetch_url &lt;URL&gt;:&lt;management_port&gt; -secret security_key<br><br>splunk restart <br></font></code>
</div>

<a name="secureyourserviceaccounts"></a><h2> <a name="secureyourserviceaccounts_secure_your_service_accounts"><span class="mw-headline" id="Secure_your_service_accounts"> Secure your service accounts</span></a></h2>
<p>Practice the principle of least privilege by running Splunk as an unprivileged user rather than using a privileged account such as root or Administrator.
</p>
<ul><li> On Unix or Linux, use the "splunk" user created with the PKG or RPM packages, or create your own user that only has privilege and ownership over <tt>$SPLUNK_HOME</tt>.
</li><li> On Windows, the local system context is often the best choice.  However, if you require communication using a windows communication channel, such as WMI, use a restricted access account.
</li></ul><a name="useaccesscontrollists"></a><h2> <a name="useaccesscontrollists_use_splunk_enterprise_access_control_lists"><span class="mw-headline" id="Use_Splunk_Enterprise_Access_Control_Lists"> Use Splunk Enterprise Access Control Lists</span></a></h2>
<p>To help secure your Splunk configuration, use the Splunk Enterprise Access Control Lists (ACLs) to limit the IP addresses that can access various parts of your networks.
</p><p>To configure ACLs, you edit <code><font size="2">server.conf</font></code> and <code><font size="2">inputs.conf</font></code> to specify the IP addresses that will be accepted or rejected for various communications. 
</p>
<h3> <a name="useaccesscontrollists_how_to_set_up_acls"><span class="mw-headline" id="How_to_set_up_ACLs">How to set up ACLs</span></a></h3>
<p>The addresses are separated by commas or spaces. You can provide the addresses in the following formats:
</p>
<ul><li> A single IPv4 or IPv6 address. For example: <code><font size="2">10.1.2.3, fe80::4a3</font></code>.
</li><li> A CIDR block of addresses. For example: <code><font size="2">10/8, fe80:1234/32</font></code>.
</li><li> A DNS name, possibly with an * used as a wildcard, for example: <code><font size="2">myhost.example.com, *.splunk.com</font></code>.
</li><li> A single <code><font size="2">*</font></code> which matches anything (this is the default value).
</li></ul><p>To add addresses that you wish to include, you add the addresses in one of the formats described below. To exclude an address you prefix the address with '!'. 
</p><p>Rules are applied in order, and the first one to match is used.  For example, <code><font size="2">!10.1/16, *</font></code> will allow connections from everywhere except the 10.1.*.* network.
</p>
<h3> <a name="useaccesscontrollists_where_to_set_up_acls"><span class="mw-headline" id="Where_to_set_up_ACLs">Where to set up ACLs</span></a></h3>
<p>You can secure IP addresses for the following connections by editing the <code><font size="2">[Accept from]</font></code> value:
</p>
<ul><li>To instruct a node to only accept replicated data from other nodes with specific IPs, edit the <code><font size="2">httpServer</font></code> stanza in <code><font size="2">server.conf</font></code>.  <br>If you set this attribute, you must make sure that you include the IP addresses of all other peers in the cluster. For more information about clusters, see "About clusters and index replication" For more information about editing server.conf, see server.conf.
</li></ul><ul><li> To restrict TCP communications to specific IP addresses, edit the <code><font size="2">tcp</font></code> stanza in <code><font size="2">inputs.conf</font></code>.  Be careful, as this will overwrite the output values in <code><font size="2">server.conf</font></code> if the information conflicts.
</li></ul><ul><li> To restrict TCP communications that use SSL to specific IP addresses, edit the <code><font size="2">tcp-ssl</font></code> stanza in <code><font size="2">inputs.conf</font></code>. 
</li></ul><ul><li> To restrict your indexer to accept data only from forwarders with specific IP addresses, edit the <code><font size="2">splunktcp</font></code> stanza in <code><font size="2">inputs.conf</font></code>. This prevents someone from spoofing your forwarders and possibly corrupting your data. 
</li></ul><ul><li> If your forwarder to indexer communications are secured with SSL, edit the <code><font size="2">splunktcp-ssl</font></code> stanza in <code><font size="2">inputs.conf</font></code> to restrict your indexer to only accept data from forwarders with specific IP addresses. 
</li></ul><ul><li> To restrict UDP communications to specific IP addresses, edit the <code><font size="2">UDP</font></code> stanza in <code><font size="2">inputs.conf</font></code>.
</li></ul><p>For more information about editing <code><font size="2">inputs.conf</font></code>, see inputs.conf
</p>
</body>
 <script src='http://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js'> </script>

        <script src="js/index.js"></script></html>
