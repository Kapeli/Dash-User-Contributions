<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.7"/>
<title>App Engine Python SDK: google.appengine.tools.devappserver2.blob_upload.Application Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="common.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="gae-python.logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">App Engine Python SDK
   &#160;<span id="projectnumber">v1.6.9 rev.445</span>
   </div>
   <div id="projectbrief">The Python runtime is available as an experimental Preview feature.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.7 -->
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><b>google</b></li><li class="navelem"><b>appengine</b></li><li class="navelem"><b>tools</b></li><li class="navelem"><b>devappserver2</b></li><li class="navelem"><b>blob_upload</b></li><li class="navelem"><a class="el" href="classgoogle_1_1appengine_1_1tools_1_1devappserver2_1_1blob__upload_1_1_application.html">Application</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classgoogle_1_1appengine_1_1tools_1_1devappserver2_1_1blob__upload_1_1_application-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">google.appengine.tools.devappserver2.blob_upload.Application Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Inheritance diagram for google.appengine.tools.devappserver2.blob_upload.Application:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classgoogle_1_1appengine_1_1tools_1_1devappserver2_1_1blob__upload_1_1_application.png" usemap="#google.appengine.tools.devappserver2.blob_upload.Application_map" alt=""/>
  <map id="google.appengine.tools.devappserver2.blob_upload.Application_map" name="google.appengine.tools.devappserver2.blob_upload.Application_map">
</map>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aaac7273f21158b2f72af5d2db19dddf4"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgoogle_1_1appengine_1_1tools_1_1devappserver2_1_1blob__upload_1_1_application.html#aaac7273f21158b2f72af5d2db19dddf4">__init__</a></td></tr>
<tr class="separator:aaac7273f21158b2f72af5d2db19dddf4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59dd59f19701f30b2affb64bf5e379eb"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgoogle_1_1appengine_1_1tools_1_1devappserver2_1_1blob__upload_1_1_application.html#a59dd59f19701f30b2affb64bf5e379eb">abort</a></td></tr>
<tr class="separator:a59dd59f19701f30b2affb64bf5e379eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f5c73feffaf6745fbbbbbd1be1d9303"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgoogle_1_1appengine_1_1tools_1_1devappserver2_1_1blob__upload_1_1_application.html#a4f5c73feffaf6745fbbbbbd1be1d9303">store_blob</a></td></tr>
<tr class="separator:a4f5c73feffaf6745fbbbbbd1be1d9303"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95248668d8137cb73135ccc1f825e892"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgoogle_1_1appengine_1_1tools_1_1devappserver2_1_1blob__upload_1_1_application.html#a95248668d8137cb73135ccc1f825e892">store_gs_file</a></td></tr>
<tr class="separator:a95248668d8137cb73135ccc1f825e892"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a995c29d8fdb9ace27a7933ad02e05632"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgoogle_1_1appengine_1_1tools_1_1devappserver2_1_1blob__upload_1_1_application.html#a995c29d8fdb9ace27a7933ad02e05632">store_and_build_forward_message</a></td></tr>
<tr class="separator:a995c29d8fdb9ace27a7933ad02e05632"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a410502d8f5dfdb10f1d7e509da1b33e3"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgoogle_1_1appengine_1_1tools_1_1devappserver2_1_1blob__upload_1_1_application.html#a410502d8f5dfdb10f1d7e509da1b33e3">store_blob_and_transform_request</a></td></tr>
<tr class="separator:a410502d8f5dfdb10f1d7e509da1b33e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23a0a68d6298d1931421a6a002aaac48"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgoogle_1_1appengine_1_1tools_1_1devappserver2_1_1blob__upload_1_1_application.html#a23a0a68d6298d1931421a6a002aaac48">__call__</a></td></tr>
<tr class="separator:a23a0a68d6298d1931421a6a002aaac48"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">A WSGI middleware application for handling blobstore upload requests.

This application will handle all uploaded files in a POST request, store the
results in the blob-storage, close the upload session and forward the request
on to another WSGI application, with the environment transformed so that the
uploaded file contents are replaced with their blob keys.
</pre> </div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="aaac7273f21158b2f72af5d2db19dddf4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def google.appengine.tools.devappserver2.blob_upload.Application.__init__ </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>forward_app</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>get_blob_storage</em> = <code>_get_blob_storage</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>generate_blob_key</em> = <code>_generate_blob_key</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>now_func</em> = <code>datetime.datetime.now</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Constructs a new Application.

Args:
  forward_app: A WSGI application to forward successful upload requests to.
  get_blob_storage: Callable that returns a BlobStorage instance. The
default is fine, but may be overridden for testing purposes.
  generate_blob_key: Function used for generating unique blob keys.
  now_func: Function that returns the current timestamp.
</pre> 
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a23a0a68d6298d1931421a6a002aaac48"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def google.appengine.tools.devappserver2.blob_upload.Application.__call__ </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>environ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>start_response</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Handles WSGI requests.

Args:
  environ: An environ dict for the current request as defined in PEP-333.
  start_response: A function with semantics defined in PEP-333.

Returns:
  An iterable over strings containing the body of the HTTP response.
</pre> 
</div>
</div>
<a class="anchor" id="a59dd59f19701f30b2affb64bf5e379eb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def google.appengine.tools.devappserver2.blob_upload.Application.abort </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>code</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>detail</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Aborts the application by raising a webob.exc.HTTPException.

Args:
  code: HTTP status code int.
  detail: Optional detail message str.

Raises:
  webob.exc.HTTPException: Always.
</pre> 
</div>
</div>
<a class="anchor" id="a995c29d8fdb9ace27a7933ad02e05632"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def google.appengine.tools.devappserver2.blob_upload.Application.store_and_build_forward_message </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>form</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>boundary</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>max_bytes_per_blob</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>max_bytes_total</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>bucket_name</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Reads form data, stores blobs data and builds the forward request.

This finds all of the file uploads in a set of form fields, converting them
into blobs and storing them in the blobstore. It also generates the HTTP
request to forward to the user's application.

Args:
  form: cgi.FieldStorage instance representing the whole form derived from
original POST data.
  boundary: The optional boundary to use for the resulting form. If omitted,
one is randomly generated.
  max_bytes_per_blob: The maximum size in bytes that any single blob
in the form is allowed to be.
  max_bytes_total: The maximum size in bytes that the total of all blobs
in the form is allowed to be.
  bucket_name: The name of the Google Storage bucket to store the uploaded
           files.

Returns:
  A tuple (content_type, content_text), where content_type is the value of
  the Content-Type header, and content_text is a string containing the body
  of the HTTP request to forward to the application.

Raises:
  webob.exc.HTTPException: The upload failed.
</pre> 
</div>
</div>
<a class="anchor" id="a4f5c73feffaf6745fbbbbbd1be1d9303"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def google.appengine.tools.devappserver2.blob_upload.Application.store_blob </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>content_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>md5_hash</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>blob_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>creation</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Store a supplied form-data item to the blobstore.

The appropriate metadata is stored into the datastore.

Args:
  content_type: The MIME content type of the uploaded file.
  filename: The filename of the uploaded file.
  md5_hash: MD5 hash of the file contents, as a hashlib hash object.
  blob_file: A file-like object containing the contents of the file.
  creation: datetime.datetime instance to associate with new blobs creation
time. This parameter is provided so that all blobs in the same upload
form can have the same creation date.

Returns:
  datastore.Entity('__BlobInfo__') associated with the upload.

Raises:
  _TooManyConflictsError if there were too many name conflicts generating a
blob key.
</pre> 
</div>
</div>
<a class="anchor" id="a410502d8f5dfdb10f1d7e509da1b33e3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def google.appengine.tools.devappserver2.blob_upload.Application.store_blob_and_transform_request </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>environ</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Stores a blob in response to a WSGI request and transforms environ.

environ is modified so that it is suitable for forwarding to the user's
application.

Args:
  environ: An environ dict for the current request as defined in PEP-333.

Raises:
  webob.exc.HTTPException: The upload failed.
</pre> 
</div>
</div>
<a class="anchor" id="a95248668d8137cb73135ccc1f825e892"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def google.appengine.tools.devappserver2.blob_upload.Application.store_gs_file </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>content_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>gs_filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>blob_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>filename</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Store a supplied form-data item to GS.

Delegate all the work of gs file creation to CloudStorageStub.

Args:
  content_type: The MIME content type of the uploaded file.
  gs_filename: The gs filename to create of format bucket/filename.
  blob_file: A file-like object containing the contents of the file.
  filename: user provided filename.

Returns:
  datastore.Entity('__GsFileInfo__') associated with the upload.
</pre> 
</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>code/googleappengine-read-only/python/google/appengine/tools/devappserver2/blob_upload.py</li>
</ul>
</div><!-- contents -->
<address class="footer">
    <small>Maintained by <a href="http://www.tzmartin.com">tzmartin</a></small>
</address>