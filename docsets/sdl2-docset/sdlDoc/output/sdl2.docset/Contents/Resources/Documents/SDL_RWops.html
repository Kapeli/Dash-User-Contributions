<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
  <head>
    <title>SDL_RWops</title>
    <script type="text/javascript" src="doc.js"></script>
  </head>
  <body>
    <div dir="ltr" id="content" lang="en"><span class="anchor" id="top"></span>
<span class="anchor" id="line-1"></span><span class="anchor" id="line-2"></span><span class="anchor" id="line-3"></span><span class="anchor" id="line-4"></span><p class="line867">
</p><h1 id="SDL_RWops-1">SDL_RWops</h1>
<span class="anchor" id="line-5"></span><p class="line874">A structure that provides an abstract interface to stream I/O. Applications can generally ignore the specifics of this structure's internals and treat them as opaque pointers. The details are important to lower-level code that might need to implement one of these, however. <span class="anchor" id="line-6"></span><span class="anchor" id="line-7"></span></p><p class="line867"></p><div class="table-of-contents"><p class="table-of-contents-heading">Contents</p><ol><li>
<a href="#SDL_RWops-1">SDL_RWops</a><ol><li>
<a href="#Data_Fields">Data Fields</a></li><li>
<a href="#Code_Examples">Code Examples</a></li><li>
<a href="#Remarks">Remarks</a><ol><li>
<a href="#Size_Function">Size Function</a></li><li>
<a href="#Seek_Function">Seek Function</a></li><li>
<a href="#Read_Function">Read Function</a></li><li>
<a href="#Write_Function">Write Function</a></li><li>
<a href="#Close_Function">Close Function</a></li><li>
<a href="#Stream_Type">Stream Type</a></li><li>
<a href="#Hidden_Union">Hidden Union</a></li></ol></li><li>
<a href="#Related_Functions">Related Functions</a></li></ol></li></ol></div><p class="line874"> <span class="anchor" id="line-8"></span><span class="anchor" id="line-9"></span></p><p class="line867">
</p><h2 id="Data_Fields">Data Fields</h2>
<span class="anchor" id="line-10"></span><div><table><tbody><tr>  <td><p class="line862">Sint64 (*)(SDL_RWops *)</p></td>
  <td><p class="line891"><strong>size</strong></p></td>
  <td><p class="line862">Callback that reports stream size; see <a href="/SDL_RWops#Size_Function">Remarks</a></p></td>
</tr>
<tr>  <td><span class="anchor" id="line-11"></span><p class="line862">Sint64 (*)(SDL_RWops *, Sint64, int)</p></td>
  <td><p class="line891"><strong>seek</strong></p></td>
  <td><p class="line862">Callback that seeks in stream; see <a href="/SDL_RWops#Seek_Function">Remarks</a></p></td>
</tr>
<tr>  <td><span class="anchor" id="line-12"></span><p class="line862">size_t (*)(SDL_RWops *, void *, size_t, size_t)</p></td>
  <td><p class="line891"><strong>read</strong></p></td>
  <td><p class="line862">Callback that reads from the stream; see <a href="/SDL_RWops#Read_Function">Remarks</a></p></td>
</tr>
<tr>  <td><span class="anchor" id="line-13"></span><p class="line862">size_t (*)(SDL_RWops *, const void *, size_t, size_t)</p></td>
  <td><p class="line891"><strong>write</strong></p></td>
  <td><p class="line862">Callback that writes to the stream; see <a href="/SDL_RWops#Write_Function">Remarks</a></p></td>
</tr>
<tr>  <td><span class="anchor" id="line-14"></span><p class="line862">int (*)(SDL_RWops *)</p></td>
  <td><p class="line891"><strong>close</strong></p></td>
  <td><p class="line862">Callback that closes the stream; see <a href="/SDL_RWops#Close_Function">Remarks</a></p></td>
</tr>
<tr>  <td><span class="anchor" id="line-15"></span><p class="line862">Uint32</p></td>
  <td><p class="line891"><strong>type</strong></p></td>
  <td><p class="line862">Type of stream; see <a href="/SDL_RWops#Stream_Type">Remarks</a></p></td>
</tr>
<tr>  <td><span class="anchor" id="line-16"></span><p class="line862">union</p></td>
  <td><p class="line891"><strong>hidden</strong></p></td>
  <td><p class="line862">Type-specific data; see <a href="/SDL_RWops#Hidden_Union">Remarks</a></p></td>
</tr>
</tbody></table></div><span class="anchor" id="line-17"></span><span class="anchor" id="line-18"></span><span class="anchor" id="line-19"></span><p class="line867">
</p><h2 id="Code_Examples">Code Examples</h2>
<span class="anchor" id="line-20"></span><p class="line867"><span class="anchor" id="line-21"></span><span class="anchor" id="line-22"></span><span class="anchor" id="line-23"></span><span class="anchor" id="line-24"></span><span class="anchor" id="line-25"></span><span class="anchor" id="line-26"></span><span class="anchor" id="line-27"></span><span class="anchor" id="line-28"></span><span class="anchor" id="line-29"></span></p><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
function isnumbered(obj) {
  return obj.childNodes.length && obj.firstChild.childNodes.length && obj.firstChild.firstChild.className == 'LineNumber';
}
function nformat(num,chrs,add) {
  var nlen = Math.max(0,chrs-(''+num).length), res = '';
  while (nlen>0) { res += ' '; nlen-- }
  return res+num+add;
}
function addnumber(did, nstart, nstep) {
  var c = document.getElementById(did), l = c.firstChild, n = 1;
  if (!isnumbered(c)) {
    if (typeof nstart == 'undefined') nstart = 1;
    if (typeof nstep  == 'undefined') nstep = 1;
    var n = nstart;
    while (l != null) {
      if (l.tagName == 'SPAN') {
        var s = document.createElement('SPAN');
        var a = document.createElement('A');
        s.className = 'LineNumber';
        a.appendChild(document.createTextNode(nformat(n,4,'')));
        a.href = '#' + did + '_' + n;
        s.appendChild(a);
        s.appendChild(document.createTextNode(' '));
        n += nstep;
        if (l.childNodes.length) {
          l.insertBefore(s, l.firstChild);
        }
        else {
          l.appendChild(s);
        }
      }
      l = l.nextSibling;
    }
  }
  return false;
}
function remnumber(did) {
  var c = document.getElementById(did), l = c.firstChild;
  if (isnumbered(c)) {
    while (l != null) {
      if (l.tagName == 'SPAN' && l.firstChild.className == 'LineNumber') l.removeChild(l.firstChild);
      l = l.nextSibling;
    }
  }
  return false;
}
function togglenumber(did, nstart, nstep) {
  var c = document.getElementById(did);
  if (isnumbered(c)) {
    remnumber(did);
  } else {
    addnumber(did,nstart,nstep);
  }
  return false;
}
</script>

<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-pygments_593\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-pygments_593" lang="en"><span class="line"><span class="n">SDL_RWops</span> <span class="o">*</span><span class="n">io</span> <span class="o">=</span> <span class="n">SDL_RWFromFile</span><span class="p">(</span><span class="s">"username.txt"</span><span class="p">,</span> <span class="s">"rb"</span><span class="p">);</span>
</span><span class="line"><span class="k">if</span> <span class="p">(</span><span class="n">io</span> <span class="o">!=</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">    <span class="kt">char</span> <span class="n">name</span><span class="p">[</span><span class="mi">256</span><span class="p">];</span>
</span><span class="line">    <span class="k">if</span> <span class="p">(</span><span class="n">io</span><span class="o">-&gt;</span><span class="n">read</span><span class="p">(</span><span class="n">io</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="k">sizeof</span> <span class="p">(</span><span class="n">name</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">        <span class="n">printf</span><span class="p">(</span><span class="s">"Hello, %s!</span><span class="se">
</span><span class="s">"</span><span class="p">,</span> <span class="n">name</span><span class="p">);</span>
</span><span class="line">    <span class="p">}</span>
</span><span class="line">    <span class="n">io</span><span class="o">-&gt;</span><span class="n">close</span><span class="p">(</span><span class="n">io</span><span class="p">);</span>
</span><span class="line"><span class="p">}</span>
</span></pre></div><span class="anchor" id="line-30"></span><span class="anchor" id="line-31"></span><span class="anchor" id="line-32"></span><p class="line867">
</p><h2 id="Remarks">Remarks</h2>
<span class="anchor" id="line-33"></span><p class="line874">SDL_RWops is an abstraction over I/O. It provides interfaces to read, write and seek data in a stream, without the caller needing to know where the data is coming from. <span class="anchor" id="line-34"></span><span class="anchor" id="line-35"></span></p><p class="line874">For example, a RWops might be fed by a memory buffer, or a file on disk, or a connection to a web server, without any changes to how the caller consumes the data. <span class="anchor" id="line-36"></span><span class="anchor" id="line-37"></span></p><p class="line874">SDL provides some internal methods for reading from common stream types, like files and memory buffers, but this structure can be used by the application or third party libraries to implement whatever type of stream it pleases. <span class="anchor" id="line-38"></span><span class="anchor" id="line-39"></span></p><p class="line874">Most of the fields of this structure are function pointers that are used as callbacks to implement the stream interface. All of them use SDLCALL calling convention. <span class="anchor" id="line-40"></span><span class="anchor" id="line-41"></span></p><p class="line874">Please note that many of these function pointers used ints in SDL 1.2; to give them a better range, they have become Sint64 in SDL 2.0. <span class="anchor" id="line-42"></span><span class="anchor" id="line-43"></span></p><p class="line862">Applications shouldn't have to care about the internals of this structure. They can treat it as an opaque data pointer and use the <a href="/SDL_RWread">SDL_RWread</a>(), <a href="/SDL_RWwrite">SDL_RWwrite</a>(), <a href="/SDL_RWseek">SDL_RWseek</a>(), <a href="/SDL_RWtell">SDL_RWtell</a>() and <a href="/SDL_RWclose">SDL_RWclose</a>() functions on them. Applications almost never create or modify these structures either, instead favoring creation functions like <a href="/SDL_RWFromFile">SDL_RWFromFile</a>(), <a href="/SDL_RWFromMem">SDL_RWFromMem</a>(), etc. <span class="anchor" id="line-44"></span><span class="anchor" id="line-45"></span></p><p class="line874">Third-party libraries and special, low-level code may need to know how to properly implement this struct, however. <span class="anchor" id="line-46"></span><span class="anchor" id="line-47"></span></p><p class="line867">
</p><h3 id="Size_Function">Size Function</h3>
<span class="anchor" id="line-48"></span><p class="line867"><strong>size</strong> is a function pointer that reports the stream's total size in bytes. If the stream size can't be determined (either because it doesn't make sense for the stream type, or there was an error), this function returns -1. <span class="anchor" id="line-49"></span><span class="anchor" id="line-50"></span></p><p class="line867">
</p><h3 id="Seek_Function">Seek Function</h3>
<span class="anchor" id="line-51"></span><p class="line867"><strong>seek</strong> is a function pointer that positions the next read/write operation in the stream. This seeks in byte offsets. If the stream can not seek (either because it doesn't make sense for the stream type, or there was an error), this function returns -1, otherwise it returns the new position. <span class="anchor" id="line-52"></span>Seeking zero bytes from RW_SEEK_CUR is a common way to determine the current stream position. <span class="anchor" id="line-53"></span><span class="anchor" id="line-54"></span></p><p class="line874">The final argument works like the standard fseek() "whence": <span class="anchor" id="line-55"></span></p><div><table><tbody><tr>  <td><p class="line862">Identifier</p></td>
  <td><p class="line862">Value</p></td>
  <td><p class="line862">Explanation</p></td>
</tr>
<tr>  <td><span class="anchor" id="line-56"></span><p class="line862">RW_SEEK_SET</p></td>
  <td><p class="line862">0</p></td>
  <td><p class="line862">Seek from the beginning of data</p></td>
</tr>
<tr>  <td><span class="anchor" id="line-57"></span><p class="line862">RW_SEEK_CUR</p></td>
  <td><p class="line862">1</p></td>
  <td><p class="line862">Seek relative to current read point</p></td>
</tr>
<tr>  <td><span class="anchor" id="line-58"></span><p class="line862">RW_SEEK_END</p></td>
  <td><p class="line862">2</p></td>
  <td><p class="line862">Seek relative to the end of data</p></td>
</tr>
</tbody></table></div><span class="anchor" id="line-59"></span><span class="anchor" id="line-60"></span><p class="line867">
</p><h3 id="Read_Function">Read Function</h3>
<span class="anchor" id="line-61"></span><p class="line867"><strong>read</strong> is a function pointer that reads from the stream. It reads up to num objects each of size bytes into the buffer pointer to by ptr. Returns the number of objects read, which may be less than requested. Returns 0 on error or EOF. <span class="anchor" id="line-62"></span><span class="anchor" id="line-63"></span></p><p class="line867">
</p><h3 id="Write_Function">Write Function</h3>
<span class="anchor" id="line-64"></span><p class="line867"><strong>write</strong> is a function pointer that writes to the stream. It writes exactly num objects each of size bytes from the buffer pointer to by ptr. Returns the number of objects written, which will be less than requested on error. <span class="anchor" id="line-65"></span><span class="anchor" id="line-66"></span></p><p class="line867">
</p><h3 id="Close_Function">Close Function</h3>
<span class="anchor" id="line-67"></span><p class="line867"><strong>close</strong> is a fucntion pointer that cleans up the stream. It should release any resources used by the stream and free the SDL_RWops itself with <a href="/SDL_FreeRW">SDL_FreeRW</a>(). This returns 0 on success, or -1 if the stream failed to flush to disk (or whereever). The SDL_RWops is no longer valid after this call, even if flushing the stream failed. <span class="anchor" id="line-68"></span><span class="anchor" id="line-69"></span></p><p class="line867">
</p><h3 id="Stream_Type">Stream Type</h3>
<span class="anchor" id="line-70"></span><span class="anchor" id="line-71"></span><p class="line862">The <strong>type</strong> field is currently one of these values. An application can usually ignore this information. <span class="anchor" id="line-72"></span><span class="anchor" id="line-73"></span></p><div><table><tbody><tr>  <td><p class="line862">Identifier</p></td>
  <td><p class="line862">Value</p></td>
  <td><p class="line862">Description</p></td>
</tr>
<tr>  <td><span class="anchor" id="line-74"></span><p class="line862">SDL_RWOPS_UNKNOWN</p></td>
  <td><p class="line862">0</p></td>
  <td><p class="line862">Unknown stream type or application-defined</p></td>
</tr>
<tr>  <td><span class="anchor" id="line-75"></span><p class="line862">SDL_RWOPS_WINFILE</p></td>
  <td><p class="line862">1</p></td>
  <td><p class="line862">Win32 file handle</p></td>
</tr>
<tr>  <td><span class="anchor" id="line-76"></span><p class="line862">SDL_RWOPS_STDFILE</p></td>
  <td><p class="line862">2</p></td>
  <td><p class="line862">stdio.h <tt class="backtick">FILE*</tt></p></td>
</tr>
<tr>  <td><span class="anchor" id="line-77"></span><p class="line862">SDL_RWOPS_JNIFILE</p></td>
  <td><p class="line862">3</p></td>
  <td><p class="line862">Android asset</p></td>
</tr>
<tr>  <td><span class="anchor" id="line-78"></span><p class="line862">SDL_RWOPS_MEMORY</p></td>
  <td><p class="line862">4</p></td>
  <td><p class="line862">Memory stream (read/write)</p></td>
</tr>
<tr>  <td><span class="anchor" id="line-79"></span><p class="line862">SDL_RWOPS_MEMORY_RO</p></td>
  <td><p class="line862">5</p></td>
  <td><p class="line862">Memory stream (read-only)</p></td>
</tr>
</tbody></table></div><span class="anchor" id="line-80"></span><span class="anchor" id="line-81"></span><p class="line874">Applications and libraries rolling their own RWops implementations should use SDL_RWOPS_UNKNOWN. All other values are currently reserved for SDL's internal use. <span class="anchor" id="line-82"></span><span class="anchor" id="line-83"></span></p><p class="line867">
</p><h3 id="Hidden_Union">Hidden Union</h3>
<span class="anchor" id="line-84"></span><span class="anchor" id="line-85"></span><p class="line862">Applications can ignore this union completely. All of the fields in this union are platform-specific and off-limits, used internally by SDL, with one exception. You may use the <strong>unknown</strong> struct to store your own RWops implementation's data, possibly cleaning it up during the <strong>close</strong> method. If your data doesn't fit in two pointers, use these pointers to hold an allocated structure that contains the real data. <span class="anchor" id="line-86"></span><span class="anchor" id="line-87"></span></p><p class="line867">
</p><h2 id="Related_Functions">Related Functions</h2>
<span class="anchor" id="line-88"></span><ul><li style="list-style-type:none"><p class="line891"><a href="/SDL_AllocRW">SDL_AllocRW</a> <span class="anchor" id="line-89"></span></p></li><li style="list-style-type:none"><p class="line891"><a href="/SDL_RWFromFile">SDL_RWFromFile</a> <span class="anchor" id="line-90"></span></p></li><li style="list-style-type:none"><p class="line891"><a href="/SDL_RWFromFP">SDL_RWFromFP</a> <span class="anchor" id="line-91"></span></p></li><li style="list-style-type:none"><p class="line891"><a href="/SDL_RWFromMem">SDL_RWFromMem</a> <span class="anchor" id="line-92"></span></p></li><li style="list-style-type:none"><p class="line891"><a href="/SDL_RWFromConstMem">SDL_RWFromConstMem</a> <span class="anchor" id="line-93"></span></p></li><li style="list-style-type:none"><p class="line891"><a href="/SDL_FreeRW">SDL_FreeRW</a> <span class="anchor" id="line-94"></span><span class="anchor" id="line-95"></span></p></li></ul><p class="line867"></p><hr><p class="line874"> <span class="anchor" id="line-96"></span><a href="/CategoryStruct"><strong class="highlight">CategoryStruct</strong></a>, <a href="/CategoryIO">CategoryIO</a> <span class="anchor" id="line-97"></span><span class="anchor" id="bottom"></span></p></div>
  </body>
</html>
