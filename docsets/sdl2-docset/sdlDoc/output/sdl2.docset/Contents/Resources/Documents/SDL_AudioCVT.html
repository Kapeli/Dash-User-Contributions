<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
  <head>
    <title>SDL_AudioCVT</title>
    <script type="text/javascript" src="doc.js"></script>
  </head>
  <body>
    <div dir="ltr" id="content" lang="en"><span class="anchor" id="top"></span>
<span class="anchor" id="line-1"></span><span class="anchor" id="line-2"></span><span class="anchor" id="line-3"></span><span class="anchor" id="line-4"></span><p class="line867">
</p><h1 id="SDL_AudioCVT-1">SDL_AudioCVT</h1>
<span class="anchor" id="line-5"></span><p class="line874">A structure that contains audio data conversion information. <span class="anchor" id="line-6"></span><span class="anchor" id="line-7"></span></p><p class="line867"></p><div class="table-of-contents"><p class="table-of-contents-heading">Contents</p><ol><li>
<a href="#SDL_AudioCVT-1">SDL_AudioCVT</a><ol><li>
<a href="#Data_Fields">Data Fields</a></li><li>
<a href="#Code_Examples">Code Examples</a></li><li>
<a href="#Remarks">Remarks</a></li><li>
<a href="#Related_Functions">Related Functions</a></li></ol></li></ol></div><p class="line874"> <span class="anchor" id="line-8"></span><span class="anchor" id="line-9"></span></p><p class="line867">
</p><h2 id="Data_Fields">Data Fields</h2>
<span class="anchor" id="line-10"></span><div><table><tbody><tr>  <td><p class="line862">int</p></td>
  <td><p class="line891"><strong>needed</strong></p></td>
  <td><p class="line862">set to 1 if conversion possible</p></td>
</tr>
<tr>  <td><span class="anchor" id="line-11"></span><p class="line891"><a href="/SDL_AudioFormat">SDL_AudioFormat</a></p></td>
  <td><p class="line891"><strong>src_format</strong></p></td>
  <td><p class="line862">source audio format</p></td>
</tr>
<tr>  <td><span class="anchor" id="line-12"></span><p class="line891"><a href="/SDL_AudioFormat">SDL_AudioFormat</a></p></td>
  <td><p class="line891"><strong>dst_format</strong></p></td>
  <td><p class="line862">target audio format</p></td>
</tr>
<tr>  <td><span class="anchor" id="line-13"></span><p class="line862">double</p></td>
  <td><p class="line891"><strong>rate_incr</strong></p></td>
  <td><p class="line862">rate conversion increment</p></td>
</tr>
<tr>  <td><span class="anchor" id="line-14"></span><p class="line862">Uint8*</p></td>
  <td><p class="line891"><strong>buf</strong></p></td>
  <td><p class="line862">the buffer to hold entire audio data; see <a href="/SDL_AudioCVT#buf">Remarks</a> for details</p></td>
</tr>
<tr>  <td><span class="anchor" id="line-15"></span><p class="line862">int</p></td>
  <td><p class="line891"><strong>len</strong></p></td>
  <td><p class="line862">length of original audio buffer; see <a href="/SDL_AudioCVT#len">Remarks</a> for details</p></td>
</tr>
<tr>  <td><span class="anchor" id="line-16"></span><p class="line862">int</p></td>
  <td><p class="line891"><strong>len_cvt</strong></p></td>
  <td><p class="line862">length of converted audio buffer</p></td>
</tr>
<tr>  <td><span class="anchor" id="line-17"></span><p class="line862">int</p></td>
  <td><p class="line891"><strong>len_mult</strong></p></td>
  <td><p class="line891"><strong>buf</strong> must be len*len_mult big; see <a href="/SDL_AudioCVT#len_mult">Remarks</a> for details</p></td>
</tr>
<tr>  <td><span class="anchor" id="line-18"></span><p class="line862">double</p></td>
  <td><p class="line891"><strong>len_ratio</strong></p></td>
  <td><p class="line862">given <strong>len</strong>, final size is len*len_ratio; see <a href="/SDL_AudioCVT#len_ratio">Remarks</a> for details</p></td>
</tr>
<tr style="color: #808080;">  <td><span class="anchor" id="line-19"></span><p class="line862">SDL_Audio<tt class="backtick"></tt>Filter[10]</p></td>
  <td><p class="line891"><strong>filters</strong></p></td>
  <td><p class="line862">filter list (internal use)</p></td>
</tr>
<tr style="color: #808080;">  <td><span class="anchor" id="line-20"></span><p class="line862">int</p></td>
  <td><p class="line891"><strong>filter_index</strong></p></td>
  <td><p class="line862">current audio conversion function (internal use)</p></td>
</tr>
</tbody></table></div><span class="anchor" id="line-21"></span><span class="anchor" id="line-22"></span><p class="line867">
</p><h2 id="Code_Examples">Code Examples</h2>
<span class="anchor" id="line-23"></span><p class="line867"><span class="anchor" id="line-24"></span><span class="anchor" id="line-25"></span><span class="anchor" id="line-26"></span><span class="anchor" id="line-27"></span><span class="anchor" id="line-28"></span><span class="anchor" id="line-29"></span><span class="anchor" id="line-30"></span><span class="anchor" id="line-31"></span><span class="anchor" id="line-32"></span><span class="anchor" id="line-33"></span></p><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
function isnumbered(obj) {
  return obj.childNodes.length && obj.firstChild.childNodes.length && obj.firstChild.firstChild.className == 'LineNumber';
}
function nformat(num,chrs,add) {
  var nlen = Math.max(0,chrs-(''+num).length), res = '';
  while (nlen>0) { res += ' '; nlen-- }
  return res+num+add;
}
function addnumber(did, nstart, nstep) {
  var c = document.getElementById(did), l = c.firstChild, n = 1;
  if (!isnumbered(c)) {
    if (typeof nstart == 'undefined') nstart = 1;
    if (typeof nstep  == 'undefined') nstep = 1;
    var n = nstart;
    while (l != null) {
      if (l.tagName == 'SPAN') {
        var s = document.createElement('SPAN');
        var a = document.createElement('A');
        s.className = 'LineNumber';
        a.appendChild(document.createTextNode(nformat(n,4,'')));
        a.href = '#' + did + '_' + n;
        s.appendChild(a);
        s.appendChild(document.createTextNode(' '));
        n += nstep;
        if (l.childNodes.length) {
          l.insertBefore(s, l.firstChild);
        }
        else {
          l.appendChild(s);
        }
      }
      l = l.nextSibling;
    }
  }
  return false;
}
function remnumber(did) {
  var c = document.getElementById(did), l = c.firstChild;
  if (isnumbered(c)) {
    while (l != null) {
      if (l.tagName == 'SPAN' && l.firstChild.className == 'LineNumber') l.removeChild(l.firstChild);
      l = l.nextSibling;
    }
  }
  return false;
}
function togglenumber(did, nstart, nstep) {
  var c = document.getElementById(did);
  if (isnumbered(c)) {
    remnumber(did);
  } else {
    addnumber(did,nstart,nstep);
  }
  return false;
}
</script>

<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-pygments_240\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-pygments_240" lang="en"><span class="line"><span class="c1">// Change 1024 stereo sample frames at 48000Hz from Float32 to Int16.</span>
</span><span class="line"><span class="n">SDL_AudioCVT</span> <span class="n">cvt</span><span class="p">;</span>
</span><span class="line"><span class="n">SDL_BuildAudioCVT</span><span class="p">(</span><span class="o">&amp;</span><span class="n">cvt</span><span class="p">,</span> <span class="n">AUDIO_F32</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">48000</span><span class="p">,</span> <span class="n">AUDIO_S16</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">48000</span><span class="p">);</span>
</span><span class="line"><span class="n">SDL_assert</span><span class="p">(</span><span class="n">cvt</span><span class="p">.</span><span class="n">needed</span><span class="p">);</span> <span class="c1">// obviously, this one is always needed.</span>
</span><span class="line"><span class="n">cvt</span><span class="p">.</span><span class="n">len</span> <span class="o">=</span> <span class="mi">1024</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="mi">4</span><span class="p">;</span>  <span class="c1">// 1024 stereo float32 sample frames.</span>
</span><span class="line"><span class="n">cvt</span><span class="p">.</span><span class="n">buf</span> <span class="o">=</span> <span class="p">(</span><span class="n">Uint8</span> <span class="o">*</span><span class="p">)</span> <span class="n">SDL_malloc</span><span class="p">(</span><span class="n">cvt</span><span class="p">.</span><span class="n">len</span> <span class="o">*</span> <span class="n">cvt</span><span class="p">.</span><span class="n">len_mult</span><span class="p">);</span>
</span><span class="line"><span class="c1">// read your float32 data into cvt.buf here.</span>
</span><span class="line"><span class="n">SDL_ConvertAudio</span><span class="p">(</span><span class="n">cvt</span><span class="p">);</span>
</span><span class="line"><span class="c1">// cvt.buf has cvt.len_cvt bytes of converted data now.</span>
</span></pre></div><span class="anchor" id="line-34"></span><span class="anchor" id="line-35"></span><p class="line867">
</p><h2 id="Remarks">Remarks</h2>
<span class="anchor" id="line-36"></span><p class="line862">The <a href="/SDL_AudioCVT">SDL_AudioCVT</a> structure is used to convert audio data between different formats. An <a href="/SDL_AudioCVT">SDL_AudioCVT</a> structure is initialized with the <a href="/SDL_BuildAudioCVT">SDL_BuildAudioCVT</a>() function, while the actual conversion is done by the <a href="/SDL_ConvertAudio">SDL_ConvertAudio</a>() function, once the application has set up appropriately-sized buffers between these two function calls. <span class="anchor" id="line-37"></span><span class="anchor" id="line-38"></span></p><p class="line867"><span class="anchor" id="buf"></span><strong>buf</strong> points to the audio data that will be used in the conversion. It is both the source and the destination, which means the converted audio data overwrites the original data. It also means that the converted data may be larger than the original data (if you were converting from 8-bit to 16-bit, for instance), so you must ensure <strong>buf</strong> is large enough for any stage of the conversion, regardless of the final converted data's size. See <strong>len_mult</strong> below for more info. <span class="anchor" id="line-39"></span><span class="anchor" id="line-40"></span></p><p class="line867"><span class="anchor" id="len"></span><strong>len</strong> is the length of the original audio data in bytes.  <span class="anchor" id="line-41"></span><span class="anchor" id="line-42"></span></p><p class="line867"><span class="anchor" id="len_mult"></span><strong>len_mult</strong> is the length multiplier for determining the size of the converted data. The audio buffer may need to be larger than either the original data or the converted data.. The allocated size of <strong>buf</strong> should be <strong>len</strong>*<strong>len_mult</strong>. <span class="anchor" id="line-43"></span><span class="anchor" id="line-44"></span></p><p class="line867"><span class="anchor" id="len_ratio"></span><strong>len_ratio</strong> is the length ratio of the converted data to the original data. When you have finished converting your audio data, you need to know how much of your audio buffer is valid. <strong>len</strong>*<strong>len_ratio</strong> is the size of the converted audio data in bytes. This is very similar to <strong>len_mult</strong>, however when the converted audio data is shorter than the original, <strong>len_mult</strong> would be 1. <strong>len_ratio</strong>, on the other hand, would be a fractional number between 0 and 1. <span class="anchor" id="line-45"></span><span class="anchor" id="line-46"></span></p><p class="line867">
</p><h2 id="Related_Functions">Related Functions</h2>
<span class="anchor" id="line-47"></span><ul><li style="list-style-type:none"><p class="line891"><a href="/SDL_BuildAudioCVT">SDL_BuildAudioCVT</a> <span class="anchor" id="line-48"></span></p></li><li style="list-style-type:none"><p class="line891"><a href="/SDL_ConvertAudio">SDL_ConvertAudio</a> <span class="anchor" id="line-49"></span><span class="anchor" id="line-50"></span></p></li></ul><p class="line867"></p><hr><p class="line874"> <span class="anchor" id="line-51"></span><a href="/CategoryStruct"><strong class="highlight">CategoryStruct</strong></a>, <a href="/CategoryAudio">CategoryAudio</a> <span class="anchor" id="line-52"></span><span class="anchor" id="bottom"></span></p></div>
  </body>
</html>
