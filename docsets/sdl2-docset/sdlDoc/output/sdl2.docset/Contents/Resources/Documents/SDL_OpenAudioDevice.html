<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
  <head>
    <title>SDL_OpenAudioDevice</title>
    <script type="text/javascript" src="doc.js"></script>
  </head>
  <body>
    <div dir="ltr" id="content" lang="en"><span class="anchor" id="top"></span>
<span class="anchor" id="line-1"></span><span class="anchor" id="line-2"></span><span class="anchor" id="line-3"></span><span class="anchor" id="line-4"></span><p class="line867">
</p><h1 id="SDL_OpenAudioDevice-1">SDL_OpenAudioDevice</h1>
<span class="anchor" id="line-5"></span><p class="line874">Use this function to open a specific audio device. <span class="anchor" id="line-6"></span><span class="anchor" id="line-7"></span></p><p class="line867"></p><div class="table-of-contents"><p class="table-of-contents-heading">Contents</p><ol><li>
<a href="#SDL_OpenAudioDevice-1">SDL_OpenAudioDevice</a><ol><li>
<a href="#Syntax">Syntax</a></li><li>
<a href="#Function_Parameters">Function Parameters</a></li><li>
<a href="#Return_Value">Return Value</a></li><li>
<a href="#Code_Examples">Code Examples</a></li><li>
<a href="#Remarks">Remarks</a></li><li>
<a href="#Related_Functions">Related Functions</a></li></ol></li></ol></div><p class="line874"> <span class="anchor" id="line-8"></span><span class="anchor" id="line-9"></span></p><p class="line867">
</p><h2 id="Syntax">Syntax</h2>
<span class="anchor" id="line-10"></span><p class="line867"><span class="anchor" id="line-11"></span><span class="anchor" id="line-12"></span><span class="anchor" id="line-13"></span><span class="anchor" id="line-14"></span><span class="anchor" id="line-15"></span><span class="anchor" id="line-16"></span></p><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
function isnumbered(obj) {
  return obj.childNodes.length && obj.firstChild.childNodes.length && obj.firstChild.firstChild.className == 'LineNumber';
}
function nformat(num,chrs,add) {
  var nlen = Math.max(0,chrs-(''+num).length), res = '';
  while (nlen>0) { res += ' '; nlen-- }
  return res+num+add;
}
function addnumber(did, nstart, nstep) {
  var c = document.getElementById(did), l = c.firstChild, n = 1;
  if (!isnumbered(c)) {
    if (typeof nstart == 'undefined') nstart = 1;
    if (typeof nstep  == 'undefined') nstep = 1;
    var n = nstart;
    while (l != null) {
      if (l.tagName == 'SPAN') {
        var s = document.createElement('SPAN');
        var a = document.createElement('A');
        s.className = 'LineNumber';
        a.appendChild(document.createTextNode(nformat(n,4,'')));
        a.href = '#' + did + '_' + n;
        s.appendChild(a);
        s.appendChild(document.createTextNode(' '));
        n += nstep;
        if (l.childNodes.length) {
          l.insertBefore(s, l.firstChild);
        }
        else {
          l.appendChild(s);
        }
      }
      l = l.nextSibling;
    }
  }
  return false;
}
function remnumber(did) {
  var c = document.getElementById(did), l = c.firstChild;
  if (isnumbered(c)) {
    while (l != null) {
      if (l.tagName == 'SPAN' && l.firstChild.className == 'LineNumber') l.removeChild(l.firstChild);
      l = l.nextSibling;
    }
  }
  return false;
}
function togglenumber(did, nstart, nstep) {
  var c = document.getElementById(did);
  if (isnumbered(c)) {
    remnumber(did);
  } else {
    addnumber(did,nstart,nstep);
  }
  return false;
}
</script>

<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-pygments_163\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-pygments_163" lang="en"><span class="line"><span class="n">SDL_AudioDeviceID</span> <span class="n">SDL_OpenAudioDevice</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span><span class="o">*</span>          <span class="n">device</span><span class="p">,</span>
</span><span class="line">                                      <span class="kt">int</span>                  <span class="n">iscapture</span><span class="p">,</span>
</span><span class="line">                                      <span class="k">const</span> <span class="n">SDL_AudioSpec</span><span class="o">*</span> <span class="n">desired</span><span class="p">,</span>
</span><span class="line">                                      <span class="n">SDL_AudioSpec</span><span class="o">*</span>       <span class="n">obtained</span><span class="p">,</span>
</span><span class="line">                                      <span class="kt">int</span>                  <span class="n">allowed_changes</span><span class="p">)</span>
</span></pre></div><span class="anchor" id="line-17"></span><span class="anchor" id="line-18"></span><p class="line867">
</p><h2 id="Function_Parameters">Function Parameters</h2>
<span class="anchor" id="line-19"></span><div><table><tbody><tr>  <td><p class="line891"><strong>device</strong></p></td>
  <td><p class="line862">a UTF-8 string reported by <a href="/SDL_GetAudioDeviceName">SDL_GetAudioDeviceName</a>(); see <a href="/SDL_OpenAudioDevice#device">Remarks</a></p></td>
</tr>
<tr>  <td><span class="anchor" id="line-20"></span><p class="line891"><strong>iscapture</strong></p></td>
  <td><p class="line862">non-zero to specify a device should be opened for recording, not playback.</p></td>
</tr>
<tr>  <td><span class="anchor" id="line-21"></span><p class="line891"><strong>desired</strong></p></td>
  <td><p class="line862">an <a href="/SDL_AudioSpec">SDL_AudioSpec</a> structure representing the desired output format; see <a href="/SDL_OpenAudio">SDL_OpenAudio</a>() for more information</p></td>
</tr>
<tr>  <td><span class="anchor" id="line-22"></span><p class="line891"><strong>obtained</strong></p></td>
  <td><p class="line862">an <a href="/SDL_AudioSpec">SDL_AudioSpec</a> structure filled in with the actual output format; see <a href="/SDL_OpenAudio">SDL_OpenAudio</a>() for more information</p></td>
</tr>
<tr>  <td><span class="anchor" id="line-23"></span><p class="line891"><strong>allowed_changes</strong></p></td>
  <td><p class="line862">0, or one or more flags OR'd together; see <a href="/SDL_OpenAudioDevice#allowed">Remarks</a> for details</p></td>
</tr>
</tbody></table></div><span class="anchor" id="line-24"></span><span class="anchor" id="line-25"></span><p class="line867">
</p><h2 id="Return_Value">Return Value</h2>
<span class="anchor" id="line-26"></span><p class="line862">Returns a valid device ID that is &gt; 0 on success or 0 on failure; call <a href="/SDL_GetError">SDL_GetError</a>() for more information.  <span class="anchor" id="line-27"></span><span class="anchor" id="line-28"></span></p><p class="line862">For compatibility with SDL 1.2, this will never return 1, since SDL reserves that ID for the legacy <a href="/SDL_OpenAudio">SDL_OpenAudio</a>() function. <span class="anchor" id="line-29"></span><span class="anchor" id="line-30"></span></p><p class="line867">
</p><h2 id="Code_Examples">Code Examples</h2>
<span class="anchor" id="line-31"></span><p class="line867"><span class="anchor" id="line-32"></span><span class="anchor" id="line-33"></span><span class="anchor" id="line-34"></span><span class="anchor" id="line-35"></span><span class="anchor" id="line-36"></span><span class="anchor" id="line-37"></span><span class="anchor" id="line-38"></span><span class="anchor" id="line-39"></span><span class="anchor" id="line-40"></span><span class="anchor" id="line-41"></span><span class="anchor" id="line-42"></span><span class="anchor" id="line-43"></span><span class="anchor" id="line-44"></span><span class="anchor" id="line-45"></span><span class="anchor" id="line-46"></span><span class="anchor" id="line-47"></span><span class="anchor" id="line-48"></span><span class="anchor" id="line-49"></span><span class="anchor" id="line-50"></span><span class="anchor" id="line-51"></span><span class="anchor" id="line-52"></span></p><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-pygments_164\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-pygments_164" lang="en"><span class="line"><span class="n">SDL_AudioSpec</span> <span class="n">want</span><span class="p">,</span> <span class="n">have</span><span class="p">;</span>
</span><span class="line"><span class="n">SDL_AudioDeviceID</span> <span class="n">dev</span><span class="p">;</span>
</span><span class="line">
</span><span class="line"><span class="n">SDL_zero</span><span class="p">(</span><span class="n">want</span><span class="p">);</span>
</span><span class="line"><span class="n">want</span><span class="p">.</span><span class="n">freq</span> <span class="o">=</span> <span class="mi">48000</span><span class="p">;</span>
</span><span class="line"><span class="n">want</span><span class="p">.</span><span class="n">format</span> <span class="o">=</span> <span class="n">AUDIO_F32</span><span class="p">;</span>
</span><span class="line"><span class="n">want</span><span class="p">.</span><span class="n">channels</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
</span><span class="line"><span class="n">want</span><span class="p">.</span><span class="n">samples</span> <span class="o">=</span> <span class="mi">4096</span><span class="p">;</span>
</span><span class="line"><span class="n">want</span><span class="p">.</span><span class="n">callback</span> <span class="o">=</span> <span class="n">MyAudioCallback</span><span class="p">;</span>  <span class="c1">// you wrote this function elsewhere.</span>
</span><span class="line">
</span><span class="line"><span class="n">dev</span> <span class="o">=</span> <span class="n">SDL_OpenAudioDevice</span><span class="p">(</span><span class="nb">NULL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">want</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">have</span><span class="p">,</span> <span class="n">SDL_AUDIO_ALLOW_FORMAT_CHANGE</span><span class="p">);</span>
</span><span class="line"><span class="k">if</span> <span class="p">(</span><span class="n">dev</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">    <span class="n">printf</span><span class="p">(</span><span class="s">"Failed to open audio: %s</span><span class="se">
</span><span class="s">"</span><span class="p">,</span> <span class="n">SDL_GetError</span><span class="p">());</span>
</span><span class="line"><span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class="line">    <span class="k">if</span> <span class="p">(</span><span class="n">have</span><span class="p">.</span><span class="n">format</span> <span class="o">!=</span> <span class="n">want</span><span class="p">.</span><span class="n">format</span><span class="p">)</span>  <span class="c1">// we let this one thing change.</span>
</span><span class="line">        <span class="n">printf</span><span class="p">(</span><span class="s">"We didn't get Float32 audio format.</span><span class="se">
</span><span class="s">"</span><span class="p">);</span>
</span><span class="line">    <span class="n">SDL_PauseAudioDevice</span><span class="p">(</span><span class="n">dev</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>  <span class="c1">// start audio playing.</span>
</span><span class="line">    <span class="n">SDL_Delay</span><span class="p">(</span><span class="mi">5000</span><span class="p">);</span>  <span class="c1">// let the audio callback play some sound for 5 seconds.</span>
</span><span class="line">    <span class="n">SDL_CloseAudioDevice</span><span class="p">(</span><span class="n">dev</span><span class="p">);</span>
</span><span class="line"><span class="p">}</span>
</span></pre></div><span class="anchor" id="line-53"></span><span class="anchor" id="line-54"></span><p class="line867">
</p><h2 id="Remarks">Remarks</h2>
<span class="anchor" id="line-55"></span><p class="line867"><a href="/SDL_OpenAudio">SDL_OpenAudio</a>(), unlike this function, always acts on device ID 1. As such, this function will never return a 1 so as not to conflict with the legacy function. <span class="anchor" id="line-56"></span><span class="anchor" id="line-57"></span></p><p class="line862">Please note that SDL 2.0 does not support recording yet; as such, this function will fail if <strong>iscapture</strong> is not zero. In the future, when recording is implemented, this value can be non-zero. <span class="anchor" id="line-58"></span><span class="anchor" id="line-59"></span></p><p class="line867"><span class="anchor" id="device"></span> Passing in a <strong>device</strong> name of NULL requests the most reasonable default (and is equivalent to what <a href="/SDL_OpenAudio">SDL_OpenAudio</a>() does to choose a device). <span class="anchor" id="line-60"></span>The <strong>device</strong> name is a UTF-8 string reported by <a href="/SDL_GetAudioDeviceName">SDL_GetAudioDeviceName</a>(), but some drivers allow arbitrary and driver-specific strings, such as a hostname/IP address for a remote audio server, or a filename in the diskaudio driver. <span class="anchor" id="line-61"></span><span class="anchor" id="line-62"></span></p><p class="line867"><span class="anchor" id="allowed"></span> <strong>allowed_changes</strong> can have the following flags OR'd together: <span class="anchor" id="line-63"></span></p><div><table><tbody><tr>  <td><p class="line862">SDL_AUDIO_ALLOW_FREQUENCY_CHANGE</p></td>
</tr>
<tr>  <td><span class="anchor" id="line-64"></span><p class="line862">SDL_AUDIO_ALLOW_FORMAT_CHANGE</p></td>
</tr>
<tr>  <td><span class="anchor" id="line-65"></span><p class="line862">SDL_AUDIO_ALLOW_CHANNELS_CHANGE</p></td>
</tr>
<tr>  <td><span class="anchor" id="line-66"></span><p class="line862">SDL_AUDIO_ALLOW_ANY_CHANGE</p></td>
</tr>
</tbody></table></div><span class="anchor" id="line-67"></span><span class="anchor" id="line-68"></span><p class="line874">These flags specify how SDL should behave when a device cannot offer a specific feature. If the application requests a feature that the hardware doesn't offer, SDL will always try to get the closest equivalent. <span class="anchor" id="line-69"></span><span class="anchor" id="line-70"></span></p><p class="line862">For example, if you ask for float32 audio format, but the sound card only supports int16, SDL will set the hardware to int16. If you had set SDL_AUDIO_ALLOW_FORMAT_CHANGE, SDL will change the format in the <strong>obtained</strong> structure. If that flag was <em>not</em> set, SDL will prepare to convert your callback's float32 audio to int16 before feeding it to the hardware and will keep the originally requested format in the <strong>obtained</strong> structure. <span class="anchor" id="line-71"></span><span class="anchor" id="line-72"></span></p><p class="line862">If your application can only handle one specific data format, pass a zero for <strong>allowed_changes</strong> and let SDL transparently handle any differences. <span class="anchor" id="line-73"></span><span class="anchor" id="line-74"></span></p><p class="line862">An opened audio device starts out paused, and should be enabled for playing by calling <a href="/SDL_PauseAudioDevice">SDL_PauseAudioDevice</a>(devid, 0) when you are ready for your audio callback function to be called.  Since the audio driver may modify the requested size of the audio buffer, you should allocate any local mixing buffers after you open the audio device. <span class="anchor" id="line-75"></span><span class="anchor" id="line-76"></span></p><p class="line862">The audio callback runs in a separate thread in most cases; you can prevent race conditions between your callback and other threads without fully pausing playback with <a href="/SDL_LockAudioDevice">SDL_LockAudioDevice</a>(). <span class="anchor" id="line-77"></span><span class="anchor" id="line-78"></span><span class="anchor" id="line-79"></span></p><p class="line867">
</p><h2 id="Related_Functions">Related Functions</h2>
<span class="anchor" id="line-80"></span><ul><li style="list-style-type:none"><p class="line891"><a href="/SDL_CloseAudioDevice">SDL_CloseAudioDevice</a> <span class="anchor" id="line-81"></span></p></li><li style="list-style-type:none"><p class="line891"><a href="/SDL_GetAudioDeviceName">SDL_GetAudioDeviceName</a> <span class="anchor" id="line-82"></span></p></li><li style="list-style-type:none"><p class="line891"><a href="/SDL_LockAudioDevice">SDL_LockAudioDevice</a> <span class="anchor" id="line-83"></span></p></li><li style="list-style-type:none"><p class="line891"><a href="/SDL_OpenAudio">SDL_OpenAudio</a> <span class="anchor" id="line-84"></span></p></li><li style="list-style-type:none"><p class="line891"><a href="/SDL_PauseAudioDevice">SDL_PauseAudioDevice</a> <span class="anchor" id="line-85"></span></p></li><li style="list-style-type:none"><p class="line891"><a href="/SDL_UnlockAudioDevice">SDL_UnlockAudioDevice</a> <span class="anchor" id="line-86"></span><span class="anchor" id="line-87"></span></p></li></ul><p class="line867"></p><hr><p class="line874"> <span class="anchor" id="line-88"></span><a href="/CategoryAPI"><strong class="highlight">CategoryAPI</strong></a>, <a href="/CategoryAudio">CategoryAudio</a> <span class="anchor" id="line-89"></span><span class="anchor" id="bottom"></span></p></div>
  </body>
</html>
