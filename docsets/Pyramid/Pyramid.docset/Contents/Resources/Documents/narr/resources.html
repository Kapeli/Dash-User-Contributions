<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Resources &mdash; The Pyramid Web Framework v1.5</title>
    
    <link rel="stylesheet" href="../_static/pylons.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.5',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="copyright" title="Copyright" href="../copyright.html" />
    <link rel="top" title="The Pyramid Web Framework v1.5" href="../index.html" />
    <link rel="next" title="Hello Traversal World" href="hellotraversal.html" />
    <link rel="prev" title="Unit, Integration, and Functional Testing" href="testing.html" />
<link rel="stylesheet" href="http://static.pylonsproject.org/fonts/nobile/stylesheet.css" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="http://static.pylonsproject.org/fonts/neuton/stylesheet.css" type="text/css" media="screen" charset="utf-8" />
<!--[if lte IE 6]>
<link rel="stylesheet" href="../_static/ie6.css" type="text/css" media="screen" charset="utf-8" />
<![endif]-->
<link rel="shortcut icon" href="../_static/pyramid.ico"/>

  </head>
  <body>







<div class="header-small">
	
	<div class="logo-small">
		<a href="../index.html">
      		<img class="logo" src="../_static/pyramid-small.png" alt="Logo"/>
		</a>
  	</div>
</div>

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="hellotraversal.html" title="Hello Traversal World"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="testing.html" title="Unit, Integration, and Functional Testing"
             accesskey="P">previous</a> |</li>
    	<li><a href="../index.html">The Pyramid Web Framework v1.5</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="resources">
<span id="resources-chapter"></span><h1>Resources<a class="headerlink" href="#resources" title="Permalink to this headline">¶</a></h1>
<p>A <a class="reference internal" href="../glossary.html#term-resource"><em class="xref std std-term">resource</em></a> is an object that represents a &quot;place&quot; in a tree
related to your application.  Every <span>Pyramid</span> application has at
least one resource object: the <a class="reference internal" href="../glossary.html#term-root"><em class="xref std std-term">root</em></a> resource.  Even if you don't
define a root resource manually, a default one is created for you.  The
root resource is the root of a <a class="reference internal" href="../glossary.html#term-resource-tree"><em class="xref std std-term">resource tree</em></a>.  A resource tree
is a set of nested dictionary-like objects which you can use to
represent your website's structure.</p>
<p>In an application which uses <a class="reference internal" href="../glossary.html#term-traversal"><em class="xref std std-term">traversal</em></a> to map URLs to code, the
resource tree structure is used heavily to map each URL to a <a class="reference internal" href="../glossary.html#term-view-callable"><em class="xref std std-term">view
callable</em></a>.  When <a class="reference internal" href="../glossary.html#term-traversal"><em class="xref std std-term">traversal</em></a> is used, <span>Pyramid</span> will walk
through the resource tree by traversing through its nested dictionary
structure in order to find a <a class="reference internal" href="../glossary.html#term-context"><em class="xref std std-term">context</em></a> resource.  Once a context
resource is found, the context resource and data in the request will be
used to find a <a class="reference internal" href="../glossary.html#term-view-callable"><em class="xref std std-term">view callable</em></a>.</p>
<p>In an application which uses <a class="reference internal" href="../glossary.html#term-url-dispatch"><em class="xref std std-term">URL dispatch</em></a>, the resource tree is only
used indirectly, and is often &quot;invisible&quot; to the developer.  In URL dispatch
applications, the resource &quot;tree&quot; is often composed of only the root resource
by itself.  This root resource sometimes has security declarations attached
to it, but is not required to have any.  In general, the resource tree is
much less important in applications that use URL dispatch than applications
that use traversal.</p>
<p>In &quot;Zope-like&quot; <span>Pyramid</span> applications, resource objects also often store
data persistently, and offer methods related to mutating that persistent data.
In these kinds of applications, resources not only represent the site
structure of your website, but they become the <a class="reference internal" href="../glossary.html#term-domain-model"><em class="xref std std-term">domain model</em></a> of the
application.</p>
<p>Also:</p>
<ul class="simple">
<li>The <tt class="docutils literal"><span class="pre">context</span></tt> and <tt class="docutils literal"><span class="pre">containment</span></tt> predicate arguments to
<a class="reference internal" href="../api/config.html#pyramid.config.Configurator.add_view" title="pyramid.config.Configurator.add_view"><tt class="xref py py-meth docutils literal"><span class="pre">add_view()</span></tt></a> (or a
<a class="reference internal" href="../api/view.html#pyramid.view.view_config" title="pyramid.view.view_config"><tt class="xref py py-func docutils literal"><span class="pre">view_config()</span></tt></a> decorator) reference a resource class
or resource <a class="reference internal" href="../glossary.html#term-interface"><em class="xref std std-term">interface</em></a>.</li>
<li>A <a class="reference internal" href="../glossary.html#term-root-factory"><em class="xref std std-term">root factory</em></a> returns a resource.</li>
<li>A resource is exposed to <a class="reference internal" href="../glossary.html#term-view"><em class="xref std std-term">view</em></a> code as the <a class="reference internal" href="../glossary.html#term-context"><em class="xref std std-term">context</em></a> of a
view.</li>
<li>Various helpful <span>Pyramid</span> API methods expect a resource as an argument
(e.g. <a class="reference internal" href="../api/request.html#pyramid.request.Request.resource_url" title="pyramid.request.Request.resource_url"><tt class="xref py py-meth docutils literal"><span class="pre">resource_url()</span></tt></a> and others).</li>
</ul>
<div class="section" id="defining-a-resource-tree">
<span id="index-0"></span><h2>Defining a Resource Tree<a class="headerlink" href="#defining-a-resource-tree" title="Permalink to this headline">¶</a></h2>
<p>When <a class="reference internal" href="../glossary.html#term-traversal"><em class="xref std std-term">traversal</em></a> is used (as opposed to a purely <a class="reference internal" href="../glossary.html#term-url-dispatch"><em class="xref std std-term">url dispatch</em></a>
based application), <span>Pyramid</span> expects to be able to traverse a tree
composed of resources (the <a class="reference internal" href="../glossary.html#term-resource-tree"><em class="xref std std-term">resource tree</em></a>).  Traversal begins at a
root resource, and descends into the tree recursively, trying each resource's
<tt class="docutils literal"><span class="pre">__getitem__</span></tt> method to resolve a path segment to another resource object.
<span>Pyramid</span> imposes the following policy on resource instances in the
tree:</p>
<ul class="simple">
<li>A container resource (a resource which contains other resources) must
supply a <tt class="docutils literal"><span class="pre">__getitem__</span></tt> method which is willing to resolve a unicode name
to a sub-resource.  If a sub-resource by a particular name does not exist
in a container resource, <tt class="docutils literal"><span class="pre">__getitem__</span></tt> method of the container resource
must raise a <a class="reference external" href="http://docs.python.org/3/library/exceptions.html#KeyError" title="(in Python v3.4)"><tt class="xref py py-exc docutils literal"><span class="pre">KeyError</span></tt></a>.  If a sub-resource by that name <em>does</em> exist,
the container's <tt class="docutils literal"><span class="pre">__getitem__</span></tt> should return the sub-resource.</li>
<li>Leaf resources, which do not contain other resources, must not implement a
<tt class="docutils literal"><span class="pre">__getitem__</span></tt>, or if they do, their <tt class="docutils literal"><span class="pre">__getitem__</span></tt> method must always
raise a <a class="reference external" href="http://docs.python.org/3/library/exceptions.html#KeyError" title="(in Python v3.4)"><tt class="xref py py-exc docutils literal"><span class="pre">KeyError</span></tt></a>.</li>
</ul>
<p>See <a class="reference internal" href="traversal.html#traversal-chapter"><em>Traversal</em></a> for more information about how traversal
works against resource instances.</p>
<p>Here's a sample resource tree, represented by a variable named <tt class="docutils literal"><span class="pre">root</span></tt>:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Resource</span><span class="p">(</span><span class="nb">dict</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="n">root</span> <span class="o">=</span> <span class="n">Resource</span><span class="p">({</span><span class="s">&#39;a&#39;</span><span class="p">:</span><span class="n">Resource</span><span class="p">({</span><span class="s">&#39;b&#39;</span><span class="p">:</span><span class="n">Resource</span><span class="p">({</span><span class="s">&#39;c&#39;</span><span class="p">:</span><span class="n">Resource</span><span class="p">()})})})</span>
</pre></div>
</td></tr></table></div>
<p>The resource tree we've created above is represented by a dictionary-like
root object which has a single child named <tt class="docutils literal"><span class="pre">'a'</span></tt>.  <tt class="docutils literal"><span class="pre">'a'</span></tt> has a single child
named <tt class="docutils literal"><span class="pre">'b'</span></tt>, and <tt class="docutils literal"><span class="pre">'b'</span></tt> has a single child named <tt class="docutils literal"><span class="pre">'c'</span></tt>, which has no
children. It is therefore possible to access the <tt class="docutils literal"><span class="pre">'c'</span></tt> leaf resource like so:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span class="n">root</span><span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">][</span><span class="s">&#39;b&#39;</span><span class="p">][</span><span class="s">&#39;c&#39;</span><span class="p">]</span>
</pre></div>
</td></tr></table></div>
<p>If you returned the above <tt class="docutils literal"><span class="pre">root</span></tt> object from a <a class="reference internal" href="../glossary.html#term-root-factory"><em class="xref std std-term">root factory</em></a>, the
path <tt class="docutils literal"><span class="pre">/a/b/c</span></tt> would find the <tt class="docutils literal"><span class="pre">'c'</span></tt> object in the resource tree as the
result of <a class="reference internal" href="../glossary.html#term-traversal"><em class="xref std std-term">traversal</em></a>.</p>
<p>In this example, each of the resources in the tree is of the same class.
This is not a requirement.  Resource elements in the tree can be of any type.
We used a single class to represent all resources in the tree for the sake of
simplicity, but in a &quot;real&quot; app, the resources in the tree can be arbitrary.</p>
<p>Although the example tree above can service a traversal, the resource
instances in the above example are not aware of <a class="reference internal" href="../glossary.html#term-location"><em class="xref std std-term">location</em></a>, so their
utility in a &quot;real&quot; application is limited.  To make best use of built-in
<span>Pyramid</span> API facilities, your resources should be &quot;location-aware&quot;.
The next section details how to make resources location-aware.</p>
</div>
<div class="section" id="location-aware-resources">
<span id="location-aware"></span><span id="index-1"></span><h2>Location-Aware Resources<a class="headerlink" href="#location-aware-resources" title="Permalink to this headline">¶</a></h2>
<p>In order for certain <span>Pyramid</span> location, security, URL-generation, and
traversal APIs to work properly against the resources in a resource tree, all
resources in the tree must be <a class="reference internal" href="../glossary.html#term-location"><em class="xref std std-term">location</em></a> -aware.  This means they must
have two attributes: <tt class="docutils literal"><span class="pre">__parent__</span></tt> and <tt class="docutils literal"><span class="pre">__name__</span></tt>.</p>
<p>The <tt class="docutils literal"><span class="pre">__parent__</span></tt> attribute of a location-aware resource should be a
reference to the resource's parent resource instance in the tree.  The
<tt class="docutils literal"><span class="pre">__name__</span></tt> attribute should be the name with which a resource's parent
refers to the resource via <tt class="docutils literal"><span class="pre">__getitem__</span></tt>.</p>
<p>The <tt class="docutils literal"><span class="pre">__parent__</span></tt> of the root resource should be <tt class="docutils literal"><span class="pre">None</span></tt> and its
<tt class="docutils literal"><span class="pre">__name__</span></tt> should be the empty string.  For instance:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">class</span> <span class="nc">MyRootResource</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="n">__name__</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
    <span class="n">__parent__</span> <span class="o">=</span> <span class="bp">None</span>
</pre></div>
</td></tr></table></div>
<p>A resource returned from the root resource's <tt class="docutils literal"><span class="pre">__getitem__</span></tt> method should
have a <tt class="docutils literal"><span class="pre">__parent__</span></tt> attribute that is a reference to the root resource, and
its <tt class="docutils literal"><span class="pre">__name__</span></tt> attribute should match the name by which it is reachable via
the root resource's <tt class="docutils literal"><span class="pre">__getitem__</span></tt>.  A container resource within the root
resource should have a <tt class="docutils literal"><span class="pre">__getitem__</span></tt> that returns resources with a
<tt class="docutils literal"><span class="pre">__parent__</span></tt> attribute that points at the container, and these subobjects
should have a <tt class="docutils literal"><span class="pre">__name__</span></tt> attribute that matches the name by which they are
retrieved from the container via <tt class="docutils literal"><span class="pre">__getitem__</span></tt>.  This pattern continues
recursively &quot;up&quot; the tree from the root.</p>
<p>The <tt class="docutils literal"><span class="pre">__parent__</span></tt> attributes of each resource form a linked list that points
&quot;downwards&quot; toward the root. This is analogous to the <cite>..</cite> entry in
filesystem directories. If you follow the <tt class="docutils literal"><span class="pre">__parent__</span></tt> values from any
resource in the resource tree, you will eventually come to the root resource,
just like if you keep executing the <tt class="docutils literal"><span class="pre">cd</span> <span class="pre">..</span></tt> filesystem command, eventually
you will reach the filesystem root directory.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">If your root resource has a <tt class="docutils literal"><span class="pre">__name__</span></tt> argument that is not
<tt class="docutils literal"><span class="pre">None</span></tt> or the empty string, URLs returned by the
<a class="reference internal" href="../api/request.html#pyramid.request.Request.resource_url" title="pyramid.request.Request.resource_url"><tt class="xref py py-func docutils literal"><span class="pre">resource_url()</span></tt></a> function and paths generated
by the <a class="reference internal" href="../api/traversal.html#pyramid.traversal.resource_path" title="pyramid.traversal.resource_path"><tt class="xref py py-func docutils literal"><span class="pre">resource_path()</span></tt></a> and
<a class="reference internal" href="../api/traversal.html#pyramid.traversal.resource_path_tuple" title="pyramid.traversal.resource_path_tuple"><tt class="xref py py-func docutils literal"><span class="pre">resource_path_tuple()</span></tt></a> APIs will be generated
improperly.  The value of <tt class="docutils literal"><span class="pre">__name__</span></tt> will be prepended to every path and
URL generated (as opposed to a single leading slash or empty tuple
element).</p>
</div>
<div class="sidebar">
<p class="first sidebar-title">For your convenience</p>
<p>If you'd rather not manage the <tt class="docutils literal"><span class="pre">__name__</span></tt> and <tt class="docutils literal"><span class="pre">__parent__</span></tt> attributes
of your resources &quot;by hand&quot;, an add-on package named
<tt class="xref py py-mod docutils literal"><span class="pre">pyramid_traversalwrapper</span></tt> can help.</p>
<p>In order to use this helper feature, you must first install the
<tt class="xref py py-mod docutils literal"><span class="pre">pyramid_traversalwrapper</span></tt> package (available via PyPI), then register
its <tt class="docutils literal"><span class="pre">ModelGraphTraverser</span></tt> as the traversal policy, rather than the
default <span>Pyramid</span> traverser. The package contains instructions for
doing so.</p>
<p class="last">Once <span>Pyramid</span> is configured with this feature, you will no longer
need to manage the <tt class="docutils literal"><span class="pre">__parent__</span></tt> and <tt class="docutils literal"><span class="pre">__name__</span></tt> attributes on resource
objects &quot;by hand&quot;.  Instead, as necessary, during traversal <span>Pyramid</span>
will wrap each resource (even the root resource) in a <tt class="docutils literal"><span class="pre">LocationProxy</span></tt>
which will dynamically assign a <tt class="docutils literal"><span class="pre">__name__</span></tt> and a <tt class="docutils literal"><span class="pre">__parent__</span></tt> to the
traversed resource (based on the last traversed resource and the name
supplied to <tt class="docutils literal"><span class="pre">__getitem__</span></tt>).  The root resource will have a <tt class="docutils literal"><span class="pre">__name__</span></tt>
attribute of <tt class="docutils literal"><span class="pre">None</span></tt> and a <tt class="docutils literal"><span class="pre">__parent__</span></tt> attribute of <tt class="docutils literal"><span class="pre">None</span></tt>.</p>
</div>
<p>Applications which use tree-walking <span>Pyramid</span> APIs require
location-aware resources.  These APIs include (but are not limited to)
<a class="reference internal" href="../api/request.html#pyramid.request.Request.resource_url" title="pyramid.request.Request.resource_url"><tt class="xref py py-meth docutils literal"><span class="pre">resource_url()</span></tt></a>,
<a class="reference internal" href="../api/traversal.html#pyramid.traversal.find_resource" title="pyramid.traversal.find_resource"><tt class="xref py py-func docutils literal"><span class="pre">find_resource()</span></tt></a>,
<a class="reference internal" href="../api/traversal.html#pyramid.traversal.find_root" title="pyramid.traversal.find_root"><tt class="xref py py-func docutils literal"><span class="pre">find_root()</span></tt></a>,
<a class="reference internal" href="../api/traversal.html#pyramid.traversal.find_interface" title="pyramid.traversal.find_interface"><tt class="xref py py-func docutils literal"><span class="pre">find_interface()</span></tt></a>,
<a class="reference internal" href="../api/traversal.html#pyramid.traversal.resource_path" title="pyramid.traversal.resource_path"><tt class="xref py py-func docutils literal"><span class="pre">resource_path()</span></tt></a>,
<a class="reference internal" href="../api/traversal.html#pyramid.traversal.resource_path_tuple" title="pyramid.traversal.resource_path_tuple"><tt class="xref py py-func docutils literal"><span class="pre">resource_path_tuple()</span></tt></a>, or
<a class="reference internal" href="../api/traversal.html#pyramid.traversal.traverse" title="pyramid.traversal.traverse"><tt class="xref py py-func docutils literal"><span class="pre">traverse()</span></tt></a>, <a class="reference internal" href="../api/traversal.html#pyramid.traversal.virtual_root" title="pyramid.traversal.virtual_root"><tt class="xref py py-func docutils literal"><span class="pre">virtual_root()</span></tt></a>,
and (usually) <a class="reference internal" href="../api/request.html#pyramid.request.Request.has_permission" title="pyramid.request.Request.has_permission"><tt class="xref py py-meth docutils literal"><span class="pre">has_permission()</span></tt></a> and
<a class="reference internal" href="../api/security.html#pyramid.security.principals_allowed_by_permission" title="pyramid.security.principals_allowed_by_permission"><tt class="xref py py-func docutils literal"><span class="pre">principals_allowed_by_permission()</span></tt></a>.</p>
<p>In general, since so much <span>Pyramid</span> infrastructure depends on
location-aware resources, it's a good idea to make each resource in your tree
location-aware.</p>
</div>
<div class="section" id="generating-the-url-of-a-resource">
<span id="index-2"></span><span id="id1"></span><h2>Generating The URL Of A Resource<a class="headerlink" href="#generating-the-url-of-a-resource" title="Permalink to this headline">¶</a></h2>
<p>If your resources are <a class="reference internal" href="../glossary.html#term-location"><em class="xref std std-term">location</em></a> aware, you can use the
<a class="reference internal" href="../api/request.html#pyramid.request.Request.resource_url" title="pyramid.request.Request.resource_url"><tt class="xref py py-meth docutils literal"><span class="pre">pyramid.request.Request.resource_url()</span></tt></a> API to generate a URL for the
resource.  This URL will use the resource's position in the parent tree to
create a resource path, and it will prefix the path with the current
application URL to form a fully-qualified URL with the scheme, host, port,
and path.  You can also pass extra arguments to
<a class="reference internal" href="../api/request.html#pyramid.request.Request.resource_url" title="pyramid.request.Request.resource_url"><tt class="xref py py-meth docutils literal"><span class="pre">resource_url()</span></tt></a> to influence the generated URL.</p>
<p>The simplest call to <a class="reference internal" href="../api/request.html#pyramid.request.Request.resource_url" title="pyramid.request.Request.resource_url"><tt class="xref py py-meth docutils literal"><span class="pre">resource_url()</span></tt></a> looks like
this:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span class="n">url</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">resource_url</span><span class="p">(</span><span class="n">resource</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>The <tt class="docutils literal"><span class="pre">request</span></tt> in the above example is an instance of a <span>Pyramid</span>
<a class="reference internal" href="../glossary.html#term-request"><em class="xref std std-term">request</em></a> object.</p>
<p>If the resource referred to as <tt class="docutils literal"><span class="pre">resource</span></tt> in the above example was the root
resource, and the host that was used to contact the server was
<tt class="docutils literal"><span class="pre">example.com</span></tt>, the URL generated would be <tt class="docutils literal"><span class="pre">http://example.com/</span></tt>.
However, if the resource was a child of the root resource named <tt class="docutils literal"><span class="pre">a</span></tt>, the
generated URL would be <tt class="docutils literal"><span class="pre">http://example.com/a/</span></tt>.</p>
<p>A slash is appended to all resource URLs when
<a class="reference internal" href="../api/request.html#pyramid.request.Request.resource_url" title="pyramid.request.Request.resource_url"><tt class="xref py py-meth docutils literal"><span class="pre">resource_url()</span></tt></a> is used to generate them in
this simple manner, because resources are &quot;places&quot; in the hierarchy, and URLs
are meant to be clicked on to be visited.  Relative URLs that you include on
HTML pages rendered as the result of the default view of a resource are more
apt to be relative to these resources than relative to their parent.</p>
<p>You can also pass extra elements to
<a class="reference internal" href="../api/request.html#pyramid.request.Request.resource_url" title="pyramid.request.Request.resource_url"><tt class="xref py py-meth docutils literal"><span class="pre">resource_url()</span></tt></a>:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span class="n">url</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">resource_url</span><span class="p">(</span><span class="n">resource</span><span class="p">,</span> <span class="s">&#39;foo&#39;</span><span class="p">,</span> <span class="s">&#39;bar&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>If the resource referred to as <tt class="docutils literal"><span class="pre">resource</span></tt> in the above example was the root
resource, and the host that was used to contact the server was
<tt class="docutils literal"><span class="pre">example.com</span></tt>, the URL generated would be <tt class="docutils literal"><span class="pre">http://example.com/foo/bar</span></tt>.
Any number of extra elements can be passed to
<a class="reference internal" href="../api/request.html#pyramid.request.Request.resource_url" title="pyramid.request.Request.resource_url"><tt class="xref py py-meth docutils literal"><span class="pre">resource_url()</span></tt></a> as extra positional arguments.
When extra elements are passed, they are appended to the resource's URL.  A
slash is not appended to the final segment when elements are passed.</p>
<p>You can also pass a query string:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span class="n">url</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">resource_url</span><span class="p">(</span><span class="n">resource</span><span class="p">,</span> <span class="n">query</span><span class="o">=</span><span class="p">{</span><span class="s">&#39;a&#39;</span><span class="p">:</span><span class="s">&#39;1&#39;</span><span class="p">})</span>
</pre></div>
</td></tr></table></div>
<p>If the resource referred to as <tt class="docutils literal"><span class="pre">resource</span></tt> in the above example was the root
resource, and the host that was used to contact the server was
<tt class="docutils literal"><span class="pre">example.com</span></tt>, the URL generated would be <tt class="docutils literal"><span class="pre">http://example.com/?a=1</span></tt>.</p>
<p>When a <a class="reference internal" href="../glossary.html#term-virtual-root"><em class="xref std std-term">virtual root</em></a> is active, the URL generated by
<a class="reference internal" href="../api/request.html#pyramid.request.Request.resource_url" title="pyramid.request.Request.resource_url"><tt class="xref py py-meth docutils literal"><span class="pre">resource_url()</span></tt></a> for a resource may be &quot;shorter&quot;
than its physical tree path.  See <a class="reference internal" href="vhosting.html#virtual-root-support"><em>Virtual Root Support</em></a> for more
information about virtually rooting a resource.</p>
<p>For more information about generating resource URLs, see the documentation
for <a class="reference internal" href="../api/request.html#pyramid.request.Request.resource_url" title="pyramid.request.Request.resource_url"><tt class="xref py py-meth docutils literal"><span class="pre">pyramid.request.Request.resource_url()</span></tt></a>.</p>
<div class="section" id="overriding-resource-url-generation">
<span id="index-3"></span><span id="id2"></span><h3>Overriding Resource URL Generation<a class="headerlink" href="#overriding-resource-url-generation" title="Permalink to this headline">¶</a></h3>
<p>If a resource object implements a <tt class="docutils literal"><span class="pre">__resource_url__</span></tt> method, this method
will be called when <a class="reference internal" href="../api/request.html#pyramid.request.Request.resource_url" title="pyramid.request.Request.resource_url"><tt class="xref py py-meth docutils literal"><span class="pre">resource_url()</span></tt></a> is called
to generate a URL for the resource, overriding the default URL returned for
the resource by <a class="reference internal" href="../api/request.html#pyramid.request.Request.resource_url" title="pyramid.request.Request.resource_url"><tt class="xref py py-meth docutils literal"><span class="pre">resource_url()</span></tt></a>.</p>
<p>The <tt class="docutils literal"><span class="pre">__resource_url__</span></tt> hook is passed two arguments: <tt class="docutils literal"><span class="pre">request</span></tt> and
<tt class="docutils literal"><span class="pre">info</span></tt>.  <tt class="docutils literal"><span class="pre">request</span></tt> is the <a class="reference internal" href="../glossary.html#term-request"><em class="xref std std-term">request</em></a> object passed to
<a class="reference internal" href="../api/request.html#pyramid.request.Request.resource_url" title="pyramid.request.Request.resource_url"><tt class="xref py py-meth docutils literal"><span class="pre">resource_url()</span></tt></a>.  <tt class="docutils literal"><span class="pre">info</span></tt> is a dictionary with
the following keys:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">physical_path</span></tt></dt>
<dd>A string representing the &quot;physical path&quot; computed for the resource, as
defined by <tt class="docutils literal"><span class="pre">pyramid.traversal.resource_path(resource)</span></tt>.  It will begin
and end with a slash.</dd>
<dt><tt class="docutils literal"><span class="pre">virtual_path</span></tt></dt>
<dd>A string representing the &quot;virtual path&quot; computed for the resource, as
defined by <a class="reference internal" href="vhosting.html#virtual-root-support"><em>Virtual Root Support</em></a>.  This will be identical to the
physical path if virtual rooting is not enabled.  It will begin and end
with a slash.</dd>
<dt><tt class="docutils literal"><span class="pre">app_url</span></tt></dt>
<dd>A string representing the application URL generated during
<tt class="docutils literal"><span class="pre">request.resource_url</span></tt>.  It will not end with a slash.  It represents a
potentially customized URL prefix, containing potentially custom scheme,
host and port information passed by the user to <tt class="docutils literal"><span class="pre">request.resource_url</span></tt>.
It should be preferred over use of <tt class="docutils literal"><span class="pre">request.application_url</span></tt>.</dd>
</dl>
<p>The <tt class="docutils literal"><span class="pre">__resource_url__</span></tt> method of a resource should return a string
representing a URL.  If it cannot override the default, it should return
<tt class="docutils literal"><span class="pre">None</span></tt>.  If it returns <tt class="docutils literal"><span class="pre">None</span></tt>, the default URL will be returned.</p>
<p>Here's an example <tt class="docutils literal"><span class="pre">__resource_url__</span></tt> method.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Resource</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__resource_url__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">info</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">info</span><span class="p">[</span><span class="s">&#39;app_url&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">info</span><span class="p">[</span><span class="s">&#39;virtual_path&#39;</span><span class="p">]</span>
</pre></div>
</td></tr></table></div>
<p>The above example actually just generates and returns the default URL, which
would have been what was generated by the default <tt class="docutils literal"><span class="pre">resource_url</span></tt> machinery,
but your code can perform arbitrary logic as necessary.  For example, your
code may wish to override the hostname or port number of the generated URL.</p>
<p>Note that the URL generated by <tt class="docutils literal"><span class="pre">__resource_url__</span></tt> should be fully
qualified, should end in a slash, and should not contain any query string or
anchor elements (only path elements) to work with
<a class="reference internal" href="../api/request.html#pyramid.request.Request.resource_url" title="pyramid.request.Request.resource_url"><tt class="xref py py-meth docutils literal"><span class="pre">resource_url()</span></tt></a>.</p>
</div>
</div>
<div class="section" id="generating-the-path-to-a-resource">
<span id="index-4"></span><h2>Generating the Path To a Resource<a class="headerlink" href="#generating-the-path-to-a-resource" title="Permalink to this headline">¶</a></h2>
<p><a class="reference internal" href="../api/traversal.html#pyramid.traversal.resource_path" title="pyramid.traversal.resource_path"><tt class="xref py py-func docutils literal"><span class="pre">pyramid.traversal.resource_path()</span></tt></a> returns a string object representing
the absolute physical path of the resource object based on its position in
the resource tree.  Each segment of the path is separated with a slash
character.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">pyramid.traversal</span> <span class="kn">import</span> <span class="n">resource_path</span>
<span class="n">url</span> <span class="o">=</span> <span class="n">resource_path</span><span class="p">(</span><span class="n">resource</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>If <tt class="docutils literal"><span class="pre">resource</span></tt> in the example above was accessible in the tree as
<tt class="docutils literal"><span class="pre">root['a']['b']</span></tt>, the above example would generate the string <tt class="docutils literal"><span class="pre">/a/b</span></tt>.</p>
<p>Any positional arguments passed in to <a class="reference internal" href="../api/traversal.html#pyramid.traversal.resource_path" title="pyramid.traversal.resource_path"><tt class="xref py py-func docutils literal"><span class="pre">resource_path()</span></tt></a>
will be appended as path segments to the end of the resource path.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">pyramid.traversal</span> <span class="kn">import</span> <span class="n">resource_path</span>
<span class="n">url</span> <span class="o">=</span> <span class="n">resource_path</span><span class="p">(</span><span class="n">resource</span><span class="p">,</span> <span class="s">&#39;foo&#39;</span><span class="p">,</span> <span class="s">&#39;bar&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>If <tt class="docutils literal"><span class="pre">resource</span></tt> in the example above was accessible in the tree as
<tt class="docutils literal"><span class="pre">root['a']['b']</span></tt>, the above example would generate the string
<tt class="docutils literal"><span class="pre">/a/b/foo/bar</span></tt>.</p>
<p>The resource passed in must be <a class="reference internal" href="../glossary.html#term-location"><em class="xref std std-term">location</em></a>-aware.</p>
<p>The presence or absence of a <a class="reference internal" href="../glossary.html#term-virtual-root"><em class="xref std std-term">virtual root</em></a> has no impact on the
behavior of <a class="reference internal" href="../api/traversal.html#pyramid.traversal.resource_path" title="pyramid.traversal.resource_path"><tt class="xref py py-func docutils literal"><span class="pre">resource_path()</span></tt></a>.</p>
</div>
<div class="section" id="finding-a-resource-by-path">
<span id="index-5"></span><h2>Finding a Resource by Path<a class="headerlink" href="#finding-a-resource-by-path" title="Permalink to this headline">¶</a></h2>
<p>If you have a string path to a resource, you can grab the resource from
that place in the application's resource tree using
<a class="reference internal" href="../api/traversal.html#pyramid.traversal.find_resource" title="pyramid.traversal.find_resource"><tt class="xref py py-func docutils literal"><span class="pre">pyramid.traversal.find_resource()</span></tt></a>.</p>
<p>You can resolve an absolute path by passing a string prefixed with a <tt class="docutils literal"><span class="pre">/</span></tt> as
the <tt class="docutils literal"><span class="pre">path</span></tt> argument:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">pyramid.traversal</span> <span class="kn">import</span> <span class="n">find_resource</span>
<span class="n">url</span> <span class="o">=</span> <span class="n">find_resource</span><span class="p">(</span><span class="n">anyresource</span><span class="p">,</span> <span class="s">&#39;/path&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>Or you can resolve a path relative to the resource you pass in by passing a
string that isn't prefixed by <tt class="docutils literal"><span class="pre">/</span></tt>:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">pyramid.traversal</span> <span class="kn">import</span> <span class="n">find_resource</span>
<span class="n">url</span> <span class="o">=</span> <span class="n">find_resource</span><span class="p">(</span><span class="n">anyresource</span><span class="p">,</span> <span class="s">&#39;path&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>Often the paths you pass to <a class="reference internal" href="../api/traversal.html#pyramid.traversal.find_resource" title="pyramid.traversal.find_resource"><tt class="xref py py-func docutils literal"><span class="pre">find_resource()</span></tt></a> are
generated by the <a class="reference internal" href="../api/traversal.html#pyramid.traversal.resource_path" title="pyramid.traversal.resource_path"><tt class="xref py py-func docutils literal"><span class="pre">resource_path()</span></tt></a> API.  These APIs
are &quot;mirrors&quot; of each other.</p>
<p>If the path cannot be resolved when calling
<a class="reference internal" href="../api/traversal.html#pyramid.traversal.find_resource" title="pyramid.traversal.find_resource"><tt class="xref py py-func docutils literal"><span class="pre">find_resource()</span></tt></a> (if the respective resource in the
tree does not exist), a <a class="reference external" href="http://docs.python.org/3/library/exceptions.html#KeyError" title="(in Python v3.4)"><tt class="xref py py-exc docutils literal"><span class="pre">KeyError</span></tt></a> will be raised.</p>
<p>See the <a class="reference internal" href="../api/traversal.html#pyramid.traversal.find_resource" title="pyramid.traversal.find_resource"><tt class="xref py py-func docutils literal"><span class="pre">pyramid.traversal.find_resource()</span></tt></a> documentation for more
information about resolving a path to a resource.</p>
</div>
<div class="section" id="obtaining-the-lineage-of-a-resource">
<span id="index-6"></span><h2>Obtaining the Lineage of a Resource<a class="headerlink" href="#obtaining-the-lineage-of-a-resource" title="Permalink to this headline">¶</a></h2>
<p><a class="reference internal" href="../api/location.html#pyramid.location.lineage" title="pyramid.location.lineage"><tt class="xref py py-func docutils literal"><span class="pre">pyramid.location.lineage()</span></tt></a> returns a generator representing the
<a class="reference internal" href="../glossary.html#term-lineage"><em class="xref std std-term">lineage</em></a> of the <a class="reference internal" href="../glossary.html#term-location"><em class="xref std std-term">location</em></a> aware <a class="reference internal" href="../glossary.html#term-resource"><em class="xref std std-term">resource</em></a> object.</p>
<p>The <a class="reference internal" href="../api/location.html#pyramid.location.lineage" title="pyramid.location.lineage"><tt class="xref py py-func docutils literal"><span class="pre">lineage()</span></tt></a> function returns the resource it is
passed, then each parent of the resource, in order.  For example, if the
resource tree is composed like so:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Thing</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span> <span class="k">pass</span>

<span class="n">thing1</span> <span class="o">=</span> <span class="n">Thing</span><span class="p">()</span>
<span class="n">thing2</span> <span class="o">=</span> <span class="n">Thing</span><span class="p">()</span>
<span class="n">thing2</span><span class="o">.</span><span class="n">__parent__</span> <span class="o">=</span> <span class="n">thing1</span>
</pre></div>
</td></tr></table></div>
<p>Calling <tt class="docutils literal"><span class="pre">lineage(thing2)</span></tt> will return a generator.  When we turn it into a
list, we will get:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span class="nb">list</span><span class="p">(</span><span class="n">lineage</span><span class="p">(</span><span class="n">thing2</span><span class="p">))</span>
<span class="p">[</span> <span class="o">&lt;</span><span class="n">Thing</span> <span class="nb">object</span> <span class="n">at</span> <span class="n">thing2</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">Thing</span> <span class="nb">object</span> <span class="n">at</span> <span class="n">thing1</span><span class="o">&gt;</span> <span class="p">]</span>
</pre></div>
</td></tr></table></div>
<p>The generator returned by <a class="reference internal" href="../api/location.html#pyramid.location.lineage" title="pyramid.location.lineage"><tt class="xref py py-func docutils literal"><span class="pre">lineage()</span></tt></a> first returns the
resource it was passed unconditionally.  Then, if the resource supplied a
<tt class="docutils literal"><span class="pre">__parent__</span></tt> attribute, it returns the resource represented by
<tt class="docutils literal"><span class="pre">resource.__parent__</span></tt>.  If <em>that</em> resource has a <tt class="docutils literal"><span class="pre">__parent__</span></tt> attribute,
return that resource's parent, and so on, until the resource being inspected
either has no <tt class="docutils literal"><span class="pre">__parent__</span></tt> attribute or has a <tt class="docutils literal"><span class="pre">__parent__</span></tt> attribute of
<tt class="docutils literal"><span class="pre">None</span></tt>.</p>
<p>See the documentation for <a class="reference internal" href="../api/location.html#pyramid.location.lineage" title="pyramid.location.lineage"><tt class="xref py py-func docutils literal"><span class="pre">pyramid.location.lineage()</span></tt></a> for more
information.</p>
</div>
<div class="section" id="determining-if-a-resource-is-in-the-lineage-of-another-resource">
<h2>Determining if a Resource is In The Lineage of Another Resource<a class="headerlink" href="#determining-if-a-resource-is-in-the-lineage-of-another-resource" title="Permalink to this headline">¶</a></h2>
<p>Use the <a class="reference internal" href="../api/location.html#pyramid.location.inside" title="pyramid.location.inside"><tt class="xref py py-func docutils literal"><span class="pre">pyramid.location.inside()</span></tt></a> function to determine if one resource
is in the <a class="reference internal" href="../glossary.html#term-lineage"><em class="xref std std-term">lineage</em></a> of another resource.</p>
<p>For example, if the resource tree is:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Thing</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span> <span class="k">pass</span>

<span class="n">a</span> <span class="o">=</span> <span class="n">Thing</span><span class="p">()</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">Thing</span><span class="p">()</span>
<span class="n">b</span><span class="o">.</span><span class="n">__parent__</span> <span class="o">=</span> <span class="n">a</span>
</pre></div>
</td></tr></table></div>
<p>Calling <tt class="docutils literal"><span class="pre">inside(b,</span> <span class="pre">a)</span></tt> will return <tt class="docutils literal"><span class="pre">True</span></tt>, because <tt class="docutils literal"><span class="pre">b</span></tt> has a lineage
that includes <tt class="docutils literal"><span class="pre">a</span></tt>.  However, calling <tt class="docutils literal"><span class="pre">inside(a,</span> <span class="pre">b)</span></tt> will return <tt class="docutils literal"><span class="pre">False</span></tt>
because <tt class="docutils literal"><span class="pre">a</span></tt> does not have a lineage that includes <tt class="docutils literal"><span class="pre">b</span></tt>.</p>
<p>The argument list for <a class="reference internal" href="../api/location.html#pyramid.location.inside" title="pyramid.location.inside"><tt class="xref py py-func docutils literal"><span class="pre">inside()</span></tt></a> is <tt class="docutils literal"><span class="pre">(resource1,</span>
<span class="pre">resource2)</span></tt>.  <tt class="docutils literal"><span class="pre">resource1</span></tt> is 'inside' <tt class="docutils literal"><span class="pre">resource2</span></tt> if <tt class="docutils literal"><span class="pre">resource2</span></tt> is a
<a class="reference internal" href="../glossary.html#term-lineage"><em class="xref std std-term">lineage</em></a> ancestor of <tt class="docutils literal"><span class="pre">resource1</span></tt>.  It is a lineage ancestor if its
parent (or one of its parent's parents, etc.) is an ancestor.</p>
<p>See <a class="reference internal" href="../api/location.html#pyramid.location.inside" title="pyramid.location.inside"><tt class="xref py py-func docutils literal"><span class="pre">pyramid.location.inside()</span></tt></a> for more information.</p>
</div>
<div class="section" id="finding-the-root-resource">
<span id="index-7"></span><h2>Finding the Root Resource<a class="headerlink" href="#finding-the-root-resource" title="Permalink to this headline">¶</a></h2>
<p>Use the <a class="reference internal" href="../api/traversal.html#pyramid.traversal.find_root" title="pyramid.traversal.find_root"><tt class="xref py py-func docutils literal"><span class="pre">pyramid.traversal.find_root()</span></tt></a> API to find the <a class="reference internal" href="../glossary.html#term-root"><em class="xref std std-term">root</em></a>
resource.  The root resource is the root resource of the <a class="reference internal" href="../glossary.html#term-resource-tree"><em class="xref std std-term">resource
tree</em></a>.  The API accepts a single argument: <tt class="docutils literal"><span class="pre">resource</span></tt>.  This is a resource
that is <a class="reference internal" href="../glossary.html#term-location"><em class="xref std std-term">location</em></a> aware.  It can be any resource in the tree for which
you want to find the root.</p>
<p>For example, if the resource tree is:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Thing</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span> <span class="k">pass</span>

<span class="n">a</span> <span class="o">=</span> <span class="n">Thing</span><span class="p">()</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">Thing</span><span class="p">()</span>
<span class="n">b</span><span class="o">.</span><span class="n">__parent__</span> <span class="o">=</span> <span class="n">a</span>
</pre></div>
</td></tr></table></div>
<p>Calling <tt class="docutils literal"><span class="pre">find_root(b)</span></tt> will return <tt class="docutils literal"><span class="pre">a</span></tt>.</p>
<p>The root resource is also available as <tt class="docutils literal"><span class="pre">request.root</span></tt> within <a class="reference internal" href="../glossary.html#term-view-callable"><em class="xref std std-term">view
callable</em></a> code.</p>
<p>The presence or absence of a <a class="reference internal" href="../glossary.html#term-virtual-root"><em class="xref std std-term">virtual root</em></a> has no impact on the
behavior of <a class="reference internal" href="../api/traversal.html#pyramid.traversal.find_root" title="pyramid.traversal.find_root"><tt class="xref py py-func docutils literal"><span class="pre">find_root()</span></tt></a>.  The root object returned
is always the <em>physical</em> root object.</p>
</div>
<div class="section" id="resources-which-implement-interfaces">
<span id="index-8"></span><span id="id3"></span><h2>Resources Which Implement Interfaces<a class="headerlink" href="#resources-which-implement-interfaces" title="Permalink to this headline">¶</a></h2>
<p>Resources can optionally be made to implement an <a class="reference internal" href="../glossary.html#term-interface"><em class="xref std std-term">interface</em></a>.  An
interface is used to tag a resource object with a &quot;type&quot; that can later be
referred to within <a class="reference internal" href="../glossary.html#term-view-configuration"><em class="xref std std-term">view configuration</em></a> and by
<a class="reference internal" href="../api/traversal.html#pyramid.traversal.find_interface" title="pyramid.traversal.find_interface"><tt class="xref py py-func docutils literal"><span class="pre">pyramid.traversal.find_interface()</span></tt></a>.</p>
<p>Specifying an interface instead of a class as the <tt class="docutils literal"><span class="pre">context</span></tt> or
<tt class="docutils literal"><span class="pre">containment</span></tt> predicate arguments within <a class="reference internal" href="../glossary.html#term-view-configuration"><em class="xref std std-term">view configuration</em></a>
statements makes it possible to use a single view callable for more than one
class of resource object.  If your application is simple enough that you see
no reason to want to do this, you can skip reading this section of the
chapter.</p>
<p>For example, here's some code which describes a blog entry which also
declares that the blog entry implements an <a class="reference internal" href="../glossary.html#term-interface"><em class="xref std std-term">interface</em></a>.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">implementer</span>
<span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Interface</span>

<span class="k">class</span> <span class="nc">IBlogEntry</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="nd">@implementer</span><span class="p">(</span><span class="n">IBlogEntry</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">BlogEntry</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="n">author</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="n">title</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">body</span> <span class="o">=</span> <span class="n">body</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">author</span> <span class="o">=</span> <span class="n">author</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">created</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
<p>This resource consists of two things: the class which defines the resource
constructor as the class <tt class="docutils literal"><span class="pre">BlogEntry</span></tt>, and an <a class="reference internal" href="../glossary.html#term-interface"><em class="xref std std-term">interface</em></a> attached to
the class via an <tt class="docutils literal"><span class="pre">implementer</span></tt> class decorator using the <tt class="docutils literal"><span class="pre">IBlogEntry</span></tt>
interface as its sole argument.</p>
<p>The interface object used must be an instance of a class that inherits from
<tt class="xref py py-class docutils literal"><span class="pre">zope.interface.Interface</span></tt>.</p>
<p>A resource class may implement zero or more interfaces.  You specify that a
resource implements an interface by using the
<tt class="xref py py-func docutils literal"><span class="pre">zope.interface.implementer()</span></tt> function as a class decorator.  The above
<tt class="docutils literal"><span class="pre">BlogEntry</span></tt> resource implements the <tt class="docutils literal"><span class="pre">IBlogEntry</span></tt> interface.</p>
<p>You can also specify that a particular resource <em>instance</em> provides an
interface, as opposed to its class.  When you declare that a class implements
an interface, all instances of that class will also provide that interface.
However, you can also just say that a single object provides the interface.
To do so, use the <tt class="xref py py-func docutils literal"><span class="pre">zope.interface.directlyProvides()</span></tt> function:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">directlyProvides</span>
<span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Interface</span>

<span class="k">class</span> <span class="nc">IBlogEntry</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="k">class</span> <span class="nc">BlogEntry</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="n">author</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="n">title</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">body</span> <span class="o">=</span> <span class="n">body</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">author</span> <span class="o">=</span> <span class="n">author</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">created</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>

<span class="n">entry</span> <span class="o">=</span> <span class="n">BlogEntry</span><span class="p">(</span><span class="s">&#39;title&#39;</span><span class="p">,</span> <span class="s">&#39;body&#39;</span><span class="p">,</span> <span class="s">&#39;author&#39;</span><span class="p">)</span>
<span class="n">directlyProvides</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">IBlogEntry</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p><tt class="xref py py-func docutils literal"><span class="pre">zope.interface.directlyProvides()</span></tt> will replace any existing interface
that was previously provided by an instance.  If a resource object already
has instance-level interface declarations that you don't want to replace, use
the <tt class="xref py py-func docutils literal"><span class="pre">zope.interface.alsoProvides()</span></tt> function:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">alsoProvides</span>
<span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">directlyProvides</span>
<span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Interface</span>

<span class="k">class</span> <span class="nc">IBlogEntry1</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="k">class</span> <span class="nc">IBlogEntry2</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="k">class</span> <span class="nc">BlogEntry</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="n">author</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="n">title</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">body</span> <span class="o">=</span> <span class="n">body</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">author</span> <span class="o">=</span> <span class="n">author</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">created</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>

<span class="n">entry</span> <span class="o">=</span> <span class="n">BlogEntry</span><span class="p">(</span><span class="s">&#39;title&#39;</span><span class="p">,</span> <span class="s">&#39;body&#39;</span><span class="p">,</span> <span class="s">&#39;author&#39;</span><span class="p">)</span>
<span class="n">directlyProvides</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">IBlogEntry1</span><span class="p">)</span>
<span class="n">alsoProvides</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">IBlogEntry2</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p><tt class="xref py py-func docutils literal"><span class="pre">zope.interface.alsoProvides()</span></tt> will augment the set of interfaces
directly provided by an instance instead of overwriting them like
<tt class="xref py py-func docutils literal"><span class="pre">zope.interface.directlyProvides()</span></tt> does.</p>
<p>For more information about how resource interfaces can be used by view
configuration, see <a class="reference internal" href="traversal.html#using-resource-interfaces"><em>Using Resource Interfaces In View Configuration</em></a>.</p>
</div>
<div class="section" id="finding-a-resource-with-a-class-or-interface-in-lineage">
<span id="index-9"></span><h2>Finding a Resource With a Class or Interface in Lineage<a class="headerlink" href="#finding-a-resource-with-a-class-or-interface-in-lineage" title="Permalink to this headline">¶</a></h2>
<p>Use the <a class="reference internal" href="../api/traversal.html#pyramid.traversal.find_interface" title="pyramid.traversal.find_interface"><tt class="xref py py-func docutils literal"><span class="pre">find_interface()</span></tt></a> API to locate a parent that
is of a particular Python class, or which implements some <a class="reference internal" href="../glossary.html#term-interface"><em class="xref std std-term">interface</em></a>.</p>
<p>For example, if your resource tree is composed as follows:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Thing1</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span> <span class="k">pass</span>
<span class="k">class</span> <span class="nc">Thing2</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span> <span class="k">pass</span>

<span class="n">a</span> <span class="o">=</span> <span class="n">Thing1</span><span class="p">()</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">Thing2</span><span class="p">()</span>
<span class="n">b</span><span class="o">.</span><span class="n">__parent__</span> <span class="o">=</span> <span class="n">a</span>
</pre></div>
</td></tr></table></div>
<p>Calling <tt class="docutils literal"><span class="pre">find_interface(a,</span> <span class="pre">Thing1)</span></tt> will return the <tt class="docutils literal"><span class="pre">a</span></tt> resource because
<tt class="docutils literal"><span class="pre">a</span></tt> is of class <tt class="docutils literal"><span class="pre">Thing1</span></tt> (the resource passed as the first argument is
considered first, and is returned if the class or interface spec matches).</p>
<p>Calling <tt class="docutils literal"><span class="pre">find_interface(b,</span> <span class="pre">Thing1)</span></tt> will return the <tt class="docutils literal"><span class="pre">a</span></tt> resource because
<tt class="docutils literal"><span class="pre">a</span></tt> is of class <tt class="docutils literal"><span class="pre">Thing1</span></tt> and <tt class="docutils literal"><span class="pre">a</span></tt> is the first resource in <tt class="docutils literal"><span class="pre">b</span></tt>'s
lineage of this class.</p>
<p>Calling <tt class="docutils literal"><span class="pre">find_interface(b,</span> <span class="pre">Thing2)</span></tt> will return the <tt class="docutils literal"><span class="pre">b</span></tt> resource.</p>
<p>The second argument to find_interface may also be a <a class="reference internal" href="../glossary.html#term-interface"><em class="xref std std-term">interface</em></a> instead
of a class.  If it is an interface, each resource in the lineage is checked
to see if the resource implements the specificed interface (instead of seeing
if the resource is of a class).</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">See also <a class="reference internal" href="#resources-which-implement-interfaces"><em>Resources Which Implement Interfaces</em></a>.</p>
</div>
</div>
<div class="section" id="pyramid-api-functions-that-act-against-resources">
<span id="index-10"></span><h2><span>Pyramid</span> API Functions That Act Against Resources<a class="headerlink" href="#pyramid-api-functions-that-act-against-resources" title="Permalink to this headline">¶</a></h2>
<p>A resource object is used as the <a class="reference internal" href="../glossary.html#term-context"><em class="xref std std-term">context</em></a> provided to a view.  See
<a class="reference internal" href="traversal.html#traversal-chapter"><em>Traversal</em></a> and <a class="reference internal" href="urldispatch.html#urldispatch-chapter"><em>URL Dispatch</em></a> for more information
about how a resource object becomes the context.</p>
<p>The APIs provided by <a class="reference internal" href="../api/traversal.html#traversal-module"><em>pyramid.traversal</em></a> are used against resource
objects.  These functions can be used to find the &quot;path&quot; of a resource, the
root resource in a resource tree, or to generate a URL for a resource.</p>
<p>The APIs provided by <a class="reference internal" href="../api/location.html#location-module"><em>pyramid.location</em></a> are used against resources.
These can be used to walk down a resource tree, or conveniently locate one
resource &quot;inside&quot; another.</p>
<p>Some APIs on the <a class="reference internal" href="../api/request.html#pyramid.request.Request" title="pyramid.request.Request"><tt class="xref py py-class docutils literal"><span class="pre">pyramid.request.Request</span></tt></a> accept a resource object as a parameter.
For example, the <a class="reference internal" href="../api/request.html#pyramid.request.Request.has_permission" title="pyramid.request.Request.has_permission"><tt class="xref py py-meth docutils literal"><span class="pre">has_permission()</span></tt></a> API accepts a
resource object as one of its arguments; the ACL is obtained from this
resource or one of its ancestors.  Other security related APIs on the
<a class="reference internal" href="../api/request.html#pyramid.request.Request" title="pyramid.request.Request"><tt class="xref py py-class docutils literal"><span class="pre">pyramid.request.Request</span></tt></a> class also accept <a class="reference internal" href="../glossary.html#term-context"><em class="xref std std-term">context</em></a> as an argument,
and a context is always a resource.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Resources</a><ul>
<li><a class="reference internal" href="#defining-a-resource-tree">Defining a Resource Tree</a></li>
<li><a class="reference internal" href="#location-aware-resources">Location-Aware Resources</a></li>
<li><a class="reference internal" href="#generating-the-url-of-a-resource">Generating The URL Of A Resource</a><ul>
<li><a class="reference internal" href="#overriding-resource-url-generation">Overriding Resource URL Generation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#generating-the-path-to-a-resource">Generating the Path To a Resource</a></li>
<li><a class="reference internal" href="#finding-a-resource-by-path">Finding a Resource by Path</a></li>
<li><a class="reference internal" href="#obtaining-the-lineage-of-a-resource">Obtaining the Lineage of a Resource</a></li>
<li><a class="reference internal" href="#determining-if-a-resource-is-in-the-lineage-of-another-resource">Determining if a Resource is In The Lineage of Another Resource</a></li>
<li><a class="reference internal" href="#finding-the-root-resource">Finding the Root Resource</a></li>
<li><a class="reference internal" href="#resources-which-implement-interfaces">Resources Which Implement Interfaces</a></li>
<li><a class="reference internal" href="#finding-a-resource-with-a-class-or-interface-in-lineage">Finding a Resource With a Class or Interface in Lineage</a></li>
<li><a class="reference internal" href="#pyramid-api-functions-that-act-against-resources"><span>Pyramid</span> API Functions That Act Against Resources</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="testing.html"
                        title="previous chapter">Unit, Integration, and Functional Testing</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="hellotraversal.html"
                        title="next chapter">Hello Traversal World</a></p>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="hellotraversal.html" title="Hello Traversal World"
             >next</a> |</li>
        <li class="right" >
          <a href="testing.html" title="Unit, Integration, and Functional Testing"
             >previous</a> |</li>
    	<li><a href="../index.html">The Pyramid Web Framework v1.5</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; <a href="../copyright.html">Copyright</a> 2008-2014, Agendaless Consulting.
      Last updated on Nov 09, 2014.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
  </body>
</html>