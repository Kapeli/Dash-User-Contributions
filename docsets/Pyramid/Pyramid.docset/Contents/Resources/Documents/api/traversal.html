<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta content="text/html; charset=utf-8" http-equiv="Content-Type"/><title>pyramid.traversal — The Pyramid Web Framework v1.5</title><link href="../_static/pylons.css" rel="stylesheet" type="text/css"/><link href="../_static/pygments.css" rel="stylesheet" type="text/css"/><script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.5',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script><script src="../_static/jquery.js" type="text/javascript"></script><script src="../_static/underscore.js" type="text/javascript"></script><script src="../_static/doctools.js" type="text/javascript"></script><link href="../copyright.html" rel="copyright" title="Copyright"/><link href="../index.html" rel="top" title="The Pyramid Web Framework v1.5"/><link href="tweens.html" rel="next" title="pyramid.tweens"/><link href="threadlocal.html" rel="prev" title="pyramid.threadlocal"/><link charset="utf-8" href="http://static.pylonsproject.org/fonts/nobile/stylesheet.css" media="screen" rel="stylesheet" type="text/css"/><link charset="utf-8" href="http://static.pylonsproject.org/fonts/neuton/stylesheet.css" media="screen" rel="stylesheet" type="text/css"/><!--[if lte IE 6]>
<link rel="stylesheet" href="../_static/ie6.css" type="text/css" media="screen" charset="utf-8" />
<![endif]--><link href="../_static/pyramid.ico" rel="shortcut icon"/></head><body>
<div class="header-small">
<div class="logo-small">
<a href="../index.html">
<img alt="Logo" class="logo" src="../_static/pyramid-small.png"/>
</a>
</div>
</div>
<div class="related">
<h3>Navigation</h3>
<ul>
<li class="right" style="margin-right: 10px">
<a accesskey="I" href="../genindex.html" title="General Index">index</a></li>
<li class="right">
<a href="../py-modindex.html" title="Python Module Index">modules</a> |</li>
<li class="right">
<a accesskey="N" href="tweens.html" title="pyramid.tweens">next</a> |</li>
<li class="right">
<a accesskey="P" href="threadlocal.html" title="pyramid.threadlocal">previous</a> |</li>
<li><a href="../index.html">The Pyramid Web Framework v1.5</a> »</li>
</ul>
</div>
<div class="document">
<div class="documentwrapper">
<div class="bodywrapper">
<div class="body">
<div class="section" id="module-pyramid.traversal">
<span id="pyramid-traversal"></span><span id="traversal-module"></span><h1><a name="//apple_ref/cpp/Module/pyramid.traversal"></a><a class="reference internal" href="#module-pyramid.traversal" title="pyramid.traversal"><tt class="xref py py-mod docutils literal"><span class="pre">pyramid.traversal</span></tt></a><a class="headerlink" href="#module-pyramid.traversal" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="pyramid.traversal.find_interface"><a name="//apple_ref/cpp/func/pyramid.traversal.find_interface"></a>
<tt class="descname">find_interface</tt><big>(</big><em>resource</em>, <em>class_or_interface</em><big>)</big><a class="reference internal" href="../_modules/pyramid/traversal.html#find_interface"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyramid.traversal.find_interface" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the first resource found in the <a class="reference internal" href="../glossary.html#term-lineage"><em class="xref std std-term">lineage</em></a> of <tt class="docutils literal"><span class="pre">resource</span></tt>
which, a) if <tt class="docutils literal"><span class="pre">class_or_interface</span></tt> is a Python class object, is an
instance of the class or any subclass of that class or b) if
<tt class="docutils literal"><span class="pre">class_or_interface</span></tt> is a <a class="reference internal" href="../glossary.html#term-interface"><em class="xref std std-term">interface</em></a>, provides the specified
interface.  Return <tt class="docutils literal"><span class="pre">None</span></tt> if no resource providing <tt class="docutils literal"><span class="pre">interface_or_class</span></tt>
can be found in the lineage.  The <tt class="docutils literal"><span class="pre">resource</span></tt> passed in <em>must</em> be
<a class="reference internal" href="../glossary.html#term-location"><em class="xref std std-term">location</em></a>-aware.</p>
</dd></dl>
<dl class="function">
<dt id="pyramid.traversal.find_resource"><a name="//apple_ref/cpp/func/pyramid.traversal.find_resource"></a>
<tt class="descname">find_resource</tt><big>(</big><em>resource</em>, <em>path</em><big>)</big><a class="reference internal" href="../_modules/pyramid/traversal.html#find_resource"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyramid.traversal.find_resource" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a resource object and a string or tuple representing a path
(such as the return value of <a class="reference internal" href="#pyramid.traversal.resource_path" title="pyramid.traversal.resource_path"><tt class="xref py py-func docutils literal"><span class="pre">pyramid.traversal.resource_path()</span></tt></a> or
<a class="reference internal" href="#pyramid.traversal.resource_path_tuple" title="pyramid.traversal.resource_path_tuple"><tt class="xref py py-func docutils literal"><span class="pre">pyramid.traversal.resource_path_tuple()</span></tt></a>), return a resource in this
application's resource tree at the specified path.  The resource passed
in <em>must</em> be <a class="reference internal" href="../glossary.html#term-location"><em class="xref std std-term">location</em></a>-aware.  If the path cannot be resolved (if
the respective node in the resource tree does not exist), a
<a class="reference external" href="http://docs.python.org/3/library/exceptions.html#KeyError" title="(in Python v3.4)"><tt class="xref py py-exc docutils literal"><span class="pre">KeyError</span></tt></a> will be raised.</p>
<p>This function is the logical inverse of
<a class="reference internal" href="#pyramid.traversal.resource_path" title="pyramid.traversal.resource_path"><tt class="xref py py-func docutils literal"><span class="pre">pyramid.traversal.resource_path()</span></tt></a> and
<a class="reference internal" href="#pyramid.traversal.resource_path_tuple" title="pyramid.traversal.resource_path_tuple"><tt class="xref py py-func docutils literal"><span class="pre">pyramid.traversal.resource_path_tuple()</span></tt></a>; it can resolve any
path string or tuple generated by either of those functions.</p>
<p>Rules for passing a <em>string</em> as the <tt class="docutils literal"><span class="pre">path</span></tt> argument: if the
first character in the path string is the <tt class="docutils literal"><span class="pre">/</span></tt>
character, the path is considered absolute and the resource tree
traversal will start at the root resource.  If the first character
of the path string is <em>not</em> the <tt class="docutils literal"><span class="pre">/</span></tt> character, the path is
considered relative and resource tree traversal will begin at the resource
object supplied to the function as the <tt class="docutils literal"><span class="pre">resource</span></tt> argument.  If an
empty string is passed as <tt class="docutils literal"><span class="pre">path</span></tt>, the <tt class="docutils literal"><span class="pre">resource</span></tt> passed in will
be returned.  Resource path strings must be escaped in the following
manner: each Unicode path segment must be encoded as UTF-8 and as
each path segment must escaped via Python's <tt class="xref py py-mod docutils literal"><span class="pre">urllib.quote</span></tt>.
For example, <tt class="docutils literal"><span class="pre">/path/to%20the/La%20Pe%C3%B1a</span></tt> (absolute) or
<tt class="docutils literal"><span class="pre">to%20the/La%20Pe%C3%B1a</span></tt> (relative).  The
<a class="reference internal" href="#pyramid.traversal.resource_path" title="pyramid.traversal.resource_path"><tt class="xref py py-func docutils literal"><span class="pre">pyramid.traversal.resource_path()</span></tt></a> function generates strings
which follow these rules (albeit only absolute ones).</p>
<p>Rules for passing <em>text</em> (Unicode) as the <tt class="docutils literal"><span class="pre">path</span></tt> argument are the same
as those for a string.  In particular, the text may not have any nonascii
characters in it.</p>
<p>Rules for passing a <em>tuple</em> as the <tt class="docutils literal"><span class="pre">path</span></tt> argument: if the first
element in the path tuple is the empty string (for example <tt class="docutils literal"><span class="pre">('',</span>
<span class="pre">'a',</span> <span class="pre">'b',</span> <span class="pre">'c')</span></tt>, the path is considered absolute and the resource tree
traversal will start at the resource tree root object.  If the first
element in the path tuple is not the empty string (for example
<tt class="docutils literal"><span class="pre">('a',</span> <span class="pre">'b',</span> <span class="pre">'c')</span></tt>), the path is considered relative and resource tree
traversal will begin at the resource object supplied to the function
as the <tt class="docutils literal"><span class="pre">resource</span></tt> argument.  If an empty sequence is passed as
<tt class="docutils literal"><span class="pre">path</span></tt>, the <tt class="docutils literal"><span class="pre">resource</span></tt> passed in itself will be returned.  No
URL-quoting or UTF-8-encoding of individual path segments within
the tuple is required (each segment may be any string or unicode
object representing a resource name).  Resource path tuples generated by
<a class="reference internal" href="#pyramid.traversal.resource_path_tuple" title="pyramid.traversal.resource_path_tuple"><tt class="xref py py-func docutils literal"><span class="pre">pyramid.traversal.resource_path_tuple()</span></tt></a> can always be
resolved by <tt class="docutils literal"><span class="pre">find_resource</span></tt>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For backwards compatibility purposes, this function can also
be imported as <tt class="xref py py-func docutils literal"><span class="pre">pyramid.traversal.find_model()</span></tt>, although doing so
will emit a deprecation warning.</p>
</div>
</dd></dl>
<dl class="function">
<dt id="pyramid.traversal.find_root"><a name="//apple_ref/cpp/func/pyramid.traversal.find_root"></a>
<tt class="descname">find_root</tt><big>(</big><em>resource</em><big>)</big><a class="reference internal" href="../_modules/pyramid/traversal.html#find_root"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyramid.traversal.find_root" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the root node in the resource tree to which <tt class="docutils literal"><span class="pre">resource</span></tt>
belongs. Note that <tt class="docutils literal"><span class="pre">resource</span></tt> should be <a class="reference internal" href="../glossary.html#term-location"><em class="xref std std-term">location</em></a>-aware.
Note that the root resource is available in the request object by
accessing the <tt class="docutils literal"><span class="pre">request.root</span></tt> attribute.</p>
</dd></dl>
<dl class="function">
<dt id="pyramid.traversal.resource_path"><a name="//apple_ref/cpp/func/pyramid.traversal.resource_path"></a>
<tt class="descname">resource_path</tt><big>(</big><em>resource</em>, <em>*elements</em><big>)</big><a class="reference internal" href="../_modules/pyramid/traversal.html#resource_path"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyramid.traversal.resource_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a string object representing the absolute physical path of the
resource object based on its position in the resource tree, e.g
<tt class="docutils literal"><span class="pre">/foo/bar</span></tt>.  Any positional arguments passed in as <tt class="docutils literal"><span class="pre">elements</span></tt> will be
appended as path segments to the end of the resource path.  For instance,
if the resource's path is <tt class="docutils literal"><span class="pre">/foo/bar</span></tt> and <tt class="docutils literal"><span class="pre">elements</span></tt> equals <tt class="docutils literal"><span class="pre">('a',</span>
<span class="pre">'b')</span></tt>, the returned string will be <tt class="docutils literal"><span class="pre">/foo/bar/a/b</span></tt>.  The first
character in the string will always be the <tt class="docutils literal"><span class="pre">/</span></tt> character (a leading
<tt class="docutils literal"><span class="pre">/</span></tt> character in a path string represents that the path is absolute).</p>
<p>Resource path strings returned will be escaped in the following
manner: each unicode path segment will be encoded as UTF-8 and
each path segment will be escaped via Python's <tt class="xref py py-mod docutils literal"><span class="pre">urllib.quote</span></tt>.
For example, <tt class="docutils literal"><span class="pre">/path/to%20the/La%20Pe%C3%B1a</span></tt>.</p>
<p>This function is a logical inverse of
<a class="reference internal" href="#pyramid.traversal.find_resource" title="pyramid.traversal.find_resource"><tt class="xref py py-mod docutils literal"><span class="pre">pyramid.traversal.find_resource</span></tt></a>: it can be used to generate
path references that can later be resolved via that function.</p>
<p>The <tt class="docutils literal"><span class="pre">resource</span></tt> passed in <em>must</em> be <a class="reference internal" href="../glossary.html#term-location"><em class="xref std std-term">location</em></a>-aware.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Each segment in the path string returned will use the <tt class="docutils literal"><span class="pre">__name__</span></tt>
attribute of the resource it represents within the resource tree.  Each
of these segments <em>should</em> be a unicode or string object (as per the
contract of <a class="reference internal" href="../glossary.html#term-location"><em class="xref std std-term">location</em></a>-awareness).  However, no conversion or
safety checking of resource names is performed.  For instance, if one of
the resources in your tree has a <tt class="docutils literal"><span class="pre">__name__</span></tt> which (by error) is a
dictionary, the <a class="reference internal" href="#pyramid.traversal.resource_path" title="pyramid.traversal.resource_path"><tt class="xref py py-func docutils literal"><span class="pre">pyramid.traversal.resource_path()</span></tt></a> function will
attempt to append it to a string and it will cause a
<a class="reference internal" href="exceptions.html#pyramid.exceptions.URLDecodeError" title="pyramid.exceptions.URLDecodeError"><tt class="xref py py-exc docutils literal"><span class="pre">pyramid.exceptions.URLDecodeError</span></tt></a>.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <a class="reference internal" href="../glossary.html#term-root"><em class="xref std std-term">root</em></a> resource <em>must</em> have a <tt class="docutils literal"><span class="pre">__name__</span></tt> attribute with a
value of either <tt class="docutils literal"><span class="pre">None</span></tt> or the empty string for paths to be generated
properly.  If the root resource has a non-null <tt class="docutils literal"><span class="pre">__name__</span></tt> attribute,
its name will be prepended to the generated path rather than a single
leading '/' character.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For backwards compatibility purposes, this function can also
be imported as <tt class="docutils literal"><span class="pre">model_path</span></tt>, although doing so will cause
a deprecation warning to be emitted.</p>
</div>
</dd></dl>
<dl class="function">
<dt id="pyramid.traversal.resource_path_tuple"><a name="//apple_ref/cpp/func/pyramid.traversal.resource_path_tuple"></a>
<tt class="descname">resource_path_tuple</tt><big>(</big><em>resource</em>, <em>*elements</em><big>)</big><a class="reference internal" href="../_modules/pyramid/traversal.html#resource_path_tuple"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyramid.traversal.resource_path_tuple" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a tuple representing the absolute physical path of the
<tt class="docutils literal"><span class="pre">resource</span></tt> object based on its position in a resource tree, e.g
<tt class="docutils literal"><span class="pre">('',</span> <span class="pre">'foo',</span> <span class="pre">'bar')</span></tt>.  Any positional arguments passed in as
<tt class="docutils literal"><span class="pre">elements</span></tt> will be appended as elements in the tuple
representing the resource path.  For instance, if the resource's
path is <tt class="docutils literal"><span class="pre">('',</span> <span class="pre">'foo',</span> <span class="pre">'bar')</span></tt> and elements equals <tt class="docutils literal"><span class="pre">('a',</span> <span class="pre">'b')</span></tt>,
the returned tuple will be <tt class="docutils literal"><span class="pre">('',</span> <span class="pre">'foo',</span> <span class="pre">'bar',</span> <span class="pre">'a',</span> <span class="pre">'b')</span></tt>.  The
first element of this tuple will always be the empty string (a
leading empty string element in a path tuple represents that the
path is absolute).</p>
<p>This function is a logical inverse of
<a class="reference internal" href="#pyramid.traversal.find_resource" title="pyramid.traversal.find_resource"><tt class="xref py py-func docutils literal"><span class="pre">pyramid.traversal.find_resource()</span></tt></a>: it can be used to
generate path references that can later be resolved by that function.</p>
<p>The <tt class="docutils literal"><span class="pre">resource</span></tt> passed in <em>must</em> be <a class="reference internal" href="../glossary.html#term-location"><em class="xref std std-term">location</em></a>-aware.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Each segment in the path tuple returned will equal the <tt class="docutils literal"><span class="pre">__name__</span></tt>
attribute of the resource it represents within the resource tree.  Each
of these segments <em>should</em> be a unicode or string object (as per the
contract of <a class="reference internal" href="../glossary.html#term-location"><em class="xref std std-term">location</em></a>-awareness).  However, no conversion or
safety checking of resource names is performed.  For instance, if one of
the resources in your tree has a <tt class="docutils literal"><span class="pre">__name__</span></tt> which (by error) is a
dictionary, that dictionary will be placed in the path tuple; no warning
or error will be given.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <a class="reference internal" href="../glossary.html#term-root"><em class="xref std std-term">root</em></a> resource <em>must</em> have a <tt class="docutils literal"><span class="pre">__name__</span></tt> attribute with a
value of either <tt class="docutils literal"><span class="pre">None</span></tt> or the empty string for path tuples to be
generated properly.  If the root resource has a non-null <tt class="docutils literal"><span class="pre">__name__</span></tt>
attribute, its name will be the first element in the generated path tuple
rather than the empty string.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For backwards compatibility purposes, this function can also be imported
as <tt class="docutils literal"><span class="pre">model_path_tuple</span></tt>, although doing so will cause a deprecation
warning to be emitted.</p>
</div>
</dd></dl>
<dl class="function">
<dt id="pyramid.traversal.quote_path_segment"><a name="//apple_ref/cpp/func/pyramid.traversal.quote_path_segment"></a>
<tt class="descname">quote_path_segment</tt><big>(</big><em>segment</em>, <em>safe=''</em><big>)</big><a class="reference internal" href="../_modules/pyramid/traversal.html#quote_path_segment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyramid.traversal.quote_path_segment" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="function">
<dt id="pyramid.traversal.virtual_root"><a name="//apple_ref/cpp/func/pyramid.traversal.virtual_root"></a>
<tt class="descname">virtual_root</tt><big>(</big><em>resource</em>, <em>request</em><big>)</big><a class="reference internal" href="../_modules/pyramid/traversal.html#virtual_root"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyramid.traversal.virtual_root" title="Permalink to this definition">¶</a></dt>
<dd><p>Provided any <a class="reference internal" href="../glossary.html#term-resource"><em class="xref std std-term">resource</em></a> and a <a class="reference internal" href="../glossary.html#term-request"><em class="xref std std-term">request</em></a> object, return
the resource object representing the <a class="reference internal" href="../glossary.html#term-virtual-root"><em class="xref std std-term">virtual root</em></a> of the
current <a class="reference internal" href="../glossary.html#term-request"><em class="xref std std-term">request</em></a>.  Using a virtual root in a
<a class="reference internal" href="../glossary.html#term-traversal"><em class="xref std std-term">traversal</em></a> -based <span>Pyramid</span> application permits
rooting, for example, the resource at the traversal path <tt class="docutils literal"><span class="pre">/cms</span></tt> at
<tt class="docutils literal"><span class="pre">http://example.com/</span></tt> instead of rooting it at
<tt class="docutils literal"><span class="pre">http://example.com/cms/</span></tt>.</p>
<p>If the <tt class="docutils literal"><span class="pre">resource</span></tt> passed in is a context obtained via
<a class="reference internal" href="../glossary.html#term-traversal"><em class="xref std std-term">traversal</em></a>, and if the <tt class="docutils literal"><span class="pre">HTTP_X_VHM_ROOT</span></tt> key is in the
WSGI environment, the value of this key will be treated as a
'virtual root path': the <a class="reference internal" href="#pyramid.traversal.find_resource" title="pyramid.traversal.find_resource"><tt class="xref py py-func docutils literal"><span class="pre">pyramid.traversal.find_resource()</span></tt></a>
API will be used to find the virtual root resource using this path;
if the resource is found, it will be returned.  If the
<tt class="docutils literal"><span class="pre">HTTP_X_VHM_ROOT</span></tt> key is not present in the WSGI environment,
the physical <a class="reference internal" href="../glossary.html#term-root"><em class="xref std std-term">root</em></a> of the resource tree will be returned instead.</p>
<p>Virtual roots are not useful at all in applications that use
<a class="reference internal" href="../glossary.html#term-url-dispatch"><em class="xref std std-term">URL dispatch</em></a>. Contexts obtained via URL dispatch don't
really support being virtually rooted (each URL dispatch context
is both its own physical and virtual root).  However if this API
is called with a <tt class="docutils literal"><span class="pre">resource</span></tt> argument which is a context obtained
via URL dispatch, the resource passed in will be returned
unconditionally.</p>
</dd></dl>
<dl class="function">
<dt id="pyramid.traversal.traverse"><a name="//apple_ref/cpp/func/pyramid.traversal.traverse"></a>
<tt class="descname">traverse</tt><big>(</big><em>resource</em>, <em>path</em><big>)</big><a class="reference internal" href="../_modules/pyramid/traversal.html#traverse"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyramid.traversal.traverse" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a resource object as <tt class="docutils literal"><span class="pre">resource</span></tt> and a string or tuple
representing a path as <tt class="docutils literal"><span class="pre">path</span></tt> (such as the return value of
<a class="reference internal" href="#pyramid.traversal.resource_path" title="pyramid.traversal.resource_path"><tt class="xref py py-func docutils literal"><span class="pre">pyramid.traversal.resource_path()</span></tt></a> or
<a class="reference internal" href="#pyramid.traversal.resource_path_tuple" title="pyramid.traversal.resource_path_tuple"><tt class="xref py py-func docutils literal"><span class="pre">pyramid.traversal.resource_path_tuple()</span></tt></a> or the value of
<tt class="docutils literal"><span class="pre">request.environ['PATH_INFO']</span></tt>), return a dictionary with the
keys <tt class="docutils literal"><span class="pre">context</span></tt>, <tt class="docutils literal"><span class="pre">root</span></tt>, <tt class="docutils literal"><span class="pre">view_name</span></tt>, <tt class="docutils literal"><span class="pre">subpath</span></tt>,
<tt class="docutils literal"><span class="pre">traversed</span></tt>, <tt class="docutils literal"><span class="pre">virtual_root</span></tt>, and <tt class="docutils literal"><span class="pre">virtual_root_path</span></tt>.</p>
<p>A definition of each value in the returned dictionary:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">context</span></tt>: The <a class="reference internal" href="../glossary.html#term-context"><em class="xref std std-term">context</em></a> (a <a class="reference internal" href="../glossary.html#term-resource"><em class="xref std std-term">resource</em></a> object) found
via traversal or url dispatch.  If the <tt class="docutils literal"><span class="pre">path</span></tt> passed in is the
empty string, the value of the <tt class="docutils literal"><span class="pre">resource</span></tt> argument passed to this
function is returned.</li>
<li><tt class="docutils literal"><span class="pre">root</span></tt>: The resource object at which <a class="reference internal" href="../glossary.html#term-traversal"><em class="xref std std-term">traversal</em></a> begins.
If the <tt class="docutils literal"><span class="pre">resource</span></tt> passed in was found via url dispatch or if the
<tt class="docutils literal"><span class="pre">path</span></tt> passed in was relative (non-absolute), the value of the
<tt class="docutils literal"><span class="pre">resource</span></tt> argument passed to this function is returned.</li>
<li><tt class="docutils literal"><span class="pre">view_name</span></tt>: The <a class="reference internal" href="../glossary.html#term-view-name"><em class="xref std std-term">view name</em></a> found during
<a class="reference internal" href="../glossary.html#term-traversal"><em class="xref std std-term">traversal</em></a> or <a class="reference internal" href="../glossary.html#term-url-dispatch"><em class="xref std std-term">url dispatch</em></a>; if the <tt class="docutils literal"><span class="pre">resource</span></tt> was
found via traversal, this is usually a representation of the
path segment which directly follows the path to the <tt class="docutils literal"><span class="pre">context</span></tt>
in the <tt class="docutils literal"><span class="pre">path</span></tt>.  The <tt class="docutils literal"><span class="pre">view_name</span></tt> will be a Unicode object or
the empty string.  The <tt class="docutils literal"><span class="pre">view_name</span></tt> will be the empty string if
there is no element which follows the <tt class="docutils literal"><span class="pre">context</span></tt> path.  An
example: if the path passed is <tt class="docutils literal"><span class="pre">/foo/bar</span></tt>, and a resource
object is found at <tt class="docutils literal"><span class="pre">/foo</span></tt> (but not at <tt class="docutils literal"><span class="pre">/foo/bar</span></tt>), the 'view
name' will be <tt class="docutils literal"><span class="pre">u'bar'</span></tt>.  If the <tt class="docutils literal"><span class="pre">resource</span></tt> was found via
urldispatch, the view_name will be the name the route found was
registered with.</li>
<li><tt class="docutils literal"><span class="pre">subpath</span></tt>: For a <tt class="docutils literal"><span class="pre">resource</span></tt> found via <a class="reference internal" href="../glossary.html#term-traversal"><em class="xref std std-term">traversal</em></a>, this
is a sequence of path segments found in the <tt class="docutils literal"><span class="pre">path</span></tt> that follow
the <tt class="docutils literal"><span class="pre">view_name</span></tt> (if any).  Each of these items is a Unicode
object.  If no path segments follow the <tt class="docutils literal"><span class="pre">view_name</span></tt>, the
subpath will be the empty sequence.  An example: if the path
passed is <tt class="docutils literal"><span class="pre">/foo/bar/baz/buz</span></tt>, and a resource object is found at
<tt class="docutils literal"><span class="pre">/foo</span></tt> (but not <tt class="docutils literal"><span class="pre">/foo/bar</span></tt>), the 'view name' will be
<tt class="docutils literal"><span class="pre">u'bar'</span></tt> and the <a class="reference internal" href="../glossary.html#term-subpath"><em class="xref std std-term">subpath</em></a> will be <tt class="docutils literal"><span class="pre">[u'baz',</span> <span class="pre">u'buz']</span></tt>.
For a <tt class="docutils literal"><span class="pre">resource</span></tt> found via url dispatch, the subpath will be a
sequence of values discerned from <tt class="docutils literal"><span class="pre">*subpath</span></tt> in the route
pattern matched or the empty sequence.</li>
<li><tt class="docutils literal"><span class="pre">traversed</span></tt>: The sequence of path elements traversed from the
root to find the <tt class="docutils literal"><span class="pre">context</span></tt> object during <a class="reference internal" href="../glossary.html#term-traversal"><em class="xref std std-term">traversal</em></a>.
Each of these items is a Unicode object.  If no path segments
were traversed to find the <tt class="docutils literal"><span class="pre">context</span></tt> object (e.g. if the
<tt class="docutils literal"><span class="pre">path</span></tt> provided is the empty string), the <tt class="docutils literal"><span class="pre">traversed</span></tt> value
will be the empty sequence.  If the <tt class="docutils literal"><span class="pre">resource</span></tt> is a resource found
via <a class="reference internal" href="../glossary.html#term-url-dispatch"><em class="xref std std-term">url dispatch</em></a>, traversed will be None.</li>
<li><tt class="docutils literal"><span class="pre">virtual_root</span></tt>: A resource object representing the 'virtual' root
of the resource tree being traversed during <a class="reference internal" href="../glossary.html#term-traversal"><em class="xref std std-term">traversal</em></a>.
See <a class="reference internal" href="../narr/vhosting.html#vhosting-chapter"><em>Virtual Hosting</em></a> for a definition of the virtual root
object.  If no virtual hosting is in effect, and the <tt class="docutils literal"><span class="pre">path</span></tt>
passed in was absolute, the <tt class="docutils literal"><span class="pre">virtual_root</span></tt> will be the
<em>physical</em> root resource object (the object at which <a class="reference internal" href="../glossary.html#term-traversal"><em class="xref std std-term">traversal</em></a>
begins).  If the <tt class="docutils literal"><span class="pre">resource</span></tt> passed in was found via <a class="reference internal" href="../glossary.html#term-url-dispatch"><em class="xref std std-term">URL
dispatch</em></a> or if the <tt class="docutils literal"><span class="pre">path</span></tt> passed in was relative, the
<tt class="docutils literal"><span class="pre">virtual_root</span></tt> will always equal the <tt class="docutils literal"><span class="pre">root</span></tt> object (the
resource passed in).</li>
<li><tt class="docutils literal"><span class="pre">virtual_root_path</span></tt> -- If <a class="reference internal" href="../glossary.html#term-traversal"><em class="xref std std-term">traversal</em></a> was used to find
the <tt class="docutils literal"><span class="pre">resource</span></tt>, this will be the sequence of path elements
traversed to find the <tt class="docutils literal"><span class="pre">virtual_root</span></tt> resource.  Each of these
items is a Unicode object.  If no path segments were traversed
to find the <tt class="docutils literal"><span class="pre">virtual_root</span></tt> resource (e.g. if virtual hosting is
not in effect), the <tt class="docutils literal"><span class="pre">traversed</span></tt> value will be the empty list.
If url dispatch was used to find the <tt class="docutils literal"><span class="pre">resource</span></tt>, this will be
<tt class="docutils literal"><span class="pre">None</span></tt>.</li>
</ul>
<p>If the path cannot be resolved, a <a class="reference external" href="http://docs.python.org/3/library/exceptions.html#KeyError" title="(in Python v3.4)"><tt class="xref py py-exc docutils literal"><span class="pre">KeyError</span></tt></a> will be raised.</p>
<p>Rules for passing a <em>string</em> as the <tt class="docutils literal"><span class="pre">path</span></tt> argument: if the
first character in the path string is the with the <tt class="docutils literal"><span class="pre">/</span></tt>
character, the path will considered absolute and the resource tree
traversal will start at the root resource.  If the first character
of the path string is <em>not</em> the <tt class="docutils literal"><span class="pre">/</span></tt> character, the path is
considered relative and resource tree traversal will begin at the resource
object supplied to the function as the <tt class="docutils literal"><span class="pre">resource</span></tt> argument.  If an
empty string is passed as <tt class="docutils literal"><span class="pre">path</span></tt>, the <tt class="docutils literal"><span class="pre">resource</span></tt> passed in will
be returned.  Resource path strings must be escaped in the following
manner: each Unicode path segment must be encoded as UTF-8 and
each path segment must escaped via Python's <tt class="xref py py-mod docutils literal"><span class="pre">urllib.quote</span></tt>.
For example, <tt class="docutils literal"><span class="pre">/path/to%20the/La%20Pe%C3%B1a</span></tt> (absolute) or
<tt class="docutils literal"><span class="pre">to%20the/La%20Pe%C3%B1a</span></tt> (relative).  The
<a class="reference internal" href="#pyramid.traversal.resource_path" title="pyramid.traversal.resource_path"><tt class="xref py py-func docutils literal"><span class="pre">pyramid.traversal.resource_path()</span></tt></a> function generates strings
which follow these rules (albeit only absolute ones).</p>
<p>Rules for passing a <em>tuple</em> as the <tt class="docutils literal"><span class="pre">path</span></tt> argument: if the first
element in the path tuple is the empty string (for example <tt class="docutils literal"><span class="pre">('',</span>
<span class="pre">'a',</span> <span class="pre">'b',</span> <span class="pre">'c')</span></tt>, the path is considered absolute and the resource tree
traversal will start at the resource tree root object.  If the first
element in the path tuple is not the empty string (for example
<tt class="docutils literal"><span class="pre">('a',</span> <span class="pre">'b',</span> <span class="pre">'c')</span></tt>), the path is considered relative and resource tree
traversal will begin at the resource object supplied to the function
as the <tt class="docutils literal"><span class="pre">resource</span></tt> argument.  If an empty sequence is passed as
<tt class="docutils literal"><span class="pre">path</span></tt>, the <tt class="docutils literal"><span class="pre">resource</span></tt> passed in itself will be returned.  No
URL-quoting or UTF-8-encoding of individual path segments within
the tuple is required (each segment may be any string or unicode
object representing a resource name).</p>
<p>Explanation of the conversion of <tt class="docutils literal"><span class="pre">path</span></tt> segment values to
Unicode during traversal: Each segment is URL-unquoted, and
decoded into Unicode. Each segment is assumed to be encoded using
the UTF-8 encoding (or a subset, such as ASCII); a
<a class="reference internal" href="exceptions.html#pyramid.exceptions.URLDecodeError" title="pyramid.exceptions.URLDecodeError"><tt class="xref py py-exc docutils literal"><span class="pre">pyramid.exceptions.URLDecodeError</span></tt></a> is raised if a segment
cannot be decoded.  If a segment name is empty or if it is <tt class="docutils literal"><span class="pre">.</span></tt>,
it is ignored.  If a segment name is <tt class="docutils literal"><span class="pre">..</span></tt>, the previous segment
is deleted, and the <tt class="docutils literal"><span class="pre">..</span></tt> is ignored.  As a result of this
process, the return values <tt class="docutils literal"><span class="pre">view_name</span></tt>, each element in the
<tt class="docutils literal"><span class="pre">subpath</span></tt>, each element in <tt class="docutils literal"><span class="pre">traversed</span></tt>, and each element in
the <tt class="docutils literal"><span class="pre">virtual_root_path</span></tt> will be Unicode as opposed to a string,
and will be URL-decoded.</p>
</dd></dl>
<dl class="function">
<dt id="pyramid.traversal.traversal_path"><a name="//apple_ref/cpp/func/pyramid.traversal.traversal_path"></a>
<tt class="descname">traversal_path</tt><big>(</big><em>path</em><big>)</big><a class="reference internal" href="../_modules/pyramid/traversal.html#traversal_path"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyramid.traversal.traversal_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Variant of <tt class="xref py py-func docutils literal"><span class="pre">pyramid.traversal.traversal_path_info()</span></tt> suitable for
decoding paths that are URL-encoded.</p>
<p>If this function is passed a Unicode object instead of a sequence of
bytes as <tt class="docutils literal"><span class="pre">path</span></tt>, that Unicode object <em>must</em> directly encodeable to
ASCII.  For example, u'/foo' will work but u'/&lt;unprintable unicode&gt;' (a
Unicode object with characters that cannot be encoded to ascii) will
not. A <a class="reference external" href="http://docs.python.org/3/library/exceptions.html#UnicodeEncodeError" title="(in Python v3.4)"><tt class="xref py py-exc docutils literal"><span class="pre">UnicodeEncodeError</span></tt></a> will be raised if the Unicode cannot be
encoded directly to ASCII.</p>
</dd></dl>
</div>
</div>
</div>
</div>
<div class="sphinxsidebar">
<div class="sphinxsidebarwrapper">
<h4>Previous topic</h4>
<p class="topless"><a href="threadlocal.html" title="previous chapter"><tt class="docutils literal"><span class="pre">pyramid.threadlocal</span></tt></a></p>
<h4>Next topic</h4>
<p class="topless"><a href="tweens.html" title="next chapter"><tt class="docutils literal"><span class="pre">pyramid.tweens</span></tt></a></p>
<div id="searchbox" style="display: none">
<h3>Quick search</h3>
<form action="../search.html" class="search" method="get">
<input name="q" type="text"/>
<input type="submit" value="Go"/>
<input name="check_keywords" type="hidden" value="yes"/>
<input name="area" type="hidden" value="default"/>
</form>
<p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
</div>
</div>
<div class="clearer"></div>
</div>
<div class="related">
<h3>Navigation</h3>
<ul>
<li class="right" style="margin-right: 10px">
<a href="../genindex.html" title="General Index">index</a></li>
<li class="right">
<a href="../py-modindex.html" title="Python Module Index">modules</a> |</li>
<li class="right">
<a href="tweens.html" title="pyramid.tweens">next</a> |</li>
<li class="right">
<a href="threadlocal.html" title="pyramid.threadlocal">previous</a> |</li>
<li><a href="../index.html">The Pyramid Web Framework v1.5</a> »</li>
</ul>
</div>
<div class="footer">
        © <a href="../copyright.html">Copyright</a> 2008-2014, Agendaless Consulting.
      Last updated on Nov 09, 2014.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
</body></html>