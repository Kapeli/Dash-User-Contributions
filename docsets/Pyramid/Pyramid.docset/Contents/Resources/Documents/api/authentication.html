<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta content="text/html; charset=utf-8" http-equiv="Content-Type"/><title>pyramid.authentication — The Pyramid Web Framework v1.5</title><link href="../_static/pylons.css" rel="stylesheet" type="text/css"/><link href="../_static/pygments.css" rel="stylesheet" type="text/css"/><script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.5',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script><script src="../_static/jquery.js" type="text/javascript"></script><script src="../_static/underscore.js" type="text/javascript"></script><script src="../_static/doctools.js" type="text/javascript"></script><link href="../copyright.html" rel="copyright" title="Copyright"/><link href="../index.html" rel="top" title="The Pyramid Web Framework v1.5"/><link href="authorization.html" rel="next" title="pyramid.authorization"/><link href="../tutorials/modwsgi/index.html" rel="prev" title="Running a Pyramid Application under mod_wsgi"/><link charset="utf-8" href="http://static.pylonsproject.org/fonts/nobile/stylesheet.css" media="screen" rel="stylesheet" type="text/css"/><link charset="utf-8" href="http://static.pylonsproject.org/fonts/neuton/stylesheet.css" media="screen" rel="stylesheet" type="text/css"/><!--[if lte IE 6]>
<link rel="stylesheet" href="../_static/ie6.css" type="text/css" media="screen" charset="utf-8" />
<![endif]--><link href="../_static/pyramid.ico" rel="shortcut icon"/></head><body>
<div class="header-small">
<div class="logo-small">
<a href="../index.html">
<img alt="Logo" class="logo" src="../_static/pyramid-small.png"/>
</a>
</div>
</div>
<div class="related">
<h3>Navigation</h3>
<ul>
<li class="right" style="margin-right: 10px">
<a accesskey="I" href="../genindex.html" title="General Index">index</a></li>
<li class="right">
<a href="../py-modindex.html" title="Python Module Index">modules</a> |</li>
<li class="right">
<a accesskey="N" href="authorization.html" title="pyramid.authorization">next</a> |</li>
<li class="right">
<a accesskey="P" href="../tutorials/modwsgi/index.html" title="Running a Pyramid Application under mod_wsgi">previous</a> |</li>
<li><a href="../index.html">The Pyramid Web Framework v1.5</a> »</li>
</ul>
</div>
<div class="document">
<div class="documentwrapper">
<div class="bodywrapper">
<div class="body">
<div class="section" id="pyramid-authentication">
<span id="authentication-module"></span><h1><a class="reference internal" href="#module-pyramid.authentication" title="pyramid.authentication"><tt class="xref py py-mod docutils literal"><span class="pre">pyramid.authentication</span></tt></a><a class="headerlink" href="#pyramid-authentication" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-pyramid.authentication">
<span id="authentication-policies"></span><h2><a name="//apple_ref/cpp/Module/pyramid.authentication"></a>Authentication Policies<a class="headerlink" href="#module-pyramid.authentication" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="pyramid.authentication.AuthTktAuthenticationPolicy"><a name="//apple_ref/cpp/cl/pyramid.authentication.AuthTktAuthenticationPolicy"></a>
<em class="property">class </em><tt class="descname">AuthTktAuthenticationPolicy</tt><big>(</big><em>secret</em>, <em>callback=None</em>, <em>cookie_name='auth_tkt'</em>, <em>secure=False</em>, <em>include_ip=False</em>, <em>timeout=None</em>, <em>reissue_time=None</em>, <em>max_age=None</em>, <em>path='/'</em>, <em>http_only=False</em>, <em>wild_domain=True</em>, <em>debug=False</em>, <em>hashalg=&lt;object object at 0x106b3f1f0&gt;</em>, <em>parent_domain=False</em>, <em>domain=None</em><big>)</big><a class="reference internal" href="../_modules/pyramid/authentication.html#AuthTktAuthenticationPolicy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyramid.authentication.AuthTktAuthenticationPolicy" title="Permalink to this definition">¶</a></dt>
<dd><p>A <span>Pyramid</span> <a class="reference internal" href="../glossary.html#term-authentication-policy"><em class="xref std std-term">authentication policy</em></a> which
obtains data from a Pyramid "auth ticket" cookie.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The default hash algorithm used in this policy is MD5 and has known
hash collision vulnerabilities. The risk of an exploit is low.
However, for improved authentication security, use
<tt class="docutils literal"><span class="pre">hashalg='sha512'</span></tt>.</p>
</div>
<p>Constructor Arguments</p>
<p><tt class="docutils literal"><span class="pre">secret</span></tt></p>
<blockquote>
<div>The secret (a string) used for auth_tkt cookie signing.  This value
should be unique across all values provided to Pyramid for various
subsystem secrets (see <a class="reference internal" href="../narr/security.html#admonishment-against-secret-sharing"><em>Admonishment Against Secret-Sharing</em></a>).
Required.</div></blockquote>
<p><tt class="docutils literal"><span class="pre">callback</span></tt></p>
<blockquote>
<div>Default: <tt class="docutils literal"><span class="pre">None</span></tt>.  A callback passed the userid and the
request, expected to return <tt class="docutils literal"><span class="pre">None</span></tt> if the userid doesn't
exist or a sequence of principal identifiers (possibly empty) if
the user does exist.  If <tt class="docutils literal"><span class="pre">callback</span></tt> is <tt class="docutils literal"><span class="pre">None</span></tt>, the userid
will be assumed to exist with no principals.  Optional.</div></blockquote>
<p><tt class="docutils literal"><span class="pre">cookie_name</span></tt></p>
<blockquote>
<div>Default: <tt class="docutils literal"><span class="pre">auth_tkt</span></tt>.  The cookie name used
(string).  Optional.</div></blockquote>
<p><tt class="docutils literal"><span class="pre">secure</span></tt></p>
<blockquote>
<div>Default: <tt class="docutils literal"><span class="pre">False</span></tt>.  Only send the cookie back over a secure
conn.  Optional.</div></blockquote>
<p><tt class="docutils literal"><span class="pre">include_ip</span></tt></p>
<blockquote>
<div><p>Default: <tt class="docutils literal"><span class="pre">False</span></tt>.  Make the requesting IP address part of
the authentication data in the cookie.  Optional.</p>
<p>For IPv6 this option is not recommended. The <tt class="docutils literal"><span class="pre">mod_auth_tkt</span></tt>
specification does not specify how to handle IPv6 addresses, so using
this option in combination with IPv6 addresses may cause an
incompatible cookie. It ties the authentication ticket to that
individual's IPv6 address.</p>
</div></blockquote>
<p><tt class="docutils literal"><span class="pre">timeout</span></tt></p>
<blockquote>
<div>Default: <tt class="docutils literal"><span class="pre">None</span></tt>.  Maximum number of seconds which a newly
issued ticket will be considered valid.  After this amount of
time, the ticket will expire (effectively logging the user
out).  If this value is <tt class="docutils literal"><span class="pre">None</span></tt>, the ticket never expires.
Optional.</div></blockquote>
<p><tt class="docutils literal"><span class="pre">reissue_time</span></tt></p>
<blockquote>
<div><p>Default: <tt class="docutils literal"><span class="pre">None</span></tt>.  If this parameter is set, it represents the number
of seconds that must pass before an authentication token cookie is
automatically reissued as the result of a request which requires
authentication.  The duration is measured as the number of seconds
since the last auth_tkt cookie was issued and 'now'.  If this value is
<tt class="docutils literal"><span class="pre">0</span></tt>, a new ticket cookie will be reissued on every request which
requires authentication.</p>
<p>A good rule of thumb: if you want auto-expired cookies based on
inactivity: set the <tt class="docutils literal"><span class="pre">timeout</span></tt> value to 1200 (20 mins) and set the
<tt class="docutils literal"><span class="pre">reissue_time</span></tt> value to perhaps a tenth of the <tt class="docutils literal"><span class="pre">timeout</span></tt> value
(120 or 2 mins).  It's nonsensical to set the <tt class="docutils literal"><span class="pre">timeout</span></tt> value lower
than the <tt class="docutils literal"><span class="pre">reissue_time</span></tt> value, as the ticket will never be reissued
if so.  However, such a configuration is not explicitly prevented.</p>
<p>Optional.</p>
</div></blockquote>
<p><tt class="docutils literal"><span class="pre">max_age</span></tt></p>
<blockquote>
<div>Default: <tt class="docutils literal"><span class="pre">None</span></tt>.  The max age of the auth_tkt cookie, in
seconds.  This differs from <tt class="docutils literal"><span class="pre">timeout</span></tt> inasmuch as <tt class="docutils literal"><span class="pre">timeout</span></tt>
represents the lifetime of the ticket contained in the cookie,
while this value represents the lifetime of the cookie itself.
When this value is set, the cookie's <tt class="docutils literal"><span class="pre">Max-Age</span></tt> and
<tt class="docutils literal"><span class="pre">Expires</span></tt> settings will be set, allowing the auth_tkt cookie
to last between browser sessions.  It is typically nonsensical
to set this to a value that is lower than <tt class="docutils literal"><span class="pre">timeout</span></tt> or
<tt class="docutils literal"><span class="pre">reissue_time</span></tt>, although it is not explicitly prevented.
Optional.</div></blockquote>
<p><tt class="docutils literal"><span class="pre">path</span></tt></p>
<blockquote>
<div>Default: <tt class="docutils literal"><span class="pre">/</span></tt>. The path for which the auth_tkt cookie is valid.
May be desirable if the application only serves part of a domain.
Optional.</div></blockquote>
<p><tt class="docutils literal"><span class="pre">http_only</span></tt></p>
<blockquote>
<div>Default: <tt class="docutils literal"><span class="pre">False</span></tt>. Hide cookie from JavaScript by setting the
HttpOnly flag. Not honored by all browsers.
Optional.</div></blockquote>
<p><tt class="docutils literal"><span class="pre">wild_domain</span></tt></p>
<blockquote>
<div>Default: <tt class="docutils literal"><span class="pre">True</span></tt>. An auth_tkt cookie will be generated for the
wildcard domain. If your site is hosted as <tt class="docutils literal"><span class="pre">example.com</span></tt> this
will make the cookie available for sites underneath <tt class="docutils literal"><span class="pre">example.com</span></tt>
such as <tt class="docutils literal"><span class="pre">www.example.com</span></tt>.
Optional.</div></blockquote>
<p><tt class="docutils literal"><span class="pre">parent_domain</span></tt></p>
<blockquote>
<div><p>Default: <tt class="docutils literal"><span class="pre">False</span></tt>. An auth_tkt cookie will be generated for the
parent domain of the current site. For example if your site is
hosted under <tt class="docutils literal"><span class="pre">www.example.com</span></tt> a cookie will be generated for
<tt class="docutils literal"><span class="pre">.example.com</span></tt>. This can be useful if you have multiple sites
sharing the same domain. This option supercedes the <tt class="docutils literal"><span class="pre">wild_domain</span></tt>
option.
Optional.</p>
<p>This option is available as of <span>Pyramid</span> 1.5.</p>
</div></blockquote>
<p><tt class="docutils literal"><span class="pre">domain</span></tt></p>
<blockquote>
<div><p>Default: <tt class="docutils literal"><span class="pre">None</span></tt>. If provided the auth_tkt cookie will only be
set for this domain. This option is not compatible with <tt class="docutils literal"><span class="pre">wild_domain</span></tt>
and <tt class="docutils literal"><span class="pre">parent_domain</span></tt>.
Optional.</p>
<p>This option is available as of <span>Pyramid</span> 1.5.</p>
</div></blockquote>
<p><tt class="docutils literal"><span class="pre">hashalg</span></tt></p>
<blockquote>
<div><p>Default: <tt class="docutils literal"><span class="pre">md5</span></tt> (the literal string).</p>
<p>Any hash algorithm supported by Python's <tt class="docutils literal"><span class="pre">hashlib.new()</span></tt> function
can be used as the <tt class="docutils literal"><span class="pre">hashalg</span></tt>.</p>
<p>Cookies generated by different instances of AuthTktAuthenticationPolicy
using different <tt class="docutils literal"><span class="pre">hashalg</span></tt> options are not compatible. Switching the
<tt class="docutils literal"><span class="pre">hashalg</span></tt> will imply that all existing users with a valid cookie will
be required to re-login.</p>
<p>A warning is emitted at startup if an explicit <tt class="docutils literal"><span class="pre">hashalg</span></tt> is not
passed.  This is for backwards compatibility reasons.</p>
<p>This option is available as of <span>Pyramid</span> 1.4.</p>
<p>Optional.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><tt class="docutils literal"><span class="pre">md5</span></tt> is the default for backwards compatibility reasons. However,
if you don't specify <tt class="docutils literal"><span class="pre">md5</span></tt> as the hashalg explicitly, a warning is
issued at application startup time.  An explicit value of <tt class="docutils literal"><span class="pre">sha512</span></tt>
is recommended for improved security, and <tt class="docutils literal"><span class="pre">sha512</span></tt> will become the
default in a future Pyramid version.</p>
</div>
</div></blockquote>
<p><tt class="docutils literal"><span class="pre">debug</span></tt></p>
<blockquote>
<div>Default: <tt class="docutils literal"><span class="pre">False</span></tt>.  If <tt class="docutils literal"><span class="pre">debug</span></tt> is <tt class="docutils literal"><span class="pre">True</span></tt>, log messages to the
Pyramid debug logger about the results of various authentication
steps.  The output from debugging is useful for reporting to maillist
or IRC channels when asking for support.</div></blockquote>
<p>Objects of this class implement the interface described by
<a class="reference internal" href="interfaces.html#pyramid.interfaces.IAuthenticationPolicy" title="pyramid.interfaces.IAuthenticationPolicy"><tt class="xref py py-class docutils literal"><span class="pre">pyramid.interfaces.IAuthenticationPolicy</span></tt></a>.</p>
<dl class="method">
<dt id="pyramid.authentication.AuthTktAuthenticationPolicy.authenticated_userid"><a name="//apple_ref/cpp/clm/pyramid.authentication.AuthTktAuthenticationPolicy.authenticated_userid"></a>
<tt class="descname">authenticated_userid</tt><big>(</big><em>request</em><big>)</big><a class="headerlink" href="#pyramid.authentication.AuthTktAuthenticationPolicy.authenticated_userid" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the authenticated userid or <tt class="docutils literal"><span class="pre">None</span></tt>.</p>
<p>If no callback is registered, this will be the same as
<tt class="docutils literal"><span class="pre">unauthenticated_userid</span></tt>.</p>
<p>If a <tt class="docutils literal"><span class="pre">callback</span></tt> is registered, this will return the userid if
and only if the callback returns a value that is not <tt class="docutils literal"><span class="pre">None</span></tt>.</p>
</dd></dl>
<dl class="method">
<dt id="pyramid.authentication.AuthTktAuthenticationPolicy.effective_principals"><a name="//apple_ref/cpp/clm/pyramid.authentication.AuthTktAuthenticationPolicy.effective_principals"></a>
<tt class="descname">effective_principals</tt><big>(</big><em>request</em><big>)</big><a class="headerlink" href="#pyramid.authentication.AuthTktAuthenticationPolicy.effective_principals" title="Permalink to this definition">¶</a></dt>
<dd><p>A list of effective principals derived from request.</p>
<p>This will return a list of principals including, at least,
<a class="reference internal" href="security.html#pyramid.security.Everyone" title="pyramid.security.Everyone"><tt class="xref py py-data docutils literal"><span class="pre">pyramid.security.Everyone</span></tt></a>. If there is no authenticated
userid, or the <tt class="docutils literal"><span class="pre">callback</span></tt> returns <tt class="docutils literal"><span class="pre">None</span></tt>, this will be the
only principal:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">return</span> <span class="p">[</span><span class="n">Everyone</span><span class="p">]</span>
</pre></div>
</div>
<p>If the <tt class="docutils literal"><span class="pre">callback</span></tt> does not return <tt class="docutils literal"><span class="pre">None</span></tt> and an authenticated
userid is found, then the principals will include
<a class="reference internal" href="security.html#pyramid.security.Authenticated" title="pyramid.security.Authenticated"><tt class="xref py py-data docutils literal"><span class="pre">pyramid.security.Authenticated</span></tt></a>, the <tt class="docutils literal"><span class="pre">authenticated_userid</span></tt>
and the list of principals returned by the <tt class="docutils literal"><span class="pre">callback</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">extra_principals</span> <span class="o">=</span> <span class="n">callback</span><span class="p">(</span><span class="n">userid</span><span class="p">,</span> <span class="n">request</span><span class="p">)</span>
<span class="k">return</span> <span class="p">[</span><span class="n">Everyone</span><span class="p">,</span> <span class="n">Authenticated</span><span class="p">,</span> <span class="n">userid</span><span class="p">]</span> <span class="o">+</span> <span class="n">extra_principals</span>
</pre></div>
</div>
</dd></dl>
<dl class="method">
<dt id="pyramid.authentication.AuthTktAuthenticationPolicy.forget"><a name="//apple_ref/cpp/clm/pyramid.authentication.AuthTktAuthenticationPolicy.forget"></a>
<tt class="descname">forget</tt><big>(</big><em>request</em><big>)</big><a class="reference internal" href="../_modules/pyramid/authentication.html#AuthTktAuthenticationPolicy.forget"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyramid.authentication.AuthTktAuthenticationPolicy.forget" title="Permalink to this definition">¶</a></dt>
<dd><p>A list of headers which will delete appropriate cookies.</p>
</dd></dl>
<dl class="method">
<dt id="pyramid.authentication.AuthTktAuthenticationPolicy.remember"><a name="//apple_ref/cpp/clm/pyramid.authentication.AuthTktAuthenticationPolicy.remember"></a>
<tt class="descname">remember</tt><big>(</big><em>request</em>, <em>principal</em>, <em>**kw</em><big>)</big><a class="reference internal" href="../_modules/pyramid/authentication.html#AuthTktAuthenticationPolicy.remember"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyramid.authentication.AuthTktAuthenticationPolicy.remember" title="Permalink to this definition">¶</a></dt>
<dd><p>Accepts the following kw args: <tt class="docutils literal"><span class="pre">max_age=&lt;int-seconds&gt;,</span>
<span class="pre">``tokens=&lt;sequence-of-ascii-strings&gt;</span></tt>.</p>
<p>Return a list of headers which will set appropriate cookies on
the response.</p>
</dd></dl>
<dl class="method">
<dt id="pyramid.authentication.AuthTktAuthenticationPolicy.unauthenticated_userid"><a name="//apple_ref/cpp/clm/pyramid.authentication.AuthTktAuthenticationPolicy.unauthenticated_userid"></a>
<tt class="descname">unauthenticated_userid</tt><big>(</big><em>request</em><big>)</big><a class="reference internal" href="../_modules/pyramid/authentication.html#AuthTktAuthenticationPolicy.unauthenticated_userid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyramid.authentication.AuthTktAuthenticationPolicy.unauthenticated_userid" title="Permalink to this definition">¶</a></dt>
<dd><p>The userid key within the auth_tkt cookie.</p>
</dd></dl>
</dd></dl>
<dl class="class">
<dt id="pyramid.authentication.RemoteUserAuthenticationPolicy"><a name="//apple_ref/cpp/cl/pyramid.authentication.RemoteUserAuthenticationPolicy"></a>
<em class="property">class </em><tt class="descname">RemoteUserAuthenticationPolicy</tt><big>(</big><em>environ_key='REMOTE_USER'</em>, <em>callback=None</em>, <em>debug=False</em><big>)</big><a class="reference internal" href="../_modules/pyramid/authentication.html#RemoteUserAuthenticationPolicy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyramid.authentication.RemoteUserAuthenticationPolicy" title="Permalink to this definition">¶</a></dt>
<dd><p>A <span>Pyramid</span> <a class="reference internal" href="../glossary.html#term-authentication-policy"><em class="xref std std-term">authentication policy</em></a> which
obtains data from the <tt class="docutils literal"><span class="pre">REMOTE_USER</span></tt> WSGI environment variable.</p>
<p>Constructor Arguments</p>
<p><tt class="docutils literal"><span class="pre">environ_key</span></tt></p>
<blockquote>
<div>Default: <tt class="docutils literal"><span class="pre">REMOTE_USER</span></tt>.  The key in the WSGI environ which
provides the userid.</div></blockquote>
<p><tt class="docutils literal"><span class="pre">callback</span></tt></p>
<blockquote>
<div>Default: <tt class="docutils literal"><span class="pre">None</span></tt>.  A callback passed the userid and the request,
expected to return None if the userid doesn't exist or a sequence of
principal identifiers (possibly empty) representing groups if the
user does exist.  If <tt class="docutils literal"><span class="pre">callback</span></tt> is None, the userid will be assumed
to exist with no group principals.</div></blockquote>
<p><tt class="docutils literal"><span class="pre">debug</span></tt></p>
<blockquote>
<div>Default: <tt class="docutils literal"><span class="pre">False</span></tt>.  If <tt class="docutils literal"><span class="pre">debug</span></tt> is <tt class="docutils literal"><span class="pre">True</span></tt>, log messages to the
Pyramid debug logger about the results of various authentication
steps.  The output from debugging is useful for reporting to maillist
or IRC channels when asking for support.</div></blockquote>
<p>Objects of this class implement the interface described by
<a class="reference internal" href="interfaces.html#pyramid.interfaces.IAuthenticationPolicy" title="pyramid.interfaces.IAuthenticationPolicy"><tt class="xref py py-class docutils literal"><span class="pre">pyramid.interfaces.IAuthenticationPolicy</span></tt></a>.</p>
<dl class="method">
<dt id="pyramid.authentication.RemoteUserAuthenticationPolicy.authenticated_userid"><a name="//apple_ref/cpp/clm/pyramid.authentication.RemoteUserAuthenticationPolicy.authenticated_userid"></a>
<tt class="descname">authenticated_userid</tt><big>(</big><em>request</em><big>)</big><a class="headerlink" href="#pyramid.authentication.RemoteUserAuthenticationPolicy.authenticated_userid" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the authenticated userid or <tt class="docutils literal"><span class="pre">None</span></tt>.</p>
<p>If no callback is registered, this will be the same as
<tt class="docutils literal"><span class="pre">unauthenticated_userid</span></tt>.</p>
<p>If a <tt class="docutils literal"><span class="pre">callback</span></tt> is registered, this will return the userid if
and only if the callback returns a value that is not <tt class="docutils literal"><span class="pre">None</span></tt>.</p>
</dd></dl>
<dl class="method">
<dt id="pyramid.authentication.RemoteUserAuthenticationPolicy.effective_principals"><a name="//apple_ref/cpp/clm/pyramid.authentication.RemoteUserAuthenticationPolicy.effective_principals"></a>
<tt class="descname">effective_principals</tt><big>(</big><em>request</em><big>)</big><a class="headerlink" href="#pyramid.authentication.RemoteUserAuthenticationPolicy.effective_principals" title="Permalink to this definition">¶</a></dt>
<dd><p>A list of effective principals derived from request.</p>
<p>This will return a list of principals including, at least,
<a class="reference internal" href="security.html#pyramid.security.Everyone" title="pyramid.security.Everyone"><tt class="xref py py-data docutils literal"><span class="pre">pyramid.security.Everyone</span></tt></a>. If there is no authenticated
userid, or the <tt class="docutils literal"><span class="pre">callback</span></tt> returns <tt class="docutils literal"><span class="pre">None</span></tt>, this will be the
only principal:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">return</span> <span class="p">[</span><span class="n">Everyone</span><span class="p">]</span>
</pre></div>
</div>
<p>If the <tt class="docutils literal"><span class="pre">callback</span></tt> does not return <tt class="docutils literal"><span class="pre">None</span></tt> and an authenticated
userid is found, then the principals will include
<a class="reference internal" href="security.html#pyramid.security.Authenticated" title="pyramid.security.Authenticated"><tt class="xref py py-data docutils literal"><span class="pre">pyramid.security.Authenticated</span></tt></a>, the <tt class="docutils literal"><span class="pre">authenticated_userid</span></tt>
and the list of principals returned by the <tt class="docutils literal"><span class="pre">callback</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">extra_principals</span> <span class="o">=</span> <span class="n">callback</span><span class="p">(</span><span class="n">userid</span><span class="p">,</span> <span class="n">request</span><span class="p">)</span>
<span class="k">return</span> <span class="p">[</span><span class="n">Everyone</span><span class="p">,</span> <span class="n">Authenticated</span><span class="p">,</span> <span class="n">userid</span><span class="p">]</span> <span class="o">+</span> <span class="n">extra_principals</span>
</pre></div>
</div>
</dd></dl>
<dl class="method">
<dt id="pyramid.authentication.RemoteUserAuthenticationPolicy.forget"><a name="//apple_ref/cpp/clm/pyramid.authentication.RemoteUserAuthenticationPolicy.forget"></a>
<tt class="descname">forget</tt><big>(</big><em>request</em><big>)</big><a class="reference internal" href="../_modules/pyramid/authentication.html#RemoteUserAuthenticationPolicy.forget"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyramid.authentication.RemoteUserAuthenticationPolicy.forget" title="Permalink to this definition">¶</a></dt>
<dd><p>A no-op. The <tt class="docutils literal"><span class="pre">REMOTE_USER</span></tt> does not provide a protocol for
forgetting the user. This will be application-specific and can
be done somewhere else or in a subclass.</p>
</dd></dl>
<dl class="method">
<dt id="pyramid.authentication.RemoteUserAuthenticationPolicy.remember"><a name="//apple_ref/cpp/clm/pyramid.authentication.RemoteUserAuthenticationPolicy.remember"></a>
<tt class="descname">remember</tt><big>(</big><em>request</em>, <em>principal</em>, <em>**kw</em><big>)</big><a class="reference internal" href="../_modules/pyramid/authentication.html#RemoteUserAuthenticationPolicy.remember"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyramid.authentication.RemoteUserAuthenticationPolicy.remember" title="Permalink to this definition">¶</a></dt>
<dd><p>A no-op. The <tt class="docutils literal"><span class="pre">REMOTE_USER</span></tt> does not provide a protocol for
remembering the user. This will be application-specific and can
be done somewhere else or in a subclass.</p>
</dd></dl>
<dl class="method">
<dt id="pyramid.authentication.RemoteUserAuthenticationPolicy.unauthenticated_userid"><a name="//apple_ref/cpp/clm/pyramid.authentication.RemoteUserAuthenticationPolicy.unauthenticated_userid"></a>
<tt class="descname">unauthenticated_userid</tt><big>(</big><em>request</em><big>)</big><a class="reference internal" href="../_modules/pyramid/authentication.html#RemoteUserAuthenticationPolicy.unauthenticated_userid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyramid.authentication.RemoteUserAuthenticationPolicy.unauthenticated_userid" title="Permalink to this definition">¶</a></dt>
<dd><p>The <tt class="docutils literal"><span class="pre">REMOTE_USER</span></tt> value found within the <tt class="docutils literal"><span class="pre">environ</span></tt>.</p>
</dd></dl>
</dd></dl>
<dl class="class">
<dt id="pyramid.authentication.SessionAuthenticationPolicy"><a name="//apple_ref/cpp/cl/pyramid.authentication.SessionAuthenticationPolicy"></a>
<em class="property">class </em><tt class="descname">SessionAuthenticationPolicy</tt><big>(</big><em>prefix='auth.'</em>, <em>callback=None</em>, <em>debug=False</em><big>)</big><a class="reference internal" href="../_modules/pyramid/authentication.html#SessionAuthenticationPolicy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyramid.authentication.SessionAuthenticationPolicy" title="Permalink to this definition">¶</a></dt>
<dd><p>A <span>Pyramid</span> authentication policy which gets its data from the
configured <a class="reference internal" href="../glossary.html#term-session"><em class="xref std std-term">session</em></a>.  For this authentication policy to work, you
will have to follow the instructions in the <a class="reference internal" href="../narr/sessions.html#sessions-chapter"><em>Sessions</em></a> to
configure a <a class="reference internal" href="../glossary.html#term-session-factory"><em class="xref std std-term">session factory</em></a>.</p>
<p>Constructor Arguments</p>
<p><tt class="docutils literal"><span class="pre">prefix</span></tt></p>
<blockquote>
<div>A prefix used when storing the authentication parameters in the
session. Defaults to 'auth.'. Optional.</div></blockquote>
<p><tt class="docutils literal"><span class="pre">callback</span></tt></p>
<blockquote>
<div>Default: <tt class="docutils literal"><span class="pre">None</span></tt>.  A callback passed the userid and the
request, expected to return <tt class="docutils literal"><span class="pre">None</span></tt> if the userid doesn't
exist or a sequence of principal identifiers (possibly empty) if
the user does exist.  If <tt class="docutils literal"><span class="pre">callback</span></tt> is <tt class="docutils literal"><span class="pre">None</span></tt>, the userid
will be assumed to exist with no principals.  Optional.</div></blockquote>
<p><tt class="docutils literal"><span class="pre">debug</span></tt></p>
<blockquote>
<div>Default: <tt class="docutils literal"><span class="pre">False</span></tt>.  If <tt class="docutils literal"><span class="pre">debug</span></tt> is <tt class="docutils literal"><span class="pre">True</span></tt>, log messages to the
Pyramid debug logger about the results of various authentication
steps.  The output from debugging is useful for reporting to maillist
or IRC channels when asking for support.</div></blockquote>
<dl class="method">
<dt id="pyramid.authentication.SessionAuthenticationPolicy.authenticated_userid"><a name="//apple_ref/cpp/clm/pyramid.authentication.SessionAuthenticationPolicy.authenticated_userid"></a>
<tt class="descname">authenticated_userid</tt><big>(</big><em>request</em><big>)</big><a class="headerlink" href="#pyramid.authentication.SessionAuthenticationPolicy.authenticated_userid" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the authenticated userid or <tt class="docutils literal"><span class="pre">None</span></tt>.</p>
<p>If no callback is registered, this will be the same as
<tt class="docutils literal"><span class="pre">unauthenticated_userid</span></tt>.</p>
<p>If a <tt class="docutils literal"><span class="pre">callback</span></tt> is registered, this will return the userid if
and only if the callback returns a value that is not <tt class="docutils literal"><span class="pre">None</span></tt>.</p>
</dd></dl>
<dl class="method">
<dt id="pyramid.authentication.SessionAuthenticationPolicy.effective_principals"><a name="//apple_ref/cpp/clm/pyramid.authentication.SessionAuthenticationPolicy.effective_principals"></a>
<tt class="descname">effective_principals</tt><big>(</big><em>request</em><big>)</big><a class="headerlink" href="#pyramid.authentication.SessionAuthenticationPolicy.effective_principals" title="Permalink to this definition">¶</a></dt>
<dd><p>A list of effective principals derived from request.</p>
<p>This will return a list of principals including, at least,
<a class="reference internal" href="security.html#pyramid.security.Everyone" title="pyramid.security.Everyone"><tt class="xref py py-data docutils literal"><span class="pre">pyramid.security.Everyone</span></tt></a>. If there is no authenticated
userid, or the <tt class="docutils literal"><span class="pre">callback</span></tt> returns <tt class="docutils literal"><span class="pre">None</span></tt>, this will be the
only principal:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">return</span> <span class="p">[</span><span class="n">Everyone</span><span class="p">]</span>
</pre></div>
</div>
<p>If the <tt class="docutils literal"><span class="pre">callback</span></tt> does not return <tt class="docutils literal"><span class="pre">None</span></tt> and an authenticated
userid is found, then the principals will include
<a class="reference internal" href="security.html#pyramid.security.Authenticated" title="pyramid.security.Authenticated"><tt class="xref py py-data docutils literal"><span class="pre">pyramid.security.Authenticated</span></tt></a>, the <tt class="docutils literal"><span class="pre">authenticated_userid</span></tt>
and the list of principals returned by the <tt class="docutils literal"><span class="pre">callback</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">extra_principals</span> <span class="o">=</span> <span class="n">callback</span><span class="p">(</span><span class="n">userid</span><span class="p">,</span> <span class="n">request</span><span class="p">)</span>
<span class="k">return</span> <span class="p">[</span><span class="n">Everyone</span><span class="p">,</span> <span class="n">Authenticated</span><span class="p">,</span> <span class="n">userid</span><span class="p">]</span> <span class="o">+</span> <span class="n">extra_principals</span>
</pre></div>
</div>
</dd></dl>
<dl class="method">
<dt id="pyramid.authentication.SessionAuthenticationPolicy.forget"><a name="//apple_ref/cpp/clm/pyramid.authentication.SessionAuthenticationPolicy.forget"></a>
<tt class="descname">forget</tt><big>(</big><em>request</em><big>)</big><a class="reference internal" href="../_modules/pyramid/authentication.html#SessionAuthenticationPolicy.forget"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyramid.authentication.SessionAuthenticationPolicy.forget" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove the stored principal from the session.</p>
</dd></dl>
<dl class="method">
<dt id="pyramid.authentication.SessionAuthenticationPolicy.remember"><a name="//apple_ref/cpp/clm/pyramid.authentication.SessionAuthenticationPolicy.remember"></a>
<tt class="descname">remember</tt><big>(</big><em>request</em>, <em>principal</em>, <em>**kw</em><big>)</big><a class="reference internal" href="../_modules/pyramid/authentication.html#SessionAuthenticationPolicy.remember"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyramid.authentication.SessionAuthenticationPolicy.remember" title="Permalink to this definition">¶</a></dt>
<dd><p>Store a principal in the session.</p>
</dd></dl>
</dd></dl>
<dl class="class">
<dt id="pyramid.authentication.BasicAuthAuthenticationPolicy"><a name="//apple_ref/cpp/cl/pyramid.authentication.BasicAuthAuthenticationPolicy"></a>
<em class="property">class </em><tt class="descname">BasicAuthAuthenticationPolicy</tt><big>(</big><em>check</em>, <em>realm='Realm'</em>, <em>debug=False</em><big>)</big><a class="reference internal" href="../_modules/pyramid/authentication.html#BasicAuthAuthenticationPolicy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyramid.authentication.BasicAuthAuthenticationPolicy" title="Permalink to this definition">¶</a></dt>
<dd><p>A <span>Pyramid</span> authentication policy which uses HTTP standard basic
authentication protocol to authenticate users.  To use this policy you will
need to provide a callback which checks the supplied user credentials
against your source of login data.</p>
<p>Constructor Arguments</p>
<p><tt class="docutils literal"><span class="pre">check</span></tt></p>
<blockquote>
<div>A callback function passed a username, password and request, in that
order as positional arguments.  Expected to return <tt class="docutils literal"><span class="pre">None</span></tt> if the
userid doesn't exist or a sequence of principal identifiers (possibly
empty) if the user does exist.</div></blockquote>
<p><tt class="docutils literal"><span class="pre">realm</span></tt></p>
<blockquote>
<div>Default: <tt class="docutils literal"><span class="pre">"Realm"</span></tt>.  The Basic Auth Realm string.  Usually displayed to
the user by the browser in the login dialog.</div></blockquote>
<p><tt class="docutils literal"><span class="pre">debug</span></tt></p>
<blockquote>
<div>Default: <tt class="docutils literal"><span class="pre">False</span></tt>.  If <tt class="docutils literal"><span class="pre">debug</span></tt> is <tt class="docutils literal"><span class="pre">True</span></tt>, log messages to the
Pyramid debug logger about the results of various authentication
steps.  The output from debugging is useful for reporting to maillist
or IRC channels when asking for support.</div></blockquote>
<p><strong>Issuing a challenge</strong></p>
<p>Regular browsers will not send username/password credentials unless they
first receive a challenge from the server.  The following recipe will
register a view that will send a Basic Auth challenge to the user whenever
there is an attempt to call a view which results in a Forbidden response:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">pyramid.httpexceptions</span> <span class="kn">import</span> <span class="n">HTTPUnauthorized</span>
<span class="kn">from</span> <span class="nn">pyramid.security</span> <span class="kn">import</span> <span class="n">forget</span>
<span class="kn">from</span> <span class="nn">pyramid.view</span> <span class="kn">import</span> <span class="n">forbidden_view_config</span>

<span class="nd">@forbidden_view_config</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">basic_challenge</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">HTTPUnauthorized</span><span class="p">()</span>
    <span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">forget</span><span class="p">(</span><span class="n">request</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">response</span>
</pre></div>
</div>
<dl class="method">
<dt id="pyramid.authentication.BasicAuthAuthenticationPolicy.authenticated_userid"><a name="//apple_ref/cpp/clm/pyramid.authentication.BasicAuthAuthenticationPolicy.authenticated_userid"></a>
<tt class="descname">authenticated_userid</tt><big>(</big><em>request</em><big>)</big><a class="headerlink" href="#pyramid.authentication.BasicAuthAuthenticationPolicy.authenticated_userid" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the authenticated userid or <tt class="docutils literal"><span class="pre">None</span></tt>.</p>
<p>If no callback is registered, this will be the same as
<tt class="docutils literal"><span class="pre">unauthenticated_userid</span></tt>.</p>
<p>If a <tt class="docutils literal"><span class="pre">callback</span></tt> is registered, this will return the userid if
and only if the callback returns a value that is not <tt class="docutils literal"><span class="pre">None</span></tt>.</p>
</dd></dl>
<dl class="method">
<dt id="pyramid.authentication.BasicAuthAuthenticationPolicy.effective_principals"><a name="//apple_ref/cpp/clm/pyramid.authentication.BasicAuthAuthenticationPolicy.effective_principals"></a>
<tt class="descname">effective_principals</tt><big>(</big><em>request</em><big>)</big><a class="headerlink" href="#pyramid.authentication.BasicAuthAuthenticationPolicy.effective_principals" title="Permalink to this definition">¶</a></dt>
<dd><p>A list of effective principals derived from request.</p>
<p>This will return a list of principals including, at least,
<a class="reference internal" href="security.html#pyramid.security.Everyone" title="pyramid.security.Everyone"><tt class="xref py py-data docutils literal"><span class="pre">pyramid.security.Everyone</span></tt></a>. If there is no authenticated
userid, or the <tt class="docutils literal"><span class="pre">callback</span></tt> returns <tt class="docutils literal"><span class="pre">None</span></tt>, this will be the
only principal:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">return</span> <span class="p">[</span><span class="n">Everyone</span><span class="p">]</span>
</pre></div>
</div>
<p>If the <tt class="docutils literal"><span class="pre">callback</span></tt> does not return <tt class="docutils literal"><span class="pre">None</span></tt> and an authenticated
userid is found, then the principals will include
<a class="reference internal" href="security.html#pyramid.security.Authenticated" title="pyramid.security.Authenticated"><tt class="xref py py-data docutils literal"><span class="pre">pyramid.security.Authenticated</span></tt></a>, the <tt class="docutils literal"><span class="pre">authenticated_userid</span></tt>
and the list of principals returned by the <tt class="docutils literal"><span class="pre">callback</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">extra_principals</span> <span class="o">=</span> <span class="n">callback</span><span class="p">(</span><span class="n">userid</span><span class="p">,</span> <span class="n">request</span><span class="p">)</span>
<span class="k">return</span> <span class="p">[</span><span class="n">Everyone</span><span class="p">,</span> <span class="n">Authenticated</span><span class="p">,</span> <span class="n">userid</span><span class="p">]</span> <span class="o">+</span> <span class="n">extra_principals</span>
</pre></div>
</div>
</dd></dl>
<dl class="method">
<dt id="pyramid.authentication.BasicAuthAuthenticationPolicy.forget"><a name="//apple_ref/cpp/clm/pyramid.authentication.BasicAuthAuthenticationPolicy.forget"></a>
<tt class="descname">forget</tt><big>(</big><em>request</em><big>)</big><a class="reference internal" href="../_modules/pyramid/authentication.html#BasicAuthAuthenticationPolicy.forget"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyramid.authentication.BasicAuthAuthenticationPolicy.forget" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns challenge headers. This should be attached to a response
to indicate that credentials are required.</p>
</dd></dl>
<dl class="method">
<dt id="pyramid.authentication.BasicAuthAuthenticationPolicy.remember"><a name="//apple_ref/cpp/clm/pyramid.authentication.BasicAuthAuthenticationPolicy.remember"></a>
<tt class="descname">remember</tt><big>(</big><em>request</em>, <em>principal</em>, <em>**kw</em><big>)</big><a class="reference internal" href="../_modules/pyramid/authentication.html#BasicAuthAuthenticationPolicy.remember"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyramid.authentication.BasicAuthAuthenticationPolicy.remember" title="Permalink to this definition">¶</a></dt>
<dd><p>A no-op. Basic authentication does not provide a protocol for
remembering the user. Credentials are sent on every request.</p>
</dd></dl>
<dl class="method">
<dt id="pyramid.authentication.BasicAuthAuthenticationPolicy.unauthenticated_userid"><a name="//apple_ref/cpp/clm/pyramid.authentication.BasicAuthAuthenticationPolicy.unauthenticated_userid"></a>
<tt class="descname">unauthenticated_userid</tt><big>(</big><em>request</em><big>)</big><a class="reference internal" href="../_modules/pyramid/authentication.html#BasicAuthAuthenticationPolicy.unauthenticated_userid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyramid.authentication.BasicAuthAuthenticationPolicy.unauthenticated_userid" title="Permalink to this definition">¶</a></dt>
<dd><p>The userid parsed from the <tt class="docutils literal"><span class="pre">Authorization</span></tt> request header.</p>
</dd></dl>
</dd></dl>
<dl class="class">
<dt id="pyramid.authentication.RepozeWho1AuthenticationPolicy"><a name="//apple_ref/cpp/cl/pyramid.authentication.RepozeWho1AuthenticationPolicy"></a>
<em class="property">class </em><tt class="descname">RepozeWho1AuthenticationPolicy</tt><big>(</big><em>identifier_name='auth_tkt'</em>, <em>callback=None</em><big>)</big><a class="reference internal" href="../_modules/pyramid/authentication.html#RepozeWho1AuthenticationPolicy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyramid.authentication.RepozeWho1AuthenticationPolicy" title="Permalink to this definition">¶</a></dt>
<dd><p>A <span>Pyramid</span> <a class="reference internal" href="../glossary.html#term-authentication-policy"><em class="xref std std-term">authentication policy</em></a> which
obtains data from the <a class="reference external" href="http://docs.repoze.org/who/latest/index.html#module-repoze.who" title="(in repoze.who v2.0)"><tt class="xref py py-mod docutils literal"><span class="pre">repoze.who</span></tt></a> 1.X WSGI 'API' (the
<tt class="docutils literal"><span class="pre">repoze.who.identity</span></tt> key in the WSGI environment).</p>
<p>Constructor Arguments</p>
<p><tt class="docutils literal"><span class="pre">identifier_name</span></tt></p>
<blockquote>
<div>Default: <tt class="docutils literal"><span class="pre">auth_tkt</span></tt>.  The <a class="reference external" href="http://docs.repoze.org/who/latest/index.html#module-repoze.who" title="(in repoze.who v2.0)"><tt class="xref py py-mod docutils literal"><span class="pre">repoze.who</span></tt></a> plugin name that
performs remember/forget.  Optional.</div></blockquote>
<p><tt class="docutils literal"><span class="pre">callback</span></tt></p>
<blockquote>
<div>Default: <tt class="docutils literal"><span class="pre">None</span></tt>.  A callback passed the <a class="reference external" href="http://docs.repoze.org/who/latest/index.html#module-repoze.who" title="(in repoze.who v2.0)"><tt class="xref py py-mod docutils literal"><span class="pre">repoze.who</span></tt></a> identity
and the <a class="reference internal" href="../glossary.html#term-request"><em class="xref std std-term">request</em></a>, expected to return <tt class="docutils literal"><span class="pre">None</span></tt> if the user
represented by the identity doesn't exist or a sequence of principal
identifiers (possibly empty) representing groups if the user does
exist.  If <tt class="docutils literal"><span class="pre">callback</span></tt> is None, the userid will be assumed to exist
with no group principals.</div></blockquote>
<p>Objects of this class implement the interface described by
<a class="reference internal" href="interfaces.html#pyramid.interfaces.IAuthenticationPolicy" title="pyramid.interfaces.IAuthenticationPolicy"><tt class="xref py py-class docutils literal"><span class="pre">pyramid.interfaces.IAuthenticationPolicy</span></tt></a>.</p>
<dl class="method">
<dt id="pyramid.authentication.RepozeWho1AuthenticationPolicy.authenticated_userid"><a name="//apple_ref/cpp/clm/pyramid.authentication.RepozeWho1AuthenticationPolicy.authenticated_userid"></a>
<tt class="descname">authenticated_userid</tt><big>(</big><em>request</em><big>)</big><a class="reference internal" href="../_modules/pyramid/authentication.html#RepozeWho1AuthenticationPolicy.authenticated_userid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyramid.authentication.RepozeWho1AuthenticationPolicy.authenticated_userid" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the authenticated userid or <tt class="docutils literal"><span class="pre">None</span></tt>.</p>
<p>If no callback is registered, this will be the same as
<tt class="docutils literal"><span class="pre">unauthenticated_userid</span></tt>.</p>
<p>If a <tt class="docutils literal"><span class="pre">callback</span></tt> is registered, this will return the userid if
and only if the callback returns a value that is not <tt class="docutils literal"><span class="pre">None</span></tt>.</p>
</dd></dl>
<dl class="method">
<dt id="pyramid.authentication.RepozeWho1AuthenticationPolicy.effective_principals"><a name="//apple_ref/cpp/clm/pyramid.authentication.RepozeWho1AuthenticationPolicy.effective_principals"></a>
<tt class="descname">effective_principals</tt><big>(</big><em>request</em><big>)</big><a class="reference internal" href="../_modules/pyramid/authentication.html#RepozeWho1AuthenticationPolicy.effective_principals"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyramid.authentication.RepozeWho1AuthenticationPolicy.effective_principals" title="Permalink to this definition">¶</a></dt>
<dd><p>A list of effective principals derived from the identity.</p>
<p>This will return a list of principals including, at least,
<a class="reference internal" href="security.html#pyramid.security.Everyone" title="pyramid.security.Everyone"><tt class="xref py py-data docutils literal"><span class="pre">pyramid.security.Everyone</span></tt></a>. If there is no identity, or
the <tt class="docutils literal"><span class="pre">callback</span></tt> returns <tt class="docutils literal"><span class="pre">None</span></tt>, this will be the only principal.</p>
<p>If the <tt class="docutils literal"><span class="pre">callback</span></tt> does not return <tt class="docutils literal"><span class="pre">None</span></tt> and an identity is
found, then the principals will include
<a class="reference internal" href="security.html#pyramid.security.Authenticated" title="pyramid.security.Authenticated"><tt class="xref py py-data docutils literal"><span class="pre">pyramid.security.Authenticated</span></tt></a>, the <tt class="docutils literal"><span class="pre">authenticated_userid</span></tt>
and the list of principals returned by the <tt class="docutils literal"><span class="pre">callback</span></tt>.</p>
</dd></dl>
<dl class="method">
<dt id="pyramid.authentication.RepozeWho1AuthenticationPolicy.forget"><a name="//apple_ref/cpp/clm/pyramid.authentication.RepozeWho1AuthenticationPolicy.forget"></a>
<tt class="descname">forget</tt><big>(</big><em>request</em><big>)</big><a class="reference internal" href="../_modules/pyramid/authentication.html#RepozeWho1AuthenticationPolicy.forget"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyramid.authentication.RepozeWho1AuthenticationPolicy.forget" title="Permalink to this definition">¶</a></dt>
<dd><p>Forget the current authenticated user.</p>
<p>Return headers that, if included in a response, will delete the
cookie responsible for tracking the current user.</p>
</dd></dl>
<dl class="method">
<dt id="pyramid.authentication.RepozeWho1AuthenticationPolicy.remember"><a name="//apple_ref/cpp/clm/pyramid.authentication.RepozeWho1AuthenticationPolicy.remember"></a>
<tt class="descname">remember</tt><big>(</big><em>request</em>, <em>principal</em>, <em>**kw</em><big>)</big><a class="reference internal" href="../_modules/pyramid/authentication.html#RepozeWho1AuthenticationPolicy.remember"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyramid.authentication.RepozeWho1AuthenticationPolicy.remember" title="Permalink to this definition">¶</a></dt>
<dd><p>Store the <tt class="docutils literal"><span class="pre">principal</span></tt> as <tt class="docutils literal"><span class="pre">repoze.who.userid</span></tt>.</p>
<p>The identity to authenticated to <a class="reference external" href="http://docs.repoze.org/who/latest/index.html#module-repoze.who" title="(in repoze.who v2.0)"><tt class="xref py py-mod docutils literal"><span class="pre">repoze.who</span></tt></a>
will contain the given principal as <tt class="docutils literal"><span class="pre">userid</span></tt>, and
provide all keyword arguments as additional identity
keys. Useful keys could be <tt class="docutils literal"><span class="pre">max_age</span></tt> or <tt class="docutils literal"><span class="pre">userdata</span></tt>.</p>
</dd></dl>
<dl class="method">
<dt id="pyramid.authentication.RepozeWho1AuthenticationPolicy.unauthenticated_userid"><a name="//apple_ref/cpp/clm/pyramid.authentication.RepozeWho1AuthenticationPolicy.unauthenticated_userid"></a>
<tt class="descname">unauthenticated_userid</tt><big>(</big><em>request</em><big>)</big><a class="reference internal" href="../_modules/pyramid/authentication.html#RepozeWho1AuthenticationPolicy.unauthenticated_userid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyramid.authentication.RepozeWho1AuthenticationPolicy.unauthenticated_userid" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the <tt class="docutils literal"><span class="pre">repoze.who.userid</span></tt> key from the detected identity.</p>
</dd></dl>
</dd></dl>
</div>
<div class="section" id="helper-classes">
<h2>Helper Classes<a class="headerlink" href="#helper-classes" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><dl class="class">
<dt id="pyramid.authentication.AuthTktCookieHelper"><a name="//apple_ref/cpp/cl/pyramid.authentication.AuthTktCookieHelper"></a>
<em class="property">class </em><tt class="descname">AuthTktCookieHelper</tt><big>(</big><em>secret</em>, <em>cookie_name='auth_tkt'</em>, <em>secure=False</em>, <em>include_ip=False</em>, <em>timeout=None</em>, <em>reissue_time=None</em>, <em>max_age=None</em>, <em>http_only=False</em>, <em>path='/'</em>, <em>wild_domain=True</em>, <em>hashalg='md5'</em>, <em>parent_domain=False</em>, <em>domain=None</em><big>)</big><a class="reference internal" href="../_modules/pyramid/authentication.html#AuthTktCookieHelper"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyramid.authentication.AuthTktCookieHelper" title="Permalink to this definition">¶</a></dt>
<dd><p>A helper class for use in third-party authentication policy
implementations.  See
<a class="reference internal" href="#pyramid.authentication.AuthTktAuthenticationPolicy" title="pyramid.authentication.AuthTktAuthenticationPolicy"><tt class="xref py py-class docutils literal"><span class="pre">pyramid.authentication.AuthTktAuthenticationPolicy</span></tt></a> for the
meanings of the constructor arguments.</p>
<dl class="class">
<dt id="pyramid.authentication.AuthTktCookieHelper.AuthTicket"><a name="//apple_ref/cpp/cl/pyramid.authentication.AuthTktCookieHelper.AuthTicket"></a>
<em class="property">class </em><tt class="descname">AuthTicket</tt><big>(</big><em>secret</em>, <em>userid</em>, <em>ip</em>, <em>tokens=()</em>, <em>user_data=''</em>, <em>time=None</em>, <em>cookie_name='auth_tkt'</em>, <em>secure=False</em>, <em>hashalg='md5'</em><big>)</big><a class="headerlink" href="#pyramid.authentication.AuthTktCookieHelper.AuthTicket" title="Permalink to this definition">¶</a></dt>
<dd><p>This class represents an authentication token.  You must pass in
the shared secret, the userid, and the IP address.  Optionally you
can include tokens (a list of strings, representing role names),
'user_data', which is arbitrary data available for your own use in
later scripts.  Lastly, you can override the cookie name and
timestamp.</p>
<p>Once you provide all the arguments, use .cookie_value() to
generate the appropriate authentication ticket.</p>
<p>Usage:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">token</span> <span class="o">=</span> <span class="n">AuthTicket</span><span class="p">(</span><span class="s">'sharedsecret'</span><span class="p">,</span> <span class="s">'username'</span><span class="p">,</span>
    <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s">'REMOTE_ADDR'</span><span class="p">],</span> <span class="n">tokens</span><span class="o">=</span><span class="p">[</span><span class="s">'admin'</span><span class="p">])</span>
<span class="n">val</span> <span class="o">=</span> <span class="n">token</span><span class="o">.</span><span class="n">cookie_value</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>
<dl class="exception">
<dt id="pyramid.authentication.AuthTktCookieHelper.BadTicket">
<em class="property">exception </em><tt class="descclassname">AuthTktCookieHelper.</tt><tt class="descname">BadTicket</tt><big>(</big><em>msg</em>, <em>expected=None</em><big>)</big><a class="headerlink" href="#pyramid.authentication.AuthTktCookieHelper.BadTicket" title="Permalink to this definition">¶</a></dt>
<dd><p>Exception raised when a ticket can't be parsed.  If we get far enough to
determine what the expected digest should have been, expected is set.
This should not be shown by default, but can be useful for debugging.</p>
</dd></dl>
<dl class="method">
<dt id="pyramid.authentication.AuthTktCookieHelper.forget"><a name="//apple_ref/cpp/clm/pyramid.authentication.AuthTktCookieHelper.forget"></a>
<tt class="descclassname">AuthTktCookieHelper.</tt><tt class="descname">forget</tt><big>(</big><em>request</em><big>)</big><a class="reference internal" href="../_modules/pyramid/authentication.html#AuthTktCookieHelper.forget"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyramid.authentication.AuthTktCookieHelper.forget" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a set of expires Set-Cookie headers, which will destroy
any existing auth_tkt cookie when attached to a response</p>
</dd></dl>
<dl class="method">
<dt id="pyramid.authentication.AuthTktCookieHelper.identify"><a name="//apple_ref/cpp/clm/pyramid.authentication.AuthTktCookieHelper.identify"></a>
<tt class="descclassname">AuthTktCookieHelper.</tt><tt class="descname">identify</tt><big>(</big><em>request</em><big>)</big><a class="reference internal" href="../_modules/pyramid/authentication.html#AuthTktCookieHelper.identify"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyramid.authentication.AuthTktCookieHelper.identify" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a dictionary with authentication information, or <tt class="docutils literal"><span class="pre">None</span></tt>
if no valid auth_tkt is attached to <tt class="docutils literal"><span class="pre">request</span></tt></p>
</dd></dl>
<dl class="staticmethod">
<dt id="pyramid.authentication.AuthTktCookieHelper.parse_ticket">
<em class="property">static </em><tt class="descclassname">AuthTktCookieHelper.</tt><tt class="descname">parse_ticket</tt><big>(</big><em>secret</em>, <em>ticket</em>, <em>ip</em>, <em>hashalg='md5'</em><big>)</big><a class="headerlink" href="#pyramid.authentication.AuthTktCookieHelper.parse_ticket" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse the ticket, returning (timestamp, userid, tokens, user_data).</p>
<p>If the ticket cannot be parsed, a <tt class="docutils literal"><span class="pre">BadTicket</span></tt> exception will be raised
with an explanation.</p>
</dd></dl>
<dl class="method">
<dt id="pyramid.authentication.AuthTktCookieHelper.remember"><a name="//apple_ref/cpp/clm/pyramid.authentication.AuthTktCookieHelper.remember"></a>
<tt class="descclassname">AuthTktCookieHelper.</tt><tt class="descname">remember</tt><big>(</big><em>request</em>, <em>userid</em>, <em>max_age=None</em>, <em>tokens=()</em><big>)</big><a class="reference internal" href="../_modules/pyramid/authentication.html#AuthTktCookieHelper.remember"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyramid.authentication.AuthTktCookieHelper.remember" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a set of Set-Cookie headers; when set into a response,
these headers will represent a valid authentication ticket.</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">max_age</span></tt></dt>
<dd>The max age of the auth_tkt cookie, in seconds.  When this value is
set, the cookie's <tt class="docutils literal"><span class="pre">Max-Age</span></tt> and <tt class="docutils literal"><span class="pre">Expires</span></tt> settings will be set,
allowing the auth_tkt cookie to last between browser sessions.  If
this value is <tt class="docutils literal"><span class="pre">None</span></tt>, the <tt class="docutils literal"><span class="pre">max_age</span></tt> value provided to the
helper itself will be used as the <tt class="docutils literal"><span class="pre">max_age</span></tt> value.  Default:
<tt class="docutils literal"><span class="pre">None</span></tt>.</dd>
<dt><tt class="docutils literal"><span class="pre">tokens</span></tt></dt>
<dd>A sequence of strings that will be placed into the auth_tkt tokens
field.  Each string in the sequence must be of the Python <tt class="docutils literal"><span class="pre">str</span></tt>
type and must match the regex <tt class="docutils literal"><span class="pre">^[A-Za-z][A-Za-z0-9+_-]*$</span></tt>.
Tokens are available in the returned identity when an auth_tkt is
found in the request and unpacked.  Default: <tt class="docutils literal"><span class="pre">()</span></tt>.</dd>
</dl>
</dd></dl>
</dd></dl>
</div></blockquote>
</div>
</div>
</div>
</div>
</div>
<div class="sphinxsidebar">
<div class="sphinxsidebarwrapper">
<h3><a href="../index.html">Table Of Contents</a></h3>
<ul>
<li><a class="reference internal" href="#"><tt class="docutils literal"><span class="pre">pyramid.authentication</span></tt></a><ul>
<li><a class="reference internal" href="#module-pyramid.authentication">Authentication Policies</a></li>
<li><a class="reference internal" href="#helper-classes">Helper Classes</a></li>
</ul>
</li>
</ul>
<h4>Previous topic</h4>
<p class="topless"><a href="../tutorials/modwsgi/index.html" title="previous chapter">Running a <span>Pyramid</span> Application under <tt class="docutils literal"><span class="pre">mod_wsgi</span></tt></a></p>
<h4>Next topic</h4>
<p class="topless"><a href="authorization.html" title="next chapter"><tt class="docutils literal"><span class="pre">pyramid.authorization</span></tt></a></p>
<div id="searchbox" style="display: none">
<h3>Quick search</h3>
<form action="../search.html" class="search" method="get">
<input name="q" type="text"/>
<input type="submit" value="Go"/>
<input name="check_keywords" type="hidden" value="yes"/>
<input name="area" type="hidden" value="default"/>
</form>
<p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
</div>
</div>
<div class="clearer"></div>
</div>
<div class="related">
<h3>Navigation</h3>
<ul>
<li class="right" style="margin-right: 10px">
<a href="../genindex.html" title="General Index">index</a></li>
<li class="right">
<a href="../py-modindex.html" title="Python Module Index">modules</a> |</li>
<li class="right">
<a href="authorization.html" title="pyramid.authorization">next</a> |</li>
<li class="right">
<a href="../tutorials/modwsgi/index.html" title="Running a Pyramid Application under mod_wsgi">previous</a> |</li>
<li><a href="../index.html">The Pyramid Web Framework v1.5</a> »</li>
</ul>
</div>
<div class="footer">
        © <a href="../copyright.html">Copyright</a> 2008-2014, Agendaless Consulting.
      Last updated on Nov 09, 2014.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
</body></html>