<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Created by GNU Texinfo 5.1, http://www.gnu.org/software/texinfo/ -->
<head>
<title>sawfish Programming Manual: Event Loop</title>

<meta name="description" content="sawfish Programming Manual: Event Loop">
<meta name="keywords" content="sawfish Programming Manual: Event Loop">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link href="index.html#Top" rel="start" title="Top">
<link href="Function-Index.html#Function-Index" rel="index" title="Function Index">
<link href="Concept-Index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="index.html#Top" rel="up" title="Top">
<link href="Miscellaneous-Functions.html#Miscellaneous-Functions" rel="next" title="Miscellaneous Functions">
<link href="Keymaps.html#Keymaps" rel="previous" title="Keymaps">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.smallquotation {font-size: smaller}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.indentedblock {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
div.smalldisplay {margin-left: 3.2em}
div.smallexample {margin-left: 3.2em}
div.smallindentedblock {margin-left: 3.2em; font-size: smaller}
div.smalllisp {margin-left: 3.2em}
kbd {font-style:oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
pre.smalldisplay {font-family: inherit; font-size: smaller}
pre.smallexample {font-size: smaller}
pre.smallformat {font-family: inherit; font-size: smaller}
pre.smalllisp {font-size: smaller}
span.nocodebreak {white-space:nowrap}
span.nolinebreak {white-space:nowrap}
span.roman {font-family:serif; font-weight:normal}
span.sansserif {font-family:sans-serif; font-weight:normal}
ul.no-bullet {list-style: none}
-->
</style>


</head>

<body lang="en" bgcolor="#FFFFFF" text="#000000" link="#0000FF" vlink="#800080" alink="#FF0000">
<a name="Event-Loop"></a>
<div class="header">
<p>
Next: <a href="Miscellaneous-Functions.html#Miscellaneous-Functions" accesskey="n" rel="next">Miscellaneous Functions</a>, Previous: <a href="Keymaps.html#Keymaps" accesskey="p" rel="previous">Keymaps</a>, Up: <a href="index.html#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="Concept-Index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Function-Index.html#Function-Index" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<a name="Event-Loop-1"></a>
<h2 class="chapter">19 Event Loop</h2>
<a name="index-Event-loop"></a>

<p>The event loop reads all X events received on any of the windows that
Sawfish is aware off. Many of these events invoke hooks, as described
in <a href="Standard-Hooks.html#Standard-Hooks">Standard Hooks</a>. Keyboard and pointer events are translated to
their Lisp equivalents (see <a href="Events.html#Events">Events</a>) and then used to scan all
active keymaps for a binding. If a binding is found, the associated
command is invoked through the <code>call-command</code> function.
</p>
<p>The active keymaps are determined as follows:
</p>
<ul>
<li> If the variable <code>override-keymap</code> is non-nil, then this is
the only keymap searched

</li><li> Otherwise three keymaps are searched:

<ol>
<li> the <code>keymap</code> property of the currently &ldquo;clicked&rdquo; frame
part if there is one,

</li><li> the <code>keymap</code> property of the currently focused window

</li><li> the contents of the variable <code>global-keymap</code>.
</li></ol>
</li></ul>

<p>Note that for <code>ButtonRelease</code> events, the frame part&rsquo;s keymap is
only searched if the pointer is actually within the frame part when the
release event occurs.
</p>
<p>If no binding may be found in any of the active keymaps, then the
<code>unbound-key-hook</code> hook is called. This is an <code>or</code> type
hook&mdash;the first function that returns non-nil will terminate the hook
call.
</p>
<dl>
<dt><a name="index-lookup_002devent_002dbinding"></a>Function: <strong>lookup-event-binding</strong> <em>event</em></dt>
<dd><p>Perform the usual binding lookup for the event object <var>object</var>.
Returns the command found, or <code>nil</code> if no binding exists.
</p></dd></dl>

<p>By default, both key-release events, and events that are bound to
modifier keys (e.g. <tt class="key">Control_L</tt>), are ignored. However, this
behavior may be changed:
</p>
<dl>
<dt><a name="index-eval_002dmodifier_002devents"></a>Variable: <strong>eval-modifier-events</strong></dt>
<dd><p>When non-nil, key events bound to modifier keys are evaluated.
</p></dd></dl>

<dl>
<dt><a name="index-eval_002dkey_002drelease_002devents"></a>Variable: <strong>eval-key-release-events</strong></dt>
<dd><p>When non-nil, key-release events are evaluated.
</p></dd></dl>

<p>While a command is being evaluated, information about the event that
caused it may be found:
</p>
<dl>
<dt><a name="index-current_002devent"></a>Function: <strong>current-event</strong></dt>
<dd><p>Return the event which caused the current command to be invoked
</p></dd></dl>

<dl>
<dt><a name="index-current_002devent_002dstring"></a>Function: <strong>current-event-string</strong></dt>
<dd><p>Returns the string which the current event would usually insert.
</p></dd></dl>

<dl>
<dt><a name="index-current_002devent_002dwindow"></a>Function: <strong>current-event-window</strong> <em><tt>#!optional</tt> win</em></dt>
<dd><p>Extract the owning window of the current X event (this is a window
object, or the symbol <code>root</code> for the root window, or <code>nil</code>
if there is no window or no event).  This is stored internally as the
current event window, and returned.
</p>
<p>If the optional argument <var>win</var> is a window, then it will be
returned as the current event window.
</p></dd></dl>

<dl>
<dt><a name="index-last_002devent"></a>Function: <strong>last-event</strong></dt>
<dd><p>Return the previous event which occurred.
</p></dd></dl>

<dl>
<dt><a name="index-proxy_002dcurrent_002devent"></a>Function: <strong>proxy-current-event</strong> <em>window <tt>#!optional</tt> mask propagate</em></dt>
<dd><p>Send the current X event to <var>window</var>, either a window object, a
numeric window id, or the symbol <code>root</code>. If a <code>ButtonPress</code>
event the pointer grab will be released first.
</p>
<p><var>Mask</var> may be an integer defining the X event mask to pass to the
<code>XSendEvent</code> function. If not defined, a mask is chosen that would
usually be used to select the type of event being proxied.
</p>
<p><var>Propagate</var> is a flag (<code>nil</code>/non-<code>nil</code>) passed directly
to an underlying <code>XSendEvent</code> call.  (And if someone would like
to explain what <em>that</em> means, please do so <small class="enddots">...</small>
</p></dd></dl>

<dl>
<dt><a name="index-allow_002devents"></a>Function: <strong>allow-events</strong> <em>mode</em></dt>
<dd><p>This is a wrapper for the <code>XAllowEvents</code> function. The <var>mode</var>
parameter may be one of the following symbols: <code>async-pointer</code>,
<code>async-keyboard</code>, <code>sync-pointer</code>, <code>sync-keyboard</code>,
<code>replay-pointer</code>, <code>replay-keyboard</code>, <code>async-both</code>,
<code>sync-both</code>.
</p>
<p>Events that have to be grabbed to be received (i.e. all bindings in the
<code>global-keymap</code> and the <code>window-keymap</code>) are grabbed
synchronously. This means that no more events will be received until
either the command returns, or <code>allow-events</code> is called.
</p>
<p>This is normally not important, but if the command expects to receive
further events it must call <code>allow-events</code>. See the interactive
move and resize functions for an example.
</p></dd></dl>

<dl>
<dt><a name="index-forget_002dbutton_002dpress"></a>Function: <strong>forget-button-press</strong></dt>
<dd><p>Cause the next button press to be treated as a single click event, no
matter how soon it occurs after the prevous button-press event.
</p></dd></dl>

<dl>
<dt><a name="index-accept_002dx_002dinput"></a>Function: <strong>accept-x-input</strong> <em><tt>#!optional</tt> mask</em></dt>
<dd><p>Handle any X events received. If <var>mask</var> is non-nil then only events
matching this numeric value are handled (see the X header files for
details).
</p></dd></dl>

<dl>
<dt><a name="index-x_002devents_002dqueued"></a>Function: <strong>x-events-queued</strong></dt>
<dd><p>Returns the number of X events waiting to be handled.
</p></dd></dl>


<hr>
<div class="header">
<p>
Next: <a href="Miscellaneous-Functions.html#Miscellaneous-Functions" accesskey="n" rel="next">Miscellaneous Functions</a>, Previous: <a href="Keymaps.html#Keymaps" accesskey="p" rel="previous">Keymaps</a>, Up: <a href="index.html#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="Concept-Index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Function-Index.html#Function-Index" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>
