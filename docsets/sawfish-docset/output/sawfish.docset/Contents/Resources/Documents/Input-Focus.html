<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Created by GNU Texinfo 5.1, http://www.gnu.org/software/texinfo/ -->
<head>
<title>sawfish Programming Manual: Input Focus</title>

<meta name="description" content="sawfish Programming Manual: Input Focus">
<meta name="keywords" content="sawfish Programming Manual: Input Focus">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link href="index.html#Top" rel="start" title="Top">
<link href="Function-Index.html#Function-Index" rel="index" title="Function Index">
<link href="Concept-Index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Windows.html#Windows" rel="up" title="Windows">
<link href="X-Properties.html#X-Properties" rel="next" title="X Properties">
<link href="Window-Types.html#Window-Types" rel="previous" title="Window Types">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.smallquotation {font-size: smaller}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.indentedblock {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
div.smalldisplay {margin-left: 3.2em}
div.smallexample {margin-left: 3.2em}
div.smallindentedblock {margin-left: 3.2em; font-size: smaller}
div.smalllisp {margin-left: 3.2em}
kbd {font-style:oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
pre.smalldisplay {font-family: inherit; font-size: smaller}
pre.smallexample {font-size: smaller}
pre.smallformat {font-family: inherit; font-size: smaller}
pre.smalllisp {font-size: smaller}
span.nocodebreak {white-space:nowrap}
span.nolinebreak {white-space:nowrap}
span.roman {font-family:serif; font-weight:normal}
span.sansserif {font-family:sans-serif; font-weight:normal}
ul.no-bullet {list-style: none}
-->
</style>


</head>

<body lang="en" bgcolor="#FFFFFF" text="#000000" link="#0000FF" vlink="#800080" alink="#FF0000">
<a name="Input-Focus"></a>
<div class="header">
<p>
Next: <a href="X-Properties.html#X-Properties" accesskey="n" rel="next">X Properties</a>, Previous: <a href="Window-Types.html#Window-Types" accesskey="p" rel="previous">Window Types</a>, Up: <a href="Windows.html#Windows" accesskey="u" rel="up">Windows</a> &nbsp; [<a href="Concept-Index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Function-Index.html#Function-Index" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<a name="Input-Focus-1"></a>
<h3 class="section">8.5 Input Focus</h3>
<a name="index-Input-focus"></a>
<a name="index-Keyboard-focus"></a>
<a name="index-Focus_002c-input"></a>
<a name="index-Windows_002c-input-focus"></a>

<p>The input focus defines exactly which client window will receive events
generated by the keyboard.
</p>
<dl>
<dt><a name="index-input_002dfocus"></a>Function: <strong>input-focus</strong></dt>
<dd><p>Returns the window object of the currently focused window, or
<code>nil</code> if no window is focused.
</p></dd></dl>

<dl>
<dt><a name="index-set_002dinput_002dfocus"></a>Function: <strong>set-input-focus</strong> <em>window</em></dt>
<dd><p>Sets the focus to the client window associated with <var>window</var>.
</p>
<p>If <var>window</var> is <code>nil</code>, then no window will have the focus.
</p></dd></dl>

<dl>
<dt><a name="index-window_002dwants_002dinput_002dp-1"></a>Function: <strong>window-wants-input-p</strong> <em>window</em></dt>
<dd><p>If you&rsquo;re unsure, use <code>window-really-wants-input-p</code> function
described below.
</p>
<p>Return <code>t</code> when the window <var>window</var> wants input focus in X
sense, i.e. if it has asked for the input focus to be assigned to,
through the <code>input</code> field of its <code>WM_HINTS</code> property.
</p></dd></dl>

<dl>
<dt><a name="index-window_002dreally_002dwants_002dinput_002dp-1"></a>Function: <strong>window-really-wants-input-p</strong> <em>window</em></dt>
<dd><p>Like <code>window-wants-input-p</code>, but in addition, this function also
takes into account user option provided by Sawfish, i.e. if the window
has <code>never-focus</code> property or not.
</p></dd></dl>

<p>The window manager is responsible for switching the input focus from
client window to client window.  Sawfish implements several
<em>focus modes</em> that provide this behavior.  Each focus mode is
bound to a symbol; the implementation is bound to that symbol&rsquo;s
<code>focus-mode</code> property slot.
</p>
<dl>
<dt><a name="index-focus_002dmode"></a>Variable: <strong>focus-mode</strong></dt>
<dd><p>Defines the current method of using the mouse to assign the input
focus.  This is a symbol from the list <code>focus-modes</code>.
</p></dd></dl>

<dl>
<dt><a name="index-focus_002dmodes"></a>Variable: <strong>focus-modes</strong></dt>
<dd><p>A list containing all names of focus modes.  The built-in values are
<code>enter-exit</code>, <code>enter-only</code>, <code>enter-click</code> and <code>click</code>.
</p></dd></dl>

<p>Focus mode <code>enter-exit</code> changes focus when the pointer enters a
window or leaves the focused window.  Focus mode <code>enter-only</code>
changes focus when the pointer enters a window, but not when it leaves
the focused window.  Focus mode <code>click</code> changes focus when you
click on a window.  Focus mode <code>enter-click</code> is the union of
<code>enter-only</code> and <code>click</code>, and changes focus on any
of their conditions.
</p>
<p>It is possible to add additional focus modes by defining your own
handler function.  The handler function must obey a
&ldquo;focus-mode-handler&rdquo; protocol.
</p>
<dl>
<dt><a name="index-focus_002dmode_002dhandler"></a>Function Protocol: <strong>focus-mode-handler</strong> <em>window event-name <tt>#!optional</tt> args</em></dt>
<dd><p>A function that implements the <code>focus-mode-handler</code> protocol can
be used to define a focus mode.  A <code>focus-mode-handler</code> responds
to events associated with windows.
</p>
<p>Argument <var>window</var> is the window that received this event.
</p>
<p>Argument <var>event-name</var> is one of the following symbols:
</p>
<dl compact="compact">
<dt><code>pointer-in</code></dt>
<dt><code>pointer-out</code></dt>
<dd><p>The pointer has entered or exited the window.  The handler is
responsible for checking whether an entered window wants input events.
The desktop never receives <code>pointer-in</code> or <code>pointer-out</code>;
only normal windows do.
</p>
</dd>
<dt><code>enter-root</code></dt>
<dt><code>leave-root</code></dt>
<dd><p>The pointer has entered or exited the desktop (which is the
<var>window</var> argument).  Normal windows never receive
<code>enter-root</code> or <code>leave-root</code>.
</p>
</dd>
<dt><code>focus-in</code></dt>
<dt><code>focus-out</code></dt>
<dd><p>The window argument has gotten or lost focus.  Note that the
<code>focus-in</code> handler is not responsible for updating the
window-order list.
</p>
</dd>
<dt><code>before-mode-change</code></dt>
<dt><code>after-mode-change</code></dt>
<dd><p>Sawfish sends these synthetic events to each window before/after
changing that window&rsquo;s focus mode.  When the global focus mode
changes, all windows get these events.
</p>
</dd>
<dt><code>add-window</code></dt>
<dd><p>Sawfish sends this event to every window immediately after mapping it.
Handlers can use this to initialize window-internal data structures.
</p>
</dd>
<dt><code>warp-if-necessary</code></dt>
<dd><p>Warp the cursor to the window if doing so would make the cursor
position &ldquo;consistent&rdquo; with the focus mode.  For example, in
<code>enter-exit</code> mode we warp the cursor if it is not already in this
window.  In <code>enter-only</code> mode, we warp the cursor if it is in
another window, but not if it is over the desktop&mdash;a window would not
lose focus when the cursor moved from it to the desktop.
</p>
<p>This event is implemented via <code>warp-cursor-to-window</code>, so Sawfish
will not warp unless <code>warp-to-window-enabled</code> is true.
</p>
</dd>
<dt><code>focus-revert</code></dt>
<dd><p>The focused window has disappeared (the <var>window</var> argument is not
used here).  The focus mode may react by setting focus to some other
window.  If a focused transient window disappears, focus normally
reverts to the window that the disappearing window was transient for.
<code>focus-revert</code> is not invoked in that case.
</p></dd>
</dl>

<p>The protocol allows for any number of additional arguments, but does
not define any.  Any handler function must be prepared to receive and
ignore them.
</p>
<p>Unsupported events may be ignored.  The return value of this function
is ignored.
</p></dd></dl>

<dl>
<dt><a name="index-define_002dfocus_002dmode"></a>Function: <strong>define-focus-mode</strong> <em>name fun</em></dt>
<dd><p>Defines a new focus mode called <var>name</var> (a symbol).  The focus-mode
handler <var>fun</var> implements this focus mode.
</p>
<p>See the documentation for <code>focus-mode-handler</code> for more
information.
</p></dd></dl>

<dl>
<dt><a name="index-set_002dfocus_002dmode"></a>Function: <strong>set-focus-mode</strong> <em>window mode</em></dt>
<dd><p>Set the focus mode of window <var>window</var> to <var>mode</var>.
This triggers <code>before-mode-change</code> and <code>after-mode-change</code>
focus-mode events on <var>window</var>.
</p></dd></dl>

<dl>
<dt><a name="index-warp_002dpointer_002dif_002dnecessary"></a>Function: <strong>warp-pointer-if-necessary</strong> <em>window</em></dt>
<dd><p>Generate a <code>warp-if-necessary</code> event and sends it to the window&rsquo;s
focus function.
</p>
<p>Various functions call <code>warp-pointer-if-necessary</code> if they move
the focused window out from underneath the pointer.
</p></dd></dl>

<dl>
<dt><a name="index-focus_002dclick_002dthrough"></a>Variable: <strong>focus-click-through</strong></dt>
<dd><p>When in <code>click</code> focus mode, the focus-assigning click is only
passed through to the client window if this variable is <code>t</code> (the
default).
</p>
<p>This option may be set on a per-window basis by setting the
<code>focus-click-through</code> property of the window (using the
<code>window-put</code> function).
</p></dd></dl>

<dl>
<dt><a name="index-focus_002dwithin_002dclick_002devent"></a>Variable: <strong>focus-within-click-event</strong></dt>
<dd><p>When true, the current command is being called from within a
click-to-focus button press event.
</p>
<p>This is a fluid object, not an ordinary variable.
</p></dd></dl>

<p>Sawfish also maintains the order in which windows were recently
focused.
</p>
<dl>
<dt><a name="index-window_002dorder"></a>Function: <strong>window-order</strong> <em><tt>#!optional</tt> workspace allow-iconified all-viewports</em></dt>
<dd><p>Return a list of windows, in most-recently-focused order.
</p>
<p>If <var>workspace</var> is an integer, then only windows on that workspace
are included, otherwise all workspaces are searched.
</p>
<p>If <var>allow-iconified</var> is non-nil, iconified windows are included. If
<code>all-viewports</code> is non-nil, then all viewports of the workspace(s)
are scanned.
</p></dd></dl>

<dl>
<dt><a name="index-window_002dorder_002dpush"></a>Function: <strong>window-order-push</strong> <em>window</em></dt>
<dd><p>Push window object <var>window</var> onto the top of the focus stack.
</p></dd></dl>

<dl>
<dt><a name="index-window_002dorder_002dpop"></a>Function: <strong>window-order-pop</strong> <em>window</em></dt>
<dd><p>Remove window object <var>window</var> from the focus stack.
</p></dd></dl>

<dl>
<dt><a name="index-window_002dorder_002dmost_002drecent"></a>Function: <strong>window-order-most-recent</strong> <em><tt>#!optional</tt> windows</em></dt>
<dd><p>Return the most-recently focused window in the current workspace.  If
the optional argument <var>windows</var> is given, it must be a list of
windows.  In that case, the function will return the most-recently
focused window from that list.
</p></dd></dl>

<dl>
<dt><a name="index-window_002dorder_002dfocus_002dmost_002drecent"></a>Function: <strong>window-order-focus-most-recent</strong></dt>
<dd><p>Focus the most-recently-focused window of the current workspace.
</p></dd></dl>

<dl>
<dt><a name="index-focus_002ddont_002dpush"></a>Variable: <strong>focus-dont-push</strong></dt>
<dd><p>When true, focusing a window doesn&rsquo;t change it&rsquo;s position in the stack of
most-recently focused windows.
</p></dd></dl>

<p>Other focus related functions:
</p>
<dl>
<dt><a name="index-window_002din_002dcycle_002dp"></a>Function: <strong>window-in-cycle-p</strong> <em>window &amp;keyword ignore-cycle-skip</em></dt>
<dd><p>Returns <code>t</code> if the window <var>window</var> should be included when
cycling between windows.  Desktop windows and those with the
<code>cycle-skip</code> property should normally not be included.
</p>
<p>When <code>t</code>, the <var>ignore-cycle-skip</var> keyword argument
forces the function to include windows with the <code>cycle-skip</code>
property.
</p></dd></dl>

<dl>
<dt><a name="index-focus_002dpush_002dmap"></a>Function: <strong>focus-push-map</strong> <em>window keymap</em></dt>
<dt><a name="index-focus_002dpop_002dmap"></a>Function: <strong>focus-pop-map</strong> <em>window</em></dt>
<dd><p>Maintain a two-element keymap stack for <var>window</var>.
</p>
<p><code>focus-push-map</code> makes <var>keymap</var> current for <var>window</var>, but
saves the existing keymap.  We can restore this existing keymap with
<code>focus-pop-map</code>.
</p>
<p>These functions are intended to support click-to-focus.  They enforce
certain sanity rules: pushing into a two-element stack will only
overwrite the top element, while popping a one-element stack has no
effect.
</p></dd></dl>

<dl>
<dt><a name="index-autoload_002dfocus_002dmode"></a>Function: <strong>autoload-focus-mode</strong> <em>name func</em></dt>
<dd><p>MISSING.  This does not seem to be used anywhere, and its behavior is
unclear.
</p></dd></dl>

<dl>
<dt><a name="index-select_002dwindow"></a>Function: <strong>select-window</strong></dt>
<dd><p>Waits for the user to left-click on a window, and returns that window.
The mouse cursor changes shape, and all normal input events are
suppressed until a window is selected. For root window, <code>nil</code> is
returned.
</p></dd></dl>

<dl>
<dt><a name="index-select_002dwindow_002dcursor_002dshape"></a>Variable: <strong>select-window-cursor-shape</strong></dt>
<dd><p>The cursor shape to use when selecting a window.  Defaults to
<code>crosshair</code>.
</p></dd></dl>

<hr>
<div class="header">
<p>
Next: <a href="X-Properties.html#X-Properties" accesskey="n" rel="next">X Properties</a>, Previous: <a href="Window-Types.html#Window-Types" accesskey="p" rel="previous">Window Types</a>, Up: <a href="Windows.html#Windows" accesskey="u" rel="up">Windows</a> &nbsp; [<a href="Concept-Index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Function-Index.html#Function-Index" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>
