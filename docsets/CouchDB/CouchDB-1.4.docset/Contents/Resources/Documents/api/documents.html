

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    

    <title>9.2. Document Methods &mdash; Apache CouchDB 1.4 Manual</title>
<!-- RTD <head> -->
<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
<script type="text/javascript" src="//media.readthedocs.org/javascript/underscore.js"></script>
<script type="text/javascript" src="//media.readthedocs.org/javascript/doctools.js"></script>

<script type="text/javascript">
  // This is included here for Javascript that doesn't have access to the templates.
  var doc_version = "1.4.x";
  var doc_slug = "couchdb";
  var page_name = "api/documents";
</script>

<script type="text/javascript" src="//media.readthedocs.org/javascript/rtd.js"></script>
<!-- end RTD <head> -->

    
    <link rel="stylesheet" href="../_static/rtd.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.4.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="top" title="Apache CouchDB 1.4 Manual" href="../index.html" />
    <link rel="up" title="9. API Reference" href="reference.html" />
    <link rel="next" title="9.3. Local (non-replicating) Document Methods" href="local.html" />
    <link rel="prev" title="9.1. Database Methods" href="database.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="local.html" title="9.3. Local (non-replicating) Document Methods"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="database.html" title="9.1. Database Methods"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">Apache CouchDB 1.4 Manual</a> &raquo;</li>
          <li><a href="reference.html" accesskey="U">9. API Reference</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="document-methods">
<span id="api-doc"></span><h1>9.2. Document Methods<a class="headerlink" href="#document-methods" title="Permalink to this headline">¶</a></h1>
<p>The CouchDB API Server Document methods detail how to create, read,
update and delete documents within a database.</p>
<p>A list of the available methods and URL paths are provided below:</p>
<table border="1" class="docutils">
<colgroup>
<col width="11%" />
<col width="33%" />
<col width="57%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Method</th>
<th class="head">Path</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>POST</td>
<td>/db</td>
<td>Create a new document</td>
</tr>
<tr class="row-odd"><td>GET</td>
<td>/db/doc</td>
<td>Returns the latest revision of the
document</td>
</tr>
<tr class="row-even"><td>HEAD</td>
<td>/db/doc</td>
<td>Returns bare information in the HTTP
Headers for the document</td>
</tr>
<tr class="row-odd"><td>PUT</td>
<td>/db/doc</td>
<td>Inserts a new document, or new version
of an existing document</td>
</tr>
<tr class="row-even"><td>DELETE</td>
<td>/db/doc</td>
<td>Deletes the document</td>
</tr>
<tr class="row-odd"><td>COPY</td>
<td>/db/doc</td>
<td>Copies the document</td>
</tr>
<tr class="row-even"><td>GET</td>
<td>/db/doc/attachment</td>
<td>Gets the attachment of a document</td>
</tr>
<tr class="row-odd"><td>PUT</td>
<td>/db/doc/attachment</td>
<td>Adds an attachment of a document</td>
</tr>
<tr class="row-even"><td>DELETE</td>
<td>/db/doc/attachment</td>
<td>Deletes an attachment of a document</td>
</tr>
</tbody>
</table>
<div class="section" id="post-db">
<h2>9.2.1. <tt class="docutils literal"><span class="pre">POST</span> <span class="pre">/db</span></tt><a class="headerlink" href="#post-db" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><strong>Method</strong>: <tt class="docutils literal"><span class="pre">POST</span> <span class="pre">/db</span></tt></li>
<li><strong>Request</strong>: JSON of the new document</li>
<li><strong>Response</strong>: JSON with the committed document information</li>
<li><strong>Admin Privileges Required</strong>: no</li>
<li><strong>Query Arguments</strong>:<ul>
<li><strong>Argument</strong>: batch<ul>
<li><strong>Description</strong>:  Allow document store request to be batched with others</li>
<li><strong>Optional</strong>: yes</li>
<li><strong>Type</strong>: string</li>
<li><strong>Supported Values</strong>: asd</li>
<li><strong>ok</strong>: Enable</li>
</ul>
</li>
</ul>
</li>
<li><strong>Return Codes</strong>:<ul>
<li><strong>201</strong>:
Document has been created successfully</li>
<li><strong>409</strong>:
Conflict - a document with the specified document ID already exists</li>
</ul>
</li>
</ul>
<p>Create a new document in the specified database, using the supplied JSON
document structure. If the JSON structure includes the <tt class="docutils literal"><span class="pre">_id</span></tt> field,
then the document will be created with the specified document ID. If the
<tt class="docutils literal"><span class="pre">_id</span></tt> field is not specified, a new unique ID will be generated.</p>
<p>For example, you can generate a new document with a generated UUID using
the following request:</p>
<div class="highlight-http"><pre>POST http://couchdb:5984/recipes/
Content-Type: application/json

{
   "servings" : 4,
   "subtitle" : "Delicious with fresh bread",
   "title" : "Fish Stew"
}</pre>
</div>
<p>The return JSON will specify the automatically generated ID and revision
information:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
   <span class="s2">&quot;id&quot;</span> <span class="o">:</span> <span class="s2">&quot;64575eef70ab90a2b8d55fc09e00440d&quot;</span><span class="p">,</span>
   <span class="s2">&quot;ok&quot;</span> <span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
   <span class="s2">&quot;rev&quot;</span> <span class="o">:</span> <span class="s2">&quot;1-9c65296036141e575d32ba9c034dd3ee&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="section" id="specifying-the-document-id">
<h3>9.2.1.1. Specifying the Document ID<a class="headerlink" href="#specifying-the-document-id" title="Permalink to this headline">¶</a></h3>
<p>The document ID can be specified by including the <tt class="docutils literal"><span class="pre">_id</span></tt> field in the
JSON of the submitted record. The following request will create the same
document with the ID <tt class="docutils literal"><span class="pre">FishStew</span></tt>:</p>
<div class="highlight-http"><pre>POST http://couchdb:5984/recipes/
Content-Type: application/json

{
   "_id" : "FishStew",
   "servings" : 4,
   "subtitle" : "Delicious with fresh bread",
   "title" : "Fish Stew"
}</pre>
</div>
<p>The structure of the submitted document is as shown in the table below:</p>
<p>In either case, the returned JSON will specify the document ID, revision
ID, and status message:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
   <span class="s2">&quot;id&quot;</span> <span class="o">:</span> <span class="s2">&quot;FishStew&quot;</span><span class="p">,</span>
   <span class="s2">&quot;ok&quot;</span> <span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
   <span class="s2">&quot;rev&quot;</span> <span class="o">:</span> <span class="s2">&quot;1-9c65296036141e575d32ba9c034dd3ee&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="uuid-generation-algorithms">
<span id="api-batch-writes"></span><h3>9.2.1.2. UUID generation algorithms<a class="headerlink" href="#uuid-generation-algorithms" title="Permalink to this headline">¶</a></h3>
<p>CouchDB supports a number of different UUID generation algorithms for use
in situations where a user-specified UUID does not make sense. These
can be set simply by <cite>PUT http://couchdb:5984/_config/uuids/algorithm</cite>.</p>
<table border="1" class="docutils">
<colgroup>
<col width="21%" />
<col width="29%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Algorithm</th>
<th class="head">Description</th>
<th class="head">Sample UUID</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>random</td>
<td>128 bits of pure
random awesomeness</td>
<td><ul class="first last simple">
<li>43febce5675468a5467fb5467ce9e6c0</li>
</ul>
</td>
</tr>
<tr class="row-odd"><td>sequential</td>
<td>monotonically
increasing ids with
random increments</td>
<td><ul class="first last simple">
<li>f755c413badf66b22941313f9f001e28</li>
<li>f755c413badf66b22941313f9f0024ca</li>
<li>f755c413badf66b22941313f9f00332c</li>
</ul>
</td>
</tr>
<tr class="row-even"><td>utc_random</td>
<td>time since start of
epoch, as 14 hex
digits, followed by
18 random digits.</td>
<td><ul class="first last simple">
<li>04cfa405381205204f75100d0241ccc3</li>
<li>04cfa4059c48e76e7c054bbe033dd8db</li>
<li>04cfa405fce10b0df4c08f95e667cd2f</li>
</ul>
</td>
</tr>
<tr class="row-odd"><td>utc_id
&amp; additional
parameter</td>
<td>time since start of
epoch, as 14 hex
digits, followed by
utc_id_suffix.</td>
<td><ul class="first last simple">
<li>04cfa718b00848_i_am_in_yer_couch</li>
<li>04cfa71d377aef_i_am_in_yer_couch</li>
<li>04cfa71e0deabd_i_am_in_yer_couch</li>
</ul>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="batch-mode-writes">
<h3>9.2.1.3. Batch Mode Writes<a class="headerlink" href="#batch-mode-writes" title="Permalink to this headline">¶</a></h3>
<p>You can write documents to the database at a higher rate by using the
batch option. This collects document writes together in memory (on a
user-by-user basis) before they are committed to disk. This increases
the risk of the documents not being stored in the event of a failure,
since the documents are not written to disk immediately.</p>
<p>To use the batched mode, append the <tt class="docutils literal"><span class="pre">batch=ok</span></tt> query argument to the
URL of the <tt class="docutils literal"><span class="pre">PUT</span></tt> or <tt class="docutils literal"><span class="pre">POST</span></tt> request. The CouchDB server will respond
with a 202 HTTP response code immediately.</p>
</div>
<div class="section" id="including-attachments">
<h3>9.2.1.4. Including Attachments<a class="headerlink" href="#including-attachments" title="Permalink to this headline">¶</a></h3>
<p>You can include one or more attachments with a given document by
incorporating the attachment information within the JSON of the
document. This provides a simpler alternative to loading documents with
attachments than making a separate call (see <a class="reference internal" href="#api-put-attachment"><em>PUT /db/doc/attachment</em></a>).</p>
<ul class="simple">
<li><strong>_id</strong> (optional): Document ID</li>
<li><strong>_rev</strong> (optional): Revision ID (when updating an existing document)</li>
<li><strong>_attachments</strong> (optional): Document Attachment<ul>
<li><strong>filename</strong>: Attachment information<ul>
<li><strong>content_type</strong>: MIME Content type string</li>
<li><strong>data</strong>: File attachment content, Base64 encoded</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>The <tt class="docutils literal"><span class="pre">filename</span></tt> will be the attachment name. For example, when sending
the JSON structure below:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
   <span class="s2">&quot;_id&quot;</span> <span class="o">:</span> <span class="s2">&quot;FishStew&quot;</span><span class="p">,</span>
   <span class="s2">&quot;servings&quot;</span> <span class="o">:</span> <span class="mi">4</span><span class="p">,</span>
   <span class="s2">&quot;subtitle&quot;</span> <span class="o">:</span> <span class="s2">&quot;Delicious with fresh bread&quot;</span><span class="p">,</span>
   <span class="s2">&quot;title&quot;</span> <span class="o">:</span> <span class="s2">&quot;Fish Stew&quot;</span>
   <span class="s2">&quot;_attachments&quot;</span> <span class="o">:</span> <span class="p">{</span>
      <span class="s2">&quot;styling.css&quot;</span> <span class="o">:</span> <span class="p">{</span>
         <span class="s2">&quot;content-type&quot;</span> <span class="o">:</span> <span class="s2">&quot;text/css&quot;</span><span class="p">,</span>
         <span class="s2">&quot;data&quot;</span> <span class="o">:</span> <span class="s2">&quot;cCB7IGZvbnQtc2l6ZTogMTJwdDsgfQo=&quot;</span><span class="p">,</span>
         <span class="p">},</span>
   <span class="p">},</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The attachment <tt class="docutils literal"><span class="pre">styling.css</span></tt> can be accessed using
<tt class="docutils literal"><span class="pre">/recipes/FishStew/styling.css</span></tt>. For more information on attachments,
see <a class="reference internal" href="#api-get-attachment"><em>GET /db/doc/attachment</em></a>.</p>
<p>The document data embedded in to the structure must be encoded using
base64.</p>
</div>
</div>
<div class="section" id="get-db-doc">
<span id="api-get-doc"></span><h2>9.2.2. <tt class="docutils literal"><span class="pre">GET</span> <span class="pre">/db/doc</span></tt><a class="headerlink" href="#get-db-doc" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><strong>Method</strong>: <tt class="docutils literal"><span class="pre">GET</span> <span class="pre">/db/doc</span></tt></li>
<li><strong>Request</strong>: None</li>
<li><strong>Response</strong>: Returns the JSON for the document</li>
<li><strong>Admin Privileges Required</strong>: no</li>
<li><strong>Query Arguments</strong>:<ul>
<li><strong>Argument</strong>: conflicts<ul>
<li><strong>Description</strong>: Returns the conflict tree for the document.</li>
<li><strong>Optional</strong>: yes</li>
<li><strong>Type</strong>: boolean</li>
<li><strong>Default</strong>: false</li>
<li><strong>Supported Values</strong>:<ul>
<li><strong>true</strong>: Includes the revisions</li>
</ul>
</li>
</ul>
</li>
<li><strong>Argument</strong>: rev<ul>
<li><strong>Description</strong>: Specify the revision to return</li>
<li><strong>Optional</strong>: yes</li>
<li><strong>Type</strong>: string</li>
<li><strong>Supported Values</strong>:<ul>
<li><strong>true</strong>: Includes the revisions</li>
</ul>
</li>
</ul>
</li>
<li><strong>Argument</strong>: revs<ul>
<li><strong>Description</strong>:  Return a list of the revisions for the document</li>
<li><strong>Optional</strong>: yes</li>
<li><strong>Type</strong>: boolean</li>
</ul>
</li>
<li><strong>Argument</strong>: revs_info<ul>
<li><strong>Description</strong>: Return a list of detailed revision information for the
document</li>
<li><strong>Optional</strong>: yes</li>
<li><strong>Type</strong>: boolean</li>
<li><strong>Supported Values</strong>:<ul>
<li><strong>true</strong>: Includes the revisions</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><strong>Return Codes</strong>:<ul>
<li><strong>200</strong>:
Document retrieved</li>
<li><strong>400</strong>:
The format of the request or revision was invalid</li>
<li><strong>404</strong>:
The specified document or revision cannot be found, or has been deleted</li>
<li><strong>409</strong>:
Conflict - a document with the specified document ID already exists</li>
</ul>
</li>
</ul>
<p>Returns the specified <tt class="docutils literal"><span class="pre">doc</span></tt> from the specified <tt class="docutils literal"><span class="pre">db</span></tt>. For example, to
retrieve the document with the id <tt class="docutils literal"><span class="pre">FishStew</span></tt> you would send the
following request:</p>
<div class="highlight-http"><pre>GET http://couchdb:5984/recipes/FishStew
Content-Type: application/json
Accept: application/json</pre>
</div>
<p>The returned JSON is the JSON of the document, including the document ID
and revision number:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
   <span class="s2">&quot;_id&quot;</span> <span class="o">:</span> <span class="s2">&quot;FishStew&quot;</span><span class="p">,</span>
   <span class="s2">&quot;_rev&quot;</span> <span class="o">:</span> <span class="s2">&quot;3-a1a9b39ee3cc39181b796a69cb48521c&quot;</span><span class="p">,</span>
   <span class="s2">&quot;servings&quot;</span> <span class="o">:</span> <span class="mi">4</span><span class="p">,</span>
   <span class="s2">&quot;subtitle&quot;</span> <span class="o">:</span> <span class="s2">&quot;Delicious with a green salad&quot;</span><span class="p">,</span>
   <span class="s2">&quot;title&quot;</span> <span class="o">:</span> <span class="s2">&quot;Irish Fish Stew&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Unless you request a specific revision, the latest revision of the
document will always be returned.</p>
<div class="section" id="attachments">
<h3>9.2.2.1. Attachments<a class="headerlink" href="#attachments" title="Permalink to this headline">¶</a></h3>
<p>If the document includes attachments, then the returned structure will
contain a summary of the attachments associated with the document, but
not the attachment data itself.</p>
<p>The JSON for the returned document will include the <tt class="docutils literal"><span class="pre">_attachments</span></tt>
field, with one or more attachment definitions. For example:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
   <span class="s2">&quot;_id&quot;</span> <span class="o">:</span> <span class="s2">&quot;FishStew&quot;</span><span class="p">,</span>
   <span class="s2">&quot;servings&quot;</span> <span class="o">:</span> <span class="mi">4</span><span class="p">,</span>
   <span class="s2">&quot;subtitle&quot;</span> <span class="o">:</span> <span class="s2">&quot;Delicious with fresh bread&quot;</span><span class="p">,</span>
   <span class="s2">&quot;title&quot;</span> <span class="o">:</span> <span class="s2">&quot;Fish Stew&quot;</span>
   <span class="s2">&quot;_attachments&quot;</span> <span class="o">:</span> <span class="p">{</span>
      <span class="s2">&quot;styling.css&quot;</span> <span class="o">:</span> <span class="p">{</span>
         <span class="s2">&quot;stub&quot;</span> <span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
         <span class="s2">&quot;content-type&quot;</span> <span class="o">:</span> <span class="s2">&quot;text/css&quot;</span><span class="p">,</span>
         <span class="s2">&quot;length&quot;</span> <span class="o">:</span> <span class="mi">783426</span><span class="p">,</span>
         <span class="p">},</span>
   <span class="p">},</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The format of the returned JSON is shown in the table below:</p>
<ul class="simple">
<li><strong>_id</strong> (optional): Document ID</li>
<li><strong>_rev</strong> (optional): Revision ID (when updating an existing document)</li>
<li><strong>_attachments</strong> (optional): Document Attachment<ul>
<li><strong>filename</strong>: Attachment information<ul>
<li><strong>content_type</strong>: MIME Content type string</li>
<li><strong>length</strong>: Length (bytes) of the attachment data</li>
<li><strong>revpos</strong>: Revision where this attachment exists</li>
<li><strong>stub</strong>: Indicates whether the attachment is a stub</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="getting-a-list-of-revisions">
<h3>9.2.2.2. Getting a List of Revisions<a class="headerlink" href="#getting-a-list-of-revisions" title="Permalink to this headline">¶</a></h3>
<p>You can obtain a list of the revisions for a given document by adding
the <tt class="docutils literal"><span class="pre">revs=true</span></tt> parameter to the request URL. For example:</p>
<div class="highlight-http"><pre>GET http://couchdb:5984/recipes/FishStew?revs=true
Accept: application/json</pre>
</div>
<p>The returned JSON structure includes the original document, including a
<tt class="docutils literal"><span class="pre">_revisions</span></tt> structure that includes the revision information:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
   <span class="s2">&quot;servings&quot;</span> <span class="o">:</span> <span class="mi">4</span><span class="p">,</span>
   <span class="s2">&quot;subtitle&quot;</span> <span class="o">:</span> <span class="s2">&quot;Delicious with a green salad&quot;</span><span class="p">,</span>
   <span class="s2">&quot;_id&quot;</span> <span class="o">:</span> <span class="s2">&quot;FishStew&quot;</span><span class="p">,</span>
   <span class="s2">&quot;title&quot;</span> <span class="o">:</span> <span class="s2">&quot;Irish Fish Stew&quot;</span><span class="p">,</span>
   <span class="s2">&quot;_revisions&quot;</span> <span class="o">:</span> <span class="p">{</span>
      <span class="s2">&quot;ids&quot;</span> <span class="o">:</span> <span class="p">[</span>
         <span class="s2">&quot;a1a9b39ee3cc39181b796a69cb48521c&quot;</span><span class="p">,</span>
         <span class="s2">&quot;7c4740b4dcf26683e941d6641c00c39d&quot;</span><span class="p">,</span>
         <span class="s2">&quot;9c65296036141e575d32ba9c034dd3ee&quot;</span>
      <span class="p">],</span>
      <span class="s2">&quot;start&quot;</span> <span class="o">:</span> <span class="mi">3</span>
   <span class="p">},</span>
   <span class="s2">&quot;_rev&quot;</span> <span class="o">:</span> <span class="s2">&quot;3-a1a9b39ee3cc39181b796a69cb48521c&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li><strong>_id</strong> (optional): Document ID</li>
<li><strong>_rev</strong> (optional): Revision ID (when updating an existing document)</li>
<li><strong>_revisions</strong>: CouchDB Document Revisions<ul>
<li><strong>ids</strong> [array]: Array of valid revision IDs, in reverse order
(latest first)</li>
<li><strong>start</strong>: Prefix number for the latest revision</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="obtaining-an-extended-revision-history">
<h3>9.2.2.3. Obtaining an Extended Revision History<a class="headerlink" href="#obtaining-an-extended-revision-history" title="Permalink to this headline">¶</a></h3>
<p>You can get additional information about the revisions for a given
document by supplying the <tt class="docutils literal"><span class="pre">revs_info</span></tt> argument to the query:</p>
<div class="highlight-http"><pre>GET http://couchdb:5984/recipes/FishStew?revs_info=true
Accept: application/json</pre>
</div>
<p>This returns extended revision information, including the availability
and status of each revision:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
   <span class="s2">&quot;servings&quot;</span> <span class="o">:</span> <span class="mi">4</span><span class="p">,</span>
   <span class="s2">&quot;subtitle&quot;</span> <span class="o">:</span> <span class="s2">&quot;Delicious with a green salad&quot;</span><span class="p">,</span>
   <span class="s2">&quot;_id&quot;</span> <span class="o">:</span> <span class="s2">&quot;FishStew&quot;</span><span class="p">,</span>
   <span class="s2">&quot;_revs_info&quot;</span> <span class="o">:</span> <span class="p">[</span>
      <span class="p">{</span>
         <span class="s2">&quot;status&quot;</span> <span class="o">:</span> <span class="s2">&quot;available&quot;</span><span class="p">,</span>
         <span class="s2">&quot;rev&quot;</span> <span class="o">:</span> <span class="s2">&quot;3-a1a9b39ee3cc39181b796a69cb48521c&quot;</span>
      <span class="p">},</span>
      <span class="p">{</span>
         <span class="s2">&quot;status&quot;</span> <span class="o">:</span> <span class="s2">&quot;available&quot;</span><span class="p">,</span>
         <span class="s2">&quot;rev&quot;</span> <span class="o">:</span> <span class="s2">&quot;2-7c4740b4dcf26683e941d6641c00c39d&quot;</span>
      <span class="p">},</span>
      <span class="p">{</span>
         <span class="s2">&quot;status&quot;</span> <span class="o">:</span> <span class="s2">&quot;available&quot;</span><span class="p">,</span>
         <span class="s2">&quot;rev&quot;</span> <span class="o">:</span> <span class="s2">&quot;1-9c65296036141e575d32ba9c034dd3ee&quot;</span>
      <span class="p">}</span>
   <span class="p">],</span>
   <span class="s2">&quot;title&quot;</span> <span class="o">:</span> <span class="s2">&quot;Irish Fish Stew&quot;</span><span class="p">,</span>
   <span class="s2">&quot;_rev&quot;</span> <span class="o">:</span> <span class="s2">&quot;3-a1a9b39ee3cc39181b796a69cb48521c&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li><strong>_id</strong> (optional): Document ID</li>
<li><strong>_rev</strong> (optional): Revision ID (when updating an existing document)</li>
<li><strong>_revs_info</strong> [array]: CouchDB Document Extended Revision Info<ul>
<li><strong>rev</strong>: Full revision string</li>
<li><strong>status</strong>: Status of the revision</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="obtaining-a-specific-revision">
<h3>9.2.2.4. Obtaining a Specific Revision<a class="headerlink" href="#obtaining-a-specific-revision" title="Permalink to this headline">¶</a></h3>
<p>To get a specific revision, use the <tt class="docutils literal"><span class="pre">rev</span></tt> argument to the request, and
specify the full revision number:</p>
<div class="highlight-http"><pre>GET http://couchdb:5984/recipes/FishStew?rev=2-7c4740b4dcf26683e941d6641c00c39d
Accept: application/json</pre>
</div>
<p>The specified revision of the document will be returned, including a
<tt class="docutils literal"><span class="pre">_rev</span></tt> field specifying the revision that was requested:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
   <span class="s2">&quot;_id&quot;</span> <span class="o">:</span> <span class="s2">&quot;FishStew&quot;</span><span class="p">,</span>
   <span class="s2">&quot;_rev&quot;</span> <span class="o">:</span> <span class="s2">&quot;2-7c4740b4dcf26683e941d6641c00c39d&quot;</span><span class="p">,</span>
   <span class="s2">&quot;servings&quot;</span> <span class="o">:</span> <span class="mi">4</span><span class="p">,</span>
   <span class="s2">&quot;subtitle&quot;</span> <span class="o">:</span> <span class="s2">&quot;Delicious with a green salad&quot;</span><span class="p">,</span>
   <span class="s2">&quot;title&quot;</span> <span class="o">:</span> <span class="s2">&quot;Fish Stew&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="head-db-doc">
<h2>9.2.3. <tt class="docutils literal"><span class="pre">HEAD</span> <span class="pre">/db/doc</span></tt><a class="headerlink" href="#head-db-doc" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><strong>Method</strong>: <tt class="docutils literal"><span class="pre">HEAD</span> <span class="pre">/db/doc</span></tt></li>
<li><strong>Request</strong>: None</li>
<li><strong>Response</strong>: None</li>
<li><strong>Admin Privileges Required</strong>: no</li>
<li><strong>Query Arguments</strong>:<ul>
<li><strong>Argument</strong>: rev<ul>
<li><strong>Description</strong>:  Specify the revision to return</li>
<li><strong>Optional</strong>: yes</li>
<li><strong>Type</strong>: string</li>
</ul>
</li>
<li><strong>Argument</strong>: revs<ul>
<li><strong>Description</strong>:  Return a list of the revisions for the document</li>
<li><strong>Optional</strong>: yes</li>
<li><strong>Type</strong>: boolean</li>
</ul>
</li>
<li><strong>Argument</strong>: revs_info<ul>
<li><strong>Description</strong>:  Return a list of detailed revision information for the
document</li>
<li><strong>Optional</strong>: yes</li>
<li><strong>Type</strong>: boolean</li>
</ul>
</li>
</ul>
</li>
<li><strong>Return Codes</strong>:<ul>
<li><strong>404</strong>:
The specified document or revision cannot be found, or has been deleted</li>
</ul>
</li>
</ul>
<p>Returns the HTTP Headers containing a minimal amount of information
about the specified document. The method supports the same query
arguments as the <tt class="docutils literal"><span class="pre">GET</span></tt> method, but only the header information
(including document size, and the revision as an ETag), is returned. For
example, a simple <tt class="docutils literal"><span class="pre">HEAD</span></tt> request:</p>
<div class="highlight-http"><pre>HEAD http://couchdb:5984/recipes/FishStew
Content-Type: application/json</pre>
</div>
<p>Returns the following HTTP Headers:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">HTTP</span><span class="o">/</span><span class="mf">1.1</span> <span class="mi">200</span> <span class="nx">OK</span>
<span class="nx">Server</span><span class="o">:</span> <span class="nx">CouchDB</span><span class="o">/</span><span class="mf">1.0</span><span class="p">.</span><span class="mi">1</span> <span class="p">(</span><span class="nx">Erlang</span> <span class="nx">OTP</span><span class="o">/</span><span class="nx">R13B</span><span class="p">)</span>
<span class="nx">Etag</span><span class="o">:</span> <span class="s2">&quot;7-a19a1a5ecd946dad70e85233ba039ab2&quot;</span>
<span class="nb">Date</span><span class="o">:</span> <span class="nx">Fri</span><span class="p">,</span> <span class="mi">05</span> <span class="nx">Nov</span> <span class="mi">2010</span> <span class="mi">14</span><span class="o">:</span><span class="mi">54</span><span class="o">:</span><span class="mi">43</span> <span class="nx">GMT</span>
<span class="nx">Content</span><span class="o">-</span><span class="nx">Type</span><span class="o">:</span> <span class="nx">text</span><span class="o">/</span><span class="nx">plain</span><span class="p">;</span><span class="nx">charset</span><span class="o">=</span><span class="nx">utf</span><span class="o">-</span><span class="mi">8</span>
<span class="nx">Content</span><span class="o">-</span><span class="nx">Length</span><span class="o">:</span> <span class="mi">136</span>
<span class="nx">Cache</span><span class="o">-</span><span class="nx">Control</span><span class="o">:</span> <span class="nx">must</span><span class="o">-</span><span class="nx">revalidate</span>
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">Etag</span></tt> header shows the current revision for the requested
document, and the <tt class="docutils literal"><span class="pre">Content-Length</span></tt> specifies the length of the data,
if the document were requested in full.</p>
<p>Adding any of the query arguments (as supported by <tt class="docutils literal"><span class="pre">`GET```_</span> <span class="pre">method),</span>
<span class="pre">then</span> <span class="pre">the</span> <span class="pre">resulting</span> <span class="pre">HTTP</span> <span class="pre">Headers</span> <span class="pre">will</span> <span class="pre">correspond</span> <span class="pre">to</span> <span class="pre">what</span> <span class="pre">would</span> <span class="pre">be</span>
<span class="pre">returned.</span> <span class="pre">Note</span> <span class="pre">that</span> <span class="pre">the</span> <span class="pre">current</span> <span class="pre">revision</span> <span class="pre">is</span> <span class="pre">not</span> <span class="pre">returned</span> <span class="pre">when</span> <span class="pre">the</span>
<span class="pre">``refs_info</span></tt> argument is used. For example:</p>
<div class="highlight-http"><div class="highlight"><pre><span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Server</span><span class="o">:</span> <span class="l">CouchDB/1.0.1 (Erlang OTP/R13B)</span>
<span class="na">Date</span><span class="o">:</span> <span class="l">Fri, 05 Nov 2010 14:57:16 GMT</span>
<span class="na">Content-Type</span><span class="o">:</span> <span class="l">text/plain;charset=utf-8</span>
<span class="na">Content-Length</span><span class="o">:</span> <span class="l">609</span>
<span class="na">Cache-Control</span><span class="o">:</span> <span class="l">must-revalidate</span>
</pre></div>
</div>
</div>
<div class="section" id="put-db-doc">
<span id="api-put-doc"></span><h2>9.2.4. <tt class="docutils literal"><span class="pre">PUT</span> <span class="pre">/db/doc</span></tt><a class="headerlink" href="#put-db-doc" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><strong>Method</strong>: <tt class="docutils literal"><span class="pre">PUT</span> <span class="pre">/db/doc</span></tt></li>
<li><strong>Request</strong>: JSON of the new document, or updated version of the existed
document</li>
<li><strong>Response</strong>: JSON of the document ID and revision</li>
<li><strong>Admin Privileges Required</strong>: no</li>
<li><strong>Query Arguments</strong>:<ul>
<li><strong>Argument</strong>: batch<ul>
<li><strong>Description</strong>:  Allow document store request to be batched with others</li>
<li><strong>Optional</strong>: yes</li>
<li><strong>Type</strong>: string</li>
<li><strong>Supported Values</strong>:<ul>
<li><strong>ok</strong>: Enable</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><strong>HTTP Headers</strong><ul>
<li><strong>Header</strong>: <tt class="docutils literal"><span class="pre">If-Match</span></tt><ul>
<li><strong>Description</strong>: Current revision of the document for validation</li>
<li><strong>Optional</strong>: yes</li>
</ul>
</li>
</ul>
</li>
<li><strong>Return Codes</strong>:<ul>
<li><strong>201</strong>:
Document has been created successfully</li>
<li><strong>202</strong>:
Document accepted for writing (batch mode)</li>
</ul>
</li>
</ul>
<p>The <tt class="docutils literal"><span class="pre">PUT</span></tt> method creates a new named document, or creates a new
revision of the existing document. Unlike the <tt class="docutils literal"><span class="pre">POST</span></tt> method, you
must specify the document ID in the request URL.</p>
<p>For example, to create the document <tt class="docutils literal"><span class="pre">FishStew</span></tt>, you would send the
following request:</p>
<div class="highlight-http"><pre>PUT http://couchdb:5984/recipes/FishStew
Content-Type: application/json

{
  "servings" : 4,
  "subtitle" : "Delicious with fresh bread",
  "title" : "Fish Stew"
}</pre>
</div>
<p>The return type is JSON of the status, document ID,and revision number:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
   <span class="s2">&quot;id&quot;</span> <span class="o">:</span> <span class="s2">&quot;FishStew&quot;</span><span class="p">,</span>
   <span class="s2">&quot;ok&quot;</span> <span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
   <span class="s2">&quot;rev&quot;</span> <span class="o">:</span> <span class="s2">&quot;1-9c65296036141e575d32ba9c034dd3ee&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="section" id="updating-an-existing-document">
<h3>9.2.4.1. Updating an Existing Document<a class="headerlink" href="#updating-an-existing-document" title="Permalink to this headline">¶</a></h3>
<p>To update an existing document you must specify the current revision
number within the <tt class="docutils literal"><span class="pre">_rev</span></tt> parameter. For example:</p>
<div class="highlight-http"><pre>PUT http://couchdb:5984/recipes/FishStew
Content-Type: application/json

{
  "_rev" : "1-9c65296036141e575d32ba9c034dd3ee",
  "servings" : 4,
  "subtitle" : "Delicious with fresh salad",
  "title" : "Fish Stew"
}</pre>
</div>
<p>Alternatively, you can supply the current revision number in the
<tt class="docutils literal"><span class="pre">If-Match</span></tt> HTTP header of the request. For example:</p>
<div class="highlight-http"><pre>PUT http://couchdb:5984/recipes/FishStew
If-Match: 2-d953b18035b76f2a5b1d1d93f25d3aea
Content-Type: application/json

{
   "servings" : 4,
   "subtitle" : "Delicious with fresh salad",
   "title" : "Fish Stew"
}</pre>
</div>
<p>The JSON returned will include the updated revision number:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
   <span class="s2">&quot;id&quot;</span> <span class="o">:</span> <span class="s2">&quot;FishStew99&quot;</span><span class="p">,</span>
   <span class="s2">&quot;ok&quot;</span> <span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
   <span class="s2">&quot;rev&quot;</span> <span class="o">:</span> <span class="s2">&quot;2-d953b18035b76f2a5b1d1d93f25d3aea&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>For information on batched writes, which can provide improved
performance, see <a class="reference internal" href="#api-batch-writes"><em>UUID generation algorithms</em></a>.</p>
</div>
</div>
<div class="section" id="delete-db-doc">
<span id="api-del-doc"></span><h2>9.2.5. <tt class="docutils literal"><span class="pre">DELETE</span> <span class="pre">/db/doc</span></tt><a class="headerlink" href="#delete-db-doc" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><strong>Method</strong>: <tt class="docutils literal"><span class="pre">DELETE</span> <span class="pre">/db/doc</span></tt></li>
<li><strong>Request</strong>: None</li>
<li><strong>Response</strong>: JSON of the deleted revision</li>
<li><strong>Admin Privileges Required</strong>: no</li>
<li><strong>Query Arguments</strong>:<ul>
<li><strong>Argument</strong>: rev<ul>
<li><strong>Description</strong>:  Current revision of the document for validation</li>
<li><strong>Optional</strong>: yes</li>
<li><strong>Type</strong>: string</li>
</ul>
</li>
</ul>
</li>
<li><strong>HTTP Headers</strong><ul>
<li><strong>Header</strong>: <tt class="docutils literal"><span class="pre">If-Match</span></tt><ul>
<li><strong>Description</strong>: Current revision of the document for validation</li>
<li><strong>Optional</strong>: yes</li>
</ul>
</li>
</ul>
</li>
<li><strong>Return Codes</strong>:<ul>
<li><strong>409</strong>:
Revision is missing, invalid or not the latest</li>
</ul>
</li>
</ul>
<p>Deletes the specified document from the database. You must supply the
current (latest) revision, either by using the <tt class="docutils literal"><span class="pre">rev</span></tt> parameter to
specify the revision:</p>
<div class="highlight-http"><pre>DELETE http://couchdb:5984/recipes/FishStew?rev=3-a1a9b39ee3cc39181b796a69cb48521c
Content-Type: application/json</pre>
</div>
<p>Alternatively, you can use ETags with the <tt class="docutils literal"><span class="pre">If-Match</span></tt> field:</p>
<div class="highlight-http"><pre>DELETE http://couchdb:5984/recipes/FishStew
If-Match: 3-a1a9b39ee3cc39181b796a69cb48521c
Content-Type: application/json</pre>
</div>
<p>The returned JSON contains the document ID, revision and status:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
   <span class="s2">&quot;id&quot;</span> <span class="o">:</span> <span class="s2">&quot;FishStew&quot;</span><span class="p">,</span>
   <span class="s2">&quot;ok&quot;</span> <span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
   <span class="s2">&quot;rev&quot;</span> <span class="o">:</span> <span class="s2">&quot;4-2719fd41187c60762ff584761b714cfb&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Note that deletion of a record increments the revision number. The
use of a revision for deletion of the record allows replication of
the database to correctly track the deletion in synchronized copies.</p>
</div>
</div>
<div class="section" id="copy-db-doc">
<span id="api-copy-doc"></span><h2>9.2.6. <tt class="docutils literal"><span class="pre">COPY</span> <span class="pre">/db/doc</span></tt><a class="headerlink" href="#copy-db-doc" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><strong>Method</strong>: <tt class="docutils literal"><span class="pre">COPY</span> <span class="pre">/db/doc</span></tt></li>
<li><strong>Request</strong>: None</li>
<li><strong>Response</strong>: JSON of the new document and revision</li>
<li><strong>Admin Privileges Required</strong>: no</li>
<li><strong>Query Arguments</strong>:<ul>
<li><strong>Argument</strong>: rev<ul>
<li><strong>Description</strong>:  Revision to copy from</li>
<li><strong>Optional</strong>: yes</li>
<li><strong>Type</strong>: string</li>
</ul>
</li>
</ul>
</li>
<li><strong>HTTP Headers</strong><ul>
<li><strong>Header</strong>: <tt class="docutils literal"><span class="pre">Destination</span></tt><ul>
<li><strong>Description</strong>: Destination document (and optional revision)</li>
<li><strong>Optional</strong>: no</li>
</ul>
</li>
</ul>
</li>
<li><strong>Return Codes</strong>:<ul>
<li><strong>201</strong>:
Document has been copied and created successfully</li>
<li><strong>409</strong>:
Revision is missing, invalid or not the latest</li>
</ul>
</li>
</ul>
<p>The <tt class="docutils literal"><span class="pre">COPY</span></tt> command (which is non-standard HTTP) copies an existing
document to a new or existing document.</p>
<p>The source document is specified on the request line, with the
<tt class="docutils literal"><span class="pre">Destination</span></tt> HTTP Header of the request specifying the target
document.</p>
<div class="section" id="copying-a-document">
<h3>9.2.6.1. Copying a Document<a class="headerlink" href="#copying-a-document" title="Permalink to this headline">¶</a></h3>
<p>You can copy the latest version of a document to a new document by
specifying the current document and target document:</p>
<div class="highlight-http"><pre>COPY http://couchdb:5984/recipes/FishStew
Content-Type: application/json
Destination: IrishFishStew</pre>
</div>
<p>The above request copies the document <tt class="docutils literal"><span class="pre">FishStew</span></tt> to the new document
<tt class="docutils literal"><span class="pre">IrishFishStew</span></tt>. The response is the ID and revision of the new
document.</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
   <span class="s2">&quot;id&quot;</span> <span class="o">:</span> <span class="s2">&quot;IrishFishStew&quot;</span><span class="p">,</span>
   <span class="s2">&quot;rev&quot;</span> <span class="o">:</span> <span class="s2">&quot;1-9c65296036141e575d32ba9c034dd3ee&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="copying-from-a-specific-revision">
<h3>9.2.6.2. Copying from a Specific Revision<a class="headerlink" href="#copying-from-a-specific-revision" title="Permalink to this headline">¶</a></h3>
<p>To copy <em>from</em> a specific version, use the <tt class="docutils literal"><span class="pre">rev</span></tt> argument to the query
string:</p>
<div class="highlight-http"><pre>COPY http://couchdb:5984/recipes/FishStew?rev=5-acfd32d233f07cea4b4f37daaacc0082
Content-Type: application/json
Destination: IrishFishStew</pre>
</div>
<p>The new document will be created using the information in the specified
revision of the source document.</p>
</div>
<div class="section" id="copying-to-an-existing-document">
<h3>9.2.6.3. Copying to an Existing Document<a class="headerlink" href="#copying-to-an-existing-document" title="Permalink to this headline">¶</a></h3>
<p>To copy to an existing document, you must specify the current revision
string for the target document, using the <tt class="docutils literal"><span class="pre">rev</span></tt> parameter to the
<tt class="docutils literal"><span class="pre">Destination</span></tt> HTTP Header string. For example:</p>
<div class="highlight-http"><pre>COPY http://couchdb:5984/recipes/FishStew
Content-Type: application/json
Destination: IrishFishStew?rev=1-9c65296036141e575d32ba9c034dd3ee</pre>
</div>
<p>The return value will be the new revision of the copied document:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
   <span class="s2">&quot;id&quot;</span> <span class="o">:</span> <span class="s2">&quot;IrishFishStew&quot;</span><span class="p">,</span>
   <span class="s2">&quot;rev&quot;</span> <span class="o">:</span> <span class="s2">&quot;2-55b6a1b251902a2c249b667dab1c6692&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="get-db-doc-attachment">
<span id="api-get-attachment"></span><h2>9.2.7. <tt class="docutils literal"><span class="pre">GET</span> <span class="pre">/db/doc/attachment</span></tt><a class="headerlink" href="#get-db-doc-attachment" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><strong>Method</strong>: <tt class="docutils literal"><span class="pre">GET</span> <span class="pre">/db/doc/attachment</span></tt></li>
<li><strong>Request</strong>: None</li>
<li><strong>Response</strong>: Returns the attachment data</li>
<li><strong>Admin Privileges Required</strong>: no</li>
</ul>
<p>Returns the file attachment <tt class="docutils literal"><span class="pre">attachment</span></tt> associated with the document
<tt class="docutils literal"><span class="pre">doc</span></tt>. The raw data of the associated attachment is returned (just as
if you were accessing a static file. The returned HTTP <tt class="docutils literal"><span class="pre">Content-type</span></tt>
will be the same as the content type set when the document attachment
was submitted into the database.</p>
</div>
<div class="section" id="put-db-doc-attachment">
<span id="api-put-attachment"></span><h2>9.2.8. <tt class="docutils literal"><span class="pre">PUT</span> <span class="pre">/db/doc/attachment</span></tt><a class="headerlink" href="#put-db-doc-attachment" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><strong>Method</strong>: <tt class="docutils literal"><span class="pre">PUT</span> <span class="pre">/db/doc/attachment</span></tt></li>
<li><strong>Request</strong>: Raw document data</li>
<li><strong>Response</strong>: JSON document status</li>
<li><strong>Admin Privileges Required</strong>: no</li>
<li><strong>Query Arguments</strong>:<ul>
<li><strong>Argument</strong>: rev<ul>
<li><strong>Description</strong>:  Current document revision</li>
<li><strong>Optional</strong>: no</li>
<li><strong>Type</strong>: string</li>
</ul>
</li>
</ul>
</li>
<li><strong>HTTP Headers</strong><ul>
<li><strong>Header</strong>: <tt class="docutils literal"><span class="pre">Content-Length</span></tt><ul>
<li><strong>Description</strong>: Length (bytes) of the attachment being uploaded</li>
<li><strong>Optional</strong>: no</li>
</ul>
</li>
<li><strong>Header</strong>: <tt class="docutils literal"><span class="pre">Content-Type</span></tt><ul>
<li><strong>Description</strong>: MIME type for the uploaded attachment</li>
<li><strong>Optional</strong>: no</li>
</ul>
</li>
<li><strong>Header</strong>: <tt class="docutils literal"><span class="pre">If-Match</span></tt><ul>
<li><strong>Description</strong>: Current revision of the document for validation</li>
<li><strong>Optional</strong>: yes</li>
</ul>
</li>
</ul>
</li>
<li><strong>Return Codes</strong>:<ul>
<li><strong>201</strong>:
Attachment has been accepted</li>
</ul>
</li>
</ul>
<p>Upload the supplied content as an attachment to the specified document
(<tt class="docutils literal"><span class="pre">doc</span></tt>). The <tt class="docutils literal"><span class="pre">attachment</span></tt> name provided must be a URL encoded
string. You must also supply either the <tt class="docutils literal"><span class="pre">rev</span></tt> query argument or the
<tt class="docutils literal"><span class="pre">If-Match</span></tt> HTTP header for validation, and the HTTP headers (to set
the attachment content type). The content type is used when the
attachment is requested as the corresponding content-type in the
returned document header.</p>
<p>For example, you could upload a simple text document using the following
request:</p>
<div class="highlight-http"><pre>PUT http://couchdb:5984/recipes/FishStew/basic?rev=8-a94cb7e50ded1e06f943be5bfbddf8ca
Content-Length: 10
Content-Type: text/plain

Roast it</pre>
</div>
<p>Or by using the <tt class="docutils literal"><span class="pre">If-Match</span></tt> HTTP header:</p>
<div class="highlight-http"><pre>PUT http://couchdb:5984/recipes/FishStew/basic
If-Match: 8-a94cb7e50ded1e06f943be5bfbddf8ca
Content-Length: 10
Content-Type: text/plain

Roast it</pre>
</div>
<p>The returned JSON contains the new document information:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
   <span class="s2">&quot;id&quot;</span> <span class="o">:</span> <span class="s2">&quot;FishStew&quot;</span><span class="p">,</span>
   <span class="s2">&quot;ok&quot;</span> <span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
   <span class="s2">&quot;rev&quot;</span> <span class="o">:</span> <span class="s2">&quot;9-247bb19a41bfd9bfdaf5ee6e2e05be74&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Uploading an attachment updates the corresponding document revision.
Revisions are tracked for the parent document, not individual
attachments.</p>
</div>
<div class="section" id="updating-an-existing-attachment">
<h3>9.2.8.1. Updating an Existing Attachment<a class="headerlink" href="#updating-an-existing-attachment" title="Permalink to this headline">¶</a></h3>
<p>Uploading an attachment using an existing attachment name will update
the corresponding stored content of the database. Since you must supply
the revision information to add an attachment to a document, this serves
as validation to update the existing attachment.</p>
</div>
</div>
<div class="section" id="delete-db-doc-attachment">
<h2>9.2.9. <tt class="docutils literal"><span class="pre">DELETE</span> <span class="pre">/db/doc/attachment</span></tt><a class="headerlink" href="#delete-db-doc-attachment" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><strong>Method</strong>: <tt class="docutils literal"><span class="pre">DELETE</span> <span class="pre">/db/doc/attachment</span></tt></li>
<li><strong>Request</strong>: None</li>
<li><strong>Response</strong>: JSON status</li>
<li><strong>Admin Privileges Required</strong>: no</li>
<li><strong>Query Arguments</strong>:<ul>
<li><strong>Argument</strong>: rev<ul>
<li><strong>Description</strong>:  Current document revision</li>
<li><strong>Optional</strong>: no</li>
<li><strong>Type</strong>: string</li>
</ul>
</li>
</ul>
</li>
<li><strong>HTTP Headers</strong><ul>
<li><strong>Header</strong>: <tt class="docutils literal"><span class="pre">If-Match</span></tt><ul>
<li><strong>Description</strong>: Current revision of the document for validation</li>
<li><strong>Optional</strong>: yes</li>
</ul>
</li>
</ul>
</li>
<li><strong>Return Codes</strong>:<ul>
<li><strong>200</strong>:
Attachment deleted successfully</li>
<li><strong>409</strong>:
Supplied revision is incorrect or missing</li>
</ul>
</li>
</ul>
<p>Deletes the attachment <tt class="docutils literal"><span class="pre">attachment</span></tt> to the specified <tt class="docutils literal"><span class="pre">doc</span></tt>. You must
supply the <tt class="docutils literal"><span class="pre">rev</span></tt> argument with the current revision to delete the
attachment.</p>
<p>For example to delete the attachment <tt class="docutils literal"><span class="pre">basic</span></tt> from the recipe
<tt class="docutils literal"><span class="pre">FishStew</span></tt>:</p>
<div class="highlight-http"><pre>DELETE http://couchdb:5984/recipes/FishStew/basic?rev=9-247bb19a41bfd9bfdaf5ee6e2e05be74
Content-Type: application/json</pre>
</div>
<p>The returned JSON contains the updated revision information:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
   <span class="s2">&quot;id&quot;</span> <span class="o">:</span> <span class="s2">&quot;FishStew&quot;</span><span class="p">,</span>
   <span class="s2">&quot;ok&quot;</span> <span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
   <span class="s2">&quot;rev&quot;</span> <span class="o">:</span> <span class="s2">&quot;10-561bf6b1e27615cee83d1f48fa65dd3e&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">

            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/logo.png" alt="Logo"/>
            </a></p>

<!--

Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at

   http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software distributed
under the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR
CONDITIONS OF ANY KIND, either express or implied. See the License for the
specific language governing permissions and limitations under the License.

-->

<div id="searchbox" style="display: none">

<h3>Quick Search</h3>

<form class="search" action="search.html" method="get">
<input type="text" name="q">
<input type="submit" value="Go">
<input type="hidden" name="check_keywords" value="yes">
<input type="hidden" name="area" value="default">
</form>

<br>

</div>

<script type="text/javascript">$('#searchbox').show(0);</script>
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">9.2. Document Methods</a><ul>
<li><a class="reference internal" href="#post-db">9.2.1. <tt class="docutils literal"><span class="pre">POST</span> <span class="pre">/db</span></tt></a><ul>
<li><a class="reference internal" href="#specifying-the-document-id">9.2.1.1. Specifying the Document ID</a></li>
<li><a class="reference internal" href="#uuid-generation-algorithms">9.2.1.2. UUID generation algorithms</a></li>
<li><a class="reference internal" href="#batch-mode-writes">9.2.1.3. Batch Mode Writes</a></li>
<li><a class="reference internal" href="#including-attachments">9.2.1.4. Including Attachments</a></li>
</ul>
</li>
<li><a class="reference internal" href="#get-db-doc">9.2.2. <tt class="docutils literal"><span class="pre">GET</span> <span class="pre">/db/doc</span></tt></a><ul>
<li><a class="reference internal" href="#attachments">9.2.2.1. Attachments</a></li>
<li><a class="reference internal" href="#getting-a-list-of-revisions">9.2.2.2. Getting a List of Revisions</a></li>
<li><a class="reference internal" href="#obtaining-an-extended-revision-history">9.2.2.3. Obtaining an Extended Revision History</a></li>
<li><a class="reference internal" href="#obtaining-a-specific-revision">9.2.2.4. Obtaining a Specific Revision</a></li>
</ul>
</li>
<li><a class="reference internal" href="#head-db-doc">9.2.3. <tt class="docutils literal"><span class="pre">HEAD</span> <span class="pre">/db/doc</span></tt></a></li>
<li><a class="reference internal" href="#put-db-doc">9.2.4. <tt class="docutils literal"><span class="pre">PUT</span> <span class="pre">/db/doc</span></tt></a><ul>
<li><a class="reference internal" href="#updating-an-existing-document">9.2.4.1. Updating an Existing Document</a></li>
</ul>
</li>
<li><a class="reference internal" href="#delete-db-doc">9.2.5. <tt class="docutils literal"><span class="pre">DELETE</span> <span class="pre">/db/doc</span></tt></a></li>
<li><a class="reference internal" href="#copy-db-doc">9.2.6. <tt class="docutils literal"><span class="pre">COPY</span> <span class="pre">/db/doc</span></tt></a><ul>
<li><a class="reference internal" href="#copying-a-document">9.2.6.1. Copying a Document</a></li>
<li><a class="reference internal" href="#copying-from-a-specific-revision">9.2.6.2. Copying from a Specific Revision</a></li>
<li><a class="reference internal" href="#copying-to-an-existing-document">9.2.6.3. Copying to an Existing Document</a></li>
</ul>
</li>
<li><a class="reference internal" href="#get-db-doc-attachment">9.2.7. <tt class="docutils literal"><span class="pre">GET</span> <span class="pre">/db/doc/attachment</span></tt></a></li>
<li><a class="reference internal" href="#put-db-doc-attachment">9.2.8. <tt class="docutils literal"><span class="pre">PUT</span> <span class="pre">/db/doc/attachment</span></tt></a><ul>
<li><a class="reference internal" href="#updating-an-existing-attachment">9.2.8.1. Updating an Existing Attachment</a></li>
</ul>
</li>
<li><a class="reference internal" href="#delete-db-doc-attachment">9.2.9. <tt class="docutils literal"><span class="pre">DELETE</span> <span class="pre">/db/doc/attachment</span></tt></a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="database.html"
                        title="previous chapter">9.1. Database Methods</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="local.html"
                        title="next chapter">9.3. Local (non-replicating) Document Methods</a></p><!--

Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at

   http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software distributed
under the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR
CONDITIONS OF ANY KIND, either express or implied. See the License for the
specific language governing permissions and limitations under the License.

-->

<!--

Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at

   http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software distributed
under the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR
CONDITIONS OF ANY KIND, either express or implied. See the License for the
specific language governing permissions and limitations under the License.

-->

<h3>More Help</h3>

<ul>
<li><a href="https://couchdb.apache.org/">Homepage</a></li>
<li><a href="http://wiki.apache.org/couchdb/">Wiki</a></li>
<li><a href="https://couchdb.apache.org/#mailing-list">Mailing Lists</a></li>
<li><a href="http://webchat.freenode.net/?channels=couchdb">IRC</a></li>
<li><a href="https://issues.apache.org/jira/browse/CouchDB">Issues</a></li>
</ul>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="local.html" title="9.3. Local (non-replicating) Document Methods"
             >next</a> |</li>
        <li class="right" >
          <a href="database.html" title="9.1. Database Methods"
             >previous</a> |</li>
        <li><a href="../index.html">Apache CouchDB 1.4 Manual</a> &raquo;</li>
          <li><a href="reference.html" >9. API Reference</a> &raquo;</li> 
      </ul>
    </div>

    <div class="footer">
        &copy; Copyright 2013, The Apache Software Foundation.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
 <!-- End original user content -->


<br/>
<br/>
<br/>


<style type="text/css">
  #version_menu, .rtd-badge.rtd {
    -webkit-transition: all 0.25s 0.75s;
    transition: all 0.25s 0.75s;
  }
  .footer_popout:hover #version_menu, .footer_popout:hover .rtd-badge.rtd {
    -webkit-transition: all 0.25s 0s;
    transition: all 0.25s 0s;
  }
  .rtd-badge {
    position: fixed;
    display: block;
    bottom: 5px;
    height: 40px;
    text-indent: -9999em;
    border-radius: 3px;
    -moz-border-radius: 3px;
    -webkit-border-radius: 3px;
    box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 1px 0 rgba(255, 255, 255, 0.2) inset;
    -moz-box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 1px 0 rgba(255, 255, 255, 0.2) inset;
    -webkit-box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 1px 0 rgba(255, 255, 255, 0.2) inset;
  }
  #version_menu {
    position: fixed;
    visibility: hidden;
    opacity: 0;
    bottom: 11px;
    right: 47px;
    list-style-type: none;
    margin: 0;
  }
  .footer_popout:hover #version_menu {
    visibility: visible;
    opacity: 1;
    right: 166px;
  }
  #version_menu li {
    display: block;
    float: right;
  }
  #version_menu li a {
    display: block;
    padding: 6px 10px 4px 10px;
    margin: 7px 7px 0 0;
    font-weight: bold;
    font-size: 14px;
    height: 20px;
    line-height: 17px;
    text-decoration: none;
    color: #fff;
    background: #8ca1af url(//media.readthedocs.org//images/gradient-light.png) bottom left repeat-x;
    border-radius: 3px;
    -moz-border-radius: 3px;
    -webkit-border-radius: 3px;
    box-shadow: 0 1px 1px #465158;
    -moz-box-shadow: 0 1px 1px #465158;
    -webkit-box-shadow: 0 1px 1px #465158;
    text-shadow: 0 1px 1px rgba(0, 0, 0, 0.5);
  }
  #version_menu li a:hover {
    text-decoration: none;
    background-color: #697983;
    box-shadow: 0 1px 0px #465158;
    -moz-box-shadow: 0 1px 0px #465158;
    -webkit-box-shadow: 0 1px 0px #465158;
  }
  .rtd-badge.rtd {
    background: #3b4449 url(//media.readthedocs.org//images/badge-rtd.png) scroll top left no-repeat;
    border: 1px solid #282E32;
    width: 41px;
    right: 5px;
  }
  .footer_popout:hover .rtd-badge.rtd {
    width: 160px;
  }
  .rtd-badge.revsys { background: #465158 url(//media.readthedocs.org//images/badge-revsys.png) top left no-repeat;
    border: 1px solid #1C5871;
    width: 290px;
    right: 173px;
  }
  .rtd-badge.revsys-inline-sponsored {
    position: inherit;
    margin-left: auto;
    margin-right: 175px;
    margin-bottom: 5px;
    background: #465158 url(//media.readthedocs.org//images/badge-revsys.png) top left no-repeat;
    border: 1px solid #1C5871;
    width: 290px;
    right: 173px;
  }
  .rtd-badge.revsys-inline {
    position: inherit;
    margin-left: auto;
    margin-right: 175px;
    margin-bottom: 5px;
    background: #465158 url(//media.readthedocs.org//images/badge-revsys-sm.png) top left no-repeat;
    border: 1px solid #1C5871;
    width: 205px;
    right: 173px;
  }

</style>
<div class="rtd_doc_footer">
  <div class="footer_popout">
    <a href="//readthedocs.org/projects/couchdb/?fromdocs=couchdb" class="rtd-badge rtd"> Brought to you by Read the Docs</a>
    <ul id="version_menu">
      
        <li><a href="/en/latest/">latest</a></li>
      
        <li><a href="/en/1.4.x/">1.4.x</a></li>
      
        <li><a href="/en/1.3.x/">1.3.x</a></li>
      
    </ul>
  </div>
</div>
<!-- RTD Analytics Code -->
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-17997319-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>




  </body>
</html>